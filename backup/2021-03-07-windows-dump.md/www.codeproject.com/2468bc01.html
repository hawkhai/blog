<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head>

	

	
	<link rel="preconnect" href="https://apps.developermedia.com" />
	<link rel="preconnect" href="https://cdn1.developermedia.com" />
	<link rel="preconnect" href="https://cdn.ampproject.org" />
	<link rel="preconnect" href="https://fonts.googleapis.com" />
	<link rel="preconnect" href="https://ajax.googleapis.com" />
	<link rel="preconnect" href="https://adservice.google.com" />
	<link rel="preconnect" href="https://www.googletagservices.com" />
	<link rel="preconnect" href="https://www.googletagmanager.com" />
	<link rel="preconnect" href="https://www.google.com" />
	<link rel="preconnect" href="https://www.google-analytics.com" />
	<link rel="preconnect" href="https://pagead2.googlesyndication.com" />

	<link rel="preconnect" href="https://codeproject.freetls.fastly.net" />


	<link rel="preload" href="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/logo250x135.gif" as="image" />


	<link rel="preload" href="/App_Themes/CodeProject/Img/logo135-bg.gif" as="image" />
	<link rel="preload" href="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js" as="script" type="text/javascript" />


	<title>Effective Exception Handling in Visual C++ - CodeProject</title> 
    
	<!-- inlined file /App_Themes/CodeProject/Css/article.critical.min.css. Minimized in Release. -->
<style type="text/css">
/*! CSS Used from: /App_Themes/CodeProject/Css/Main.css?dt=2.8.20201208.1 ; media=all */
@media all{.theme1-background{background-color:#f90}.blank-background{background-color:#fff}div,span,iframe,a,code,img,strike,strong,form,label,table,tbody,tr,td,li,ol,ul{margin:0;padding:0;border:0}body,p,h1,h2,h3,h4,h5,li,tr,td{font-family:"Segoe UI",Arial,Sans-Serif;font-size:14px;line-height:1.4;color:#111}body{margin:0}h1,h3,h4,h5{font-weight:bold}h1{color:#333;padding:0;margin:0 0 7px;text-align:left}h2{margin:20px 0 11px;padding:0;padding-bottom:10px;color:#333}h3{color:#f90}h5{color:#808080;margin-bottom:2px}h1{font-size:29px;font-weight:200}h2{font-size:29px;font-weight:200}h3{font-size:19px;font-weight:normal}h4{font-size:16px}h5{font-size:14px;font-weight:bold}pre{color:#000;background-color:#fbedbb;padding:6px;font:13px Consolas,"Courier New",Courier,mono;white-space:pre;overflow:auto !important;border:solid 1px #fbedbb;-moz-tab-size:4;-o-tab-size:4;-webkit-tab-size:4;tab-size:4}code{color:#900;font:15px Consolas,"Courier New",Courier,mono}table{background-color:Transparent}img{-ms-interpolation-mode:bicubic}a{text-decoration:none;color:#005782}a:visited{color:#800080}a:active{text-decoration:underline}a:hover{text-decoration:underline}a:focus{outline:none !important}img:focus{outline:none !important}a:not([href]){color:inherit;text-decoration:none}::selection{background-color:#f90;color:#fff;text-shadow:none}::-moz-selection{background-color:#f90;color:#fff;text-shadow:none}input[type="text"],input[type="search"],select,textarea{border:1px solid #d7d7d7;font-size:14px;padding:5px}input[type="text"]:focus,input[type="search"]:focus,select:focus,textarea:focus{border:1px solid #a0acbf}input[type=radio]{border:none}textarea{font-family:Consolas,monospace}a.button,.button{color:#fff;background-color:#e08900;border:1px solid #ccc;text-decoration:none !important;white-space:nowrap;font-size:100%;padding:4px;cursor:pointer;border-radius:3px;-webkit-border-radius:3px;-moz-border-radius:3px}button.button{font-size:90%}.button.compose{color:#fff !important;background-color:#d14836 !important;border-color:#d14836 !important}.button.compose a,.button.compose a:hover{color:#fff !important}.button.compose:hover{border-color:#c53727 !important}.button.safe{border-color:#76ab40}.button.safe:hover{border-color:#577d30}.tiny-text{font-size:11px}.small-text{font-size:12px !important}.medium-text{font-size:16px}.invisible{display:none}.subdue{color:#808080}.bold{font-weight:bold}.align-left{text-align:left !important}.align-right{text-align:right !important}.align-center{text-align:center}.align-middle{vertical-align:middle}.float-right{float:right}.float-left{float:left}.extended{width:100%;box-sizing:border-box}.padded-top{padding-top:20px !important}.tight{margin:0 !important;padding:0 !important}.spaced{margin:10px}.nowrap{white-space:nowrap}.fixed-layout{table-layout:fixed}.clipped{overflow:hidden}.inline{display:inline-block}.raised{background-color:#fff8df;border:1px solid #ccc;-moz-box-shadow:4px 4px 16px 1px rgba(0,0,0,.25);-webkit-box-shadow:4px 4px 16px 1px rgba(0,0,0,.25);box-shadow:4px 4px 16px 1px rgba(0,0,0,.25)}.border-none{border-style:none !important}.border-none:focus{border-style:none !important;outline:transparent}ol,ul{padding-left:40px;margin:10px 0}ul li.compact{font-size:12px}ul.download{margin-top:25px}ul.download li{background:url("/images/download24.png") no-repeat scroll left center transparent;font-weight:bold;list-style-type:none;margin:0 0 6px -40px;padding:0 0 1px 30px;vertical-align:middle}div.admin-only{background-color:#ffffbe}.annotation{margin:20px 0;background-color:#ffffe1;color:#333;border:1px solid #ccc;padding:15px}.trace{padding:20px;background-color:#eee;color:#333;border:1px solid #f00;font-size:11px}.safe{background-color:#76ab40 !important}textarea,input[type="text"],input[type="submit"]{-webkit-appearance:none;border-radius:0}div.pagelog{border:0 !important;padding:0 !important}div.pagelog.slow{background-color:#ff0;color:#f00 !important}div.pagelog&gt;span{display:inline-block}div.pagelog&gt;span.timestamp{width:60px;padding-right:5px;text-align:right}div.pagelog&gt;span.timestamp .partial{font-size:70%;vertical-align:top}div.pagelog&gt;span.duration{width:60px;text-align:right;padding:0 10px 0 5px}div.pagelog&gt;span.calldata{padding-left:10px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;display:inline-block}.container-content{background-color:#fff;position:relative;zoom:1;padding:0 9px;cursor:default}.container-content-wrap{margin:auto;max-width:1056px}.container-content pre{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word;_white-space:pre;word-break:break-word;-ms-word-break:break-word}.flex-container{display:-webkit-box !important;display:-moz-box !important;display:-ms-flexbox !important;display:-webkit-flex !important;display:flex !important}.flex-extend{justify-content:space-between}.flex-item{-webkit-box-flex:1 !important;-moz-box-flex:1 !important;-webkit-flex:1 !important;-ms-flex:1 !important;flex:1 !important}.flex-item-tight{flex:0 1 auto}.button-group{white-space:nowrap;padding-right:1em;margin:0}.hover-container{display:block;position:relative}.hover-container .button-group,.hover-row .button-group{display:none}.hover-row:hover,.hover-row:hover td{background-color:#fff8df !important}.hover-container:hover .button-group{background-color:inherit;margin:0;position:absolute;top:0;right:3px;display:block}.clearfix:after,.container:after{display:block;content:'.';visibility:hidden;height:0;clear:both}.clearfix,.container{display:inline-block;display:block}.access-link,.access-link img{position:absolute;top:0;left:0;width:1px;height:1px;z-index:101;border-style:none;margin-top:-1px;overflow:hidden}.site-top-menu{white-space:nowrap;position:absolute;z-index:101;width:100% !important}.site-top-menu .main-content{width:100% !important}.site-top-menu .main-content .memberbar{margin-left:90px;margin-right:10px}.site-top-menu.fixed .main-content{margin:auto;max-width:1056px}.site-header{background-image:url('/App_Themes/CodeProject/Img/logo135-bg.gif');white-space:nowrap;overflow:hidden}.site-header .main-content{position:relative;overflow:hidden;white-space:nowrap}.site-header .logo{display:inline-block}.site-header .promo{display:inline-block;position:absolute;top:33px;right:0}.site-header.fixed .main-content{margin:auto;max-width:1056px}@media(max-width:1000px){.site-header .promo{left:250px}}.sub-headerbar{padding-right:9px;position:relative;margin:auto;max-width:1044px}.sub-headerbar-divider{margin-left:10px;height:1px;border-bottom:1px solid #ccc;position:absolute;bottom:2px;left:0;right:9px}.memberbar{height:25px;padding-top:10px;color:#999;font-size:12px}.memberbar a{color:#808080;font-size:12px}.member-links .me{font-weight:bold}.member-links .me.mobile-only{font-size:24px}.member-links .tooltip-flyout{width:13em !important;right:-16px !important;left:auto !important;border-bottom:4px #f90 solid}.notification-count{background-color:#f00 !important;color:#fff !important;font-weight:bold;margin-right:3px;font-size:11px;padding:0 4px 1px 4px;vertical-align:baseline;border-radius:6px;-webkit-border-radius:6px;-moz-border-radius:6px}.notification-count,.notification-count:hover,.notification-count:visited{color:#fff}.notification-dropdown{left:auto !important;right:-115px;width:350px !important}.notification-dropdown .notification-list{max-height:400px;overflow-y:auto}div.navbar{white-space:nowrap}.navmenu{background:#fff;color:#4d4d4d;padding:0;margin:0;list-style:none;height:25px}.navmenu ul,.navmenu li{margin:0;padding:0}.navmenu .has-submenu{position:absolute;right:5px;padding-left:10px}.navmenu&gt;li:hover&gt;a,.navmenu&gt;li&gt;a:active{border:1px solid #ccc}.navmenu ul{border:1px solid #ccc;border-bottom-color:#fff}.navmenu&gt;li{margin:0 11px 2px 2px}.navmenu&gt;li:active,.navmenu&gt;li:active&gt;a,.navmenu&gt;li:hover,.navmenu&gt;li&gt;a:active{background:#fff !important;color:#4d4d4d !important}.navmenu&gt;li&gt;a{padding:2px 7px 6px 7px;border:1px solid transparent;font-weight:bold}.navmenu a{display:block;float:left;color:#666;background:#fff;font-size:16px;padding:0 9px;text-decoration:none;white-space:nowrap}.navmenu a.fly{white-space:nowrap}.navmenu ul{background:#fff;position:absolute;left:-9999px;top:-9999px;list-style:none}.navmenu li{float:left;color:#4d4d4d}.navmenu li.last{height:9px}.navmenu li a:active,.navmenu li a:hover{color:#fff;background-color:#f90}.navmenu li&gt;a:active,.navmenu li:hover,.navmenu li:hover&gt;a,.navmenu li a.selected{position:relative;color:#fff;background-color:#f90}.navmenu li.openable:hover ul{left:0;top:30px;z-index:500}.navmenu li.openable:hover li.openable:active&gt;ul,.navmenu li.openable:hover li.openable:hover&gt;ul{left:-1px;margin-left:100%;top:-1px;z-index:500}.navmenu li.openable:hover&gt;ul ul{position:absolute;left:-9999px;top:-9999px;width:auto}.navmenu li li:hover ul.taxonomy{left:100%;margin-left:-1px;top:-1px}.navmenu li ul{border-bottom:5px solid #f90}.navmenu li li{float:none}.navmenu li li:active&gt;a.fly,.navmenu li li:hover&gt;a.fly{color:#fff;background-color:#f90}.navmenu li li a{float:none;font-size:13px;font-weight:normal}.navmenu li li a.fly{color:#4d4d4d;background-color:#fff;padding:2px 20px}.navmenu li li a.break{margin-bottom:15px}.navmenu li li a.highlight1,.navmenu li li a.highlight1:active,.navmenu li li a.highlight1:hover{background-color:#090}.navmenu li li a.highlight2,.navmenu li li a.highlight2:active,.navmenu li li a.highlight2:hover{background-color:#f90}.navmenu li li a.highlight3,.navmenu li li a.highlight3:active,.navmenu li li a.highlight3:hover{background-color:#000}.navmenu li li a.highlight1,.navmenu li li a.highlight2,.navmenu li li a.highlight3{color:#fff;font-size:15px;margin:5px 0;padding:9px 20px}.site-footer{display:-webkit-box !important;display:-moz-box !important;display:-ms-flexbox !important;display:-webkit-flex !important;display:flex !important;padding-top:5px;width:100%;font-size:11px;color:#999}.site-footer .align-left,.site-footer .align-center,.site-footer .align-right{-webkit-box-flex:1 !important;-moz-box-flex:1 !important;-webkit-flex:1 !important;-ms-flex:1 !important;flex:1 !important}.site-footer .align-left{flex:1 0 100px}.site-footer .align-center{flex:0 1 0%;white-space:nowrap}.site-footer .align-right{flex:1 0 100px}.site-footer .page-width .active{border-bottom:2px solid #f90}.admin-bar{margin-left:20px}.admin-bar img{vertical-align:text-bottom;opacity:.6;margin-left:7px}.admin-bar img:hover{opacity:1}.searchbar{padding:0}.searchbar .search{margin-bottom:4px;padding:2px 5px 0;border:1px solid #ccc}.searchbar .search.subdue{color:#ccc}.searchbar input.search{width:190px;border:none;font-size:11px;padding:4px 2px}.searchbar .search-advanced{padding:8px;width:203px;z-index:1000;background-color:#fff;border:solid 1px #ccc;position:absolute;top:-4px;right:0}.search td{background-color:#fff}.article-container-parts{display:-webkit-box !important;display:-moz-box !important;display:-ms-flexbox !important;display:-webkit-flex !important;display:flex !important}.article-container{-webkit-box-flex:1 !important;-moz-box-flex:1 !important;-webkit-flex:1 !important;-ms-flex:1 !important;flex:1 !important;background-color:#fff;color:#111;zoom:1;position:relative;max-width:730px;min-height:675px}.article-container .article{margin:0 20px 0 10px;line-height:143%}.article-left-sidebar{width:120px;min-width:120px;min-height:400px;font-size:12px;border-right:1px solid #f2f2f2;padding:0}.article-left-sidebar .article-left-sidebar-inner{width:120px;min-width:120px}.article-left-sidebar .tabs&gt;div{padding:5px 0 5px 10px}.article-left-sidebar .selected{font-weight:bold;background:transparent url("/images/right-selected.gif") no-repeat scroll right 9px}.article-left-sidebar h4{color:#f90;font-size:12px;font-weight:bold}.article-left-sidebar .stats div div div{padding:0 0 10px 10px;color:#666}.article-right-sidebar{width:160px;margin-left:10px;font-size:12px}.article-right-sidebar .gototop{text-align:center;padding:10px 0;opacity:0;-webkit-transition:opacity .3s linear 0ms;-moz-transition:opacity .3s linear 0ms;-o-transition:opacity .3s linear 0ms;transition:opacity .3s linear 0ms}.article-right-sidebar .stuck .gototop{opacity:1;-webkit-transition:opacity .3s linear 0ms;-moz-transition:opacity .3s linear 0ms;-o-transition:opacity .3s linear 0ms;transition:opacity .3s linear 0ms}.article-right-sidebar .stuck .gototop a{border:1px solid #ccc;padding:3px 10px;border-radius:8px;-webkit-border-radius:8px;-moz-border-radius:8px}.container-content .edit-links{margin:21px 0 0 10px}.article-summary{padding:0 10px 0 10px;overflow:hidden}.article-summary ul.prize-list{background:url("/images/award24.gif") no-repeat scroll left 5px transparent;list-style-type:none;margin:0 0 6px 0;padding:0 0 1px 30px;vertical-align:middle}.article-summary ul.prize-list li{font-size:12px;line-height:17px}.article h1{margin:0 0 15px 0}.article h2{color:#f90}.article pre{overflow:auto}.article .header .title{color:#808080}.article .header .author{font-weight:bold;min-width:100px}.article .header .author a{color:#808080}.article .header .avatar{max-width:48px;max-height:48px;margin-right:10px;overflow:unset}.article .header .date{white-space:nowrap}.article .header .license{margin-left:15px}.article img.lazyload{opacity:0}.article img.lazyloaded{opacity:1;transition:opacity 300ms}.article .share-list{margin-bottom:40px;width:385px;display:inline-block}.article .summary{color:#808080;padding:40px 0 15px 0}.article .text{padding-top:10px}.article-nav{text-align:right;margin-top:21px;vertical-align:middle;line-height:15px}.msg-728x90{width:728px;height:90px;overflow:hidden}.msg-300x250{width:300px;height:250px;overflow:hidden}.msg-160x600{width:160px;height:600px;overflow:hidden}div.readlaterlist-dropdown{width:18em}.tags{line-height:190%}.tags .t{background:none repeat scroll 0 0 transparent;border:1px solid transparent;border-radius:12px 0 0 12px;line-height:1.4;padding:0 2px 0 4px;position:relative;text-decoration:none;margin:2px 0 4px 0;white-space:nowrap}.tags .t .follow{opacity:.3;margin-bottom:-1px}.tags .t .follow:hover{opacity:1}.tags .t.followed{background-color:transparent !important}.tags .t.followed img{opacity:1 !important}.tags .t:hover{background-color:#fff8ba !important;border:1px solid #e5dc8a;text-decoration:none}.tags .t a{color:#666;display:inline-block;margin-right:3px;padding-left:5px;text-overflow:ellipsis}.container-breadcrumb{font-size:12px;margin-top:5px;color:#808080;margin:12px 0 35px}.container-breadcrumb a{color:#808080}.code-comment{color:#008000;font-style:italic}.code-summarycomment{color:#808080}.code-keyword{color:#00f}.code-sdkkeyword{color:#399}.code-string{color:#800080}.code-attribute{color:#f00}.code-leadattribute{color:#800000}.code-digit{color:#000080}.pre-action-link{position:relative;font-size:11px;text-align:right;color:#999;display:inline}.pre-action-link span{cursor:pointer;margin:0;-webkit-transition:color .1s linear;-moz-transition:color .1s linear;-o-transition:color .1s linear;transition:color .1s linear}.pre-action-link img{vertical-align:text-top;opacity:.5;-webkit-transition:opacity .1s linear 0ms;-moz-transition:opacity .1s linear 0ms;-o-transition:opacity .1s linear 0ms;transition:opacity .1s linear 0ms}.pre-action-link:hover span{color:#005782}.pre-action-link:hover img{opacity:1}.speech-bubble-container-up,.speech-bubble-container-up-right{position:relative}.speech-bubble-up,.speech-bubble-up-right{padding:.6em;border:1px solid #ccc;background-color:#fff !important;margin:15px;text-decoration:none;font-weight:normal;text-align:left;white-space:normal;color:#333;font-size:11px}.tooltip .speech-bubble-up,.tooltip .speech-bubble-up-right{-moz-box-shadow:4px 4px 16px 1px rgba(0,0,0,.25);-webkit-box-shadow:4px 4px 16px 1px rgba(0,0,0,.25);box-shadow:4px 4px 16px 1px rgba(0,0,0,.25)}.speech-bubble-pointer-up,.speech-bubble-pointer-up-right,.speech-bubble-pointer-up-inner,.speech-bubble-pointer-up-right-inner{width:0;height:0;border-top-width:0;background:none}.speech-bubble-pointer-up,.speech-bubble-pointer-up-right{border-left:5px solid transparent;border-right:5px solid transparent;border-bottom:1px solid #ccc;border-bottom-width:14px;margin-left:35px;position:absolute;top:-12px;_display:none}.speech-bubble-pointer-up-inner,.speech-bubble-pointer-up-right-inner{border-left:5px solid transparent;border-right:5px solid transparent;border-bottom:12px solid #fff;margin-left:-5px;margin-bottom:-16px;padding-top:4px;position:absolute;_display:none}.speech-bubble-container-up-right .speech-bubble-pointer-up-right{margin-left:0;margin-right:0;right:35px}.tooltip{position:relative;text-decoration:none}.tooltip .speech-bubble-container-up,.tooltip .speech-bubble-container-up-right,.tooltip .tooltip-flyout{display:none;opacity:0;-webkit-transition:opacity .2s linear 0ms;-moz-transition:opacity .2s linear 0ms;-o-transition:opacity .2s linear 0ms;transition:opacity .2s linear 0ms}.tooltip:hover .speech-bubble-container-up,.tooltip:active .speech-bubble-container-up,.tooltip:hover .speech-bubble-container-up-right,.tooltip:active .speech-bubble-container-up-right,.tooltip:hover .tooltip-flyout,.tooltip:active .tooltip-flyout{display:block;z-index:16777271;opacity:1;-webkit-transition:opacity .2s linear 0ms;-moz-transition:opacity .2s linear 0ms;-o-transition:opacity .2s linear 0ms;transition:opacity .2s linear 0ms}.tooltip:hover .speech-bubble-container-up,.tooltip:active .speech-bubble-container-up{left:-35px}.tooltip:hover .speech-bubble-container-up-right,.tooltip:active .speech-bubble-container-up-right{right:-25px}.tooltip:hover .speech-bubble-container-up,.tooltip:active .speech-bubble-container-up,.tooltip:hover .speech-bubble-container-up-right,.tooltip:active .speech-bubble-container-up-right{text-decoration:none !important;position:absolute;width:150px;color:#000 !important;cursor:text}.tooltip:hover .tooltip-flyout,.tooltip:active .tooltip-flyout,.tooltip:hover .speech-bubble-container-up-right .speech-bubble-pointer-up-right,.tooltip:active .speech-bubble-container-up-right .speech-bubble-pointer-up-right,.tooltip:hover .speech-bubble-container-up .speech-bubble-pointer-up,.tooltip:active .speech-bubble-container-up .speech-bubble-pointer-up{top:1px}a:hover.tooltip{text-decoration:none !important}.tooltip-flyout{position:relative;border:1px solid #ccc;color:#666;background-color:#fff;margin:15px;z-index:2147483646;white-space:normal;font-weight:normal;text-align:left;cursor:text;width:175px;-moz-box-shadow:4px 4px 16px 1px rgba(0,0,0,.25);-webkit-box-shadow:4px 4px 16px 1px rgba(0,0,0,.25);box-shadow:4px 4px 16px 1px rgba(0,0,0,.25)}.tooltip:hover .tooltip-flyout,.tooltip:active .tooltip-flyout{position:absolute;left:-16px;top:0;display:block}.tooltip-flyout .list-item{text-decoration:none;padding:4px 15px;display:block}.tooltip-flyout .list-item:hover,.tooltip-flyout .list-item:hover a{text-decoration:none;color:#fff !important;background-color:#f90 !important}.report-header{font-weight:bold;font-size:14px;padding:4px 10px 0 16px}.report-header img{vertical-align:middle}.report-prompt{display:-webkit-box !important;display:-moz-box !important;display:-ms-flexbox !important;display:-webkit-flex !important;display:flex !important;justify-content:flex-start;font-size:12px;padding:2px 0;margin:2px 0}.report-prompt a{flex:1 1 auto}.report-comment{width:175px;margin-left:15px}.report-count-inline{display:inline-block;width:15px;color:#666}.modal{position:fixed;z-index:10000;padding-top:100px;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:#000;background-color:rgba(0,0,0,0);display:none;-webkit-transition:background-color .2s linear 0ms;-moz-transition:background-color .2s linear 0ms;-o-transition:background-color .2s linear 0ms;transition:background-color .2s linear 0ms}.readingListModal .modal_add_row{margin-bottom:5px}.readingListModal .modal_label{display:inline-block;width:80px}.readingListModal .modal_input_text{width:280px}.readingListModal .modal_loadingReadingLists{width:100%;text-align:center}.readingListModal .modal_readingLists{display:flex;flex-direction:column;text-align:left}.readingListModal .modal_readingListsColumn{text-align:left;min-height:100px;max-height:125px;overflow-y:auto;margin-bottom:10px}.readingListModal .modal_createReadingListRow{display:flex;flex-direction:row;align-items:center;justify-content:center}.readingListModal .modal_createReadingListRow:hover{color:#f90;cursor:pointer}.readingListModal .modal_createReadingListText{margin-left:10px}.readingListModal .modal_readingListAddBox{display:none}.readingListModal .modal_readingListAddBoxColumn{display:flex;flex-direction:column;align-items:flex-start}.readingListModal .modal_addBoxText{width:100%;text-align:center;margin-bottom:15px}.readingListModal .modal_createAndAddButtonContainer{display:flex;flex-direction:column;align-items:center;margin-top:15px;margin-bottom:15px;width:100%}.readingListModal .modal_createAndAddButton{width:200px}.readingListModal .modal_createAndAddStatusText{align-self:center;height:25px}.readingListModal .modal_readingListFilterBox{width:100%;text-align:left}.readingListModal .modal_readingListFilterInput{height:25px;outline:0;border:1px solid #ccc;border-radius:3px;width:75%}.readingListModal .modal_makePrimaryCheckBox{text-align:center;margin-bottom:10px}.readingListModal .modal_overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.6);display:flex;justify-content:center;align-items:center}.readingListModal .modal_container{background-color:#fff;padding:20px 30px;min-width:500px;max-width:500px;min-height:40vh;max-height:80vh;border-radius:4px;overflow-y:auto;box-sizing:border-box}.readingListModal .modal_header{display:flex;justify-content:space-between;align-items:center}.readingListModal .modal_title{margin-top:0;margin-bottom:0;color:#f90;box-sizing:border-box}.readingListModal .modal_close{background:transparent;border:0}.readingListModal .modal_header .modal_close:before{content:"✕"}.readingListModal .modal_content{margin-top:1rem;margin-bottom:2rem;line-height:1.5;color:rgba(0,0,0,.8)}.readingListModal .modal_btn{font-size:.875rem;padding-left:1rem;padding-right:1rem;padding-top:.5rem;padding-bottom:.5rem;background-color:#e6e6e6;color:rgba(0,0,0,.8);border-radius:.25rem;border-style:none;border-width:0;cursor:pointer;-webkit-appearance:button;text-transform:none;overflow:visible;line-height:1.15;margin:0;will-change:transform;-moz-osx-font-smoothing:grayscale;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-transform:translateZ(0);transform:translateZ(0);transition:-webkit-transform .25s ease-out;transition:transform .25s ease-out;transition:transform .25s ease-out,-webkit-transform .25s ease-out}.readingListModal .modal_btn:focus,.readingListModal .modal_btn:hover{-webkit-transform:scale(1.05);transform:scale(1.05)}.readingListModal .modal_btn-primary{background-color:#00449e;color:#fff}.bottom-promo{height:90px;margin-top:10px;overflow:hidden}.bottom-promo .msg-728x90{width:728px;margin:0 auto}.msg-728x90{overflow:hidden;position:relative;height:90px;min-width:728px}body .msg-728x90{*float:right}body .bottom-promo .msg-728x90{*float:none}table.forum{table-layout:fixed;margin:0 0 20px 0;padding:0 !important;width:100%}.forum table{border-collapse:separate}.forum .header1,.forum .header1 TD{color:#333;font-size:12px;vertical-align:middle}.forum .header2,.forum .header2 TD{color:#fff;background-color:#f90;font-size:12px;vertical-align:middle}.forum .header2 input,.forum .header2 TD input,.forum .header2 select,.forum .header2 TD select{padding:2px}.forum .email-alert{border:1px solid #577d30;background-color:#76ab40 !important;text-decoration:none !important;white-space:nowrap;font-size:100%;margin:3px 4px 5px 0;padding:4px 6px;cursor:pointer;float:right;color:#fff;border-radius:3px;-webkit-border-radius:3px;-moz-border-radius:3px}.forum .email-alert:hover{border-color:#577d30}.forum .button{border:1px solid #fc6;margin:1px}.forum .new-message.button{margin:5px 4px 5px 0;padding:5px 10px}.forum .new-message.button a{font-weight:normal;font-size:16px}.forum .searchbar{border:1px solid #ccc;padding:4px 0 0 0;margin:3px 0}.forum .searchbar .search{width:200px}.forum .searchbar input[type=image]{vertical-align:middle}.forum .signature{border-top:solid 1px #ccc;padding-top:0;margin-top:10px;max-height:150px;overflow:auto}.forum .modified{margin:0;padding:0;color:#333;font-style:italic;font-size:12px}.forum .dropdown{background-color:#fffdfa;font-size:95%;margin-left:5px}.forum .footer,.forum .footer td,.forum .navbar,.forum .navbar td{font-size:12px;padding:8px 0;border:0;border-top:1px solid #808080}.forum .footer .rating-result{white-space:nowrap;margin-right:15px}.forum .nav-link{color:#333;padding:1px 4px}.forum .nav-link:hover{color:#fff !important;background-color:#f90;text-decoration:none}.forum .nav-link.selected{color:#f90;font-weight:bold}.forum .nav-link.selected:hover{color:#f90 !important;background-color:transparent}.forum .nav-link.disabled{color:#808080}.forum .nav-link.disabled:hover{color:#808080 !important;background-color:transparent}.root .subject-line td{font-weight:bold}.root td.subject-line{border-top:1px dotted #f90}.selected.content&gt;td{background-color:#fff9e2 !important}.subject-line{border-bottom:1px solid #f2f2f2;background-color:transparent;overflow:hidden}.subject-line tr,.subject-line td{background-color:inherit}.subject-line .indent{vertical-align:top;text-align:right;padding:8px 0;background-color:#fff;position:relative}.subject-line .indent img{margin-right:4px}.subject-line .subject{vertical-align:top;text-align:left;padding:5px 0 7px 5px;font-size:14px}.subject-line .subject a{color:#005782}.subject-line .icon{vertical-align:top;width:20px;white-space:nowrap;padding:8px 0}.subject-line .author{vertical-align:top;text-align:left;width:140px;padding:8px 0 8px 2px;overflow:hidden}.subject-line .author a{color:#333;text-overflow:ellipsis;font-size:12px}.subject-line .date{vertical-align:top;text-align:right;width:130px !important;white-space:nowrap;padding:8px 0;color:#333;font-size:12px}.subject-line .count{vertical-align:top;text-align:right;width:30px !important;padding:5px 0}.content&gt;td{border-bottom:1px solid transparent}.content td.text{padding:7px}.content td.text a{word-break:break-all}.content a{color:#005782}.content a.new-message{background-color:transparent;padding:3px !important}.content .footer:hover a{color:#069;-webkit-transition:color .1s linear;-moz-transition:color .1s linear;-o-transition:color .1s linear;transition:color .1s linear}.content .footer:hover td{color:#808080;-webkit-transition:color .1s linear;-moz-transition:color .1s linear;-o-transition:color .1s linear;transition:color .1s linear}.content .footer:hover a.new-message{background-color:#c53227;color:#fff !important}.content .indent{background-color:#fff}.content .footer,.content .footer td{color:#808080;background-color:transparent;padding:15px 0 3px 0;font-size:12px;border:0;line-height:24px}.content .footer a,.content .footer td a{color:#808080;border:solid 1px transparent;_border:solid 1px white;padding:1px}.content .footer a:hover,.content .footer td a:hover{border:solid 1px #f90;color:#069}.content img{max-width:100%;height:auto}.vote-hi,.vote-hi a{color:#006400 !important}.author-wrapper{position:relative;padding:0 0 0 200px;min-height:185px}.author-wrapper .pic-wrapper{position:absolute;left:0;top:5px}.author-wrapper .follow{padding-right:15px}.author-wrapper .profile-pic{border:1px solid #333;margin:0;padding:10px;-moz-box-shadow:3px 3px 5px 1px rgba(0,0,0,.2);-webkit-box-shadow:3px 3px 5px 1px rgba(0,0,0,.2);box-shadow:3px 3px 5px 1px rgba(0,0,0,.2)}.author-wrapper .description{padding:15px 15px 0 0}.author-wrapper .container-member .author{font-size:22px;color:#333}.author-wrapper .container-member .company{font-size:14px;color:#808080}.member-message{margin-left:30px}a.member-rep-box{padding:0 2px;margin:4px;text-align:center;border-radius:4px;-webkit-border-radius:4px;-moz-border-radius:4px}a.member-rep-box.platinum{border:solid 2px #cfe7ff !important}.rating-container .rating-prompt{padding-right:5px;white-space:nowrap;line-height:25px;margin-right:2px;font-weight:bold;color:#808080}.rating-container:hover .rating-result.with-voting{display:none}.rating-container:hover .rating-vote{display:inline-block}.rating-container .rating-votes{margin-left:5px}.rating-container.large-stars{margin-left:7px}.rating-container.large-stars .rating-votes,.rating-container.large-stars .rating-prompt{line-height:25px}.rating-container .rating-vote .rating-star{cursor:pointer}.rating-container .rating-comment-wrap{top:12px !important;width:280px;position:relative;text-align:center}.rating-container .rating-comment{background-color:#fff;width:94%;margin:3px auto 0 auto;height:100px;border:1px solid #ccc;padding:0 5px}.rating-container .histogram{min-height:60px;display:block}.rating-vote a{cursor:pointer}.followed,.unfollowed{font-weight:bold;color:#555 !important;display:inline-block}.followed{background-color:#dedede !important;border:1px solid #f2f2f2;color:#a2a2a2 !important;font-weight:normal !important}.unfollowed{background-color:#79a9f2 !important;border:1px solid #ccc;color:#fff !important}@media(min-width:1024px){.desktop-only{display:inherit}.tablet-only{display:none}.mobile-only{display:none}.desktop-only.tablet-only{display:inherit !important}}@media(min-width:800px) and (max-width:1023px){.article-container-parts .article-container{max-width:100% !important}.article-container-parts .article-left-sidebar{display:none}.article-container-parts .article{margin:0 !important}}@media(min-width:757px) and (max-width:800px){.article-container-parts .article-container{max-width:100% !important}.article-container-parts .article-left-sidebar{display:none}.article-container-parts .article-right-sidebar{display:none}.article-container-parts .article{margin:0 !important}.article-container-parts .bottom-promo{display:none;overflow:hidden}.article-container-parts .bottom-promo .msg-728x90{position:absolute !important}}@media(max-width:756px){.article-container-parts .article-container{max-width:100% !important}.article-container-parts .article{margin:0 !important}.article-container-parts .article h1{margin-right:55px !important}.article-container-parts .article-left-sidebar{display:none}.article-container-parts .article-right-sidebar{display:none}.article-container-parts .bottom-promo{display:none}.author-wrapper{padding-left:0 !important;float:left !important}.author-wrapper .description{padding-top:15px;float:left}.author-wrapper .pic-wrapper{position:relative !important;left:0;top:0;margin:0 30px 20px 0;float:left}.author-wrapper .profile-pic{margin-left:0;width:auto;max-width:160px}}@media(min-width:769px){.tablet-only,.mobile-only{display:none}.tablet-only.desktop-only{display:inherit !important}}@media(min-width:576px) and (max-width:768px){.desktop-only{display:none}.tablet-only{display:inherit}.mobile-only{display:none}.desktop-only.tablet-only{display:inherit !important}.navmenu&gt;li{margin:0 4px !important}.site-top-menu{position:relative !important}.site-top-menu .memberbar,.site-top-menu .memberbar a{height:auto;margin-bottom:5px}.site-top-menu .memberbar{padding:0 5px !important;margin:0 !important;line-height:25px}}@media(max-width:575px){.desktop-only{display:none !important}.tablet-only{display:none !important}.mobile-only{display:inherit !important}img{max-width:100%;height:auto}.article .share-list{width:100% !important}.forum .header2{display:none}.forum .subject-line td.author{width:1px}.forum .subject-line td.date{width:1px !important}.forum .subject-line .indent img{display:none}.forum .subject-line .icon img{display:none}.forum .subject-line .author span{display:none}.forum .subject-line .date span{display:none}.forum .subject-line .author{color:#808080;font-weight:bold}.forum .subject-line .date{font-size:inherit;width:auto;padding:0;margin-left:15px;color:#808080}.forum .hover-container:hover .button-group{display:none}.forum .searchbar .search{width:180px !important;font-size:14px !important}.forum .footer .last-visit{display:none}.article-nav{z-index:100;margin-top:10px !important;width:auto !important}.article-container{word-break:break-word;-ms-word-break:break-word}.navmenu&gt;li{margin:0 4px !important}div.navbar{padding:5px 0}.notification-count{display:none}.container-breadcrumb{display:none}.container-content .edit-links{display:none}.site-top-menu{position:relative !important}.site-top-menu .memberbar,.site-top-menu .memberbar a{height:auto;margin-bottom:5px}.site-top-menu .memberbar{padding:0 5px !important;margin:0 !important;line-height:25px}.site-top-menu .memberbar .readlaterlist-dropdown{left:-129px}.author-wrapper .container-member{float:left}.site-header{margin-top:-22px !important;overflow:unset;height:132px}.site-header .main-content{position:absolute;left:0}.searchbar .search{width:100% !important}.admin-bar{margin-left:10px !important}.admin-bar img{margin-left:0 !important}.memberbar .tooltip-flyout{top:6px !important}.msg-728x90{display:none}.msg-300x250{display:none}.msg-160x600{display:none}}@media print{pre{overflow-x:auto;white-space:pre-wrap;white-space:-moz-pre-wrap !important;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}body,p,h1,h2,h3,h4,h5,li,tr,td{font-family:"Segoe UI",Arial,Sans-Serif;font-size:12px;line-height:1.4;color:#111}h1{font-size:27px;font-weight:200}h2{font-size:27px;font-weight:200}h3{font-size:19px;font-weight:normal}h4{font-size:16px}h5{font-size:14px;font-weight:bold}}.rrssb-buttons,.rrssb-buttons li,.rrssb-buttons li a{-moz-box-sizing:border-box;box-sizing:border-box}.clearfix{*zoom:1}.clearfix:after{clear:both}.clearfix:before,.clearfix:after{content:" ";display:table}.rrssb-buttons{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;height:40px;margin:0;padding:0;width:100%}.rrssb-buttons li{float:left;height:100%;list-style:none;margin:0;padding:0 2.5px;line-height:13px}.rrssb-buttons li.email a{background-color:#0a88ff}.rrssb-buttons li.email a:hover{background-color:#006ed6}.rrssb-buttons li.facebook a{background-color:#306199}.rrssb-buttons li.facebook a:hover{background-color:#244872}.rrssb-buttons li.linkedin a{background-color:#007bb6}.rrssb-buttons li.linkedin a:hover{background-color:#005983}.rrssb-buttons li.twitter a{background-color:#26c4f1}.rrssb-buttons li.twitter a:hover{background-color:#0eaad6}.rrssb-buttons li.reddit a{background-color:#8bbbe3}.rrssb-buttons li.reddit a:hover{background-color:#62a3d9}.rrssb-buttons li.pinterest a{background-color:#b81621}.rrssb-buttons li.pinterest a:hover{background-color:#8a1119}.rrssb-buttons li.compact{padding:0 4.5px}.rrssb-buttons li.compact a{border-radius:50%;padding:0 7px 0 32px}.rrssb-buttons li.compact a .icon{left:7px;top:-3px;width:5%;transform:scale(.85)}.rrssb-buttons li.compact a .icon svg{height:auto;width:auto}.rrssb-buttons li a{background-color:#ccc;border-radius:3px;display:block;font-size:11px;font-weight:bold;height:100%;padding:11px 7px 12px 27px;position:relative;text-align:center;text-decoration:none;text-transform:uppercase;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;width:100%;-webkit-transition:background-color .2s ease-in-out;-moz-transition:background-color .2s ease-in-out;-o-transition:background-color .2s ease-in-out;transition:background-color .2s ease-in-out}.rrssb-buttons li a .icon{display:block;height:100%;left:10px;padding-top:9px;position:absolute;top:0;width:10%}.rrssb-buttons li a .icon svg{height:17px;width:17px}.rrssb-buttons li a .icon svg path{fill:#fff}.rrssb-buttons li a:active{box-shadow:inset 1px 3px 15px 0 rgba(22,0,0,.25)}}.cc-window{opacity:1;background-color:#f90}.cc-window.cc-invisible{opacity:0}.cc-animate.cc-revoke.cc-top{transform:translateY(-2em)}.cc-animate.cc-revoke.cc-bottom{transform:translateY(2em)}.cc-animate.cc-revoke.cc-active.cc-top{transform:translateY(0)}.cc-animate.cc-revoke.cc-active.cc-bottom{transform:translateY(0)}.cc-revoke:hover{transform:translateY(0)}.cc-grower{max-height:0;overflow:hidden;-webkit-transition:max-height .25s;-moz-transition:max-height .25s;-ms-transition:max-height .25s;-o-transition:max-height .25s;transition:max-height .25s}.cc-window,.cc-revoke{position:fixed;overflow:hidden;box-sizing:border-box;font-family:"Segoe UI",Arial,Sans-Serif;font-size:13px;line-height:1.5em;display:flex;flex-wrap:nowrap;z-index:9999}.cc-window.cc-static{position:static}.cc-window.cc-floating{padding:2em;max-width:24em;flex-direction:column}.cc-window.cc-banner{padding:.7em 1.8em;width:100%;flex-direction:row}.cc-revoke{padding:.5em}.cc-revoke:hover{text-decoration:underline}.cc-header{font-size:18px;font-weight:bold}.cc-btn,.cc-link,.cc-close,.cc-revoke{cursor:pointer}.cc-link{opacity:.8;display:inline-block;padding:.2em;text-decoration:underline}.cc-link:hover{opacity:1}.cc-link:active,.cc-link:visited{color:initial}.cc-btn{display:block;padding:.4em .8em;font-size:.9em;font-weight:bold;border-width:2px;border-style:solid;text-align:center;white-space:nowrap}.cc-banner .cc-btn:last-child{min-width:110px;margin-left:10px}.cc-highlight .cc-btn:first-child{background-color:transparent;border-color:transparent}.cc-highlight .cc-btn:first-child:hover,.cc-highlight .cc-btn:first-child:focus{background-color:transparent;text-decoration:underline}.cc-close{display:block;position:absolute;top:.5em;right:.5em;font-size:1.6em;opacity:.9;line-height:.75}.cc-close:hover,.cc-close:focus{opacity:1}.cc-revoke.cc-top{top:0;left:3em;border-bottom-left-radius:.5em;border-bottom-right-radius:.5em}.cc-revoke.cc-bottom{bottom:0;left:3em;border-top-left-radius:.5em;border-top-right-radius:.5em}.cc-revoke.cc-left{left:3em;right:unset}.cc-revoke.cc-right{right:3em;left:unset}.cc-top{top:1em}.cc-left{left:1em}.cc-right{right:1em}.cc-bottom{bottom:1em}.cc-floating&gt;.cc-link{margin-bottom:1em}.cc-floating .cc-message{display:block;margin-bottom:1em}.cc-window.cc-floating .cc-compliance{flex:1 0 auto}.cc-window.cc-banner{align-items:center}.cc-banner.cc-top{left:0;right:0;top:0}.cc-banner.cc-bottom{left:0;right:0;bottom:0}.cc-banner .cc-message{flex:1}.cc-compliance{display:flex;align-items:center;align-content:space-between}.cc-compliance&gt;.cc-btn{flex:1}.cc-btn+.cc-btn{margin-left:.5em}@media print{.cc-window,.cc-revoke{display:none}}@media screen and (max-width:900px){.cc-btn{white-space:normal}}@media screen and (max-width:414px) and (orientation:portrait),screen and (max-width:736px) and (orientation:landscape){.cc-window.cc-top{top:0}.cc-window.cc-bottom{bottom:0}.cc-window.cc-banner,.cc-window.cc-right,.cc-window.cc-left{left:0;right:0}.cc-window.cc-banner{flex-direction:column}.cc-window.cc-banner .cc-compliance{flex:1}.cc-window.cc-floating{max-width:none}.cc-window .cc-message{margin-bottom:1em}.cc-window.cc-banner{align-items:unset}}
</style>
<link rel="stylesheet" type="text/css" href="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Css/Main.min.css?dt=2.8.20210304.1" media="all" onload="if(media!='all')media='all'" />
<noscript>&lt;link rel="stylesheet" type="text/css" href="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Css/Main.min.css?dt=2.8.20210304.1"&gt;</noscript>


    <script src="https://www.googletagservices.com/activeview/js/current/osd.js?cb=%2Fr20100101"></script><script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js" defer=""></script>
<script type="text/javascript" src="https://codeproject.freetls.fastly.net/script/Articles/JS/article.min.js?dt=2.8.20210304.1" defer=""></script>
<script type="text/javascript" src="/script/JS/advertisement.min.js" defer=""></script>
<script type="text/javascript" src="/script/Membership/JS/MemberProfilePopup.min.js?v=1.4" defer=""></script>
<script type="text/javascript" src="/a.min.js?v=1.3" defer=""></script>

	
<meta http-equiv="content-language" content="en-US" />
<meta charset="UTF-8" />
<meta name="Description" content="An overview of the standard exception handling techniques provided by Visual C++." />
<meta name="Keywords" content="C++, Windows, Dev, Intermediate, error-handling, exceptions" />
<meta name="Author" content="OlegKrivtsov" />
<meta name="Rating" content="General" />
<meta name="Revisit-After" content="1 days" />
<meta name="application-name" content="CodeProject" />
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13" />

<link rel="dns-prefetch" href="//ajax.googleapis.com" /> 
<link rel="canonical" href="https://www.codeproject.com/Articles/207464/Exception-Handling-in-Visual-Cplusplus" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@CodeProject" />
<meta name="og:site_name" content="CodeProject" />
<meta name="twitter:creator" content="@OlegKrivtsov" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="6/7/2011 4:13:00 AM" />
<meta property="article:modified_time" content="1/6/2012 4:48:00 PM" />
<meta name="twitter:label1" content="Written by" />
<meta name="twitter:data1" content="OlegKrivtsov" />
<meta property="og:url" content="https://www.codeproject.com/Articles/207464/Exception-Handling-in-Visual-Cplusplus" />
<meta property="og:title" content="Effective Exception Handling in Visual C++" />
<meta property="og:description" content="An overview of the standard exception handling techniques provided by Visual C++." />
<meta property="og:image" content="https://www.codeproject.com/KB/exception/ExceptionHandlingInVCPP/Thumb-207464.png" />
<meta name="twitter:image" content="https://www.codeproject.com/KB/exception/ExceptionHandlingInVCPP/Thumb-207464.png" />

<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All Topics" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=1" />
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Artificial Intelligence" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=31" />
<link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="https://www.codeproject.com/webservices/LoungeRSS.aspx" />
<meta name="robots" content="index, follow" />

<link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="https://www.codeproject.com/info/OpenSearch.xml" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<link rel="apple-touch-icon" sizes="144x144" href="/favicon/apple-touch-icon.png" /> 
<link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png" /> 
<link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png" /> 
<link rel="manifest" href="/favicon/manifest.json" /> 
<link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#ff9900" />
	<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codeproject.com/Articles/207464/Exception-Handling-in-Visual-Cplusplus"
   },
  "name": "Effective Exception Handling in Visual C++",
  "headline": "Effective Exception Handling in Visual C++",
  "url": "https://www.codeproject.com/Articles/207464/Exception-Handling-in-Visual-Cplusplus",
  "discussionUrl": "https://www.codeproject.com/Articles/207464/Exception-Handling-in-Visual-Cplusplus#_comments",
  "isFamilyFriendly": "true",
  "image": "https://www.codeproject.com/KB/exception/ExceptionHandlingInVCPP/Thumb-207464.png",
  "keywords": "C++,Windows,Dev,Intermediate,error-handling,exceptions",
  "commentCount": "46",
  "editor" : {
    "@type" : "Person",
    "name" : "Smitha Nishant",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=28970"
  },
  "license": "http://www.codeproject.com/info/cpol10.aspx",
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  },
  "description": "An overview of the standard exception handling techniques provided by Visual C++.",
  "articleSection": "Exception Handling",
  "author" : [{
      "@type" : "Person",
      "name" : "OlegKrivtsov",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=6399991"
    }],
  "datePublished": "2011-06-07",
  "dateCreated": "2011-06-07",
  "dateModified": "2012-01-06"
,
  "contentRating" : {
    "@type" : "Rating",
    "ratingValue" : 4.93,
    "bestRating" : 5,
    "worstRating" : 1
  }
}</script>

<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/Chapters/6/General-Programming",
      "name" : "General Programming"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/KB/exception/",
      "name" : "Exception Handling"
    }
  }]
}</script>


	<base target="_top" />
	
    


<script type="text/javascript">
function defrm () { /* thanks twitter */
    document.write = '';
    window.top.location = window.self.location;
    setTimeout(function() { document.body.innerHTML = ''; }, 0);
    window.self.onload = function(evt) { document.body.innerHTML = ''; };
}

if (window.top !== window.self) {
    try {
        if (window.top.location.host) { /* will throw for all except chrome */ }
        else { defrm(); /* chrome */ }
    } catch (ex) { defrm(); /* everyone else */ }
}

// Specific case where a site is screwing with us.
if (typeof(DemoUrl) !== 'undefined') {
    document.write(unescape('%3Cme') + 'ta http' + '-equiv="re' + 'fresh con' +
                           'tent="1;url=' + DemoUrl + unescape('"%3CE'));
}
</script>
	





<!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=UA-1735123-1"></script>
    <script type="text/javascript">
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-1735123-1' , {'user_id': 'ed4b1aaf-4db7-401b-b19b-6f7aa4ae12ef'});
    </script>


<style type="text/css"></style><style></style><meta http-equiv="origin-trial" content="A+b/H0b8RPXNaJgaNFpO0YOFuGK6myDQXlwnJB3SwzvNMfcndat4DZYMrP4ClJIzYWo3/yP2S+8FTZ/lpqbPAAEAAABueyJvcmlnaW4iOiJodHRwczovL2ltYXNkay5nb29nbGVhcGlzLmNvbTo0NDMiLCJmZWF0dXJlIjoiVHJ1c3RUb2tlbnMiLCJleHBpcnkiOjE2MjYyMjA3OTksImlzVGhpcmRQYXJ0eSI6dHJ1ZX0=" /><meta http-equiv="origin-trial" content="A9ZgbRtm4pU3oZiuNzOsKcC8ppFSZdcjP2qYcdQrFKVzkmiWH1kdYY1Mi9x7G8+PS8HV9Ha9Cz0gaMdKsiVZIgMAAAB7eyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiVHJ1c3RUb2tlbnMiLCJleHBpcnkiOjE2MjYyMjA3OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9" /><meta http-equiv="origin-trial" content="AxL6oBxcpn5rQDPKSAs+d0oxNyJYq2/4esBUh3Yx5z8QfcLu+AU8iFCXYRcr/CEEfDnkxxLTsvXPJFQBxHfvkgMAAACBeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXRhZ3NlcnZpY2VzLmNvbTo0NDMiLCJmZWF0dXJlIjoiVHJ1c3RUb2tlbnMiLCJleHBpcnkiOjE2MjYyMjA3OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9" /><meta http-equiv="origin-trial" content="A9KPtG5kl3oLTk21xqynDPGQ5t18bSOpwt0w6kGa6dEWbuwjpffmdUpR3W+faZDubGT+KIk2do0BX2ca16x8qAcAAACBeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiVHJ1c3RUb2tlbnMiLCJleHBpcnkiOjE2MjYyMjA3OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9" /><meta http-equiv="origin-trial" content="A3HucHUo1oW9s+9kIKz8mLkbcmdaj5lxt3eiIMp1Nh49dkkBlg1Fhg4Fd/r0vL69mRRA36YutI9P/lJUfL8csQoAAACFeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiQ29udmVyc2lvbk1lYXN1cmVtZW50IiwiZXhwaXJ5IjoxNjI2MjIwNzk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ==" /><script src="https://securepubads.g.doubleclick.net/gpt/pubads_impl_2021030201.js" async=""></script><link rel="preload" href="https://adservice.google.com/adsid/integrator.js?domain=www.codeproject.com" as="script" /><script type="text/javascript" src="https://adservice.google.com/adsid/integrator.js?domain=www.codeproject.com"></script><link rel="prefetch" href="https://f7150de6cb167c2d8c635f7f3580a4f2.safeframe.googlesyndication.com/safeframe/1-0-37/html/container.html" /><link rel="prefetch" href="https://tpc.googlesyndication.com/safeframe/1-0-37/html/container.html" /></head>	

<body class="chrome chrome77"><div class="cc-revoke cc-bottom cc-animate cc-color-override--316233370" style="display: none;">Cookie Policy</div><div role="dialog" aria-live="polite" aria-label="cookieconsent" aria-describedby="cookieconsent:desc" class="cc-window cc-banner cc-type-opt-in-out cc-theme-edgeless cc-bottom cc-color-override--316233370 " style=""><!--googleoff: all--><span id="cookieconsent:desc" class="cc-message">Like every other website we use cookies. By using our site you acknowledge that you have read and understand our <a href="/info/cookie.aspx">Cookie Policy</a>, <a href="/info/privacy.aspx">Privacy Policy</a>, and our <a href="/info/TermsOfUse.aspx">Terms of Service</a>. <a aria-label="learn more about cookies" role="button" tabindex="0" class="cc-link" href="https://www.codeproject.com/info/privacy.aspx" rel="noopener noreferrer nofollow" target="_blank">Learn more</a></span><div class="cc-compliance cc-highlight"><a aria-label="dismiss cookie message" role="button" tabindex="0" class="cc-btn cc-dismiss">Ask me later</a><a aria-label="deny cookies" role="button" tabindex="0" class="cc-btn cc-deny">Decline</a><a aria-label="allow cookies" role="button" tabindex="0" class="cc-btn cc-allow">Allow cookies</a></div><!--googleon: all--></div>

<a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="https://codeproject.freetls.fastly.net/images/t.gif" /></a>




<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed">
        <div class="main-content">
            

<div class="container memberbar clearfix flex-container flex-extend">

	<div id="ctl00_MemberBar_GenInfo" class="flex-item align-left">14,774,208 members</div>

	<div class="flex-item">
		
	</div>

	<div class="flex-item align-right">

		

		

		

			<script type="text/javascript">//&lt;!--
			function doSubmit(secure)
			{
				if (secure)
					document.signinForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f207464%2fException-Handling-in-Visual-Cplusplus"
				else
					document.signinForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f207464%2fException-Handling-in-Visual-Cplusplus"
				document.signinForm.submit();
				return true;
			}//--&gt;
			</script>

			<a name="SignUp"></a>
			<span class="member-signin tooltip openable">
				<span><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f207464%2fException-Handling-in-Visual-Cplusplus">Sign in</a>
                    <img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/login32.png" width="16px" height="16px" style="vertical-align:middle;" />
				</span>

				<div class="tooltip-flyout">
					<form name="signinForm" id="signinForm" action="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f207464%2fException-Handling-in-Visual-Cplusplus" method="post" class="tight">

						
						<input id="FormName" name="FormName" value="MenuBarForm" type="hidden" />

						<div>Email</div>
						<div><input class="small-text" type="email" name="Email" id="Email" autocomplete="email" /></div>
						<div>Password</div>
						<div><input class="small-text" type="password" name="Password" id="Password" autocomplete="current-password" /></div>
						<div class="action">
                            <input id="joinBtn" type="button" class="create hidden" onclick="return Join();" value="Join" style="visibility: visible;" />
                            <input type="hidden" name="fld_quicksign" value="true" />
							<input type="submit" value="Sign in" class="signin" onclick="return doSubmit(false);" />
						</div>

						<div class="container">
							
							 
							<a id="ctl00_MemberBar_SendPassword" class="forgot float-right" href="/script/Membership/SendPassword.aspx?rp=/Articles/207464/Exception-Handling-in-Visual-Cplusplus">Forgot your password?</a>
						</div>
					</form>

					<hr class="divider-dark" />

					Sign in with <a class="oauth" alt="Sign in using Github" title="Sign in using Github" href="/script/Membership/OAuthLogOn.aspx?auth=GitHub"><img src="/script/Membership/Images/octicons_github.png" style="vertical-align:middle;padding-right:3px;border:0;" /></a>
<a class="oauth" alt="Sign in using Facebook" title="Sign in using Facebook" href="/script/Membership/OAuthLogOn.aspx?auth=Facebook"><img src="/script/Membership/Images/facebook.png" style="vertical-align:middle;padding-right:3px;border:0;" /></a>
<a class="oauth" alt="Sign in using Google" title="Sign in using Google" href="/script/Membership/OAuthLogOn.aspx?auth=Google"><img src="/script/Membership/Images/google-plus.png" style="vertical-align:middle;padding-right:3px;border:0;" /></a>
<a class="oauth" alt="Sign in using Microsoft" title="Sign in using Microsoft" href="/script/Membership/OAuthLogOn.aspx?auth=Microsoft"><img src="/script/Membership/Images/microsoft.png" style="vertical-align:middle;padding-right:3px;border:0;" /></a>

				</div>
            </span>
		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed">
        <div class="main-content">
            <div class="logo"><a href="/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;" /></a></div>
            <div class="promo"><div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="General-Programming/Exception-Handling/General" data-country="US" data-tags="C++, Windows, Dev, Intermediate, error-handling, exceptions,rating4.5"><noscript>&lt;a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Exception-Handling/General&amp;sz=728x90&amp;c=282056"&gt;&lt;img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Exception-Handling/General&amp;sz=728x90&amp;c=282056"  width="728px" height="90px" target="_blank"/&gt;&lt;/a&gt;</noscript><div id="div-gpt-ad-lqm.codeproject.site/General-Programming/Exception-Handling/General-1" data-google-query-id="CLDzsaTyne8CFQzAvQodUqgFKQ" style="height: 90px; width: 728px; box-sizing: border-box; border: 0px; font-size: 0px;"><div id="google_ads_iframe_/6839/lqm.codeproject.site/General-Programming/Exception-Handling/General_0__container__" style="border: 0pt none; display: inline-block; width: 728px; height: 90px;"><iframe frameborder="0" src="https://f7150de6cb167c2d8c635f7f3580a4f2.safeframe.googlesyndication.com/safeframe/1-0-37/html/container.html" id="google_ads_iframe_/6839/lqm.codeproject.site/General-Programming/Exception-Handling/General_0" title="3rd party ad content" name="" scrolling="no" marginwidth="0" marginheight="0" width="728" height="90" data-is-safeframe="true" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" data-google-container-id="1" style="border: 0px; vertical-align: bottom;" data-load-complete="true"></iframe></div><input type="image" src="https://cdn1.developermedia.com/Content/images/undo.png" title="Report Ad" align="left" style="z-index: 1000; position: relative; left: 0px; top: -90px; margin-top: 0px; margin-left: 0px; display: block; font-size: 0px; border: 0px; padding: 0px; height: 14px; width: 14px;" /></div><div style="display: none; width: 728px; height: 90px; z-index: 100; text-align: left; border-style: solid; border-width: 1px; position: relative; background-color: white; box-sizing: border-box; top: 0px; left: 0px;"><input type="image" src="https://cdn1.developermedia.com/Content/images/redo.png" title="Show Ad" style="z-index: 1000; position: relative; left: 0px; top: 0px; width: 14px; height: 14px; margin-top: 0px; margin-left: 0px; font-size: 0px; display: block; padding: 0px; border: 0px;" /><div class="sendReportContainer" style="padding-left: 2px; display:block; line-height:initial !important"><div style="display:inline-block; font:14px/18px &quot;Segoe UI&quot;, Arial"><b>Don't like this Ad?</b></div><div class="dropzone" contenteditable="true" style="margin-left:10px; height:60px; width: 250px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; display:inline-block; white-space:normal">1. Hit the refresh icon to show the ad again and take a screenshot. 2. Drag and Drop or paste the screenshot here</div><div style="margin-left:10px; display:inline-block; font:14px/18px &quot;Segoe UI&quot;, Arial;"> <select class="reportReason" style="max-width:150px !important; padding: 0px !important"><option>Offensive</option><option>Abusive</option><option>Off topic</option><option>Don't like the Ad</option> <option>Wrong language</option></select>  <input type="button" disabled="" class="reportButton" style="padding: 0px !important" value="Report" /></div></div><div class="reportSentContainer" style="display:none; padding: 15px 20px; font:14px/18px &quot;Segoe UI&quot;, Arial;"><span style="color:#999">Thank you for the report!</span></div><a href="http://www.developermedia.com/" target="_blank"><img src="https://cdn1.developermedia.com/Content/images/dm-logo-150x23.png" style="max-width:100%;position:absolute; right:10px; top:10px;" /></a></div></div></div>
        </div>
    </div>

	
	<div id="ctl00_TPR" class="sub-headerbar clearfix fixed">
    <div class="float-right">
		

<div class="searchbar">

<form method="get" action="/search.aspx?sbo=kw" name="Search" class="tight">


<table border="0" cellspacing="0" cellpadding="0" class="search"><tbody><tr><td><input tabindex="2" class="search subdue" id="sb_tb" autocomplete="off" value="" name="q" /></td><td><input type="image" src="https://codeproject.freetls.fastly.net/images/search.gif" /></td></tr></tbody></table>

<div class="hover-container">
	<div id="SearchFilter" class="search-advanced small-text align-left" style="display: none;">
	<b>Search within:<br /></b>
		
		<input type="radio" id="sb_kw" name="sbo" value="kw" checked="checked" /><label for="sb_kw">Articles</label><br />
<input type="radio" id="sb_qa" name="sbo" value="qa" /><label for="sb_qa">Quick Answers</label><br />
<input type="radio" id="sb_fm" name="sbo" value="fm" /><label for="sb_fm">Messages</label><br />


		
		

		
		
	</div>
</div>
</form>

</div>
    </div>
    <div class="float-left">
		

<div class="navbar clearfix">
<ul class="navmenu openable">

<li class="desktop-only"><a id="ctl00_TopNavBar_Home" href="https://www.codeproject.com">home</a>


</li><li class="openable"><a id="ctl00_TopNavBar_Art" class="down selected" href="/script/Articles/Latest.aspx">articles</a>

	<ul>
		<li class="openable"><a id="ctl00_TopNavBar_ArtTopicList" class="fly" onmouseover="navBarMenu.ShowMap(this, 'ctl00_TopNavBar_MapFlyout');" href="/script/Content/SiteMap.aspx">Chapters and Sections<span class="has-submenu">&gt;</span></a><ul id="ctl00_TopNavBar_MapFlyout" class="taxonomy">
			<li>
				<div id="siteMap"></div>
			</li>
			</ul>
		</li>
		<li><a id="ctl00_TopNavBar_ArtLatestArts" class="fly" href="/script/Articles/Latest.aspx">Latest Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtTop" class="fly" href="/script/Articles/TopArticles.aspx?ta_so=5">Top Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtGuide" class="fly" href="/info/Submit.aspx">Posting/Update Guidelines</a></li>
		<li><a id="ctl00_TopNavBar_ArtHelpForum" class="fly" href="/Forums/1641/Article-Writing">Article Help Forum</a></li>
		<li><a id="ctl00_TopNavBar_ArtPostArticle" class="fly highlight1" href="/script/Articles/Submit.aspx">
			<img src="https://codeproject.freetls.fastly.net/images/write13.png" width="13" height="13" /> Submit an article or tip
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtImportGitHub" class="fly highlight3" href="/script/Articles/ImportArticle.aspx">
			<img src="https://codeproject.freetls.fastly.net/images/write13.png" width="13" height="13" /> Import GitHub Project
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtPostBlog" class="fly highlight2" href="/script/Articles/BlogFeed.aspx">
			<img src="https://codeproject.freetls.fastly.net/images/write13.png" width="13" height="13" /> Import your Blog
			</a></li>		
        
        <li class="last"></li>
	</ul>

</li>



<li class="openable">
<a id="ctl00_TopNavBar_Answers" href="/script/Answers/List.aspx?tab=active">
    <span class="desktop-only tablet-only">quick answers</span><span class="mobile-only">Q&amp;A</span>
</a>
	<ul>
		<li id="ctl00_TopNavBar_AQL"><a id="ctl00_TopNavBar_ArticleQuestion" class="fly highlight1" href="#_comments">
			<img src="https://codeproject.freetls.fastly.net/images/write13.png" width="13" height="13" /> Ask a Question about this 
			article</a>
		</li>

		<li><a id="ctl00_TopNavBar_QAAsk" class="fly highlight2" href="/Questions/ask.aspx"><img src="https://codeproject.freetls.fastly.net/images/write13.png" width="13" height="13" /> Ask a Question</a></li>

		<li><a id="ctl00_TopNavBar_QAUnanswered" class="fly" href="/script/Answers/List.aspx?tab=unanswered">View Unanswered Questions</a></li>
		<li><a id="ctl00_TopNavBar_QALatest" class="fly" href="/script/Answers/List.aspx?tab=active">View All Questions</a></li>
        
				<li><a id="ctl00_TopNavBar_QATR_ctl00_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=81" style="padding-left:30px">View C# questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl01_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=842" style="padding-left:30px">View VB.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl02_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=78" style="padding-left:30px">View C++ questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl03_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=93" style="padding-left:30px">View SQL questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl04_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=87" style="padding-left:30px">View Javascript questions</a></li>
			
    
		<li class="last"></li>
	</ul>

</li>



<li class="openable"><a id="ctl00_TopNavBar_Forums" href="/script/Forums/List.aspx">
        <span class="desktop-only tablet-only">discussions</span><span class="mobile-only">forums</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_MessageBoardsAll" class="fly" href="/script/Forums/List.aspx">All Message Boards...</a></li>
		<li class="openable"><a class="fly" style="padding-left:30px" href="/Forums/1580997/Application-Lifecycle">Application Lifecycle<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="/Forums/1533717/Running-a-Business">Running a Business</a></li>
<li><a class="fly" href="/Forums/1533716/Sales-Marketing">Sales / Marketing</a></li>
<li><a class="fly" href="/Forums/1651/Collaboration-Beta-Testing">Collaboration / Beta Testing</a></li>
<li><a class="fly" href="/Forums/3304/Work-Issues">Work  Issues</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="/Forums/369270/Design-and-Architecture">Design and Architecture</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/12076/ASP-NET">ASP.NET</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1580226/JavaScript">JavaScript</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="/Forums/1647/C-Cplusplus-MFC">C / C++ / MFC<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="/Forums/4486/ATL-WTL-STL">ATL /  WTL / STL</a></li>
<li><a class="fly" href="/Forums/3785/Managed-Cplusplus-CLI">Managed C++/CLI</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1649/Csharp">C#</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1627782/Free-Tools">Free Tools</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1827460/Objective-C-and-Swift">Objective-C and Swift</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1725/Database">Database</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="/Forums/186301/Hardware-Devices">Hardware &amp; Devices<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="/Forums/1644/System-Admin">System Admin</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1606152/Hosting-and-Servers">Hosting and Servers</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1643/Java">Java</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1942421/Linux-Programming">Linux Programming</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1650/NET-Core-and-Framework">.NET (Core and Framework)</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1848626/Android">Android</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1876716/iOS">iOS</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/13695/Mobile">Mobile</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1004257/Silverlight-WPF">Silverlight / WPF</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1646/Visual-Basic">Visual Basic</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1640/Web-Development">Web Development</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/suggestions.aspx">Site Bugs / Suggestions</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1652005/Spam-and-Abuse-Watch">Spam and Abuse Watch</a>
</li>

		<li class="last"></li>
	</ul>

</li>

<li class="openable"><a id="ctl00_TopNavBar_Features" href="/Feature/">
      <span class="desktop-only tablet-only">features</span><span class="mobile-only">stuff</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_Comps" class="fly" href="/script/Contests/CurrentCompetitions.aspx?cmpTpId=3&amp;amp;awsac=true">Competitions</a></li>
        
		<li><a id="ctl00_TopNavBar_News" class="fly" href="/script/News/List.aspx">News</a></li>
		<li><a id="ctl00_TopNavBar_Insider" class="fly" href="/Feature/Insider/">The Insider Newsletter</a></li>
    	<li><a id="ctl00_TopNavBar_DailyBuild" class="fly" href="/Feature/DailyBuild">The Daily Build Newsletter</a></li>
		<li><a id="ctl00_TopNavBar_Newsletters" class="fly" href="/script/Mailouts/Archive.aspx?mtpid=1">Newsletter archive</a></li>
		<li><a id="ctl00_TopNavBar_Surveys" class="fly" href="/script/Surveys/List.aspx">Surveys</a></li>
		<li><a id="ctl00_TopNavBar_Showcase" class="fly" href="/KB/showcase/">Product Showcase</a></li>
        
		<li><a id="ctl00_TopNavBar_Stuff" class="fly" href="/Info/Stuff.aspx">CodeProject Stuff</a></li>
		<li class="last"></li>
	</ul>

</li>


<li class="openable"><a id="ctl00_TopNavBar_Lounge" href="/Lounge.aspx">
            <span class="desktop-only tablet-only">community</span><span class="mobile-only">lounge</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_WhosWho" class="fly" href="/script/Membership/Profiles.aspx">Who's Who</a></li>
		<li><a id="ctl00_TopNavBar_MVPs" class="fly break" href="/script/Contests/Winners.aspx?obtid=1&amp;amp;cmpTpId=2&amp;amp;cid=0">Most Valuable Professionals</a></li>

		<li><a id="ctl00_TopNavBar_LoungeLnk" class="fly highlight2" href="/Lounge.aspx">The Lounge  </a></li>
		<li><a id="ctl00_TopNavBar_WhereAmILink" class="fly" href="/Forums/1939564/Where-I-am-Member-Photos">Where I Am: Member Photos</a></li>
		<li><a id="ctl00_TopNavBar_InsiderLnk" class="fly" href="/Insider.aspx">The Insider News</a></li>
		<li><a id="ctl00_TopNavBar_WeirdWonderful" class="fly" href="/Feature/WeirdAndWonderful.aspx">The Weird &amp; The Wonderful</a></li>

		<li class="last"></li>
	</ul>

</li>


<li class="openable" style="margin-left:20px"><a id="ctl00_TopNavBar_Help" href="/KB/FAQs/">
    <span class="desktop-only tablet-only">help</span><span class="mobile-only">?</span>
</a>


	<ul>
		<li><a id="ctl00_TopNavBar_HelpWhatIs" class="fly" href="/info/guide.aspx">What is 'CodeProject'?</a></li>
		<li><a id="ctl00_TopNavBar_HelpGeneral" class="fly break" href="/KB/FAQs/">General FAQ</a></li>
		<li><a id="ctl00_TopNavBar_HelpPostQuestion" class="fly break highlight2" href="/Questions/ask.aspx">Ask a Question</a></li>
		<li><a id="ctl00_TopNavBar_HelpBugs" class="fly" href="/suggestions.aspx">Bugs and Suggestions</a></li>
		<li><a id="ctl00_TopNavBar_HelpArticles" class="fly" href="/Forums/1641/Article-Writing">Article Help Forum</a></li>
		
		
		
		
		<li><a id="ctl00_TopNavBar_HelpAboutUs" class="fly" href="/info/about.aspx">About Us</a></li>
		<li class="last"></li>
	</ul>

</li>

</ul>

</div>
    </div>
	<div class="sub-headerbar-divider"></div>
	</div>		
	

	<div id="A" class="container-content-wrap fixed"> 

	<div class="container-content">

        
		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a rel="nofollow" href="/script/Content/SiteMap.aspx">Articles</a> » <a rel="nofollow" href="/Chapters/6/General-Programming">General Programming</a> » <a rel="nofollow" href="/KB/exception/">Exception Handling</a> » <a rel="nofollow" href="/KB/exception/#General">General</a></div>
			</div>

            <div class="float-left">
				
			</div>

			<div class="edit-links float-right">
				



 
 










			</div>

			<div class="article-nav float-right">
				


<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    
</div>



 

<a id="ctl00_ActionLinks_PrintMd" data-tooltip="Print" data-enabletooltip="true" data-width="auto" href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?display=Print" class="tooltip" title="">
   <img src="/App_Themes/CodeProject/Img/print48.png" width="24px" height="24px" style="border:0" />
<div class="speech-bubble-container-up" style="width:auto">  <div class="speech-bubble-up" style="text-align:center"> Print</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>



<span id="ctl00_ActionLinks_R">
    
    
</span>
			</div>
		</div>

        
		<div class="extended article-container-parts">

			
		    <div id="ctl00_LeftSideBar" class="article-left-sidebar">

                <div id="ctl00_StickyBlock" class="article-left-sidebar-inner">
                    
    		        

<div class="tabs">
	<div class=" selected">Article</div>
<div class="browse-code"><a href="/script/Articles/ViewDownloads.aspx?aid=207464">Browse Code</a></div>
<div><a href="/script/Articles/Statistics.aspx?aid=207464">View Stats</a></div>
<div><a href="/script/Articles/ListVersions.aspx?aid=207464">Revisions (13)</a></div>
<div><a href="#_comments">Comments (46)</a></div>
<div>Posted 6 Jun 2011</div>


    
</div>



			        

			        <div>
                        <h4 id="ctl00_TaggedAsWrapper">Tagged as</h4>
			            <span id="ctl00_TagList_TagWrp" class="tags vertical">

	
	

	
	<span id="ctl00_TagList_VisibleTags"><div class="t"><a rel="tag" href="/Tags/Cplusplus" data-id="78">C++</a></div><div class="t"><a rel="tag" href="/Tags/Windows" data-id="94">Windows</a></div><div class="t"><a rel="tag" href="/Tags/error-handling" data-id="1383">error-handling</a></div><div class="t"><a rel="tag" href="/Tags/exceptions" data-id="3542">exceptions</a></div></span> 

	
	
</span>


			        </div>

                    <div id="ctl00_VerticalStatsWrapper" class="stats">
                    <h4>Stats</h4>
                    <div id="ctl00_VerticalStats"><div class="stats"><div>279.6K views</div><div>6.6K downloads</div><div>291 bookmarked</div></div></div>
                    </div>

                    
                </div>
		    </div>
            

			
			<div id="AT" class="article-container  fixed"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="./View.aspx" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="DU/aa8fxr1XbEsefi300XfIwy8FeU3CJ7gy9aBtAi/GvwYvSUifC9YAXgTqyCvWt5xoftHJYKp86vmIUboLQeAbmLYSnxpoEasu5rTOANnhdp8csjNvRE80oHNFRSzIHlPrzBposOMZju8g1OmKN1WsoOXQkaVUzG8VW5QLCjly5k9NbD9+afTK9K+o01gndWwosLqLdjCyCC6gX1u57rqTalNX7C0JX3eJi22cXYk+h6WJ36WzNqSc+qy/iEafb/kTMsPa+BjhTfHMndiZGg91OndSVRyge2REQdbKv/URmZVEmVqwdNC5BQDlggbBrGj8DmSzjMnfJmKS7+/n3inyHOk2kyb1Hs6xMV46IE64mB9OFpZ5DKM3wjnAEx+MjMC6DIA9FAzOKFxbLLHHNpqzRFaRQhHZtyuH0Vkda8z7cT2HJjSoG4CV8CHppXsoIIPk31rNy+wivmrIAwlP882hlm7501pYUXZ+YN63hREPUevIQayq0LxUD7iUfjGyaWvhV49xAVAebwkgGQZGtK61r+Q8KqP675IUTqUjlcjKV/55aMfXJ533zvtA7+oKoOyeLNDAqNy2tMNETjkiNGzrLa3ZngACwBxOAdpODvQhDCBi+fk4zgySwKUtR34+kbSvnfIkjnUeN3t2rt0TSRCw/3Z+q/x8COpj4vZQE8/90awxqKlPiph7kMdGPPRXV52m0QwZKe546mZbQEy2mk46/G3/piKghGqt3+TcS7PxfOPgwItU2liVYSaCVBpFz3yqZ3azyTF2wLVHoX/jeYZlCGzimTGoTtfuh0f3JgSc+dh9EMVD/zC/2cGzdsQQdvJmRHFfl5FVXwmfWGi1KCz7shnHgW9w5cOqWYPKYPC9BC/6qubRfz6yrTp7erIWDB0mDNI6EicOmTsYp9Lv5RaHRaDIkk+S1wus3W96FO5zTWHUVjOA4pB2OmSpLJzE8FAQmW2s08pcahj3UppeoGDY8CTI+o9sliflW7JNW/2HWcpWZtOenl1WZMAsJsuA+WX/zOHP2xBO5Qzm+1UnzXxG+JbVatslgNtUhpOIqVFhvlWVO2YHw+9Gn2gb0Lohf4JuJu1BajEpoC+L+AnPI/LZomisnAbiLOqmXBzXDkrYUZf0lSWNkhyisIOlrPAGHY2AYhqljAg8O/01HF5+OTvqZoTUJ0Ie/wf/oE8RY2CyAiWGt6fq36fVPjHNmweDwpoFs1lrZkTo1W7d86nCWdtP+L9JyVGUlNz3Sidhc8ZVRSglfNjNIDkuIGHucUyf5Qei5tkzLa59T0AIHUFPknfdhpK5pfRhP3P1T8cxahjjJT+8tDPoxpfO19d5b8BCQsGzd0yOZXgkoaK1p2rcgBWXwZwSqTEFLQG+B1GsYGZvk9bxaG+D/m1fAdBjbIouCLSPogMQCOkXSnIhGuj++q/iRZ803xVndwzf+coqbAmP43i/RQc8/MWdNIlQpv0CikzfKVloHOMND1vY7ikWAKuKhGTlvbmjPxK417vWPdSyznahejHmK0oG+HvaozFE5dFq6SoN9sTZgLbqUOapcJcfr305+0/HXxeF3xDgoY3Tt8v1ACHhAEqfJxV4rOfCCO4Eww88EqdFM1Jmzc8MBExcN7J3aDfYkLviv+0PgupTOkihHAxhULptuvJ9bRi1oqF18nTnJUqWc1mIEus8iZV7XnRPz46WMoLr0/DsEApJmHQNAiuAW+Mfo0rKZ7d1Tlif6DZcxiN8rQMizQQLOoMxUeHf/2ahtE9p8znzxQwYz9pyaGOKodjloZfkyVCXcTQ9X0wAalakjfM+EkuR4w/olrV9l8Lb6o8W2U+AGNJT8XJWgaci3A0YUAC/BWCpPaDtpgkgHYbYCB/rJXDE9JSU7vOiNJH7v1UvEJ89n3NF5gO4/ojM7EcZI6iBCmAPAmIAHa8+LQeXBqyXbsmt9tqslvp+T55blADgiRlY/Jr1EwALvjblAnKInjeKP2t4JeGZVVFMHtDRLDJeyG6XbnWBrZMFD5zjpohOSwpmGq4XMymdtFVqHlh0Bf5207sSih7T/Lw==" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69" />
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>

					    
					    <a name="_articleTop" id="_articleTop"></a>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">Effective Exception Handling in Visual C++</h1>
					    </div>

                        <div>
					        
					        <div class="entry flex-container">

                                <img src="https://www.codeproject.com/Uploads/Membership/ProfileImages/{5fd0a355-46ec-4308-ad5f-0b32ffcba5af}.jpg" id="ctl00_avatar" class="avatar" />

                                <div class="flex-item" style="flex:1 1 auto">
                                    <div class="flex-container" style="justify-content:space-between;flex-wrap:wrap-reverse">
                                       <span id="ctl00_Authors" class="author flex-item"><a href="/script/Membership/View.aspx?mid=6399991" rel="author">OlegKrivtsov</a></span> 

                                        <div class="flex-item" style="margin-top:-4px;">
                                            <div id="ctl00_RateArticle_RatingTable" class="small-text" data-objectref="2_207464_13">

	<meta itemprop="upvoteCount" content="114" />


	<div id="ctl00_RateArticle_RatingRow" class="flex-container rating-container large-stars">

					
		<div id="ctl00_RateArticle_Prompt" class="rating-prompt nowrap">Rate me:</div>

		
		<div class="nowrap tooltip">

			
			
			

			
			<div id="ctl00_RateArticle_RatingHistWrap" class="tooltip">

				
				<div id="ctl00_RateArticle_ResultWithHist" class="rating-result"><div class="flex-container rating-stars large-stars"><div><img src="https://codeproject.freetls.fastly.net/script/Ratings/Images/star-fill-lg.png" style="width:24px;height:24px" /></div><div><img src="https://codeproject.freetls.fastly.net/script/Ratings/Images/star-fill-lg.png" style="width:24px;height:24px" /></div><div><img src="https://codeproject.freetls.fastly.net/script/Ratings/Images/star-fill-lg.png" style="width:24px;height:24px" /></div><div><img src="https://codeproject.freetls.fastly.net/script/Ratings/Images/star-fill-lg.png" style="width:24px;height:24px" /></div><div style="width:22px;" class="clipped"><img src="https://codeproject.freetls.fastly.net/script/Ratings/Images/star-fill-lg.png" style="width:24px;height:24px" /></div><div style="width:2px;position:relative" class="clipped"><img src="https://codeproject.freetls.fastly.net/script/Ratings/Images/star-empty-lg.png" style="width:24px;height:24px;position:absolute;top:0px;right:0" /></div></div></div>
				

				<div class="speech-bubble-container-up-right" style="width:170px">
					<div class="speech-bubble-up-right">
						<div class="histogram"></div>
					</div>
					<div class="speech-bubble-pointer-up-right">
						<div class="speech-bubble-pointer-up-right-inner"></div>
					</div>
				</div>
			</div>

			
            

			
            <span id="ctl00_RateArticle_RatingSignin" class="speech-bubble-container-down">
		        <div class="speech-bubble-down">
                    Please <a id="ctl00_RateArticle_SignUp" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f207464%2fException-Handling-in-Visual-Cplusplus">Sign up or sign in</a> 
                    to vote.
		        </div>
		        <div class="speech-bubble-pointer-down">
			        <div class="speech-bubble-pointer-down-inner"></div>
		        </div>
	        </span>    

		</div>
		
	
		
		<div id="ctl00_RateArticle_VoteCountNoHist" class="rating-votes nowrap">4.93/5  (114 votes)</div>	

		

		
		<div class="rating-undo" title="Undo vote" style="margin-left:5px;display:none"></div>

		
		
	</div>

	
	

</div>

                                        </div>
                                    </div>

                                    <div class="flex-container">
                                        <span id="ctl00_LastUpdated" class="date flex-item-tight" title="Date last updated">6 Jan 2012</span><a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license flex-item-tight" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a>
                                    </div>
                                </div>
					        </div>

                            

                        </div>

                        <div id="ctl00_DescriptionSpot" class="summary">An overview of the standard exception handling techniques provided by Visual C++.</div><span id="ctl00_ThumbnailUrl" class="date" content="https://www.codeproject.com/KB/exception/ExceptionHandlingInVCPP/Thumb-207464.png"></span>			

                    </div>
                    
					
					

					

					
					

					
					
					
					

						
					

					

						
						<div id="contentdiv" class="text">
						



<ul class="download">

<li><a href="/KB/exception/ExceptionHandlingInVCPP/ExceptionHandler.zip">Download source code - 12.5 KB</a></li></ul>


<h2>Introduction</h2>


<p>This article describes the standard techniques of handling exceptions and errors in Visual C++ programs running in Windows.</p>


<p>An <em>exception</em> (or a critical error, or crash) typically means your program stops working normally and needs to stop its execution. 
For example, an exception may occur because of your program accessing an invalid memory address (such as <code>NULL</code> pointer), memory buffer 
can't be allocated (out of memory), the C run-time libraries (CRT) detect an error and request program termination, and so on.</p>


<p>A C++ program may handle several types of exceptions: SEH exceptions produced through the Operating System's structured exception handling mechanism, 
CRT errors produced by the C run-time libraries, and finally, signals. Each error type requires installing an <em>exception handler</em> function that would 
intercept an exception and do some error recovery actions.</p>


<p>If your application has several execution threads, things may be even more complicated. Some exception handlers work for an entire process, but some work 
for the current thread only. So you have to install exception handlers in <em>each</em> thread.</p>


<p>Each module (EXE or DLL) in your application is <em>linked to CRT libraries</em> (either statically or dynamically). Exception handling techniques strongly depend on the CRT linkage type.</p>


<p>The variety of error types, differences of handling exceptions in multi-threaded programs, and dependence of exception handling on CRT linkage requires 
a lot of work to <em>handle exactly all exceptions</em> that your application is allowed to handle. This article is aimed to help you better understand 
the exception handling mechanisms and effectively use exception handling in your C++ applications.</p>


<p>A small console demo application <em>ExceptionHandler</em> is attached to the article. The demo can raise and catch different types of exceptions 
and generate a crash minidump file allowing to see the line of the code where exception occurred.</p>


<h2>Background</h2>


<p>Some time ago I needed a way for intercepting exceptions for one of my Open-Source projects, <a href="http://code.google.com/p/crashrpt/">CrashRpt - A crash reporting 
library for Windows applications</a>. The CrashRpt library handles exceptions occurring in your application, collects technical information about 
the error (such as crash minidump, error logs, desktop screenshots), and offers the user to send an error report over the Internet (figure 1).</p>


<div class="Caption">Figure 1 - Error report window and error report details dialogs of the CrashRpt library</div>


<p><img width="600" height="425" alt="crashrpt.png" src="/KB/exception/ExceptionHandlingInVCPP/crashrpt.png" class="lazyload" data-sizes="auto" data-srcset="/KB/exception/ExceptionHandlingInVCPP/crashrpt-r-400.png 400w, /KB/exception/ExceptionHandlingInVCPP/crashrpt.png 600w" /></p>


<p>Maybe you have seen the Windows Error Reporting window (figure 2) suddenly appearing on your desktop, and the CrashRpt library does the same things, 
except it sends the error report to your own web-server instead of Microsoft's server.</p>


<div class="Caption">Figure 2 - Windows Error Reporting (Dr. Watson) window</div>


<p><img width="501" height="277" alt="wer.gif" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="/KB/exception/ExceptionHandlingInVCPP/wer.gif" class="lazyload" data-sizes="auto" data-srcset="/KB/exception/ExceptionHandlingInVCPP/wer-r-400.gif 400w, /KB/exception/ExceptionHandlingInVCPP/wer.gif 501w" /></p>


<p>Browsing the MSDN gave me the <code>SetUnhandledExceptionFilter()</code> function that I used to handle access violations. But soon I figured out that some 
of exceptions in my application are somehow left unhandled and Dr. Watson's window still appears instead of the CrashRpt window.</p>


<p>I browsed MSDN some more and found many other CRT-provided functions that could be used to handle CRT errors. Here are some examples of such 
functions: <code>set_terminate()</code>, <code>_set_invalid_parameter_handler()</code>, <code>_set_purecall_handler()</code>.</p>


<p>Then I found that some CRT handlers are valid for the current thread only, but some of them work for all threads of the process.</p>


<p>Continuing my research, I found out that there are many nuances a developer must understand to use exception handling effectively. Results of my research are presented below.</p>


<h2>Some Words About Exceptions</h2>


<p>As you already know, an exception or a critical error typically means that a program stops working normally and needs to stop its execution.</p>


<p>For example, an exception may occur because of the following:</p>


<ul>

<li>program accesses an invalid memory address (such as NULL pointer)</li><li>stack overflows due to infinite recursion</li><li>large block of data is written to a small buffer</li><li>a pure virtual method of a C++ class is called</li><li>memory buffer can't be allocated (out of memory)</li><li>invalid parameter is passed to a C++ system function</li><li>C run-time libraries detect an error and request program termination</li></ul>


<p>There are two kinds of exceptions that have a different nature: <em>SEH exceptions</em> (Structured Exception Handling, SEH) and <em>typed C++ exceptions</em>. 
You can find an in-depth description of exception mechanism implementation in the excellent <a href="http://www.codeproject.com/KB/cpp/exceptionhandler.aspx">How a Compiler 
Implements Exception Handling</a> article by Vishal Kochhar.</p>


<p>Structured exception handling mechanism is provided by the Operating System (this means that all Windows applications can raise and handle SEH exceptions). 
SEH exceptions were originally designed for the C language, but they can be used in C++ too.</p>


<p>SEH exceptions are handled using the <code>__try{}__except(){}</code> construction. The <code>main()</code> function of your program is guarded with such 
a construction, so by default all unhandled SEH exceptions are caught and Dr. Watson is invoked. SEH exceptions are Visual C++ compiler-specific. 
If you write portable code, you should guard the structured exception handling construction with <code>#ifdef/#endif</code>.</p>


<p>Here is a code example:</p>


<pre lang="C++" data-lang-orig="C++" id="pre667774" class="notranslate" style="position: relative;"><div class="pre-action-link" id="premain667774"><span id="copycode667774" onclick="return ProcessCodeBlocks.copyCode(667774);">Copy Code</span></div><span class="code-keyword">int</span>* p = NULL;   <span class="code-comment">//</span><span class="code-comment"> pointer to NULL</span>
<span class="code-keyword">__try</span>
{
    <span class="code-comment">//</span><span class="code-comment"> Guarded code</span>
    *p = <span class="code-digit">13</span>; <span class="code-comment">//</span><span class="code-comment"> causes an access violation exception</span>
}
<span class="code-keyword">__except</span>(EXCEPTION_EXECUTE_HANDLER) <span class="code-comment">//</span><span class="code-comment"> Here is exception filter expression</span>
{  
    <span class="code-comment">//</span><span class="code-comment"> Here is exception handler</span>
 
    <span class="code-comment">//</span><span class="code-comment"> Terminate program</span>
    ExitProcess(<span class="code-digit">1</span>);
}</pre>


<p>On the other hand, the C++ typed exception mechanism is provided by the C run-time libraries (this means that only C++ applications can raise and handle 
such exceptions). C++ typed exceptions are handled using the <code>try{}catch{}</code> construction. An example is presented below (the code taken 
from <a href="http://www.cplusplus.com/doc/tutorial/exceptions/">http://www.cplusplus.com/doc/tutorial/exceptions/</a>):</p>


<pre lang="C++" data-lang-orig="C++" id="pre232654" class="notranslate" style="position: relative;"><div class="pre-action-link" id="premain232654"><span id="copycode232654" onclick="return ProcessCodeBlocks.copyCode(232654);">Copy Code</span></div><span class="code-comment">//</span><span class="code-comment"> exceptions</span>
<span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">iostream</span><span class="code-keyword">&gt;</span>
</span><span class="code-keyword">using</span> <span class="code-keyword">namespace</span> std;
<span class="code-keyword">int</span> main () {
    <span class="code-keyword">try</span>
    {
        <span class="code-keyword">throw</span> <span class="code-digit">20</span>;
    }
    <span class="code-keyword">catch</span> (<span class="code-keyword">int</span> e)
    {
        cout &lt;&lt; <span class="code-string">"</span><span class="code-string">An exception occurred. Exception Nr. "</span> &lt;&lt; e &lt;&lt; endl;
    }
    <span class="code-keyword">return</span> <span class="code-digit">0</span>;
}</pre>


<h2>Structured Exception Handling</h2>


<p>When a SEH exception occurs, you typically see a window of Dr. Watson (see figure 2) that offers to send an error report to Microsoft. You even can generate 
an SEH exception yourself using the <code>RaiseException()</code> function.</p>


<p>Each SEH exception has an associated <em>exception code</em>. You can extract the exception code inside of the <code>__except</code> statement using 
the <code>GetExceptionCode()</code> intrinsic function. You can extract the exception information inside of the <code>__except</code> statement using 
the <code>GetExceptionInformation()</code> intrinsic function. To use these intrinsic functions, you usually create your custom exception filter as shown in the example below.</p>


<p>The following example shows how to use an SEH exception filter:</p>


<pre lang="C++" data-lang-orig="C++" id="pre20388" class="notranslate" style="position: relative;"><div class="pre-action-link" id="premain20388"><span id="copycode20388" onclick="return ProcessCodeBlocks.copyCode(20388);">Copy Code</span></div><span class="code-keyword">int</span> seh_filter(<span class="code-keyword">unsigned</span> <span class="code-keyword">int</span> code, <span class="code-keyword">struct</span> _EXCEPTION_POINTERS* ep)
{
  <span class="code-comment">//</span><span class="code-comment"> Generate error report</span>
  <span class="code-comment">//</span><span class="code-comment"> Execute exception handler</span>
  <span class="code-keyword">return</span> EXCEPTION_EXECUTE_HANDLER;
}
<span class="code-keyword">void</span> main()
{
  <span class="code-keyword">__try</span>
  {
    <span class="code-comment">//</span><span class="code-comment"> .. some buggy code here</span>
  }
  <span class="code-keyword">__except</span>(seh_filter(GetExceptionCode(), GetExceptionInformation()))
  {    
    <span class="code-comment">//</span><span class="code-comment"> Terminate program</span>
    ExitProcess(<span class="code-digit">1</span>);
  }
}</pre>


<p>The <code>__try{}__except(){}</code> construction is mostly C oriented. However, you can redirect an SEH exception to a C++ typed exception and handle 
it as you do with C++ typed exceptions. This can be done using the <code>_set_se_translator()</code> function provided by the C++ runtime libraries (CRT).</p>


<p>Here is a code example (taken from MSDN):</p>


<pre lang="C++" data-lang-orig="C++" id="pre367322" processed="true" class="notranslate" style="position: relative;"><div class="pre-action-link" id="premain367322"><span id="preShrink367322" onclick="ProcessCodeBlocks.shrinkExpand(367322);">Shrink ▲</span>   <span id="copycode367322" onclick="return ProcessCodeBlocks.copyCode(367322);">Copy Code</span></div><span class="code-comment">//</span><span class="code-comment"> crt_settrans.cpp</span>
<span class="code-comment">//</span><span class="code-comment"> compile with: /EHa</span>
<span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">stdio.h</span><span class="code-keyword">&gt;</span>
</span><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">windows.h</span><span class="code-keyword">&gt;</span>
</span><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">eh.h</span><span class="code-keyword">&gt;</span>
</span><span class="code-keyword">void</span> SEFunc();
<span class="code-keyword">void</span> trans_func( <span class="code-keyword">unsigned</span> <span class="code-keyword">int</span>, EXCEPTION_POINTERS* );
<span class="code-keyword">class</span> SE_Exception
{
<span class="code-keyword">private</span>:
    <span class="code-keyword">unsigned</span> <span class="code-keyword">int</span> nSE;
<span class="code-keyword">public</span>:
    SE_Exception() {}
    SE_Exception( <span class="code-keyword">unsigned</span> <span class="code-keyword">int</span> n ) : nSE( n ) {}
    ~SE_Exception() {}
    <span class="code-keyword">unsigned</span> <span class="code-keyword">int</span> getSeNumber() { <span class="code-keyword">return</span> nSE; }
};
<span class="code-keyword">int</span> main( <span class="code-keyword">void</span> )
{
    <span class="code-keyword">try</span>
    {
        _set_se_translator( trans_func );
        SEFunc();
    }
    <span class="code-keyword">catch</span>( SE_Exception e )
    {
        printf( <span class="code-string">"</span><span class="code-string">Caught a __try exception with SE_Exception.\n"</span> );
    }
}
<span class="code-keyword">void</span> SEFunc()
{
    <span class="code-keyword">__try</span>
    {
        <span class="code-keyword">int</span> x, y=<span class="code-digit">0</span>;
        x = <span class="code-digit">5</span> / y;
    }
    <span class="code-keyword">__finally</span>
    {
        printf( <span class="code-string">"</span><span class="code-string">In finally\n"</span> );
    }
}
<span class="code-keyword">void</span> trans_func( <span class="code-keyword">unsigned</span> <span class="code-keyword">int</span> u, EXCEPTION_POINTERS* pExp )
{
    printf( <span class="code-string">"</span><span class="code-string">In trans_func.\n"</span> );
    <span class="code-keyword">throw</span> SE_Exception();
}</pre>


<p>However, the disadvantage of the <code>__try{}__catch(Expression){}</code> construction is that you may forget to guard a potentially incorrect code that may cause 
an exception that won't be handled by your program. Such an unhandled SEH exception can be caught using the top-level unhandled exception filter set with 
the <code>SetUnhandledExceptionFilter()</code> function.</p>


<p><strong>Note</strong>: The word <em>top-level</em> means that if someone calls the <code>SetUnhandledExceptionFilter()</code> function after your call, 
the exception filter will be replaced. This is a disadvantage because you can't chain top-level handlers one above another. Such a disadvantage can be eliminated 
by a Vectored Exception Handling mechanism discussed later.</p>


<p>The exception information (CPU state before the exception occurred) is passed to the exception handler through the <code>EXCEPTION_POINTERS</code> structure.</p>


<p>Here is a code example:</p>


<pre lang="C++" data-lang-orig="C++" id="pre320709" class="notranslate" style="position: relative;"><div class="pre-action-link" id="premain320709"><span id="copycode320709" onclick="return ProcessCodeBlocks.copyCode(320709);">Copy Code</span></div>LONG WINAPI MyUnhandledExceptionFilter(PEXCEPTION_POINTERS pExceptionPtrs)
{
  <span class="code-comment">//</span><span class="code-comment"> Do something, for example generate error report</span>
  <span class="code-comment">//</span><span class="code-comment">..</span>
  <span class="code-comment">//</span><span class="code-comment"> Execute default exception handler next</span>
  <span class="code-keyword">return</span> EXCEPTION_EXECUTE_HANDLER; 
} 
<span class="code-keyword">void</span> main()
{ 
  SetUnhandledExceptionFilter(MyUnhandledExceptionFilter);
  <span class="code-comment">//</span><span class="code-comment"> .. some unsafe code here </span>
}</pre>


<p>The top-level SEH exception handler works for all threads of the caller process, so it's enough to call it once in the beginning of your <code>main()</code> function.</p>


<p>The top-level SEH exception handler is called in the context of the thread where the exception has occurred. This can affect the exception handler's ability to recover 
from certain exceptions, such as an invalid stack.</p>


<p>If your exception handler function is located inside of a DLL, you should be careful when using the <code>SetUnhandledExceptionFilter()</code> function. 
If your DLL is unloaded at the moment of crash, the behavior may be unpredictable.</p>


<p><strong>Note:</strong> In Windows 7, there is a new function <code>RaiseFailFastException()</code>. This function allows to ignore all installed exception 
handlers (either SEH or vectored) and pass the exception directly to Dr. Watson. Typically, you call this function if your application is in a bad state and you 
want to terminate the application immediately and have a Windows Error Report created. For additional information, see the Reference section below.</p>


<h2>Vectored Exception Handling</h2>


<p>Vectored Exception Handling (VEH) is an extension to structured exception handling. It was introduced in Windows XP.</p>


<p>To add a vectored exception handler, you can use the <code>AddVectoredExceptionHandler()</code> function. The disadvantage is that VEH is only available in Windows XP 
and later, so the presence of <code>AddVectoredExceptionHandler()</code> function should be checked at run-time.</p>


<p>To remove the previously installed handler, use the <code>RemoveVectoredExceptionHandler()</code> function.</p>


<p>VEH allows to watch or handle all SEH exceptions for the application. To preserve backward compatibility, when an SEH exception occurs in some part of the program, 
the system calls the installed VEH handlers in turn, after that it searches for the usual SEH handlers.</p>


<p>An advantage of VEH is the ability to chain exception handlers, so if somebody installs a vectored exception handler above yours, you still can intercept the exception.</p>


<p>Vectored exception handling is suitable when you need to monitor <strong>_all_</strong> SEH exceptions, like a debugger does. But the problem is you have to decide which 
exception to handle and which to skip. In the program's code, some exceptions may be intentionally guarded by a <code>__try{}__except(){}</code> construction, and by handling 
such exceptions in VEH and not passing it to a frame-based SEH handler, you may introduce bugs into the application logics.</p>


<p>I think that the <code>SetUnhandledExceptionFilter()</code> function is more suitable for exception handling than VEH, because it is the top-level SEH handler. 
If nobody handles the exception, the top-level SEH handler is called and you don't need to decide if you should skip the exception or not.</p>


<h2>CRT Error Handling</h2>


<p>In addition to SEH exceptions and C++ typed exceptions, C runtime libraries (CRT) provides their own error handling mechanism that should be taken into account 
in your program. When a CRT error occurs, you typically see a CRT error message window (figure 3).</p>


<div class="Caption">Figure 3 - CRT Error Message</div>


<p><img width="461" height="317" alt="invparam_error.png" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="/KB/exception/ExceptionHandlingInVCPP/invparam_error.png" class="lazyload" data-sizes="auto" data-srcset="/KB/exception/ExceptionHandlingInVCPP/invparam_error-r-400.png 400w, /KB/exception/ExceptionHandlingInVCPP/invparam_error.png 461w" /></p>


<h3>Terminate Handler</h3>


<p>When CRT encounters an unhandled C++ typed exception, it calls the <code>terminate()</code> function. To intercept such calls and take an appropriate action, 
you should set the error handler using the <code>set_terminate()</code> function.</p>


<p>Here is a code example:</p>


<pre lang="C++" data-lang-orig="C++" id="pre280026" class="notranslate" style="position: relative;"><div class="pre-action-link" id="premain280026"><span id="copycode280026" onclick="return ProcessCodeBlocks.copyCode(280026);">Copy Code</span></div><span class="code-keyword">void</span> my_terminate_handler()
{
  <span class="code-comment">//</span><span class="code-comment"> Abnormal program termination (terminate() function was called)</span>
  <span class="code-comment">//</span><span class="code-comment"> Do something here</span>
  <span class="code-comment">//</span><span class="code-comment"> Finally, terminate program</span>
  exit(<span class="code-digit">1</span>); 
}
<span class="code-keyword">void</span> main()
{
  set_terminate(my_terminate_handler);
  terminate();
}</pre>


<p>There is the <code>unexpected()</code> function that is not used with the current implementation of Visual C++ exception handling. However, consider using 
the <code>set_unexpected()</code> function to set a handler for the <code>unexpected()</code> function, too.</p>


<p><strong>Note</strong>: In a multi-threaded environment, unexpected and terminate functions are maintained separately for each thread. Each new thread needs to install 
its own unexpected and terminate function. Thus, each thread is in charge of its own unexpected and terminate handling.</p>


<h3>Pure Call Handler</h3>


<p>Use the <code>_set_purecall_handler()</code> function to handle pure virtual function calls. This function can be used in VC++ .NET 2003 and later. 
This function works for all threads of the caller process.</p>


<p>Here is a code example (taken from MSDN):</p>


<pre lang="C++" data-lang-orig="C++" id="pre339407" processed="true" class="notranslate" style="position: relative;"><div class="pre-action-link" id="premain339407"><span id="preShrink339407" onclick="ProcessCodeBlocks.shrinkExpand(339407);">Shrink ▲</span>   <span id="copycode339407" onclick="return ProcessCodeBlocks.copyCode(339407);">Copy Code</span></div><span class="code-comment">//</span><span class="code-comment"> _set_purecall_handler.cpp</span>
<span class="code-comment">//</span><span class="code-comment"> compile with: /W1</span>
<span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">tchar.h</span><span class="code-keyword">&gt;</span>
</span><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">stdio.h</span><span class="code-keyword">&gt;</span>
</span><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">stdlib.h</span><span class="code-keyword">&gt;</span>
</span><span class="code-keyword">class</span> CDerived;
<span class="code-keyword">class</span> CBase
{
<span class="code-keyword">public</span>:
   CBase(CDerived *derived): m_pDerived(derived) {};
   ~CBase();
   <span class="code-keyword">virtual</span> <span class="code-keyword">void</span> function(<span class="code-keyword">void</span>) = <span class="code-digit">0</span>;
   CDerived * m_pDerived;
};
<span class="code-keyword">class</span> CDerived : <span class="code-keyword">public</span> CBase
{
<span class="code-keyword">public</span>:
   CDerived() : CBase(<span class="code-keyword">this</span>) {};   <span class="code-comment">//</span><span class="code-comment"> C4355</span>
   <span class="code-keyword">virtual</span> <span class="code-keyword">void</span> function(<span class="code-keyword">void</span>) {};
};
CBase::~CBase()
{
   m_pDerived -&gt; function();
}
<span class="code-keyword">void</span> myPurecallHandler(<span class="code-keyword">void</span>)
{
   printf(<span class="code-string">"</span><span class="code-string">In _purecall_handler."</span>);
   exit(<span class="code-digit">0</span>);
}
<span class="code-keyword">int</span> _tmain(<span class="code-keyword">int</span> argc, _TCHAR* argv[])
{
   _set_purecall_handler(myPurecallHandler);
   CDerived myDerived;
}</pre>


<h3>New Operator Fault Handler</h3>


<p>Use the <code>_set_new_handler()</code> function to handle memory allocation faults. This function can be used in VC++ .NET 2003 and later. 
This function works for all threads of the caller process. Consider using the <code>_set_new_mode()</code> function to define error behaviour for the <code>malloc()</code> function.</p>


<p>Here is a code example (taken from MSDN):</p>


<pre lang="C++" data-lang-orig="C++" id="pre518056" class="notranslate" style="position: relative;"><div class="pre-action-link" id="premain518056"><span id="copycode518056" onclick="return ProcessCodeBlocks.copyCode(518056);">Copy Code</span></div><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">new.h</span><span class="code-keyword">&gt;</span>
</span><span class="code-keyword">int</span> handle_program_memory_depletion( <span class="code-sdkkeyword">size_t</span> )
{
   <span class="code-comment">//</span><span class="code-comment"> Your code</span>
}
<span class="code-keyword">int</span> main( <span class="code-keyword">void</span> )
{
   _set_new_handler( handle_program_memory_depletion );
   <span class="code-keyword">int</span> *pi = <span class="code-keyword">new</span> <span class="code-keyword">int</span>[BIG_NUMBER];
}</pre>


<h3>Invalid Parameter Handler</h3>


<p>Use the <code>_set_invalid_parameter_handler()</code> function to handle situations when CRT detects an invalid argument in a system function call. 
This function can be used in VC++ 2005 and later. This function works for all threads of the caller process.</p>


<p>Here is a code example (taken from MSDN):</p>


<pre lang="C++" data-lang-orig="C++" id="pre606614" processed="true" class="notranslate" style="position: relative;"><div class="pre-action-link" id="premain606614"><span id="preShrink606614" onclick="ProcessCodeBlocks.shrinkExpand(606614);">Shrink ▲</span>   <span id="copycode606614" onclick="return ProcessCodeBlocks.copyCode(606614);">Copy Code</span></div><span class="code-comment">//</span><span class="code-comment"> crt_set_invalid_parameter_handler.c</span>
<span class="code-comment">//</span><span class="code-comment"> compile with: /Zi /MTd</span>
<span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">stdio.h</span><span class="code-keyword">&gt;</span>
</span><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">stdlib.h</span><span class="code-keyword">&gt;</span>
</span><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">crtdbg.h</span><span class="code-keyword">&gt;</span>  // For _CrtSetReportMode
</span><span class="code-keyword">void</span> myInvalidParameterHandler(<span class="code-keyword">const</span> <span class="code-keyword">wchar_t</span>* expression,
   <span class="code-keyword">const</span> <span class="code-keyword">wchar_t</span>* function, 
   <span class="code-keyword">const</span> <span class="code-keyword">wchar_t</span>* file, 
   <span class="code-keyword">unsigned</span> <span class="code-keyword">int</span> line, 
   uintptr_t pReserved)
{
   wprintf(L<span class="code-string">"</span><span class="code-string">Invalid parameter detected in function %s."</span>
            L<span class="code-string">"</span><span class="code-string"> File: %s Line: %d\n"</span>, function, file, line);
   wprintf(L<span class="code-string">"</span><span class="code-string">Expression: %s\n"</span>, expression);
}
<span class="code-keyword">int</span> main( )
{
   <span class="code-keyword">char</span>* formatString;
   _invalid_parameter_handler oldHandler, newHandler;
   newHandler = myInvalidParameterHandler;
   oldHandler = _set_invalid_parameter_handler(newHandler);
   <span class="code-comment">//</span><span class="code-comment"> Disable the message box for assertions.</span>
   _CrtSetReportMode(_CRT_ASSERT, <span class="code-digit">0</span>);
   <span class="code-comment">//</span><span class="code-comment"> Call printf_s with invalid parameters.</span>
   formatString = NULL;
   printf(formatString);
}</pre>


<h2>C++ Signal Handling</h2>


<p>C++ provides a program interruption mechanism called signals. You can handle the signals with the <code>signal()</code> function.</p>


<p>In Visual C++, there are six types of signals:</p>


<ul>

<li><code>SIGABRT</code> Abnormal termination</li><li><code>SIGFPE</code> Floating-point error</li><li><code>SIGILL</code> Illegal instruction</li><li><code>SIGINT</code> CTRL+C signal</li><li><code>SIGSEGV</code> Illegal storage access</li><li><code>SIGTERM</code> Termination request</li></ul>


<p>MSDN says that the <code>SIGILL</code>, <code>SIGSEGV</code>, and <code>SIGTERM</code> signals are not generated under Windows and included for ANSI compatibility. 
However, practice shows that if you set the <code>SIGSEGV</code> signal handler in the main thread, it is called by CRT instead of the SEH exception handler set with 
the <code>SetUnhandledExceptionFilter()</code> function and the global variable <code>_pxcptinfoptrs</code> contains a pointer to the exception information. In other threads, 
the exception filter set with <code>SetUnhandledExceptionFilter()</code> function is called instead of the <code>SIGSEGV</code> handler.</p>


<p><strong>Note</strong>: In Linux, signals are the main way of exception handling (Linux's implementation of C run-time, glibc, also provides <code>set_unexpected()</code> 
and <code>set_terminate()</code> handlers). As you can see, in Windows, signals are not used as intensively as they deserve. Instead of using signals, C run-time libraries 
provide several Visual C++-specific error handler functions, such as <code>_invalid_parameter_handler()</code> and so on.</p>


<p>The <code>_pxcptinfoptrs</code> global variable can also be used in the <code>SIGFPE</code> handler. In all other signal handlers, it seems to be <code>NULL</code>.</p>


<p>The <code>SIGFPE</code> signal handler is called by CRT when a floating point error occurs, such as division by zero. However, by default, floating point exceptions 
are not generated, instead NaN or infinity numbers are generated as the result of a floating point operation. Use the <code>_controlfp_s()</code> function to enable 
floating point exception generation.</p>


<p>You can generate all six signals manually using the <code>raise()</code> function.</p>


<p>Here is an example:</p>


<pre lang="C++" data-lang-orig="C++" id="pre123625" class="notranslate" style="position: relative;"><div class="pre-action-link" id="premain123625"><span id="copycode123625" onclick="return ProcessCodeBlocks.copyCode(123625);">Copy Code</span></div><span class="code-keyword">void</span> sigabrt_handler(<span class="code-keyword">int</span>)
{
  <span class="code-comment">//</span><span class="code-comment"> Caught SIGABRT C++ signal</span>
  <span class="code-comment">//</span><span class="code-comment"> Terminate program</span>
  exit(<span class="code-digit">1</span>);
}
<span class="code-keyword">void</span> main()
{
  signal(SIGABRT, sigabrt_handler);
     
  <span class="code-comment">//</span><span class="code-comment"> Cause abort</span>
  abort();       
}</pre>


<p><strong>Note</strong>: Although it is not well documented in MSDN, it seems that you should install <code>SIGFPE</code>, <code>SIGILL</code>, and <code>SIGSEGV</code> 
signal handlers for each new thread in your program. The <code>SIGABRT</code>, <code>SIGINT</code>, and <code>SIGTERM</code> signal handlers seems to work for all threads 
of the caller process, so you should install them once in your <code>main()</code> function.</p>


<h2>Retrieving Exception Information</h2>


<p>When an exception occurs, you typically want to get the CPU state to determine the place in your code that caused the problem. You may want to pass this information 
to the <code>MiniDumpWriteDump()</code> function to debug the problem later (for an example of how to do this, 
see the <a href="http://www.codeproject.com/KB/debug/XCrashReportPt3.aspx">XCrashReport: Exception Handling and Crash Reporting - Part 3</a> 
article by Hans Dietrich). The way you retrieve the exception information differs depending on the exception handler you use.</p>


<p>In the SEH exception handler set with the <code>SetUnhandledExceptionFilter()</code> function, the exception information is retrieved from the <code>EXCEPTION_POINTERS</code> 
structure passed as the function parameter.</p>


<p>In the <code>__try{}__catch(Expression){}</code> construction, you retrieve the exception information using the <code>GetExceptionInformation()</code> intrinsic function 
and pass it to the SEH exception filter function as a parameter.</p>


<p>In the <code>SIGFPE</code> and <code>SIGSEGV</code> signal handlers, you can retrieve the exception information from the <code>_pxcptinfoptrs</code> global CRT variable 
that is declared in <code>&lt;signal.h&gt;</code>. This variable is not documented well in MSDN.</p>


<p>In other signal handlers and in CRT error handlers, you have no ability to easily extract the exception information. I found a workaround used in the CRT code (see CRT 8.0 
source files, <em>invarg.c</em>, line 104).</p>


<p>The following code shows how to get the current CPU state used as exception information:</p>


<pre lang="C++" data-lang-orig="C++" id="pre853955" processed="true" class="notranslate" style="position: relative;"><div class="pre-action-link" id="premain853955"><span id="preShrink853955" onclick="ProcessCodeBlocks.shrinkExpand(853955);">Shrink ▲</span>   <span id="copycode853955" onclick="return ProcessCodeBlocks.copyCode(853955);">Copy Code</span></div><span class="code-preprocessor">#if _MSC_VER&gt;=1300
</span><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">rtcapi.h</span><span class="code-keyword">&gt;</span>
</span><span class="code-preprocessor">#endif
</span><span class="code-preprocessor">#ifndef _AddressOfReturnAddress
</span><span class="code-comment">//</span><span class="code-comment"> Taken from: http://msdn.microsoft.com/en-us/library/s975zw7k(VS.71).aspx</span>
<span class="code-preprocessor">#ifdef __cplusplus
</span><span class="code-preprocessor">#define EXTERNC extern "C"
</span><span class="code-preprocessor">#else
</span><span class="code-preprocessor">#define EXTERNC
</span><span class="code-preprocessor">#endif
</span><span class="code-comment">//</span><span class="code-comment"> _ReturnAddress and _AddressOfReturnAddress should be prototyped before use </span>
EXTERNC <span class="code-keyword">void</span> * _AddressOfReturnAddress(<span class="code-keyword">void</span>);
EXTERNC <span class="code-keyword">void</span> * _ReturnAddress(<span class="code-keyword">void</span>);
<span class="code-preprocessor">#endif 
</span><span class="code-comment">//</span><span class="code-comment"> The following function retrieves exception info</span>
<span class="code-keyword">void</span> GetExceptionPointers(DWORD dwExceptionCode, 
  EXCEPTION_POINTERS** ppExceptionPointers)
{
  <span class="code-comment">//</span><span class="code-comment"> The following code was taken from VC++ 8.0 CRT (invarg.c: line 104)</span>
  
  EXCEPTION_RECORD ExceptionRecord;
  CONTEXT ContextRecord;
  memset(&amp;ContextRecord, <span class="code-digit">0</span>, <span class="code-keyword">sizeof</span>(CONTEXT));
  
<span class="code-preprocessor">#ifdef _X86_
</span>  <span class="code-keyword">__asm</span> {
      <span class="code-keyword">mov</span> <span class="code-sdkkeyword">dword</span> <span class="code-sdkkeyword">ptr</span> [ContextRecord.<span class="code-keyword">Eax</span>], <span class="code-keyword">eax</span>
      <span class="code-keyword">mov</span> <span class="code-sdkkeyword">dword</span> <span class="code-sdkkeyword">ptr</span> [ContextRecord.<span class="code-keyword">Ecx</span>], <span class="code-keyword">ecx</span>
      <span class="code-keyword">mov</span> <span class="code-sdkkeyword">dword</span> <span class="code-sdkkeyword">ptr</span> [ContextRecord.<span class="code-keyword">Edx</span>], <span class="code-keyword">edx</span>
      <span class="code-keyword">mov</span> <span class="code-sdkkeyword">dword</span> <span class="code-sdkkeyword">ptr</span> [ContextRecord.<span class="code-keyword">Ebx</span>], <span class="code-keyword">ebx</span>
      <span class="code-keyword">mov</span> <span class="code-sdkkeyword">dword</span> <span class="code-sdkkeyword">ptr</span> [ContextRecord.<span class="code-keyword">Esi</span>], <span class="code-keyword">esi</span>
      <span class="code-keyword">mov</span> <span class="code-sdkkeyword">dword</span> <span class="code-sdkkeyword">ptr</span> [ContextRecord.<span class="code-keyword">Edi</span>], <span class="code-keyword">edi</span>
      <span class="code-keyword">mov</span> <span class="code-sdkkeyword">word</span> <span class="code-sdkkeyword">ptr</span> [ContextRecord.SegSs], <span class="code-keyword">ss</span>
      <span class="code-keyword">mov</span> <span class="code-sdkkeyword">word</span> <span class="code-sdkkeyword">ptr</span> [ContextRecord.SegCs], <span class="code-keyword">cs</span>
      <span class="code-keyword">mov</span> <span class="code-sdkkeyword">word</span> <span class="code-sdkkeyword">ptr</span> [ContextRecord.SegDs], <span class="code-keyword">ds</span>
      <span class="code-keyword">mov</span> <span class="code-sdkkeyword">word</span> <span class="code-sdkkeyword">ptr</span> [ContextRecord.SegEs], <span class="code-keyword">es</span>
      <span class="code-keyword">mov</span> <span class="code-sdkkeyword">word</span> <span class="code-sdkkeyword">ptr</span> [ContextRecord.SegFs], <span class="code-keyword">fs</span>
      <span class="code-keyword">mov</span> <span class="code-sdkkeyword">word</span> <span class="code-sdkkeyword">ptr</span> [ContextRecord.SegGs], <span class="code-keyword">gs</span>
      pushfd
      <span class="code-keyword">pop</span> [ContextRecord.EFlags]
  }
  ContextRecord.ContextFlags = CONTEXT_CONTROL;
<span class="code-preprocessor">#pragma warning(push)
</span><span class="code-preprocessor">#pragma warning(disable:4311)
</span>  ContextRecord.Eip = (ULONG)_ReturnAddress();
  ContextRecord.Esp = (ULONG)_AddressOfReturnAddress();
<span class="code-preprocessor">#pragma warning(pop)
</span>  ContextRecord.Ebp = *((ULONG *)_AddressOfReturnAddress()-<span class="code-digit">1</span>);
<span class="code-preprocessor">#elif defined (_IA64_) || defined (_AMD64_)
</span>  <span class="code-comment">/*</span><span class="code-comment"> Need to fill up the Context in IA64 and AMD64. */</span>
  RtlCaptureContext(&amp;ContextRecord);
<span class="code-preprocessor">#else  /* defined (_IA64_) || defined (_AMD64_) */
</span>  ZeroMemory(&amp;ContextRecord, <span class="code-keyword">sizeof</span>(ContextRecord));
<span class="code-preprocessor">#endif  /* defined (_IA64_) || defined (_AMD64_) */
</span>  ZeroMemory(&amp;ExceptionRecord, <span class="code-keyword">sizeof</span>(EXCEPTION_RECORD));
  ExceptionRecord.ExceptionCode = dwExceptionCode;
  ExceptionRecord.ExceptionAddress = _ReturnAddress();
  
  EXCEPTION_RECORD* pExceptionRecord = <span class="code-keyword">new</span> EXCEPTION_RECORD;
  memcpy(pExceptionRecord, &amp;ExceptionRecord, <span class="code-keyword">sizeof</span>(EXCEPTION_RECORD));
  CONTEXT* pContextRecord = <span class="code-keyword">new</span> CONTEXT;
  memcpy(pContextRecord, &amp;ContextRecord, <span class="code-keyword">sizeof</span>(CONTEXT));
  *ppExceptionPointers = <span class="code-keyword">new</span> EXCEPTION_POINTERS;
  (*ppExceptionPointers)-&gt;ExceptionRecord = pExceptionRecord;
  (*ppExceptionPointers)-&gt;ContextRecord = pContextRecord;  
}</pre>


<h2>Exception Handling and CRT Linkage</h2>


<p>Each module (EXE, DLL) in your application is linked to CRT (C run-time libraries). You may link CRT as a multi-threaded static library or as a multi-threaded dynamic link library. 
When you set CRT error handlers, such as terminate handler, unexpected handler, pure call handler, invalid parameter handler, new operator error handler, or a signal handler, 
they will work for the CRT the caller module is linked to and won't intercept exceptions in different CRT modules (if exist), because each CRT module has its own internal state.</p>


<p>Several project modules may share a single CRT DLL. This reduces to minimum the overall size of the linked CRT code. And all exceptions within that CRT DLL can be handled at once. 
That's why a multi-threaded CRT DLL is the recommended way of CRT linkage. However, many developers still prefer static CRT linkage because it's easier to distribute a single executable 
module statically linked with CRT than to distribute the same executable linked with several dynamic-link CRT libraries (for more information, 
see the <a href="http://www.codeproject.com/KB/cpp/PrivateAssemblyProjects.aspx">Create projects easily with private MFC, ATL, and CRT assemblies</a> article by Martin Richter).</p>


<p>If you plan to use CRT as a static link library (which is not recommended) and want to use some exception handling functionality, you have to build the functionality as a static 
library with the <code>/NODEFAULTLIB</code> linker flag and then link this functionality to each EXE and DLL module of your application. You would also have to install the CRT 
error handlers for each module of your application, while the SEH exception handler would still be installed once.</p>


<h2>Visual C++ Compiler Flags</h2>


<p>There are several Visual C++ compiler switches that are related to exception handling. You can find the switches if you open project 
<em>Properties-&gt;Configuration Properties-&gt;C/C++-&gt;Code Generation</em>.</p>


<h3>Exception Handling Model</h3>


<p>You can set an exception handling model for your Visual C++ compiler with <code>/EHs</code> (or <code>EHsc</code>) to specify synchronous exception handling model, 
or <code>/EHa</code> to specify asynchronous exception handling model. The asynchronous model can be used to force the <code>try{}catch(){}</code> construction to catch 
both SEH and C++ typed exceptions (the same effect can be achieved with the <code>_set_se_translator()</code> function). If a synchronous model is utilized, SEH exceptions 
are not caught by the <code>try{}catch(){}</code> construction. Asynchronous model was the default in previous versions of Visual C++, but the synchronous one is the default 
in the newer versions.</p>


<h3>Floating Point Exceptions</h3>


<p>You can enable floating point exceptions using the <em>/fp:except</em> compiler flag. This option is disabled by default, so floating point exceptions are not raised. 
For more information, see <em>/fp(Specify Floating Point Behavior)</em> in the References section below.</p>


<h3>Buffer Security Checks</h3>


<p>By default, you have the <em>/GS</em> (Buffer Security Check) compiler flag enabled that forces the compiler to inject code that would check for buffer overruns. 
A buffer overrun is a situation when a large block of data is written to a small buffer.</p>


<p><strong>Note</strong>; In Visual C++ .NET (CRT 7.1), you can use the <code>_set_security_error_handler()</code> function that CRT calls when a buffer overrun is detected. 
However, this function is deprecated in the later versions of CRT.</p>


<p>Since CRT 8.0, you can't intercept the buffer overrun errors in your code. When a buffer overrun is detected, CRT invokes Dr. Watson directly instead of calling 
the unhandled exception filter. This is done because of security reasons and Microsoft doesn't plan to change this behavior. For additional info, please see these links:</p>


<ul>

<li><a title="https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=101337" href="https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=101337">https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=101337</a></li><li><a title="http://blog.kalmbachnet.de/?postid=75" href="http://blog.kalmbachnet.de/?postid=75">http://blog.kalmbachnet.de/?postid=75</a></li></ul>


<h2>Using the Code</h2>


<p>A small console demo application <em>ExceptionHandler</em> is attached to the article. The demo can raise and catch different types of exceptions and generate 
a crash minidump file. The app is displayed in the figure below.</p>


<div class="Caption">Figure 4 - ExceptionHandler Sample Application</div>


<p><img width="588" height="338" alt="exception_handler_demo.png" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="/KB/exception/ExceptionHandlingInVCPP/exception_handler_demo.png" class="lazyload" data-sizes="auto" data-srcset="/KB/exception/ExceptionHandlingInVCPP/exception_handler_demo-r-400.png 400w, /KB/exception/ExceptionHandlingInVCPP/exception_handler_demo.png 588w" /></p>


<p>To see how this works, you need to chose an exception type (enter a number between 0 and 13) and press Enter. Then an exception is raised and caught by an exception handler. 
The exception handler then invokes the code that generates a crash minidump file using the <code>MiniDumpWriteDump()</code> function from <em>dbghelp.dll</em>. The minidump file 
is written to the current folder and named <em>crashdump.dmp</em>. You can double-click the file to open it in Visual Studio, then press F5 to run it and see the line 
of the code where exception occurred.</p>


<p>There are two logical parts in the application: the part that raises exceptions and the part that catches the exceptions and generates crash minidump. 
These two parts are described below.</p>


<p>The file <em>main.cpp</em> contains the <code>main()</code> function that contains the code for exception type selection and a big switch to choose what exception 
to rise. To raise an exception, the main function may call <code>raise()</code> or <code>RaiseException()</code> functions, throw a C++ typed exception, call some helper 
code, like <code>RecurseAlloc()</code> or <code>sigfpe_test()</code> and so on.</p>
 

<p>In the beginning of the <code>main()</code> function, an instance of <code>CCrashHandler</code> class is created. This instance is used to later catch an exception. 
We call <code>CCrashHandler::SetProcessExceptionHandlers()</code> method to set exception handlers working for the entire process (like SEH exception handler). 
We call <code>CCrashHandler::SetThreadExceptionHandlers()</code> method to install exception handlers that work for the current thread only (like unexpected or terminate handlers).</p>


<p>Below, the code of the main function is presented.</p>


<pre lang="C++" data-lang-orig="C++" id="pre956656" processed="true" class="notranslate" style="position: relative;"><div class="pre-action-link" id="premain956656"><span id="preShrink956656" onclick="ProcessCodeBlocks.shrinkExpand(956656);">Shrink ▲</span>   <span id="copycode956656" onclick="return ProcessCodeBlocks.copyCode(956656);">Copy Code</span></div><span class="code-keyword">void</span> main()
{
    CCrashHandler ch;
    ch.SetProcessExceptionHandlers();
    ch.SetThreadExceptionHandlers();
    
    printf(<span class="code-string">"</span><span class="code-string">Choose an exception type:\n"</span>);
    printf(<span class="code-string">"</span><span class="code-string">0 - SEH exception\n"</span>);
    printf(<span class="code-string">"</span><span class="code-string">1 - terminate\n"</span>);
    printf(<span class="code-string">"</span><span class="code-string">2 - unexpected\n"</span>);
    printf(<span class="code-string">"</span><span class="code-string">3 - pure virtual method call\n"</span>);
    printf(<span class="code-string">"</span><span class="code-string">4 - invalid parameter\n"</span>);
    printf(<span class="code-string">"</span><span class="code-string">5 - new operator fault\n"</span>);    
    printf(<span class="code-string">"</span><span class="code-string">6 - SIGABRT\n"</span>);
    printf(<span class="code-string">"</span><span class="code-string">7 - SIGFPE\n"</span>);
    printf(<span class="code-string">"</span><span class="code-string">8 - SIGILL\n"</span>);
    printf(<span class="code-string">"</span><span class="code-string">9 - SIGINT\n"</span>);
    printf(<span class="code-string">"</span><span class="code-string">10 - SIGSEGV\n"</span>);
    printf(<span class="code-string">"</span><span class="code-string">11 - SIGTERM\n"</span>);
    printf(<span class="code-string">"</span><span class="code-string">12 - RaiseException\n"</span>);
    printf(<span class="code-string">"</span><span class="code-string">13 - throw C++ typed exception\n"</span>);
    printf(<span class="code-string">"</span><span class="code-string">Your choice &gt;  "</span>);

    <span class="code-keyword">int</span> ExceptionType = <span class="code-digit">0</span>;
    scanf_s(<span class="code-string">"</span><span class="code-string">%d"</span>, &amp;ExceptionType);

    <span class="code-keyword">switch</span>(ExceptionType)
    {
    <span class="code-keyword">case</span> <span class="code-digit">0</span>: <span class="code-comment">//</span><span class="code-comment"> SEH</span>
        {
            <span class="code-comment">//</span><span class="code-comment"> Access violation</span>
            <span class="code-keyword">int</span> *p = <span class="code-digit">0</span>;
<span class="code-preprocessor">#pragma warning(disable : 6011)
</span><span class="code-comment">//</span><span class="code-comment"> warning C6011: Dereferencing NULL pointer 'p'</span>
            *p = <span class="code-digit">0</span>;
<span class="code-preprocessor">#pragma warning(default : 6011)   
</span>        }
        <span class="code-keyword">break</span>;
    <span class="code-keyword">case</span> <span class="code-digit">1</span>: <span class="code-comment">//</span><span class="code-comment"> terminate</span>
        {
            <span class="code-comment">//</span><span class="code-comment"> Call terminate</span>
            terminate();
        }
        <span class="code-keyword">break</span>;
    <span class="code-keyword">case</span> <span class="code-digit">2</span>: <span class="code-comment">//</span><span class="code-comment"> unexpected</span>
        {
            <span class="code-comment">//</span><span class="code-comment"> Call unexpected</span>
            unexpected();
        }
        <span class="code-keyword">break</span>;
    <span class="code-keyword">case</span> <span class="code-digit">3</span>: <span class="code-comment">//</span><span class="code-comment"> pure virtual method call</span>
        {
            <span class="code-comment">//</span><span class="code-comment"> pure virtual method call</span>
            CDerived derived;
        }
        <span class="code-keyword">break</span>;
    <span class="code-keyword">case</span> <span class="code-digit">4</span>: <span class="code-comment">//</span><span class="code-comment"> invalid parameter</span>
        {      
            <span class="code-keyword">char</span>* formatString;
            <span class="code-comment">//</span><span class="code-comment"> Call printf_s with invalid parameters.</span>
            formatString = NULL;
<span class="code-preprocessor">#pragma warning(disable : 6387)
</span><span class="code-comment">//</span><span class="code-comment"> warning C6387: 'argument 1' might be '0': this does</span>
<span class="code-comment">//</span><span class="code-comment"> not adhere to the specification for the function 'printf'</span>
            printf(formatString);
<span class="code-preprocessor">#pragma warning(default : 6387)   
</span>
        }
        <span class="code-keyword">break</span>;
    <span class="code-keyword">case</span> <span class="code-digit">5</span>: <span class="code-comment">//</span><span class="code-comment"> new operator fault</span>
        {
            <span class="code-comment">//</span><span class="code-comment"> Cause memory allocation error</span>
            RecurseAlloc();
        }
        <span class="code-keyword">break</span>;
    <span class="code-keyword">case</span> <span class="code-digit">6</span>: <span class="code-comment">//</span><span class="code-comment"> SIGABRT </span>
        {
            <span class="code-comment">//</span><span class="code-comment"> Call abort</span>
            abort();
        }
        <span class="code-keyword">break</span>;
    <span class="code-keyword">case</span> <span class="code-digit">7</span>: <span class="code-comment">//</span><span class="code-comment"> SIGFPE</span>
        {
            <span class="code-comment">//</span><span class="code-comment"> floating point exception ( /fp:except compiler option)</span>
            sigfpe_test();            
        }    
        <span class="code-keyword">break</span>;
    <span class="code-keyword">case</span> <span class="code-digit">8</span>: <span class="code-comment">//</span><span class="code-comment"> SIGILL </span>
        {
            raise(SIGILL);              
        }    
        <span class="code-keyword">break</span>;
    <span class="code-keyword">case</span> <span class="code-digit">9</span>: <span class="code-comment">//</span><span class="code-comment"> SIGINT </span>
        {
            raise(SIGINT);              
        }    
        <span class="code-keyword">break</span>;
    <span class="code-keyword">case</span> <span class="code-digit">10</span>: <span class="code-comment">//</span><span class="code-comment"> SIGSEGV </span>
        {
            raise(SIGSEGV);              
        }    
        <span class="code-keyword">break</span>;
    <span class="code-keyword">case</span> <span class="code-digit">11</span>: <span class="code-comment">//</span><span class="code-comment"> SIGTERM</span>
        {
            raise(SIGTERM);            
        }
        <span class="code-keyword">break</span>;
    <span class="code-keyword">case</span> <span class="code-digit">12</span>: <span class="code-comment">//</span><span class="code-comment"> RaiseException </span>
        {
            <span class="code-comment">//</span><span class="code-comment"> Raise noncontinuable software exception</span>
            RaiseException(<span class="code-digit">123</span>, EXCEPTION_NONCONTINUABLE, <span class="code-digit">0</span>, NULL);        
        }
        <span class="code-keyword">break</span>;
    <span class="code-keyword">case</span> <span class="code-digit">13</span>: <span class="code-comment">//</span><span class="code-comment"> throw </span>
        {
            <span class="code-comment">//</span><span class="code-comment"> Throw typed C++ exception.</span>
            <span class="code-keyword">throw</span> <span class="code-digit">13</span>;
        }
        <span class="code-keyword">break</span>;
    <span class="code-keyword">default</span>:
        {
            printf(<span class="code-string">"</span><span class="code-string">Unknown exception type specified."</span>);    
            _getch();
        }
        <span class="code-keyword">break</span>;
    }
}</pre>


<p>The files <em>CrashHandler.h</em> and<em>CrashHandler.cpp</em> contain the implementation of the exception handling and crash minidump generation functionality. 
Below the declaration of the class is presented.</p>


<pre lang="C++" data-lang-orig="C++" id="pre261682" processed="true" class="notranslate" style="position: relative;"><div class="pre-action-link" id="premain261682"><span id="preShrink261682" onclick="ProcessCodeBlocks.shrinkExpand(261682);">Shrink ▲</span>   <span id="copycode261682" onclick="return ProcessCodeBlocks.copyCode(261682);">Copy Code</span></div><span class="code-keyword">class</span> CCrashHandler  
{
<span class="code-keyword">public</span>:

    <span class="code-comment">//</span><span class="code-comment"> Constructor</span>
    CCrashHandler();

    <span class="code-comment">//</span><span class="code-comment"> Destructor</span>
    <span class="code-keyword">virtual</span> ~CCrashHandler();

    <span class="code-comment">//</span><span class="code-comment"> Sets exception handlers that work on per-process basis</span>
    <span class="code-keyword">void</span> SetProcessExceptionHandlers();

    <span class="code-comment">//</span><span class="code-comment"> Installs C++ exception handlers that function on per-thread basis</span>
    <span class="code-keyword">void</span> SetThreadExceptionHandlers();

    <span class="code-comment">//</span><span class="code-comment"> Collects current process state.</span>
    <span class="code-keyword">static</span> <span class="code-keyword">void</span> GetExceptionPointers(
        DWORD dwExceptionCode, 
        EXCEPTION_POINTERS** pExceptionPointers);

    <span class="code-comment">//</span><span class="code-comment"> This method creates minidump of the process</span>
    <span class="code-keyword">static</span> <span class="code-keyword">void</span> CreateMiniDump(EXCEPTION_POINTERS* pExcPtrs);

    <span class="code-comment">/*</span><span class="code-comment"> Exception handler functions. */</span>

    <span class="code-keyword">static</span> LONG WINAPI SehHandler(PEXCEPTION_POINTERS pExceptionPtrs);
    <span class="code-keyword">static</span> <span class="code-keyword">void</span> <span class="code-keyword">__cdecl</span> TerminateHandler();
    <span class="code-keyword">static</span> <span class="code-keyword">void</span> <span class="code-keyword">__cdecl</span> UnexpectedHandler();

    <span class="code-keyword">static</span> <span class="code-keyword">void</span> <span class="code-keyword">__cdecl</span> PureCallHandler();

    <span class="code-keyword">static</span> <span class="code-keyword">void</span> <span class="code-keyword">__cdecl</span> InvalidParameterHandler(<span class="code-keyword">const</span> <span class="code-keyword">wchar_t</span>* expression, 
           <span class="code-keyword">const</span> <span class="code-keyword">wchar_t</span>* function, <span class="code-keyword">const</span> <span class="code-keyword">wchar_t</span>* file, 
           <span class="code-keyword">unsigned</span> <span class="code-keyword">int</span> line, uintptr_t pReserved);

    <span class="code-keyword">static</span> <span class="code-keyword">int</span> <span class="code-keyword">__cdecl</span> NewHandler(<span class="code-sdkkeyword">size_t</span>);

    <span class="code-keyword">static</span> <span class="code-keyword">void</span> SigabrtHandler(<span class="code-keyword">int</span>);
    <span class="code-keyword">static</span> <span class="code-keyword">void</span> SigfpeHandler(<span class="code-keyword">int</span> <span class="code-comment">/*</span><span class="code-comment">code*/</span>, <span class="code-keyword">int</span> subcode);
    <span class="code-keyword">static</span> <span class="code-keyword">void</span> SigintHandler(<span class="code-keyword">int</span>);
    <span class="code-keyword">static</span> <span class="code-keyword">void</span> SigillHandler(<span class="code-keyword">int</span>);
    <span class="code-keyword">static</span> <span class="code-keyword">void</span> SigsegvHandler(<span class="code-keyword">int</span>);
    <span class="code-keyword">static</span> <span class="code-keyword">void</span> SigtermHandler(<span class="code-keyword">int</span>);
};</pre>


<p>As you could see from the code above, the <code>CCrashHandler</code> class has two methods for setting 
exception handlers: <code>SetProcessExceptionHandlers()</code> and <code>SetThreadExceptionHandlers()</code>, for the entire process and for the current thread, respectively. 
The code of these two methods is presented below.</p>


<pre lang="C++" data-lang-orig="C++" id="pre355306" processed="true" class="notranslate" style="position: relative;"><div class="pre-action-link" id="premain355306"><span id="preShrink355306" onclick="ProcessCodeBlocks.shrinkExpand(355306);">Shrink ▲</span>   <span id="copycode355306" onclick="return ProcessCodeBlocks.copyCode(355306);">Copy Code</span></div><span class="code-keyword">void</span> CCrashHandler::SetProcessExceptionHandlers()
{
    <span class="code-comment">//</span><span class="code-comment"> Install top-level SEH handler</span>
    SetUnhandledExceptionFilter(SehHandler);    

    <span class="code-comment">//</span><span class="code-comment"> Catch pure virtual function calls.</span>
    <span class="code-comment">//</span><span class="code-comment"> Because there is one _purecall_handler for the whole process, </span>
    <span class="code-comment">//</span><span class="code-comment"> calling this function immediately impacts all threads. The last </span>
    <span class="code-comment">//</span><span class="code-comment"> caller on any thread sets the handler. </span>
    <span class="code-comment">//</span><span class="code-comment"> http://msdn.microsoft.com/en-us/library/t296ys27.aspx</span>
    _set_purecall_handler(PureCallHandler);    

    <span class="code-comment">//</span><span class="code-comment"> Catch new operator memory allocation exceptions</span>
    _set_new_handler(NewHandler);

    <span class="code-comment">//</span><span class="code-comment"> Catch invalid parameter exceptions.</span>
    _set_invalid_parameter_handler(InvalidParameterHandler); 

    <span class="code-comment">//</span><span class="code-comment"> Set up C++ signal handlers</span>

    _set_abort_behavior(_CALL_REPORTFAULT, _CALL_REPORTFAULT);

    <span class="code-comment">//</span><span class="code-comment"> Catch an abnormal program termination</span>
    signal(SIGABRT, SigabrtHandler);  

    <span class="code-comment">//</span><span class="code-comment"> Catch illegal instruction handler</span>
    signal(SIGINT, SigintHandler);     

    <span class="code-comment">//</span><span class="code-comment"> Catch a termination request</span>
    signal(SIGTERM, SigtermHandler);          
}

<span class="code-keyword">void</span> CCrashHandler::SetThreadExceptionHandlers()
{

    <span class="code-comment">//</span><span class="code-comment"> Catch terminate() calls. </span>
    <span class="code-comment">//</span><span class="code-comment"> In a multithreaded environment, terminate functions are maintained </span>
    <span class="code-comment">//</span><span class="code-comment"> separately for each thread. Each new thread needs to install its own </span>
    <span class="code-comment">//</span><span class="code-comment"> terminate function. Thus, each thread is in charge of its own termination handling.</span>
    <span class="code-comment">//</span><span class="code-comment"> http://msdn.microsoft.com/en-us/library/t6fk7h29.aspx</span>
    set_terminate(TerminateHandler);       

    <span class="code-comment">//</span><span class="code-comment"> Catch unexpected() calls.</span>
    <span class="code-comment">//</span><span class="code-comment"> In a multithreaded environment, unexpected functions are maintained </span>
    <span class="code-comment">//</span><span class="code-comment"> separately for each thread. Each new thread needs to install its own </span>
    <span class="code-comment">//</span><span class="code-comment"> unexpected function. Thus, each thread is in charge of its own unexpected handling.</span>
    <span class="code-comment">//</span><span class="code-comment"> http://msdn.microsoft.com/en-us/library/h46t5b69.aspx  </span>
    set_unexpected(UnexpectedHandler);    

    <span class="code-comment">//</span><span class="code-comment"> Catch a floating point error</span>
    <span class="code-keyword">typedef</span> <span class="code-keyword">void</span> (*sigh)(<span class="code-keyword">int</span>);
    signal(SIGFPE, (sigh)SigfpeHandler);     

    <span class="code-comment">//</span><span class="code-comment"> Catch an illegal instruction</span>
    signal(SIGILL, SigillHandler);     

    <span class="code-comment">//</span><span class="code-comment"> Catch illegal storage access errors</span>
    signal(SIGSEGV, SigsegvHandler);   

}</pre>


<p>In the class declaration, you also can see several exception handler functions, such as <code>SehHandler()</code>, <code>TerminateHandler()</code> and so on. 
Any of these exception handlers can be called when an exception occurrs. A handler function (optionally) retrieves exception information and invokes crash minidump 
generation code, then it terminates process with <code>TerminateProcess()</code> function call.</p>


<p>The <code>GetExceptionPointers()</code> static method is used to retrieve exception information. I've described how this works in the section <em>Retrieving Exception Information</em> above.</p>


<p>The <code>CreateMiniDump()</code> method is used for crash minidump generation. It takes a pointer to the <code>EXCEPTION_POINTERS</code> structure containing exception information. 
The method calls the <code>MiniDumpWriteDump()</code> function from Microsoft Debug Help Library to generate a minidump file. The code of the method is presented below.</p>


<pre lang="C++" data-lang-orig="C++" id="pre64523" processed="true" class="notranslate" style="position: relative;"><div class="pre-action-link" id="premain64523"><span id="preShrink64523" onclick="ProcessCodeBlocks.shrinkExpand(64523);">Shrink ▲</span>   <span id="copycode64523" onclick="return ProcessCodeBlocks.copyCode(64523);">Copy Code</span></div><span class="code-comment">//</span><span class="code-comment"> This method creates minidump of the process</span>
<span class="code-keyword">void</span> CCrashHandler::CreateMiniDump(EXCEPTION_POINTERS* pExcPtrs)
{   
    HMODULE hDbgHelp = NULL;
    HANDLE hFile = NULL;
    MINIDUMP_EXCEPTION_INFORMATION mei;
    MINIDUMP_CALLBACK_INFORMATION mci;
    
    <span class="code-comment">//</span><span class="code-comment"> Load dbghelp.dll</span>
    hDbgHelp = LoadLibrary(_T(<span class="code-string">"</span><span class="code-string">dbghelp.dll"</span>));
    <span class="code-keyword">if</span>(hDbgHelp==NULL)
    {
        <span class="code-comment">//</span><span class="code-comment"> Error - couldn't load dbghelp.dll</span>
        <span class="code-keyword">return</span>;
    }

    <span class="code-comment">//</span><span class="code-comment"> Create the minidump file</span>
    hFile = CreateFile(
        _T(<span class="code-string">"</span><span class="code-string">crashdump.dmp"</span>),
        GENERIC_WRITE,
        <span class="code-digit">0</span>,
        NULL,
        CREATE_ALWAYS,
        FILE_ATTRIBUTE_NORMAL,
        NULL);

    <span class="code-keyword">if</span>(hFile==INVALID_HANDLE_VALUE)
    {
        <span class="code-comment">//</span><span class="code-comment"> Couldn't create file</span>
        <span class="code-keyword">return</span>;
    }
   
    <span class="code-comment">//</span><span class="code-comment"> Write minidump to the file</span>
    mei.ThreadId = GetCurrentThreadId();
    mei.ExceptionPointers = pExcPtrs;
    mei.ClientPointers = FALSE;
    mci.CallbackRoutine = NULL;
    mci.CallbackParam = NULL;

    <span class="code-keyword">typedef</span> BOOL (WINAPI *LPMINIDUMPWRITEDUMP)(
        HANDLE hProcess, 
        DWORD ProcessId, 
        HANDLE hFile, 
        MINIDUMP_TYPE DumpType, 
        CONST PMINIDUMP_EXCEPTION_INFORMATION ExceptionParam, 
        CONST PMINIDUMP_USER_STREAM_INFORMATION UserEncoderParam, 
        CONST PMINIDUMP_CALLBACK_INFORMATION CallbackParam);

    LPMINIDUMPWRITEDUMP pfnMiniDumpWriteDump = 
        (LPMINIDUMPWRITEDUMP)GetProcAddress(hDbgHelp, <span class="code-string">"</span><span class="code-string">MiniDumpWriteDump"</span>);
    <span class="code-keyword">if</span>(!pfnMiniDumpWriteDump)
    {    
        <span class="code-comment">//</span><span class="code-comment"> Bad MiniDumpWriteDump function</span>
        <span class="code-keyword">return</span>;
    }

    HANDLE hProcess = GetCurrentProcess();
    DWORD dwProcessId = GetCurrentProcessId();

    BOOL bWriteDump = pfnMiniDumpWriteDump(
        hProcess,
        dwProcessId,
        hFile,
        MiniDumpNormal,
        &amp;mei,
        NULL,
        &amp;mci);

    <span class="code-keyword">if</span>(!bWriteDump)
    {    
        <span class="code-comment">//</span><span class="code-comment"> Error writing dump.</span>
        <span class="code-keyword">return</span>;
    }

    <span class="code-comment">//</span><span class="code-comment"> Close file</span>
    CloseHandle(hFile);

    <span class="code-comment">//</span><span class="code-comment"> Unload dbghelp.dll</span>
    FreeLibrary(hDbgHelp);
}</pre>


<h2>References</h2>


<ul>

<li><a href="http://msdn.microsoft.com/en-us/library/x057540h%28VS.80%29.aspx">Exception Handling in Visual C++</a></li><li><a href="http://msdn.microsoft.com/en-us/library/ms680634%28VS.85%29.aspx">SetUnhandledExceptionFilter()</a></li><li><a href="http://msdn.microsoft.com/en-us/library/ms680552%28VS.85%29.aspx">RaiseException()</a></li><li><a href="http://msdn.microsoft.com/en-us/library/ms679357%28VS.85%29.aspx">GetExceptionInformation()</a></li><li><a href="http://msdn.microsoft.com/en-us/library/ms679356(v=vs.85).aspx">GetExceptionCode()</a></li><li><a href="http://msdn.microsoft.com/en-us/library/t6fk7h29%28VS.71%29.aspx">set_terminate()</a></li><li><a href="http://msdn.microsoft.com/en-us/library/h46t5b69%28VS.71%29.aspx">set_unexpected()</a></li><li><a href="http://msdn.microsoft.com/en-us/library/5z4bw5h5%28VS.71%29.aspx">_set_se_translator()</a></li><li><a href="http://msdn.microsoft.com/en-us/library/ms395801%28VS.71%29.aspx">_set_security_error_handler()</a></li><li><a href="http://msdn.microsoft.com/en-us/library/t296ys27%28VS.71%29.aspx">_set_purecall_handler()</a></li><li><a href="http://msdn.microsoft.com/en-us/library/a45x8asx%28VS.71%29.aspx">_set_new_handler()</a></li><li><a href="http://msdn.microsoft.com/en-us/library/a9yf33zb%28VS.80%29.aspx">_set_invalid_parameter_handler()</a></li><li><a href="http://msdn.microsoft.com/en-us/library/xdkz3x12%28VS.71%29.aspx">signal()</a></li><li><a href="http://msdn.microsoft.com/en-us/library/dwwzkt4c%28VS.71%29.aspx">raise()</a></li><li><a href="http://msdn.microsoft.com/en-us/library/1deeycx5%28VS.80%29.aspx">/EH (Exception Handling Model)</a></li><li><a href="http://msdn.microsoft.com/en-us/library/e7s85ffb%28VS.80%29.aspx">/fp (Specify Floating-Point Behavior)</a></li><li><a href="http://msdn.microsoft.com/en-us/library/abx4dbyh%28VS.80%29.aspx">/GS (Buffer Security Check)</a></li><li><a href="http://msdn.microsoft.com/en-us/library/abx4dbyh%28VS.80%29.aspx">C Run-time Libraries (CRT)</a></li><li><a href="http://msdn.microsoft.com/en-us/magazine/cc301714.aspx">Under the Hood: New Vectored Exception Handling in Windows XP</a></li><li><a href="http://msdn.microsoft.com/en-us/library/ms681420%28VS.85%29.aspx">Vectored Exception Handling</a></li><li><a href="http://msdn.microsoft.com/en-us/library/ms679274%28VS.85%29.aspx">AddVectoredExceptionHandler Function</a></li><li><a href="http://msdn.microsoft.com/en-us/library/ms680571%28VS.85%29.aspx">RemoveVectoredExceptionHandler Function</a></li><li><a href="http://msdn.microsoft.com/en-us/library/dd941688(v=VS.85).aspx">RaiseFailFastException Function</a></li></ul>


<h2>History</h2>


<ul>

<li>7 June 2011 - Initial release.</li><li>10 June 2011 - Added Visual C++ compiler flags and the References section.</li><li>6 January 2012 - Added ExceptionHandler sample code and added the Using the Code section.</li></ul>


						</div>
						

						

						<div class="float-right" style="margin:20px 0 0 10px;border:1px solid #ccc">
						<div class="msg-300x250" data-format="300x250" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="General-Programming/Exception-Handling/General" data-country="US" data-loadonview="true" data-tags="C++, Windows, Dev, Intermediate, error-handling, exceptions,rating4.5"><noscript>&lt;a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Exception-Handling/General&amp;sz=300x250&amp;c=282056"&gt;&lt;img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Exception-Handling/General&amp;sz=300x250&amp;c=282056"  width="300px" height="250px" target="_blank"/&gt;&lt;/a&gt;</noscript></div>
						</div>
                        
                        
						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p></div>
						<h2>Share</h2>
				        <div class="share-list">
					        

    <ul class="rrssb-buttons clearfix rrssb-1">
        <li id="ctl00_SocialLike_Email" class="email compact">
            <a href="mailto:?subject=Effective%20Exception%20Handling%20in%20Visual%20C%2b%2b%20-%20CodeProject&amp;body=Here%27s%20an%20interesting%20article%20on%20for%20you%20on%20codeproject.com%0a%0aAn%20overview%20of%20the%20standard%20exception%20handling%20techniques%20provided%20by%20Visual%20C%2b%2b.%0a%0ahttps%3a%2f%2fwww.codeproject.com%2fArticles%2f207464%2fException-Handling-in-Visual-Cplusplus%0a">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <g>
                            <path d="M20.111 26.147c-2.336 1.051-4.361 1.401-7.125 1.401c-6.462 0-12.146-4.633-12.146-12.265 &#10;                                c0-7.94 5.762-14.833 14.561-14.833c6.853 0 11.8 4.7 11.8 11.252c0 5.684-3.194 9.265-7.399 &#10;                                9.3 c-1.829 0-3.153-0.934-3.347-2.997h-0.077c-1.208 1.986-2.96 2.997-5.023 2.997c-2.532 &#10;                                0-4.361-1.868-4.361-5.062 c0-4.749 3.504-9.071 9.111-9.071c1.713 0 3.7 0.4 4.6 0.973l-1.169 &#10;                                7.203c-0.388 2.298-0.116 3.3 1 3.4 c1.673 0 3.773-2.102 3.773-6.58c0-5.061-3.27-8.994-9.303-8.994c-5.957 &#10;                                0-11.175 4.673-11.175 12.1 c0 6.5 4.2 10.2 10 10.201c1.986 0 4.089-0.43 5.646-1.245L20.111 &#10;                                26.147z M16.646 10.1 c-0.311-0.078-0.701-0.155-1.207-0.155c-2.571 0-4.595 2.53-4.595 5.529c0 &#10;                                1.5 0.7 2.4 1.9 2.4 c1.441 0 2.959-1.828 3.311-4.087L16.646 10.068z"/>
                        </g>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Twitter" class="twitter compact">
            <a href="http://twitter.com/home?status=Effective+Exception+Handling+in+Visual+C%2b%2b+-+CodeProject+-+https%3a%2f%2fwww.codeproject.com%2fArticles%2f207464%2fException-Handling-in-Visual-Cplusplus" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M24.253,8.756C24.689,17.08,18.297,24.182,9.97,24.62c-3.122,0.162-6.219-0.646-8.861-2.32&#10;                        c2.703,0.179,5.376-0.648,7.508-2.321c-2.072-0.247-3.818-1.661-4.489-3.638c0.801,0.128,1.62,0.076,2.399-0.155&#10;                        C4.045,15.72,2.215,13.6,2.115,11.077c0.688,0.275,1.426,0.407,2.168,0.386c-2.135-1.65-2.729-4.621-1.394-6.965&#10;                        C5.575,7.816,9.54,9.84,13.803,10.071c-0.842-2.739,0.694-5.64,3.434-6.482c2.018-0.623,4.212,0.044,5.546,1.683&#10;                        c1.186-0.213,2.318-0.662,3.329-1.317c-0.385,1.256-1.247,2.312-2.399,2.942c1.048-0.106,2.069-0.394,3.019-0.851&#10;                        C26.275,7.229,25.39,8.196,24.253,8.756z"/>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Facebook" class="facebook compact">
            
            <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.codeproject.com%2fArticles%2f207464%2fException-Handling-in-Visual-Cplusplus" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M27.825,4.783c0-2.427-2.182-4.608-4.608-4.608H4.783c-2.422,0-4.608,2.182-4.608,4.608v18.434&#10;                            c0,2.427,2.181,4.608,4.608,4.608H14V17.379h-3.379v-4.608H14v-1.795c0-3.089,2.335-5.885,5.192-5.885h3.718v4.608h-3.726&#10;                            c-0.408,0-0.884,0.492-0.884,1.236v1.836h4.609v4.608h-4.609v10.446h4.916c2.422,0,4.608-2.188,4.608-4.608V4.783z"/>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_LinkedIn" class="linkedin compact">
            <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f207464%2fException-Handling-in-Visual-Cplusplus&amp;title=Effective+Exception+Handling+in+Visual+C%2b%2b+-+CodeProject&amp;summary=An+overview+of+the+standard+exception+handling+techniques+provided+by+Visual+C%2b%2b.&amp;source=codeproject.com" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M25.424,15.887v8.447h-4.896v-7.882c0-1.979-0.709-3.331-2.48-3.331c-1.354,0-2.158,0.911-2.514,1.803&#10;                            c-0.129,0.315-0.162,0.753-0.162,1.194v8.216h-4.899c0,0,0.066-13.349,0-14.731h4.899v2.088c-0.01,0.016-0.023,0.032-0.033,0.048&#10;                            h0.033V11.69c0.65-1.002,1.812-2.435,4.414-2.435C23.008,9.254,25.424,11.361,25.424,15.887z M5.348,2.501&#10;                            c-1.676,0-2.772,1.092-2.772,2.539c0,1.421,1.066,2.538,2.717,2.546h0.032c1.709,0,2.771-1.132,2.771-2.546&#10;                            C8.054,3.593,7.019,2.501,5.343,2.501H5.348z M2.867,24.334h4.897V9.603H2.867V24.334z"/>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Reddit" class="reddit compact">
            <a href="http://www.reddit.com/submit?url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f207464%2fException-Handling-in-Visual-Cplusplus&amp;title=Effective+Exception+Handling+in+Visual+C%2b%2b+-+CodeProject">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve"><g>
                    <path d="M11.794 15.316c0-1.029-0.835-1.895-1.866-1.895c-1.03 0-1.893 0.865-1.893 1.895s0.863 1.9 1.9 1.9 C10.958 17.2 11.8 16.3 11.8 15.316z"/>
                    <path d="M18.1 13.422c-1.029 0-1.895 0.864-1.895 1.895c0 1 0.9 1.9 1.9 1.865c1.031 0 1.869-0.836 1.869-1.865 C19.969 14.3 19.1 13.4 18.1 13.422z"/>
                    <path d="M17.527 19.791c-0.678 0.678-1.826 1.006-3.514 1.006c-0.004 0-0.009 0-0.014 0c-0.004 0-0.01 0-0.015 0 &#10;                    c-1.686 0-2.834-0.328-3.51-1.005c-0.264-0.265-0.693-0.265-0.958 0c-0.264 0.265-0.264 0.7 0 1 c0.943 0.9 2.4 1.4 &#10;                    4.5 1.402c0.005 0 0 0 0 0c0.005 0 0 0 0 0c2.066 0 3.527-0.459 4.47-1.402 c0.265-0.264 0.265-0.693 0.002-0.958C18.221 &#10;                    19.5 17.8 19.5 17.5 19.791z"/><path d="M27.707 13.267c0-1.785-1.453-3.237-3.236-3.237c-0.793 0-1.518 0.287-2.082 &#10;                    0.761c-2.039-1.295-4.646-2.069-7.438-2.219 l1.483-4.691l4.062 0.956c0.071 1.4 1.3 2.6 2.7 2.555c1.488 0 2.695-1.208 &#10;                    2.695-2.695C25.881 3.2 24.7 2 23.2 2 c-1.059 0-1.979 0.616-2.42 1.508l-4.633-1.091c-0.344-0.081-0.693 0.118-0.803 &#10;                    0.455l-1.793 5.7 C10.548 8.6 7.7 9.4 5.6 10.75C5.006 10.3 4.3 10 3.5 10.029c-1.785 0-3.237 1.452-3.237 3.2 c0 1.1 0.6 &#10;                    2.1 1.4 2.69c-0.04 0.272-0.061 0.551-0.061 0.831c0 2.3 1.3 4.4 3.7 5.9 c2.299 1.5 5.3 2.3 8.6 2.325c3.228 0 6.271-0.825 &#10;                    8.571-2.325c2.387-1.56 3.7-3.66 3.7-5.917 c0-0.26-0.016-0.514-0.051-0.768C27.088 15.5 27.7 14.4 27.7 13.267z M23.186 &#10;                    3.355c0.74 0 1.3 0.6 1.3 1.3 c0 0.738-0.6 1.34-1.34 1.34s-1.342-0.602-1.342-1.34C21.844 4 22.4 3.4 23.2 3.355z M1.648 &#10;                    13.3 c0-1.038 0.844-1.882 1.882-1.882c0.31 0 0.6 0.1 0.9 0.209c-1.049 0.868-1.813 1.861-2.26 2.9 C1.832 14.2 1.6 13.8 1.6 &#10;                    13.267z M21.773 21.57c-2.082 1.357-4.863 2.105-7.831 2.105c-2.967 0-5.747-0.748-7.828-2.105 &#10;                    c-1.991-1.301-3.088-3-3.088-4.782c0-1.784 1.097-3.484 3.088-4.784c2.081-1.358 4.861-2.106 7.828-2.106 c2.967 0 5.7 &#10;                    0.7 7.8 2.106c1.99 1.3 3.1 3 3.1 4.784C24.859 18.6 23.8 20.3 21.8 21.57z M25.787 14.6 &#10;                    c-0.432-1.084-1.191-2.095-2.244-2.977c0.273-0.156 0.59-0.245 0.928-0.245c1.035 0 1.9 0.8 1.9 1.9 &#10;                    C26.354 13.8 26.1 14.3 25.8 14.605z"/></g></svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Pinterest" class="pinterest compact">
            <a href="http://pinterest.com/pin/create/bookmarklet/?is_video=false&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f207464%2fException-Handling-in-Visual-Cplusplus&amp;description=Effective+Exception+Handling+in+Visual+C%2b%2b+-+CodeProject">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M14.021,1.57C6.96,1.57,1.236,7.293,1.236,14.355c0,7.062,5.724,12.785,12.785,12.785c7.061,0,12.785-5.725,12.785-12.785&#10;                        C26.807,7.294,21.082,1.57,14.021,1.57z M15.261,18.655c-1.161-0.09-1.649-0.666-2.559-1.219c-0.501,2.626-1.113,5.145-2.925,6.458&#10;                        c-0.559-3.971,0.822-6.951,1.462-10.116c-1.093-1.84,0.132-5.545,2.438-4.632c2.837,1.123-2.458,6.842,1.099,7.557&#10;                        c3.711,0.744,5.227-6.439,2.925-8.775c-3.325-3.374-9.678-0.077-8.897,4.754c0.19,1.178,1.408,1.538,0.489,3.168&#10;                        C7.165,15.378,6.53,13.7,6.611,11.462c0.131-3.662,3.291-6.227,6.46-6.582c4.007-0.448,7.771,1.474,8.29,5.239&#10;                        c0.579,4.255-1.816,8.865-6.102,8.533L15.261,18.655z"/>
                    </svg>
                </span>
                
            </a>
        </li>

    </ul>



				        </div> 
    			        
                        <h2 id="ctl00_AboutHeading">About the Author</h2>
						    

<div class="author-wrapper">

    <div class="pic-wrapper"> 
        <img id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto" class="profile-pic" src="https://www.codeproject.com/Uploads/Membership/ProfileImages/{5fd0a355-46ec-4308-ad5f-0b32ffcba5af}.jpg" style="border-width:0px;transform:rotate(-4deg);" />
    </div>

    <div class="container-member">  
        <b><a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink" class="author" href="/Members/zexspectrum">OlegKrivtsov</a></b>

        <table>
        <tbody><tr>
            <td rowspan="2" nowrap="" valign="middle">
            <div id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_FollowOn" class="follow">
	            <a href="https://www.twitter.com/OlegKrivtsov"><img style="vertical-align:middle;border:0;height:24px;width:24px" alt="Twitter" src="/images/twitter32.png" /></a> 
	            
	            
            </div>
            </td>
            <td nowrap="nowrap">
                <div class="company">
                    <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle"></span>
	                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberCompany"></span>
                </div>
            </td>
            <td rowspan="2" style="padding-left:15px">
                
            </td>
        </tr>
        <tr>
            <td>
                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation">Russian Federation <img src="/script/Geo/Images/RU.gif" alt="Russian Federation" width="16px" height="11px" /></span>
            </td>
        </tr>
        </tbody></table>
    </div>

    <div class="description"><div class="shortcontent">
        I am a software developer currently living in Tomsk, Russia. I received a PhD degree in Computer Science from Tomsk Polytechnic University in 2010. I have been professionally developing C/C++ and PHP software since 2005. I like contributing to open-source and writing programming articles for popular web resources, like CodeProject. Besides writing, I love skiing and watching Formula-1.

 ...</div><div class="allcontent" style="display: none;">
        I am a software developer currently living in Tomsk, Russia. I received a PhD degree in Computer Science from Tomsk Polytechnic University in 2010. I have been professionally developing C/C++ and PHP software since 2005. I like contributing to open-source and writing programming articles for popular web resources, like CodeProject. Besides writing, I love skiing and watching Formula-1.

        
    </div><div style="font-weight:bold;margin-top:6px;"><a href="javascript://nop/" class="morelink">show more</a></div></div>

</div><br />
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    <div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="General-Programming/Exception-Handling/General" data-country="US" data-loadonview="true" data-tags="C++, Windows, Dev, Intermediate, error-handling, exceptions,rating4.5,pos_bottom"><noscript>&lt;a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Exception-Handling/General&amp;sz=728x90&amp;c=282056"&gt;&lt;img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Exception-Handling/General&amp;sz=728x90&amp;c=282056"  width="728px" height="90px" target="_blank"/&gt;&lt;/a&gt;</noscript></div>
				</div>
				
                
                

				
				

					<h2>Comments and Discussions</h2>
					<a class="float-left" name="_comments" id="_comments"> </a><div id="_MessageBoardctl00_MessageBoard" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(event, null)">
<table id="ForumTable" class="forum relaxed" cellpadding="0" cellspacing="0">
<tbody><tr>
<td class="header1"><div class="callout">
	<b>You must <a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f207464%2fException-Handling-in-Visual-Cplusplus%3ffid%3d1631711%26df%3d90%26mpp%3d25%26sort%3dPosition%26view%3dNormal%26spc%3dRelaxed%26prof%3dTrue">Sign In</a> to use this message board.</b>
</div></td>
</tr><tr>
<td><table width="100%" border="0" cellpadding="3px" cellspacing="0">
<tbody><tr class="header1">
<td colspan="2" style="white-space:nowrap;"><div class="container">
<div class="float-right">
<form action="/Search.aspx?sbo=fm" method="get" class="searchbar">
<input type="hidden" name="fid" value="1631711" /><input type="hidden" name="sbo" value="fm" /><input id="search_forumCtrl_ctl00_MessageBoard" type="search" class="search subdue" autocomplete="off" name="qf" /><input type="image" src="https://codeproject.freetls.fastly.net/images/search.gif" />
</form>
</div>
</div></td>
</tr><tr class="header2">
<td></td><td style="width:100%;"><div style="text-align:right;">
<form action="/script/Forums/SetOptions.aspx?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;floc=%2fArticles%2f207464%2fException-Handling-in-Visual-Cplusplus" method="get" style="margin:0;padding:0;">
<input type="hidden" name="fid" value="1631711" /><input type="hidden" name="currentQS" value="fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;floc=%2fArticles%2f207464%2fException-Handling-in-Visual-Cplusplus" /><input type="hidden" name="floc" value="/Articles/207464/Exception-Handling-in-Visual-Cplusplus" />Spacing<select size="1" class="dropdown" name="spc">
<option selected="" value="Relaxed">Relaxed</option><option value="Compact">Compact</option><option value="Tight">Tight</option>
</select>  Layout<select size="1" class="dropdown" name="view">
<option selected="" value="Normal">Normal</option><option value="Topic">Open Topics</option><option value="Expanded">Open All</option><option value="Thread">Thread View</option>
</select>  Per page<select size="1" class="dropdown" name="mpp">
<option value="10">10</option><option selected="" value="25">25</option><option value="50">50</option>
</select>   <input type="submit" value="Update" name="SetOpt" class="button" />
</form>
</div></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><a name="xx0xx"></a><table border="0" cellpadding="2px" cellspacing="0" width="100%">
<tbody><tr class="navbar">
<td></td><td style="text-align:right;width:50%;"></td><td style="text-align:right;white-space:nowrap;"><span class="nav-link disabled">First</span> <span class="nav-link disabled">Prev</span><a class="nav-link" name="Frm_HoverNL" href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;fr=26#xx0xx">Next</a></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%" class="fixed-layout blank-background">
<tbody><tr id="F5746903_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5746903xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="5746903" parent="0" thread="5746903" href="/Messages/5746903/Multiple-module-DLL-application">Multiple module (DLL) application</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Mike Lamusse</span><span class="date">1-Sep-20  22:49</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=103626">Mike Lamusse</a></span></td><td class="date"><span>1-Sep-20  22:49 </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5746903_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">The crashhandler.h and .cpp files as available in the sample source code refers<br />
<br />
Can we assume that these two files need to be copied and contained in every DLL project as well as the final EXE project that makes up an application.  And ... that each of these EXE and DLL projects must create their own instance of CCrashHandler ?<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/207464/Exception-Handling-in-Visual-Cplusplus" rel="nofollow noopener">Sign In</a>·<wbr /><a href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5746903" title="View Thread" rel="nofollow noopener">View Thread</a></td><td style="text-align:right;"><span data-objectref="3_5746903" name="react-item_5746903" id="MRF5746903" class="reaction-result"></span><span data-objectref="3_5746903" data-votingtype="GoodOrBad" name="RateItem_5746903" id="MVF5746903" class="rating-result"></span><a href="/Messages/5746903/Multiple-module-DLL-application" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a> </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5109844_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5109844xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="5109844" parent="0" thread="5109844" href="/Messages/5109844/Attaching-Arguments-to-RaiseException">Attaching Arguments to RaiseException</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">David A. Gray</span><span class="date">15-Aug-15  23:02</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=315627">David A. Gray</a></span></td><td class="date"><span>15-Aug-15  23:02 </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5109844_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">A few minutes after I finished reading this excellent article, I found the information that I needed, but didn't find in this article. When I read it, the problem I needed to solve was how to pass an argument list to RaiseException. I found that information in blog article, "Using Structured Exception Handling to Handle Exceptions from C++ in C#," at <a href="https://limbioliong.wordpress.com/2011/10/13/using-structured-exception-handling-to-handle-exceptions-from-c-in-c/" rel="nofollow noopener">https://limbioliong.wordpress.com/2011/10/13/using-structured-exception-handling-to-handle-exceptions-from-c-in-c/</a>[<a href="https://limbioliong.wordpress.com/2011/10/13/using-structured-exception-handling-to-handle-exceptions-from-c-in-c/" target="_blank" title="New Window" rel="nofollow noopener">^</a>].<br />
<br />
Though using <code>CoTaskMemAlloc()</code> is essential in that case, I am giving serious thought to using it for my application, which is pure C, although I suspect that it's overkill, and a simple <code>HeapAlloc </code>would do just fine, since its memory is provided by the operating system from the default process heap, and it can be discarded by calling <code>HeapFree()</code>.<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/207464/Exception-Handling-in-Visual-Cplusplus" rel="nofollow noopener">Sign In</a>·<wbr /><a href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5109844" title="View Thread" rel="nofollow noopener">View Thread</a></td><td style="text-align:right;"><span data-objectref="3_5109844" name="react-item_5109844" id="MRF5109844" class="reaction-result"></span><span data-objectref="3_5109844" data-votingtype="GoodOrBad" name="RateItem_5109844" id="MVF5109844" class="rating-result"></span><a href="/Messages/5109844/Attaching-Arguments-to-RaiseException" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a> </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5109841_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5109841xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="5109841" parent="0" thread="5109841" href="/Messages/5109841/My-vote-of-5">My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">David A. Gray</span><span class="date">15-Aug-15  22:37</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=315627">David A. Gray</a></span></td><td class="date"><span>15-Aug-15  22:37 </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5109841_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">This article is exceedingly well written, thanks to your excellent command of the English language. I did not realize that you are Russian until I reached the end, because I skipped past the byline, and just started reading.<br />
<br />
The only disappointment I have is minor, which is that you said nothing about raising exceptions with parameters.<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/207464/Exception-Handling-in-Visual-Cplusplus" rel="nofollow noopener">Sign In</a>·<wbr /><a href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5109841" title="View Thread" rel="nofollow noopener">View Thread</a></td><td style="text-align:right;"><span data-objectref="3_5109841" name="react-item_5109841" id="MRF5109841" class="reaction-result"></span><span data-objectref="3_5109841" data-votingtype="GoodOrBad" name="RateItem_5109841" id="MVF5109841" class="rating-result"></span><a href="/Messages/5109841/My-vote-of-5" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a> </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5025920_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5025920xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="5025920" parent="0" thread="5025920" href="/Messages/5025920/My-vote-of-5">My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Pharago</span><span class="date">22-Mar-15  8:50</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=668695">Pharago</a></span></td><td class="date"><span>22-Mar-15  8:50 </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5025920_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Outstanding job<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/207464/Exception-Handling-in-Visual-Cplusplus" rel="nofollow noopener">Sign In</a>·<wbr /><a href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5025920" title="View Thread" rel="nofollow noopener">View Thread</a></td><td style="text-align:right;"><span data-objectref="3_5025920" name="react-item_5025920" id="MRF5025920" class="reaction-result"></span><span data-objectref="3_5025920" data-votingtype="GoodOrBad" name="RateItem_5025920" id="MVF5025920" class="rating-result"></span><a href="/Messages/5025920/My-vote-of-5" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a> </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5009256_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5009256xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="5009256" parent="0" thread="5009256" href="/Messages/5009256/stack-trace">stack trace</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">adem33aygun</span><span class="date">24-Feb-15  22:12</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=9897221">adem33aygun</a></span></td><td class="date"><span>24-Feb-15  22:12 </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5009256_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">please help : <br />
<br />
<a href="http://stackoverflow.com/questions/28713601/exception-handling-stack-trace-in-vc" rel="nofollow noopener">http://stackoverflow.com/questions/28713601/exception-handling-stack-trace-in-vc</a><br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/207464/Exception-Handling-in-Visual-Cplusplus" rel="nofollow noopener">Sign In</a>·<wbr /><a href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5009256" title="View Thread" rel="nofollow noopener">View Thread</a></td><td style="text-align:right;"><span data-objectref="3_5009256" name="react-item_5009256" id="MRF5009256" class="reaction-result"></span><span data-objectref="3_5009256" data-votingtype="GoodOrBad" name="RateItem_5009256" id="MVF5009256" class="rating-result"></span><a href="/Messages/5009256/stack-trace" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a> </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4953958_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4953958xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="4953958" parent="0" thread="4953958" href="/Messages/4953958/GetExceptionPointers-doesnt-work-correctly-under-V">GetExceptionPointers doesn't work correctly under VS2013?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">khoel</span><span class="date">1-Dec-14  3:23</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=5398971">khoel</a></span></td><td class="date"><span>1-Dec-14  3:23 </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4953958_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">First of all thanks for a great example! When I run the code under VS2013 and try the signal exceptions (like abort() for instance), the debug dump isn't generated correctly. Instead of showing the place in the code where the abort() is, it shows the exception as happening on this line in the signal handler function: <pre lang="cs" data-lang-orig="cs" id="pre300820" class="notranslate" style="position: relative;"><div class="pre-action-link" id="premain300820"><span id="preShrink300820" onclick="ProcessCodeBlocks.shrinkExpand(300820);">Shrink ▲</span>   <span id="copycode300820" onclick="return ProcessCodeBlocks.copyCode(300820);">Copy Code</span></div>CreateMiniDump(pExceptionPtrs);</pre><br />
<br />
Any ideas how to correct this? Thanks!<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/207464/Exception-Handling-in-Visual-Cplusplus" rel="nofollow noopener">Sign In</a>·<wbr /><a href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4953958" title="View Thread" rel="nofollow noopener">View Thread</a></td><td style="text-align:right;"><span data-objectref="3_4953958" name="react-item_4953958" id="MRF4953958" class="reaction-result"></span><span data-objectref="3_4953958" data-votingtype="GoodOrBad" name="RateItem_4953958" id="MVF4953958" class="rating-result"><span>1.00/5 (1 vote)</span></span><a href="/Messages/4953958/GetExceptionPointers-doesnt-work-correctly-under-V" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a> </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4790867_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4790867xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="4790867" parent="0" thread="4790867" href="/Messages/4790867/SIGSEGV-dont-work-with-Maximize-Speed-O2">SIGSEGV dont work with Maximize Speed (/O2)</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">TheCoderGuy</span><span class="date">1-Apr-14  0:36</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=8181049">TheCoderGuy</a></span></td><td class="date"><span>1-Apr-14  0:36 </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4790867_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Hi, <br />
<br />
Instead of raise(SIGSEGV), I am trying to use -<br />
<br />
<pre lang="cs" data-lang-orig="cs" id="pre862678" class="notranslate" style="position: relative;"><div class="pre-action-link" id="premain862678"><span id="preShrink862678" onclick="ProcessCodeBlocks.shrinkExpand(862678);">Shrink ▲</span>   <span id="copycode862678" onclick="return ProcessCodeBlocks.copyCode(862678);">Copy Code</span></div><span class="code-keyword">int</span> * pIntList = NULL;

<span class="code-keyword">int</span> nInt = pIntList[<span class="code-digit">2</span>];</pre><br />
<br />
to reproduce Segmentation Fault Case (10 - SIGSEGV). <br />
<br />
I am getting the handle in void CCrashHandler::SigsegvHandler(int) when i am using Optimizing as "Disabled (/Od)". <br />
<br />
But when i am trying to use Maximize Speed (/O2), I am not getting any handle with the replaced code. <br />
<br />
Any clue.<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/207464/Exception-Handling-in-Visual-Cplusplus" rel="nofollow noopener">Sign In</a>·<wbr /><a href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4790867" title="View Thread" rel="nofollow noopener">View Thread</a></td><td style="text-align:right;"><span data-objectref="3_4790867" name="react-item_4790867" id="MRF4790867" class="reaction-result"></span><span data-objectref="3_4790867" data-votingtype="GoodOrBad" name="RateItem_4790867" id="MVF4790867" class="rating-result"></span><a href="/Messages/4790867/SIGSEGV-dont-work-with-Maximize-Speed-O2" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a> </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4791576_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx4791576xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer" /></td><td class="subject hover-container"><a class="message-link" name="4791576" parent="4790867" thread="4790867" href="/Messages/4791576/Re-SIGSEGV-dont-work-with-Maximize-Speed-O2">Re: SIGSEGV dont work with Maximize Speed (/O2)</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">TheCoderGuy</span><span class="date">1-Apr-14  20:47</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=8181049">TheCoderGuy</a></span></td><td class="date"><span>1-Apr-14  20:47 </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4791576_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4790867);" href="/Messages/4790867/SIGSEGV-dont-work-with-Maximize-Speed-O2"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0" /></a></div>Oh ! got it. <br />
<br />
Compiler optimization. <br />
<br />
Since the faulty variable is used no further, the compiler might be skipping this piece of faulty code at /O2 mode. <br />
<br />
Got the handle by adding two more lines :-<br />
<br />
<pre lang="cs" data-lang-orig="cs" id="pre724274" class="notranslate" style="position: relative;"><div class="pre-action-link" id="premain724274"><span id="preShrink724274" onclick="ProcessCodeBlocks.shrinkExpand(724274);">Shrink ▲</span>   <span id="copycode724274" onclick="return ProcessCodeBlocks.copyCode(724274);">Copy Code</span></div><span class="code-keyword">if</span>(nInt <span class="code-keyword">&gt;</span> <span class="code-digit">2</span>)
    std::cout&lt;&lt; <span class="code-string">"</span><span class="code-string">No Crash"</span> &lt;&lt; std::endl;</pre><br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/207464/Exception-Handling-in-Visual-Cplusplus" rel="nofollow noopener">Sign In</a>·<wbr /><a href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4790867" title="View Thread" rel="nofollow noopener">View Thread</a></td><td style="text-align:right;"><span data-objectref="3_4791576" name="react-item_4791576" id="MRF4791576" class="reaction-result"></span><span data-objectref="3_4791576" data-votingtype="GoodOrBad" name="RateItem_4791576" id="MVF4791576" class="rating-result"></span><a href="/Messages/4791576/Re-SIGSEGV-dont-work-with-Maximize-Speed-O2" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a> </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4772788_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4772788xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="4772788" parent="0" thread="4772788" href="/Messages/4772788/testing-notes">testing notes</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Dave Calkins</span><span class="date">5-Mar-14  6:32</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=2871536">Dave Calkins</a></span></td><td class="date"><span>5-Mar-14  6:32 </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4772788_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">In testing out the exception handlers and the code used to simulate the various exception types I noticed the following.<br />
<br />
1) I am unable to get the SIGFPE handler to be called.  I tried both 64-bit and 32-bit code and attempted the FPE test from the main thread and from a worker thread.  I'm using VS2010 on Win7 x64.<br />
<br />
2) The test for the "new" handler, on 64-bit from the main thread just shows an "Out of Memory" dialog but the handler is not invoked.  Calling the test from a worker thread results in the SEH handler being called, not the new handler.  The behavior for both cases is the same for 32-bit.<br />
<br />
Anyway, great work with the article, just wanted to post this info here for reference in case it helps others.<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/207464/Exception-Handling-in-Visual-Cplusplus" rel="nofollow noopener">Sign In</a>·<wbr /><a href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4772788" title="View Thread" rel="nofollow noopener">View Thread</a></td><td style="text-align:right;"><span data-objectref="3_4772788" name="react-item_4772788" id="MRF4772788" class="reaction-result"></span><span data-objectref="3_4772788" data-votingtype="GoodOrBad" name="RateItem_4772788" id="MVF4772788" class="rating-result"></span><a href="/Messages/4772788/testing-notes" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a> </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4771735_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4771735xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="4771735" parent="0" thread="4771735" href="/Messages/4771735/dump-collection-in-the-crashing-process">dump collection in the crashing process</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Dave Calkins</span><span class="date">4-Mar-14  5:30</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=2871536">Dave Calkins</a></span></td><td class="date"><span>4-Mar-14  5:30 </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4771735_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Excellent article!  Just as a side note, we were advised by Microsoft support that saving a dump from within the crashed process can be problematic and that its probably better to launch a separate process and have that process collect the dump from the crashed process.  This is how the Windows built-in crash handling works, its a separate helper process which does the actual dump collection.  We wrote our own collection app as well and we just run it and pass in the process ID, thread ID, and exception pointers value.  The helper app can then open the crashing process and write the dump file.<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/207464/Exception-Handling-in-Visual-Cplusplus" rel="nofollow noopener">Sign In</a>·<wbr /><a href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4771735" title="View Thread" rel="nofollow noopener">View Thread</a></td><td style="text-align:right;"><span data-objectref="3_4771735" name="react-item_4771735" id="MRF4771735" class="reaction-result"></span><span data-objectref="3_4771735" data-votingtype="GoodOrBad" name="RateItem_4771735" id="MVF4771735" class="rating-result"></span><a href="/Messages/4771735/dump-collection-in-the-crashing-process" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a> </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4765292_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4765292xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_idea.gif" alt="Suggestion" title="Suggestion" /></td><td class="subject hover-container"><a class="message-link" name="4765292" parent="0" thread="4765292" href="/Messages/4765292/Thank-you-and-some-warnings">Thank you and some warnings.</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Dimhotepus</span><span class="date">23-Feb-14  9:09</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=10436048">Dimhotepus</a></span></td><td class="date"><span>23-Feb-14  9:09 </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4765292_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Thank you for detail explanation, Oleg.<br />
Post is quite old, but still useful.<br />
<br />
As i can see, the method<br />
<pre lang="c++" data-lang-orig="c++" id="pre135351" class="notranslate" style="position: relative;"><div class="pre-action-link" id="premain135351"><span id="preShrink135351" onclick="ProcessCodeBlocks.shrinkExpand(135351);">Shrink ▲</span>   <span id="copycode135351" onclick="return ProcessCodeBlocks.copyCode(135351);">Copy Code</span></div><span class="code-keyword">void</span> CCrashHandler::CreateMiniDump(EXCEPTION_POINTERS* pExcPtrs)</pre><br />
<br />
has a little flaw, when you load library or open file, it may be better to free these resources, <b>even in case something was go bad</b>.<br />
<br />
As for example:<br />
<br />
<pre lang="c++" data-lang-orig="c++" id="pre378374" class="notranslate" style="position: relative;"><div class="pre-action-link" id="premain378374"><span id="preShrink378374" onclick="ProcessCodeBlocks.shrinkExpand(378374);">Shrink ▲</span>   <span id="copycode378374" onclick="return ProcessCodeBlocks.copyCode(378374);">Copy Code</span></div><span class="code-comment">//</span><span class="code-comment"> This method creates minidump of the process</span>
<span class="code-keyword">void</span> CCrashHandler::CreateMiniDump(EXCEPTION_POINTERS* pExcPtrs)
{   
    HMODULE hDbgHelp = NULL;
    HANDLE hFile = NULL;
    MINIDUMP_EXCEPTION_INFORMATION mei;
    MINIDUMP_CALLBACK_INFORMATION mci;
    
    <span class="code-comment">//</span><span class="code-comment"> Load dbghelp.dll</span>
    hDbgHelp = LoadLibrary(_T(<span class="code-string">"</span><span class="code-string">dbghelp.dll"</span>));
    <span class="code-keyword">if</span>(hDbgHelp==NULL)
    {
        <span class="code-comment">//</span><span class="code-comment"> Error - couldn't load dbghelp.dll</span>
        <span class="code-keyword">goto</span> cleanup;
    }

    <span class="code-comment">//</span><span class="code-comment"> Create the minidump file</span>
    hFile = CreateFile(
        _T(<span class="code-string">"</span><span class="code-string">crashdump.dmp"</span>),
        GENERIC_WRITE,
        <span class="code-digit">0</span>,
        NULL,
        CREATE_ALWAYS,
        FILE_ATTRIBUTE_NORMAL,
        NULL);

    <span class="code-keyword">if</span>(hFile==INVALID_HANDLE_VALUE)
    {
        <span class="code-comment">//</span><span class="code-comment"> Couldn't create file</span>
        <span class="code-keyword">goto</span> cleanup;
    }
   
    <span class="code-comment">//</span><span class="code-comment"> Write minidump to the file</span>
    mei.ThreadId = GetCurrentThreadId();
    mei.ExceptionPointers = pExcPtrs;
    mei.ClientPointers = FALSE;
    mci.CallbackRoutine = NULL;
    mci.CallbackParam = NULL;

    <span class="code-keyword">typedef</span> BOOL (WINAPI *LPMINIDUMPWRITEDUMP)(
        HANDLE hProcess, 
        DWORD ProcessId, 
        HANDLE hFile, 
        MINIDUMP_TYPE DumpType, 
        CONST PMINIDUMP_EXCEPTION_INFORMATION ExceptionParam, 
        CONST PMINIDUMP_USER_STREAM_INFORMATION UserEncoderParam, 
        CONST PMINIDUMP_CALLBACK_INFORMATION CallbackParam);

    LPMINIDUMPWRITEDUMP pfnMiniDumpWriteDump = 
        (LPMINIDUMPWRITEDUMP)GetProcAddress(hDbgHelp, <span class="code-string">"</span><span class="code-string">MiniDumpWriteDump"</span>);
    <span class="code-keyword">if</span>(!pfnMiniDumpWriteDump)
    {    
        <span class="code-comment">//</span><span class="code-comment"> Bad MiniDumpWriteDump function</span>
        <span class="code-keyword">goto</span> cleanup;
    }

    HANDLE hProcess = GetCurrentProcess();
    DWORD dwProcessId = GetCurrentProcessId();

    BOOL bWriteDump = pfnMiniDumpWriteDump(
        hProcess,
        dwProcessId,
        hFile,
        MiniDumpNormal,
        &amp;mei,
        NULL,
        &amp;mci);

    <span class="code-keyword">if</span>(!bWriteDump)
    {    
        <span class="code-comment">//</span><span class="code-comment"> Error writing dump.</span>
        <span class="code-keyword">goto</span> cleanup;
    }

cleanup:

    <span class="code-comment">//</span><span class="code-comment"> Close file</span>
    <span class="code-keyword">if</span> (hFile)
    {
       CloseHandle(hFile);
    }

    <span class="code-comment">//</span><span class="code-comment"> Unload dbghelp.dll</span>
    <span class="code-keyword">if</span> (hDbgHelp)
    { 
       FreeLibrary(hDbgHelp);
    }
}</pre><br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/207464/Exception-Handling-in-Visual-Cplusplus" rel="nofollow noopener">Sign In</a>·<wbr /><a href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4765292" title="View Thread" rel="nofollow noopener">View Thread</a></td><td style="text-align:right;"><span data-objectref="3_4765292" name="react-item_4765292" id="MRF4765292" class="reaction-result"></span><span data-objectref="3_4765292" data-votingtype="GoodOrBad" name="RateItem_4765292" id="MVF4765292" class="rating-result"></span><a href="/Messages/4765292/Thank-you-and-some-warnings" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a> </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4658812_h0" class="header hover-row root">
<td class="subject-line normal vote-hi" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4658812xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="4658812" parent="0" thread="4658812" href="/Messages/4658812/set-com-error-handler">_set_com_error_handler</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">ark.fps</span><span class="date">12-Sep-13  14:08</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=5461301">ark.fps</a></span></td><td class="date"><span>12-Sep-13  14:08 </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4658812_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">For the sake of completeness. There is also <code>_set_com_error_handler</code> which allows you to redefine <code>_com_raise_error</code>. The default behavior is to throw C++ exception of type <code>_com_error</code>.<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/207464/Exception-Handling-in-Visual-Cplusplus" rel="nofollow noopener">Sign In</a>·<wbr /><a href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4658812" title="View Thread" rel="nofollow noopener">View Thread</a></td><td style="text-align:right;"><span data-objectref="3_4658812" name="react-item_4658812" id="MRF4658812" class="reaction-result"></span><span data-objectref="3_4658812" data-votingtype="GoodOrBad" name="RateItem_4658812" id="MVF4658812" class="rating-result"><span>5.00/5 (1 vote)</span></span><a href="/Messages/4658812/set-com-error-handler" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a> </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4598742_h0" class="header hover-row root">
<td class="subject-line normal vote-hi " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4598742xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="4598742" parent="0" thread="4598742" href="/Messages/4598742/How-to-catch-double-delete">How to catch double "delete" ?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><img class="vote-hi" src="https://codeproject.freetls.fastly.net/images/star12.png" alt="Popular" title="Popular" /><div class="mobile-only">
	<span class="author">Julia1</span><span class="date">27-Jun-13  0:39</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=42216">Julia1</a></span></td><td class="date"><span>27-Jun-13  0:39 </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4598742_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">I have a question:<br />
How can double "delete" of a pointer can be catched?<br />
For example:<br />
<pre lang="cs" data-lang-orig="cs" id="pre957338" class="notranslate" style="position: relative;"><div class="pre-action-link" id="premain957338"><span id="preShrink957338" onclick="ProcessCodeBlocks.shrinkExpand(957338);">Shrink ▲</span>   <span id="copycode957338" onclick="return ProcessCodeBlocks.copyCode(957338);">Copy Code</span></div><span class="code-keyword">char</span> *uu = <span class="code-keyword">new</span> <span class="code-keyword">char</span>[<span class="code-digit">3</span>];
delete uu;
delete uu;</pre><br />
Thank you very much.<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/207464/Exception-Handling-in-Visual-Cplusplus" rel="nofollow noopener">Sign In</a>·<wbr /><a href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4598742" title="View Thread" rel="nofollow noopener">View Thread</a></td><td style="text-align:right;"><span data-objectref="3_4598742" name="react-item_4598742" id="MRF4598742" class="reaction-result"></span><span data-objectref="3_4598742" data-votingtype="GoodOrBad" name="RateItem_4598742" id="MVF4598742" class="rating-result"><span>4.00/5 (4 votes)</span></span><a href="/Messages/4598742/How-to-catch-double-delete" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a> </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5637774_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx5637774xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer" /></td><td class="subject hover-container"><a class="message-link" name="5637774" parent="4598742" thread="4598742" href="/Messages/5637774/Re-How-to-catch-double-delete">Re: How to catch double "delete" ?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Mike Diack</span><span class="date">21-Jun-19  6:52</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=422456">Mike Diack</a></span></td><td class="date"><span>21-Jun-19  6:52 </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5637774_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4598742);" href="/Messages/4598742/How-to-catch-double-delete"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0" /></a></div>The simple answer is not easily. Static analysis tools or runtime instrumented memory management libraries can help here to find memory mismanagement issues.<br />
<br />
BTW:<br />
There's a further bug in the code!<br />
<br />
It should be:<br />
<br />
char *uu = new char[3];<br />
delete []uu;<br />
delete []uu;<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/207464/Exception-Handling-in-Visual-Cplusplus" rel="nofollow noopener">Sign In</a>·<wbr /><a href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4598742" title="View Thread" rel="nofollow noopener">View Thread</a></td><td style="text-align:right;"><span data-objectref="3_5637774" name="react-item_5637774" id="MRF5637774" class="reaction-result"></span><span data-objectref="3_5637774" data-votingtype="GoodOrBad" name="RateItem_5637774" id="MVF5637774" class="rating-result"></span><a href="/Messages/5637774/Re-How-to-catch-double-delete" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a> </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5637776_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx5637776xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer" /></td><td class="subject hover-container"><a class="message-link" name="5637776" parent="4598742" thread="4598742" href="/Messages/5637776/Re-How-to-catch-double-delete">Re: How to catch double "delete" ?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Mike Diack</span><span class="date">21-Jun-19  6:56</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=422456">Mike Diack</a></span></td><td class="date"><span>21-Jun-19  6:56 </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5637776_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4598742);" href="/Messages/4598742/How-to-catch-double-delete"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0" /></a></div>Its worth being aware Visual C++'s own code analysis /analyze option can catch this in some case (warning C6001). Others that can help (probably better are PC-Lint, PVS Studio, and CppCheck)<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/207464/Exception-Handling-in-Visual-Cplusplus" rel="nofollow noopener">Sign In</a>·<wbr /><a href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4598742" title="View Thread" rel="nofollow noopener">View Thread</a></td><td style="text-align:right;"><span data-objectref="3_5637776" name="react-item_5637776" id="MRF5637776" class="reaction-result"></span><span data-objectref="3_5637776" data-votingtype="GoodOrBad" name="RateItem_5637776" id="MVF5637776" class="rating-result"></span><a href="/Messages/5637776/Re-How-to-catch-double-delete" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a> </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4505161_h0" class="header hover-row root">
<td class="subject-line normal vote-hi" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4505161xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="4505161" parent="0" thread="4505161" href="/Messages/4505161/Mixed-mode-Api">Mixed mode Api</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">amaiz</span><span class="date">26-Feb-13  7:21</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-pro-16.png" title="Professional" alt="professional" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=1694576">amaiz</a></span></td><td class="date"><span>26-Feb-13  7:21 </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4505161_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">This is a great article. <br />
I work primarily as a C#.net developer but have written components in C and C++(CLR) which cross the boundaries between managed and unmanaged code. <br />
<br />
how does this article apply to those boundaries and the CLR. I try to catch every exception and bubble up gracefully with try{}catch{System::Exception^}<br />
<br />
sorry for the vague question<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/207464/Exception-Handling-in-Visual-Cplusplus" rel="nofollow noopener">Sign In</a>·<wbr /><a href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4505161" title="View Thread" rel="nofollow noopener">View Thread</a></td><td style="text-align:right;"><span data-objectref="3_4505161" name="react-item_4505161" id="MRF4505161" class="reaction-result"></span><span data-objectref="3_4505161" data-votingtype="GoodOrBad" name="RateItem_4505161" id="MVF4505161" class="rating-result"><span>5.00/5 (1 vote)</span></span><a href="/Messages/4505161/Mixed-mode-Api" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a> </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4501753_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4501753xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="4501753" parent="0" thread="4501753" href="/Messages/4501753/crash-handler-vs-debugger">crash handler vs debugger</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Roller_abc</span><span class="date">21-Feb-13  9:08</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=1048918">Roller_abc</a></span></td><td class="date"><span>21-Feb-13  9:08 </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4501753_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Thank you, this is a fabulous article. I wish I had known this long ago. <br />
<br />
I do have one question here and wonder if anyone can help out a little. I have two example codes below. The first one is trying to use a null boost shared pointer while the second one is NULL regular pointer. No surprise that both will crash the application, but what I don't understand is when I attach the visual studio debugger with the application, for the first one, debugger gets the exception first while the second one gets captured by the crash handler before the debugger. Shouldn't debugger always capture exceptions before the crash handler?<br />
<br />
1. <br />
boost::shared_ptr&lt;CFileVersion&gt; dmVersionObj; <br />
CString dmVersion = dmVersionObj-&gt;GetFileVersionX();<br />
<br />
2. <br />
CFileVersion * dmVersionObj = NULL;           <br />
CString dmVersion = dmVersionObj-&gt;GetFileVersionX();<br />
<br />
Any comment is appreciated. Thank you very much.<br /><br />-- modified 21-Feb-13 15:49pm.<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/207464/Exception-Handling-in-Visual-Cplusplus" rel="nofollow noopener">Sign In</a>·<wbr /><a href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4501753" title="View Thread" rel="nofollow noopener">View Thread</a></td><td style="text-align:right;"><span data-objectref="3_4501753" name="react-item_4501753" id="MRF4501753" class="reaction-result"></span><span data-objectref="3_4501753" data-votingtype="GoodOrBad" name="RateItem_4501753" id="MVF4501753" class="rating-result"></span><a href="/Messages/4501753/crash-handler-vs-debugger" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a> </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4423253_h0" class="header hover-row root">
<td class="subject-line normal vote-hi" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4423253xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="4423253" parent="0" thread="4423253" href="/Messages/4423253/My-vote-of-5">My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Mike Gaskey</span><span class="date">8-Nov-12  13:34</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=12493">Mike Gaskey</a></span></td><td class="date"><span>8-Nov-12  13:34 </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4423253_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">The vote of +5 is not enough and I am voting not because of this article but because of the CrashRpt application you've made available.  Personally I think that is an absolute gift to the developer community. I've been working on a commercial application for years on a part time basis and am in the final stages, nearly ready to do something other than continue expanding its scope.  I realized that I would have chaos if I released it without crash reporting functionality and went searching for a starting point.  Little did I realize that I'd find a complete set of functionality.  I am amazed that you make it available and you have my gratitude.  I've picked up many snippets of code here and elsewhere all of which have saved me time and effort but CrashRpt ... fantastic. Thanks.<br />
<div class="signature"><b><small>Mike - typical white guy.</small><br />
<br />
<b><small>"Political correctness is a doctrine, fostered by a delusional, illogical minority, and rabidly promoted by an unscrupulous mainstream media, which holds forth the proposition that it is entirely possible to pick up a piece of sh*t by the clean end."</small><br />
<br />
<b><small>Thomas Mann - "Tolerance becomes a crime when applied to evil."</small><br />
<br />
<b><small>As American as: hot dogs, apple and Sarah Palin.</small></b></b></b></b></div><br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/207464/Exception-Handling-in-Visual-Cplusplus" rel="nofollow noopener">Sign In</a>·<wbr /><a href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4423253" title="View Thread" rel="nofollow noopener">View Thread</a></td><td style="text-align:right;"><span data-objectref="3_4423253" name="react-item_4423253" id="MRF4423253" class="reaction-result"></span><span data-objectref="3_4423253" data-votingtype="GoodOrBad" name="RateItem_4423253" id="MVF4423253" class="rating-result"><span>5.00/5 (1 vote)</span></span><a href="/Messages/4423253/My-vote-of-5" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a> </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4414142_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4414142xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="4414142" parent="0" thread="4414142" href="/Messages/4414142/My-vote-of-5">My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">gndnet</span><span class="date">30-Oct-12  3:22</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=2821204">gndnet</a></span></td><td class="date"><span>30-Oct-12  3:22 </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4414142_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">very good article<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/207464/Exception-Handling-in-Visual-Cplusplus" rel="nofollow noopener">Sign In</a>·<wbr /><a href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4414142" title="View Thread" rel="nofollow noopener">View Thread</a></td><td style="text-align:right;"><span data-objectref="3_4414142" name="react-item_4414142" id="MRF4414142" class="reaction-result"></span><span data-objectref="3_4414142" data-votingtype="GoodOrBad" name="RateItem_4414142" id="MVF4414142" class="rating-result"></span><a href="/Messages/4414142/My-vote-of-5" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a> </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4402558_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4402558xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="4402558" parent="0" thread="4402558" href="/Messages/4402558/My-vote-of-5">My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">serhiy.semenyuk</span><span class="date">18-Oct-12  11:42</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=2947343">serhiy.semenyuk</a></span></td><td class="date"><span>18-Oct-12  11:42 </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4402558_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">great overview of exception types. Exactly what I wanted !<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/207464/Exception-Handling-in-Visual-Cplusplus" rel="nofollow noopener">Sign In</a>·<wbr /><a href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4402558" title="View Thread" rel="nofollow noopener">View Thread</a></td><td style="text-align:right;"><span data-objectref="3_4402558" name="react-item_4402558" id="MRF4402558" class="reaction-result"></span><span data-objectref="3_4402558" data-votingtype="GoodOrBad" name="RateItem_4402558" id="MVF4402558" class="rating-result"></span><a href="/Messages/4402558/My-vote-of-5" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a> </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4384073_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4384073xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_idea.gif" alt="Suggestion" title="Suggestion" /></td><td class="subject hover-container"><a class="message-link" name="4384073" parent="0" thread="4384073" href="/Messages/4384073/MFC-Activation-contexts">MFC Activation contexts</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">namezero111111</span><span class="date">1-Oct-12  2:45</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=3492370">namezero111111</a></span></td><td class="date"><span>1-Oct-12  2:45 </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4384073_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Dear zexspectrum!<br />
Thank you for this exquisite piece of software.<br />
<br />
I have just noted one problem in MFC, which suppresses access violations in the message proc.<br />
See here:<br />
<a href="http://stackoverflow.com/questions/2631452/64bit-exceptions-in-wndproc-silently-fail" rel="nofollow noopener">http://stackoverflow.com/questions/2631452/64bit-exceptions-in-wndproc-silently-fail</a>[<a href="http://stackoverflow.com/questions/2631452/64bit-exceptions-in-wndproc-silently-fail" target="_blank" title="New Window" rel="nofollow noopener">^</a>]<br />
and here:<br />
<a href="http://stackoverflow.com/questions/2622200/exceptions-silently-caught-by-windows-how-to-handle-manually" rel="nofollow noopener">http://stackoverflow.com/questions/2622200/exceptions-silently-caught-by-windows-how-to-handle-manually</a>[<a href="http://stackoverflow.com/questions/2622200/exceptions-silently-caught-by-windows-how-to-handle-manually" target="_blank" title="New Window" rel="nofollow noopener">^</a>]<br />
<br />
To work around this, I changed the first line in CCrashHandler::SetProcessExceptionHandlers():<br />
<pre lang="cs" data-lang-orig="cs" id="pre483372" class="notranslate" style="position: relative;"><div class="pre-action-link" id="premain483372"><span id="preShrink483372" onclick="ProcessCodeBlocks.shrinkExpand(483372);">Shrink ▲</span>   <span id="copycode483372" onclick="return ProcessCodeBlocks.copyCode(483372);">Copy Code</span></div><span class="code-comment">//</span><span class="code-comment">SetUnhandledExceptionFilter(SehHandler);</span>
AddVectoredExceptionHandler(<span class="code-digit">1</span>, SehHandler);</pre><br />
<br />
AddVectoredExceptionHandler() makes our SehHandler number one again.<br />
<br />
Please let me know if you approve of this change, or if there is something wrong with this approach.<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/207464/Exception-Handling-in-Visual-Cplusplus" rel="nofollow noopener">Sign In</a>·<wbr /><a href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4384073" title="View Thread" rel="nofollow noopener">View Thread</a></td><td style="text-align:right;"><span data-objectref="3_4384073" name="react-item_4384073" id="MRF4384073" class="reaction-result"></span><span data-objectref="3_4384073" data-votingtype="GoodOrBad" name="RateItem_4384073" id="MVF4384073" class="rating-result"></span><a href="/Messages/4384073/MFC-Activation-contexts" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a> </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4388250_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx4388250xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="4388250" parent="4384073" thread="4384073" href="/Messages/4388250/Re-MFC-Activation-contexts">Re: MFC Activation contexts</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">namezero111111</span><span class="date">4-Oct-12  11:06</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=3492370">namezero111111</a></span></td><td class="date"><span>4-Oct-12  11:06 </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4388250_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4384073);" href="/Messages/4384073/MFC-Activation-contexts"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0" /></a></div>I should add for those that may use this that is can lead to subtle problems, such as worker threads exceptions being handled by the library and a catch() block not called.<br />
<br />
You may tinker with this as long as you keep these things in mind.<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/207464/Exception-Handling-in-Visual-Cplusplus" rel="nofollow noopener">Sign In</a>·<wbr /><a href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4384073" title="View Thread" rel="nofollow noopener">View Thread</a></td><td style="text-align:right;"><span data-objectref="3_4388250" name="react-item_4388250" id="MRF4388250" class="reaction-result"></span><span data-objectref="3_4388250" data-votingtype="GoodOrBad" name="RateItem_4388250" id="MVF4388250" class="rating-result"></span><a href="/Messages/4388250/Re-MFC-Activation-contexts" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a> </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4383104_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4383104xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="4383104" parent="0" thread="4383104" href="/Messages/4383104/My-vote-of-5">My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">namezero111111</span><span class="date">29-Sep-12  6:15</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=3492370">namezero111111</a></span></td><td class="date"><span>29-Sep-12  6:15 </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4383104_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">I was looking for ways to do exactly what this project does. It is perfect, because I wouldn't have known about all the intricacies of catching unhandled problems.<br />
<br />
I have extended the Handler functions to write a last log entry.<br />
<br />
Thank you very much!<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/207464/Exception-Handling-in-Visual-Cplusplus" rel="nofollow noopener">Sign In</a>·<wbr /><a href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4383104" title="View Thread" rel="nofollow noopener">View Thread</a></td><td style="text-align:right;"><span data-objectref="3_4383104" name="react-item_4383104" id="MRF4383104" class="reaction-result"></span><span data-objectref="3_4383104" data-votingtype="GoodOrBad" name="RateItem_4383104" id="MVF4383104" class="rating-result"></span><a href="/Messages/4383104/My-vote-of-5" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a> </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4179816_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4179816xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="4179816" parent="0" thread="4179816" href="/Messages/4179816/Using-crashhandler-on-a-multithreaded-application">Using crashhandler on a multithreaded application</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">fandas</span><span class="date">3-Mar-12  16:16</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=655184">fandas</a></span></td><td class="date"><span>3-Mar-12  16:16 </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4179816_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Hello<br />
<br />
 I am trying to use the crash handler on an application with multiple threads. However it seems the handler would not catch exception in threads if a single "SetProcessExceptionHandlers()" .  call is made in the "process" hosting the threads.<br />
<br />
 And when calling SetProcessExceptionHandlers() or SetThreadExceptionHandlers () or both from within the threads, it will catch exceptions from the thread which called those functions last, but not from the others.<br />
<br />
 Any idea how to "expand" the catching over the entire application ?<br />
<br />
Thank you<br />
<br />
regards,<br />
Oleksiy<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/207464/Exception-Handling-in-Visual-Cplusplus" rel="nofollow noopener">Sign In</a>·<wbr /><a href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4179816" title="View Thread" rel="nofollow noopener">View Thread</a></td><td style="text-align:right;"><span data-objectref="3_4179816" name="react-item_4179816" id="MRF4179816" class="reaction-result"></span><span data-objectref="3_4179816" data-votingtype="GoodOrBad" name="RateItem_4179816" id="MVF4179816" class="rating-result"><span>3.00/5 (2 votes)</span></span><a href="/Messages/4179816/Using-crashhandler-on-a-multithreaded-application" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a> </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4172293_h0" class="header hover-row root">
<td class="subject-line normal vote-hi" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4172293xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="4172293" parent="0" thread="4172293" href="/Messages/4172293/CrashRpt">CrashRpt</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">rrrado</span><span class="date">1-Mar-12  11:31</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=37961">rrrado</a></span></td><td class="date"><span>1-Mar-12  11:31 </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4172293_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Thank you for great article, I didn't read it whole because I'm too busy so I hope I'm not sending tips already discussed in article.<br />
I've checked your CrashRpt project, it would be great if you would hook on thread creation and inject crash report automatically. It would be easier to use, but main reason is there can be 3rd party components in application which are creating own threads out of my control (for example webbrowser control).<br />
Using CRT Dll is also annoying because it is another dependancy for program which user have to download although my application is statically linked with CRT and MFC.<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/207464/Exception-Handling-in-Visual-Cplusplus" rel="nofollow noopener">Sign In</a>·<wbr /><a href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4172293" title="View Thread" rel="nofollow noopener">View Thread</a></td><td style="text-align:right;"><span data-objectref="3_4172293" name="react-item_4172293" id="MRF4172293" class="reaction-result"></span><span data-objectref="3_4172293" data-votingtype="GoodOrBad" name="RateItem_4172293" id="MVF4172293" class="rating-result"><span>5.00/5 (1 vote)</span></span><a href="/Messages/4172293/CrashRpt" title="Get permanent link" style="border:0 !important" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a> </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table width="100%" cellpadding="2px" cellspacing="0">
<tbody><tr class="footer">
<td><span class="last-visit desktop-only tablet-only">Last Visit: 1-Jan-21  0:44     Last Update: 6-Mar-21  23:42</span></td><td><a rel="nofollow" href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal">Refresh</a></td><td style="text-align:right;white-space:nowrap;"><input id="_mbnUrl" type="hidden" value="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=26" /><span class="nav-link selected">1</span><a class="nav-link" name="Frm_HoverNL" href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=26#xx0xx">2</a> <a class="nav-link" name="Frm_HoverNL" href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?fid=1631711&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=26#xx0xx">Next ᐅ</a></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table>
</div><p class="small-text"><img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" width="16px" height="16px" alt="General" /> General    <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_news.gif" width="16px" height="16px" alt="News" /> News    <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_idea.gif" width="16px" height="16px" alt="Suggestion" /> Suggestion    <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" width="16px" height="16px" alt="Question" /> Question    <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_bug.gif" width="16px" height="16px" alt="Bug" /> Bug    <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_answer.gif" width="16px" height="16px" alt="Answer" /> Answer    <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_joke.gif" width="16px" height="16px" alt="Joke" /> Joke    <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_kudos.gif" width="16px" height="16px" alt="Praise" /> Praise    <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_rant.gif" width="16px" height="16px" alt="Rant" /> Rant    <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_admin.gif" width="16px" height="16px" alt="Admin" /> Admin    </p><p class="small-text">Use Ctrl+Left/Right to switch messages, Ctrl+Up/Down to switch threads, Ctrl+Shift+Left/Right to switch pages.</p>
				

			</div>
			

            
            <div id="ctl00_RightSideBar" class="article-right-sidebar">

				

                <div id="RHSticky" class="container-article-info-sticky">

        		    

<div class="article-summary">

    <ul class="prize-list">
<li>Best C++/MFC article of June 2011 </li>
</ul>
    

</div>

				    <div id="ctl00_SectionSponsor" class="padded-top" style="width:160px;margin:10px auto">
					    <div class="small-text muted hidden">Advertisement</div><div class="msg-160x200" data-format="160x200" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="General-Programming/Exception-Handling/General" data-country="US" data-showindicator="true" data-tags="C++, Windows, Dev, Intermediate, error-handling, exceptions,rating4.5"><noscript>&lt;a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Exception-Handling/General&amp;sz=160x200&amp;c=282056"&gt;&lt;img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Exception-Handling/General&amp;sz=160x200&amp;c=282056"  width="160px" height="200px" target="_blank"/&gt;&lt;/a&gt;</noscript><div id="div-gpt-ad-lqm.codeproject.site/General-Programming/Exception-Handling/General-4" data-google-query-id="CJ2zsqTyne8CFdNgvQoddhUExA" style="height: 0px; width: 0px; box-sizing: border-box; border: 0px; font-size: 0px; display: none;"><div id="google_ads_iframe_/6839/lqm.codeproject.site/General-Programming/Exception-Handling/General_1__container__" style="border: 0pt none; width: 160px; height: 200px;"></div></div></div>
				    </div>

				    <div style="width:160px;margin: 10px auto;">
					    <div class="msg-160x600" data-format="160x600" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="General-Programming/Exception-Handling/General" data-country="US" data-tags="C++, Windows, Dev, Intermediate, error-handling, exceptions,rating4.5"><noscript>&lt;a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Exception-Handling/General&amp;sz=160x600&amp;c=282056"&gt;&lt;img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Exception-Handling/General&amp;sz=160x600&amp;c=282056"  width="160px" height="600px" target="_blank"/&gt;&lt;/a&gt;</noscript><div id="div-gpt-ad-lqm.codeproject.site/General-Programming/Exception-Handling/General-5" data-google-query-id="CLqauqTyne8CFZKCvQod7-QCJg" style="height: 600px; width: 160px; box-sizing: border-box; border: 0px; font-size: 0px;"><div id="google_ads_iframe_/6839/lqm.codeproject.site/General-Programming/Exception-Handling/General_2__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/6839/lqm.codeproject.site/General-Programming/Exception-Handling/General_2" title="3rd party ad content" name="google_ads_iframe_/6839/lqm.codeproject.site/General-Programming/Exception-Handling/General_2" width="160" height="600" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" srcdoc="" style="border: 0px; vertical-align: bottom;" data-google-container-id="3" data-load-complete="true"></iframe></div><input type="image" src="https://cdn1.developermedia.com/Content/images/undo.png" title="Report Ad" align="left" style="z-index: 1000; position: relative; left: 0px; top: -600px; margin-top: 0px; margin-left: 0px; display: block; font-size: 0px; border: 0px; padding: 0px; height: 14px; width: 14px;" /></div><div style="display: none; width: 160px; height: 600px; z-index: 100; text-align: left; border-style: solid; border-width: 1px; position: relative; background-color: white; box-sizing: border-box; top: 0px; left: 0px;"><input type="image" src="https://cdn1.developermedia.com/Content/images/redo.png" title="Show Ad" style="z-index: 1000; position: relative; left: 0px; top: 0px; width: 14px; height: 14px; margin-top: 0px; margin-left: 0px; font-size: 0px; display: block; padding: 0px; border: 0px;" /><div class="sendReportContainer" style="padding: 20px 15px; display:block; line-height:initial !important"><div style="padding-bottom:20px; display:block; font:14px/18px &quot;Segoe UI&quot;, Arial;"><b>Don't like this Ad?</b></div><div class="dropzone" contenteditable="true" style="height:180px; width: 130px; margin-top:20px; margin-bottom: 20px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; box-sizing:border-box; white-space:normal">1. Hit the refresh icon to show the ad again so you can take a screenshot <br /><br />2. Drag and Drop or paste the screenshot here</div><div style="padding-bottom:10px; padding-top: 10px display:block; font:14px/18px &quot;Segoe UI&quot;, Arial;"> <select class="reportReason" style="max-width:150px !important; padding: 0px !important"><option>Offensive</option><option>Abusive</option><option>Off topic</option><option>Don't like the Ad</option> <option>Wrong language</option></select> </div><div style="font:14px/18px &quot;Segoe UI&quot;, Arial;"><input type="button" disabled="" class="reportButton" style="padding: 0px !important" value="Report" /></div></div><div class="reportSentContainer" style="display:none; padding: 15px 20px; font:14px/18px &quot;Segoe UI&quot;, Arial;"><span style="color:#999;">Thank you for the report!</span></div><a href="http://www.developermedia.com/" target="_blank"><img src="https://cdn1.developermedia.com/Content/images/dm-logo-150x23.png" style="max-width:120px;position:absolute; right:20px; bottom:20px;" /></a></div></div>
				    </div>

                    

				    

				    

                    <div class="anchorLink gototop" id="gototop">
                        <a id="ctl00_GoToTop" href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus#_articleTop">Go to top</a>
                    </div>

			    </div>
            </div>
            

        </div>
        

		
		<div class="theme1-background" style="height:2px;margin:5px 0" id="stickyStop"></div>

		<div class="site-footer">
			<div class="align-left">
				<a id="ctl00_PermaLink" href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus">Permalink</a><br />
				<a id="ctl00_AdvertiseLink" href="http://developermedia.com/">Advertise </a><br />
				<a id="ctl00_PrivacyLink" href="/info/privacy.aspx">Privacy</a><br />
    			<a id="ctl00_CookiePolicyLink" href="/info/cookie.aspx">Cookies</a><br />
                <a id="ctl00_TermsOfUseLink" href="/info/TermsOfUse.aspx">Terms of Use</a><br />
			</div>

            <div class="align-center">
				


<div class="page-width">
    Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?PageFlow=FixedWidth">fixed</a>
    |
    <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="/Articles/207464/Exception-Handling-in-Visual-Cplusplus?PageFlow=Fluid">fluid</a>
</div>


				

				

	            

                <br />
			</div>
                
			<div class="align-right">
				Article Copyright 2011 by OlegKrivtsov<br />Everything else
				Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2021 <br />
                <br />
				Web04 
				2.8.20210304.1<br />
			</div>
		</div>
		

		<br clear="all" />
		
			

	</div> 
	</div> 
</div>



<img id="ctl00_Audience" src="https://pubads.g.doubleclick.net/activity;dc_iu=/6839/DFPAudiencePixel;ord='637506889769969615';dc_seg=33705250?" style="border-width:0px;height:1px;width:1px;" />



<script type="text/javascript"> // IMMEDIATE script

function Join() {
                                     document.location.href = 'https://www.codeproject.com/script/Membership/Modify.aspx';
                                     return false;
                                  }

var rerptjdmlx = function(n){var t=!1;n=n||{};var r=n.RetrievalServiceUrl||"/script/content/webservices/RetrieveContent.aspx/GetContent",u=n.RetrievalServiceRetries||3,f=n.RetrievalServiceTimeout||5e3,e=function(){t||(t=!0,$(window).on("resize scroll",i),i())},i=function(){if(typeof DMAds=="undefined"){var n=$('[data-type="ad"]');n.each(function(){var n=$(this),u=n.attr("data-format")||"",f=n.attr("data-publisher")||"",e=n.attr("data-zone")||"",t=n.attr("data-loadonview"),i=n.attr("data-noadx"),h=n.attr("data-tags")||"",c=n.find("iframe").length!==0||n.find("img").length!==0,r=n.attr("data-processed");t=typeof t=="string"&amp;&amp;t.toLowerCase()==="true";i=typeof i=="string"&amp;&amp;i.toLowerCase()==="true";r=typeof r=="string"&amp;&amp;r.toLowerCase()==="true";r||c||t&amp;&amp;!s(this)||(o(n,u,f,e,i,h),n.attr("data-processed","true"))})}},o=function(n,t,i,e,o,s){var h=new $.Deferred,c=JSON.stringify({format:t,publisherCode:i,zone:e,noAdX:o,keywords:s});$.ajax({url:r,cache:!1,type:"POST",data:c,contentType:"application/json; charset=utf-8",dataType:"json",tryCount:0,retryLimit:u,timeout:f}).done(function(t){var i=t?t.d:null;h.resolve(i); i &amp;&amp; i.html &amp;&amp; n.html(i.html)}).fail(function(n,t){h.reject(t)})},s=function(n){var t,f,e,o;if(!h(n))return!1;var u=!1,i=0,r=0;try{t=n.getBoundingClientRect();typeof innerWidth=="number"?(i=window.innerWidth,r=window.innerHeight):document.documentElement&amp;&amp;(document.documentElement.clientWidth||document.documentElement.clientHeight)?(i=document.documentElement.clientWidth,r=document.documentElement.clientHeight):document.body&amp;&amp;(document.body.clientWidth||document.body.clientHeight)&amp;&amp;(i=document.body.clientWidth,r=document.body.clientHeight);f=-200;t.top===t.bottom&amp;&amp;(f+=n.height*-1);e=t.top&gt;=0&amp;&amp;t.top-200&lt;=r||t.top&lt;=0&amp;&amp;t.top&gt;=f;o=i&gt;t.left&amp;&amp;t.right&gt;=0;u=e&amp;&amp;o}catch(s){u=!0}return u},h=function(n){var t=!1,i;return n&amp;&amp;n.style.position!=="fixed"&amp;&amp;n.offsetParent?t=!0:n&amp;&amp;n.style.position==="fixed"&amp;&amp;(i=window.getComputedStyle(n),t=i&amp;&amp;i.display!=="none"),t&amp;&amp;c()},c=function(){var t=!0,n="";return typeof document.hidden!="undefined"?n="hidden":typeof document.mozHidden!="undefined"?n="mozHidden":typeof document.msHidden!="undefined"?n="msHidden":typeof document.webkitHidden!="undefined"&amp;&amp;(n="webkitHidden"),n!==null&amp;&amp;document[n]&amp;&amp;(t=!1),t};return{init:e}};
document.addEventListener('DOMContentLoaded', function() {
var n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP"),t;n.onreadystatechange=function(){try{if(n.readyState==4)if(n.status==200){var t=document.createElement("script");t.type="text/javascript";t.innerHTML=n.responseText;document.getElementsByTagName("body")[0].appendChild(t)}else(new rerptjdmlx).init()}catch(i){(new rerptjdmlx).init()}};try{t='/a.min.js?v=1.3';n.open("GET",t,!0);n.send()}catch(i){(new rerptjdmlx).init()}

  $('div[data-type="ad"][data-showindicator="true"]').before('&lt;div class="small-text muted hidden"&gt;Advertisement&lt;/div&gt;');
  setTimeout(function(){ 
    $('div[data-type="ad"][data-showindicator="true"]').each(function( index ) {
      if ($(this).height() &gt; 0) {
       $(this).prev().removeClass('hidden');
      }
    });
  }, 2000);

});

var ratingCtrl_ctl00_RateArticle;

var forumConfig_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard_forumMsgFlag;
var forumCtrl_ctl00_MessageBoard_rating;
var forumCtrl_ctl00_MessageBoard_ratingConfig;
var forumCtrl_ctl00_MessageBoard_reaction;
var forumCtrl_ctl00_MessageBoard__reactionConfig;

var subscriptionConfig_ctl00_MessageBoard = {
 ParentId      : 'ctl00_MessageBoard_SubscribeDiv',
 NewId         : 'ctl00_MessageBoard_SubscribeNew',
 ReplyId       : 'ctl00_MessageBoard_SubscribeReplies',
 InstantId     : 'ctl00_MessageBoard_SubscribeInstant',
 DailyId       : 'ctl00_MessageBoard_SubscribeDaily',
 MessageTypeId : 'ctl00_MessageBoard_MessageType',
 GetInfoUrl    : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/GetSubscriptions',
 UpdateInfoUrl : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/UpdateSubscription',
 ForumId       : 1631711,
};
var subscriptions_ctl00_MessageBoard;

var trhoodg = false;
var DMReportsOK = null;
function showDMAlert() { 
  var $div = $('div.msg-728x90');
  $div.append($('&lt;img src="/images/alert-top-block.gif" style="right:0;position:absolute;z-index:0"&gt;'));
}
function onDMcallBack(event)
{
   if (event.originalEvent) event = event.originalEvent;
   jQuery.support.cors = true;
   if (event.data === 'DM-disabled') DMReportsOK = false;
   else if (event.data=='DM-enabled') DMReportsOK = true;
   else if (typeof event.data == 'object' &amp;&amp; event.data.sender &amp;&amp;             event.data.sender == 'DeveloperMedia' &amp;&amp; event.data.application=='apps' &amp;&amp;
            event.data.action == 'reportEnabled') {
            DMReportsOK = event.data.data.enabled;
   }
   rphaxrsboh = !DMReportsOK;
}
function checkLoaded() { 
 var showBlockMsg = false;
 var block        = 'None';
 if (block === 'None' &amp;&amp; typeof DMAds === 'undefined')
     block = 'ResourceBlocked';
 if (block === 'None' &amp;&amp; !document.getElementById('adbp-tester'))     block = 'ResourceBlocked';
 if (block === 'None' &amp;&amp; DMReportsOK === false)     block = 'DomModified';
 rphaxrsboh = block != 'None';
 if (trhoodg) {
  $.ajax({ url:'/script/Content/Ajax/VS.aspx',    data:{'cadm':block},     cache:false, async:true });
};
 if (showBlockMsg &amp;&amp; block != 'None')
    showDMAlert();
}
</script>

<script type="text/javascript"> // DEFERRED script

document.addEventListener('DOMContentLoaded', function() {

	ProcessCodeBlocks.Initialise('#contentdiv');
	
	$('.author-wrapper .description').shorten({showChars: 400});
	
	anchorAnimate();
	$('#RHSticky').sticky($('#stickyStop'));
	$('#ctl00_StickyBlock').sticky($('#stickyStop'));
	
	$('#__EVENTVALIDATION').attr('autocomplete', 'off');
	
	$('#joinBtn').css('visibility', 'visible');
	
	$('.oauth').click(function () {
	    $this = $(this);
	    href = $this.attr('href');
	    var myWindow = window.open(href, 'popup',
	                              'width=800,height=600,location=0,menubar=0,resizeable=0,scrollbars=0,toolbar=0');
	    myWindow.focus();
	    var timer = setInterval(function () {
	        if (myWindow.closed) {
	            clearInterval(timer);
	            // window.location.reload(); // May do a POST reload, shows a warning
	            window.location = window.location; // force a GET reload
	        }
	    }, 200);
	    return false;
	});
	
	var oSrchFlt = false, oSrchBox=false, srchBoxFoc=false;
	var sbar     = $('#sb_tb');
	var sfilter  = $('#SearchFilter');
	
	if (typeof(InitWatermark) !== 'undefined')
	  InitWatermark('sb_tb', 'Search for articles, questions, tips');
	if (sbar &amp;&amp; sfilter) {
	  sfilter.removeClass('popup'); sfilter.hide(); sfilter.removeClass('open');
	  sbar.blur(function() {
	    if (!oSrchFlt) { sfilter.hide(); sfilter.removeClass('open'); }
	    srchBoxFoc = false;
	  });
	  sbar.focus(function() {
	    oSrchFlt   = false;
	    srchBoxFoc = true;
	    sfilter.show();
	    sfilter.addClass('open');
	  });
	  sbar.mouseleave(function()    { oSrchBox = false; });
	  sbar.mouseover(function()     { oSrchBox = true; });
	  sfilter.mouseleave(function() {
	    oSrchFlt=false;
	    if (!srchBoxFoc &amp;&amp; !oSrchBox) { sfilter.hide(); sfilter.removeClass('open'); }
	  });
	  sfilter.mouseover(function()  { oSrchFlt = true; });
	}
	
	var ratingConfig_ctl00_RateArticle = {
	  objectRef:          '2_207464_13',
	  objectSubtypeId:    1,
	  objectTypeName:     'article',
	  ownerId:            6399991,
	  votingType:         'None',
	  ratingDisplayMode:  'LargeStars',
	  resultDisplayMode:  'LargeStars',
	  ratingCallback:     null,
	  staticServer:       'https://codeproject.freetls.fastly.net',
	  baseDir:            '/script/Ratings/',
	  ratingUrl:          'ajax/RateItem.aspx',
	  histogramUrl:       'ajax/Histogram.aspx',
	  getRatingUrl:       'ajax/GetRatings.aspx',
	  width:              130,
	  forceComment:       false,
	  lowVoteThreshold:   0,
	  minRating:          1,
	  maxRating:          5
	};
	ratingCtrl_ctl00_RateArticle = new RatingControl('#ctl00_RateArticle_RatingTable',ratingConfig_ctl00_RateArticle);
	
	forumConfig_ctl00_MessageBoard_ratingConfig = {
	  objectTypeId:       3,
	  objectTypeName:     'message',
	  bulkResultSelector: '#_MessageBoardctl00_MessageBoard',
	  votingType:         'GoodOrBad',
	  staticServer:       'https://codeproject.freetls.fastly.net',
	  forceComment:       false,
	  ratingDisplayMode:  'TextOnly',
	  resultDisplayMode:  'TextOnly'
	};
	forumCtrl_ctl00_MessageBoard_rating = new RatingControl('#_MessageBoardctl00_MessageBoard .content', forumConfig_ctl00_MessageBoard_ratingConfig);
	forumConfig_ctl00_MessageBoard = {
	    objectName          : 'forumCtrl_ctl00_MessageBoard',
	    messageTypeId       : 3,
	    searchPrompt        : 'Search Comments',
	    smoothScroll        : true,
	    allowReporting      : false,
	    allowRating         : false,
	    allowRatingDisplay  : true,
	    allowReactions      : false,
	    forumDir            : '/script/Forums/',
	    staticServer        : 'https://codeproject.freetls.fastly.net',
	    switchMsgCallback   : null,
	    ratingControl       : forumCtrl_ctl00_MessageBoard_rating,
	    reactionControl     : null,
	    getReportFormMethod : getReportFormHtml,
	    voteHiThreshold     : 5 - 0.5,
	    reportOptions       : [
	       { reportTypeId : 19, name : 'Abusive / Trolling'},
	       { reportTypeId : 20, name : 'Inappropriate'},
	       { reportTypeId : 5, name : 'Spam'},
	    ],
	};
	forumCtrl_ctl00_MessageBoard = new ForumControl('#ForumTable',forumConfig_ctl00_MessageBoard, -1);
	forumCtrl_ctl00_MessageBoard_rating.setConfig('ratingCallback', forumCtrl_ctl00_MessageBoard.showMessageRating);
	forumCtrl_ctl00_MessageBoard.Initialise();
	
	subscriptions_ctl00_MessageBoard = new Subscriptions(subscriptionConfig_ctl00_MessageBoard);
	subscriptions_ctl00_MessageBoard.initialise();
	
	cookieconsent.initialise({
	                                    enabled : true,
	                                    cookie  : { domain: 'codeproject.com' },
	                                    palette : {
	                                        popup: { background: '#ff9900' },
	                                        button: { background: '#f5d948' }
	                                    },
	                                    law :  {
	                                        showForAllRegions : true, 
	                                        countryCode : 'US' 
	                                    },
	                                    theme: 'edgeless',
	                                    type : 'opt-in-out',
	                                    content: {
	                                        message: 'Like every other website we use cookies. By using our site you acknowledge that you have read and understand our &lt;a href=\'/info/cookie.aspx\'&gt;Cookie Policy&lt;/a&gt;, &lt;a href=\'/info/privacy.aspx\'&gt;Privacy Policy&lt;/a&gt;, and our &lt;a href=\'/info/TermsOfUse.aspx\'&gt;Terms of Service&lt;/a&gt;.',
	                                        href:    'https://www.codeproject.com/info/privacy.aspx',
	                                        dismiss: 'Ask me later'
	                                    },
	                                    revokable:true,
	                                    onStatusChange: function(status) {
	                                        $.ajax({
	                                		    dataType  : 'json',
	                                            data: JSON.stringify({ allowCookies : this.hasConsented() }),
	                                            url: '/script/membership/webservices/LoggedOnMemberservices.aspx/SetCookieConsent',
	                                            cache: false,
	                                            type: 'POST',
	                                            contentType: 'application/json'
	                                        })
	                                        console.log(this.hasConsented() ? 'enable cookies' : 'disable cookies');
	                                        console.log(this.hasAnswered() ? 'has answered' : 'did not answer');
	                                    },
	                                });
	
	$(window).on('message', onDMcallBack);
	setTimeout(checkLoaded, 4000);

})
</script>










<div id="adbp-tester">an advertisement</div><style type="text/css">.copied::after {  position: absolute;  right: 0;  display: inline-block; white-space: nowrap; content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 8px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; } 70% { opacity: 1; } 100% { opacity: 0; } } </style><style type="text/css">.copied::after {  position: absolute;  right: 0;  display: inline-block; white-space: nowrap; content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 8px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; } 70% { opacity: 1; } 100% { opacity: 0; } } </style><script type="text/javascript">if(typeof DMAds=="undefined"){var SendDmAdUid=!1,SendSearchTermsToServer=!0,CodeProjectPublisherId="lqm.codeproject.site",EnableMutableAds=!0,EnableViewOnScroll=!0,adServer=adServer||window.location.protocol+"//ads.DeveloperMedia.com/",SearchTermUrl="https://apps.developermedia.com/Ads/PageTerms/GetTerms",AdClickUrl="https://apps.developermedia.com/Ads/PageTerms/LogClick",DownvoteUrl="https://apps.developermedia.com/Ads/AdVote/DownvoteByFingerprint",UndoDownvoteUrl="https://apps.developermedia.com/Ads/AdVote/UndoDownvote",ReportAdUrl="https://apps.developermedia.com/Ads/AdVote/ReportAd",GlobalIdUrl="https://apps.developermedia.com/Ads/GlobalUserIdentification/",CloseAdImageUrl="https://cdn1.developermedia.com/Content/images/undo.png",UndoCloseAdImageUrl="https://cdn1.developermedia.com/Content/images/redo.png",DmLogoImageUrl="https://cdn1.developermedia.com/Content/images/dm-logo-150x23.png";String.prototype.includes||(String.prototype.includes=function(n,t){"use strict";return(typeof t!="number"&amp;&amp;(t=0),t+n.length&gt;this.length)?!1:this.indexOf(n,t)!==-1});var DMAdXHelper=function(){var n=[],t={},s=!1,r=!1,v=0,f=null,y=function(n){try{var i=p(n),t=w(n),r=b(n);t.insertBefore(r,t.children[0]);n.closeAdButton=i;n.reportAdDiv=t;n.adContainer.appendChild(i);n.adContainer.parentNode.appendChild(t);n.reportButton=t.getElementsByClassName("reportButton")[0];n.reportButton.disabled=!0;n.reportButton.onclick=function(){return l(n),!1}}catch(u){console.log(u)}},p=function(n){var i=document.createElement("input");return i.type="image",i.src=t.CloseAdImageUrl,i.title="Report Ad",i.align="left",i.style.cssText="z-index:1000; position:relative; left:0px; top:-"+n.height+"px; margin-top: 0px; margin-left: 0px; display:block; font-size:0px; border: 0px; padding: 0px; height:14px; width:14px",i.onclick=n.width===125&amp;&amp;n.height===125?function(){return c(n),l(n),!1}:function(){return c(n),!1},i},w=function(n){var t=n.width,i=n.height,r=document.createElement("div"),u="&lt;select class='reportReason' style='max-width:150px !important; padding: 0px !important'&gt;&lt;option&gt;Offensive&lt;\/option&gt;&lt;option&gt;Abusive&lt;\/option&gt;&lt;option&gt;Off topic&lt;\/option&gt;&lt;option&gt;Don't like the Ad&lt;\/option &gt; &lt;option&gt;Wrong language&lt;\/option&gt;&lt;\/select &gt; ",f="&lt;input type='button' disabled class='reportButton' style='padding: 0px !important' value='Report'&gt;&lt;\/input&gt;";return t===728&amp;&amp;i===90?k(r,u,f):t===300&amp;&amp;i===250?d(r,u,f):t===160&amp;&amp;i===600?g(r,u,f):t===125&amp;&amp;i===125&amp;&amp;nt(r),(t===728&amp;&amp;i===90||t===300&amp;&amp;i===250||t===160&amp;&amp;i===600)&amp;&amp;tt(n,r),r},b=function(n){var i=document.createElement("input");return i.type="image",i.src=t.UndoCloseAdImageUrl,i.title="Show Ad",i.style.cssText="z-index:1000; position:relative; left:0px; top:0px; width:14px; height:14px;margin-top: 0px; margin-left: 0px; font-size:0px; display:block; padding: 0px; border: 0px",i.onclick=function(){return h(n),!1},i},k=function(n,i,r){n.innerHTML="&lt;div class='sendReportContainer' style='padding-left: 2px; display:block; line-height:initial !important'&gt;&lt;div style='display:inline-block; font:14px/18px \"Segoe UI\", Arial'&gt;&lt;b&gt;Don't like this Ad?&lt;\/b&gt;&lt;\/div&gt;&lt;div class='dropzone' contenteditable='true' style='margin-left:10px; height:60px; width: 250px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; display:inline-block; white-space:normal'&gt;1. Hit the refresh icon to show the ad again and take a screenshot. 2. Drag and Drop or paste the screenshot here&lt;\/div&gt;&lt;div style='margin-left:10px; display:inline-block; font:14px/18px \"Segoe UI\", Arial;'&gt; "+i+"&amp;nbsp;"+r+"&lt;\/div&gt;&lt;\/div&gt;&lt;div class='reportSentContainer' style='display:none; padding: 15px 20px; font:14px/18px \"Segoe UI\", Arial;'&gt;&lt;span style='color:#999'&gt;Thank you for the report!&lt;\/span&gt;&lt;\/div&gt;&lt;a href='http://www.developermedia.com/' target='_blank'&gt;&lt;img src='"+t.DmLogoImageUrl+"' style='max-width:100%;position:absolute; right:10px; top:10px;'&gt;&lt;\/a&gt;";n.style.cssText="display:none; width:728px; height:90px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},d=function(n,i,r){n.innerHTML="&lt;div class='sendReportContainer' style='padding: 5px 5px; display:block; line-height:initial !important'&gt;&lt;div style='padding-bottom:5px; font:14px/18px \"Segoe UI\", Arial;'&gt;&lt;b&gt;Don't like this Ad?&lt;\/b&gt;&lt;\/div&gt;&lt;div class='dropzone' contenteditable='true' style='height:100px; width: 290px; margin-top:20px; margin-bottom: 20px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; box-sizing:border-box; white-space:normal'&gt;1. Hit the refresh icon to show the ad again so you can take a screenshot &lt;br/&gt;2. Drag and Drop or paste the screenshot here&lt;\/div&gt;&lt;div style='margin-top:5px; font:14px/18px \"Segoe UI\", Arial; '&gt; "+i+"&lt;\/div&gt;&lt;div style='margin-top:5px; display:block; font:14px/18px \"Segoe UI\", Arial;'&gt;"+r+"&lt;\/div&gt;&lt;\/div&gt;&lt;div class='reportSentContainer' style='display:none; padding: 15px 20px; font:14px/18px \"Segoe UI\", Arial; '&gt;&lt;span style='color:#999;'&gt;Thank you for the report!&lt;\/span&gt;&lt;\/div&gt;&lt;a href='http://www.developermedia.com/' target='_blank'&gt;&lt;img src='"+t.DmLogoImageUrl+"' style='max-width:100%;position:absolute; right:20px; bottom:10px;'&gt;&lt;\/a&gt;";n.style.cssText="display:none; width:300px; height:250px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},g=function(n,i,r){n.innerHTML="&lt;div class='sendReportContainer' style='padding: 20px 15px; display:block; line-height:initial !important'&gt;&lt;div style='padding-bottom:20px; display:block; font:14px/18px \"Segoe UI\", Arial;'&gt;&lt;b&gt;Don't like this Ad?&lt;\/b&gt;&lt;\/div&gt;&lt;div class='dropzone' contenteditable='true' style='height:180px; width: 130px; margin-top:20px; margin-bottom: 20px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; box-sizing:border-box; white-space:normal'&gt;1. Hit the refresh icon to show the ad again so you can take a screenshot &lt;br/&gt;&lt;br/&gt;2. Drag and Drop or paste the screenshot here&lt;\/div&gt;&lt;div style='padding-bottom:10px; padding-top: 10px display:block; font:14px/18px \"Segoe UI\", Arial;'&gt; "+i+"&lt;\/div&gt;&lt;div style='font:14px/18px \"Segoe UI\", Arial;'&gt;"+r+"&lt;\/div&gt;&lt;\/div&gt;&lt;div class='reportSentContainer' style='display:none; padding: 15px 20px; font:14px/18px \"Segoe UI\", Arial;'&gt;&lt;span style='color:#999;'&gt;Thank you for the report!&lt;\/span&gt;&lt;\/div&gt;&lt;a href='http://www.developermedia.com/' target='_blank'&gt;&lt;img src='"+t.DmLogoImageUrl+"' style='max-width:120px;position:absolute; right:20px; bottom:20px;'&gt;&lt;\/a&gt;";n.style.cssText="display:none; width:160px; height:600px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},nt=function(n){n.innerHTML="&lt;div class='reportSentContainer' style='padding: 5px 5px;font:14px/18px \"Segoe UI\", Arial; width: 100px; height: 100px'&gt;&lt;span style='color:#999;'&gt;Thank you for the report!&lt;\/span&gt;&lt;\/div&gt;";n.style.cssText="display:none; width:125px; height:125px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},tt=function(n,t){if(n&amp;&amp;n.adContainer){var i=t.getElementsByClassName("dropzone")[0];i.dropzoneFor=n.adContainer.id;n.dropzone=i;s&amp;&amp;(i.ondragenter=function(n){n.currentTarget.style.backgroundColor="yellow";n.currentTarget.innerHTML="&lt;br/&gt;&lt;br/&gt;Drag and Drop the ad here"},i.ondragleave=function(n){n.currentTarget.style.backgroundColor="lightgray";u(n.currentTarget.dropzoneFor)},i.ondragover=function(n){n.stopPropagation();n.preventDefault();n.currentTarget.style.backgroundColor="yellow"},i.ondrop=function(n){n.currentTarget.style.backgroundColor="lightgreen";rt(n)});r?f?f.observe(i,{childList:!0}):i.addEventListener("DOMSubtreeModified",function(){a(i)}):i.addEventListener("paste",it,!1)}},h=function(n){n.reportAdDiv.style.display==="none"?(n.reportAdDiv.style.display="table",n.closeAdButton.style.display="none",n.adContainer.style.display="none",n.dropzone.focus()):(n.reportAdDiv.style.display="none",n.closeAdButton.style.display="block",n.adContainer.style.display="block")},e=function(n){var t=i(n),r=t.dropzone;r.style.backgroundColor="lightgreen";r.innerHTML=t.width===160&amp;&amp;t.height===600?"&lt;br/&gt; Your screenshot has been received – thanks! &lt;br/&gt;&lt;br/&gt; Next step: What’s wrong with the ad":t.width===300&amp;&amp;t.height===250?"&lt;br/&gt; Your screenshot has been received – thanks! &lt;br/&gt;&lt;br/&gt; Next step: What’s wrong with the ad":t.width===728&amp;&amp;t.height===90?"Your screenshot has been received – thanks! Next step: What’s wrong with the ad":"Ad info received. Press Report to submit"},o=function(n){var t=i(n);t&amp;&amp;(t.reportButton.disabled=!1)},u=function(n){var t=i(n);t&amp;&amp;(t.reportButton.disabled=!0)},c=function(n){h(n)},l=function(n){var r=n.reportAdDiv.getElementsByClassName("reportReason")[0],s=r&amp;&amp;r.options[r.selectedIndex].value||"Unspecified",u=n.reportAdDiv.getElementsByClassName("sendReportContainer")[0],f=n.reportAdDiv.getElementsByClassName("reportSentContainer")[0];u&amp;&amp;(u.style.display="none");f&amp;&amp;(f.style.display="block");try{var e=new XMLHttpRequest,i=new FormData,h=DMUserIdentityHelper&amp;&amp;DMUserIdentityHelper.getGlobalUserId()||0,o=null;n.fileList&amp;&amp;n.fileList.length&gt;0&amp;&amp;(o=n.fileList[0]);e.open("POST",t.DownvoteUrl,!0);i.append("adScreenshot",o);i.append("reason",s);i.append("DmGlobalUserId",h);e.send(i)}catch(c){console.log(c)}},it=function(n){var t,h,l,s,c,a,f,v;if(!r){if(n.preventDefault(),t=[],h=!1,window.clipboardData)t=window.clipboardData.files,h=!0;else if((n.clipboardData||n.originalEvent.clipboardData)&amp;&amp;(l=n.clipboardData||n.originalEvent.clipboardData,s=l&amp;&amp;l.items||[],t=[],s&amp;&amp;s.length&gt;0))for(h=!0,c=0;c&lt;s.length;c++)a=s[c],a.kind==="file"&amp;&amp;(t[t.length]=a.getAsFile());f=n.currentTarget.dropzoneFor;t&amp;&amp;t.length&gt;0?(v=i(f),v&amp;&amp;(v.fileList=t),o(f),e(f)):h?(n.currentTarget.innerHTML="&lt;br/&gt;&lt;br/&gt; No files found on clipboard &lt;br/&gt;",u(f)):(n.currentTarget.innerHTML="&lt;br/&gt;&lt;br/&gt; Paste not supported on your browser &lt;br/&gt;",u(f))}},rt=function(n){var f,r,t;if(n.stopPropagation(),n.preventDefault(),f=i(n.currentTarget.dropzoneFor),r=[],n.dataTransfer.files&amp;&amp;n.dataTransfer.files.length&gt;0)for(t=0;t&lt;n.dataTransfer.files.length;t++)n.dataTransfer.files[t].type&amp;&amp;n.dataTransfer.files[t].type.indexOf("image")&gt;=0&amp;&amp;(r[r.length]=n.dataTransfer.files[t]);r.length&gt;0?(f&amp;&amp;(f.fileList=r),e(n.currentTarget.dropzoneFor),o(n.currentTarget.dropzoneFor)):(n.currentTarget.style.backgroundColor="yellow",n.currentTarget.innerHTML="&lt;br/&gt;&lt;br/&gt;The dropped item was not an image",u(n.currentTarget.dropzoneFor))},a=function(n){for(var t,i=0;i&lt;n.children.length;i++)t=n.children[i],t.nodeName.toLowerCase()==="img"&amp;&amp;t.style.display!=="none"&amp;&amp;t.src&amp;&amp;(t.style.display="none",ut(t.src,n))},ut=function(n,t){if(n){var f=n.indexOf(","),r=n.substring(0,f),h=r.indexOf(":"),c=r.indexOf(";"),l=r.substring(h+1,c),a=n.substring(f+1),v=ot(a,l,512),u=t.dropzoneFor,s=i(u);s&amp;&amp;(s.fileList=[v]);e(u);o(u)}},ft=function(){var n=document.createElement("div");return"draggable"in n||"ondragstart"in n&amp;&amp;"ondrop"in n},et=function(){return navigator.userAgent.toLowerCase().indexOf("firefox")&gt;-1},i=function(t){for(var i=0,r=n.length;i&lt;r;i++)if(n[i]&amp;&amp;n[i].adContainer&amp;&amp;n[i].adContainer.id===t)return n[i];return null},ot=function(n,t,i){var e,o,r,f,s,u,h;for(t=t||"",i=i||512,e=atob(n),o=[],r=0;r&lt;e.length;r+=i){for(f=e.slice(r,r+i),s=new Array(f.length),u=0;u&lt;f.length;u++)s[u]=f.charCodeAt(u);h=new Uint8Array(s);o.push(h)}return new Blob(o,{type:t})};return{appendAd:function(t){n.push(t)},init:function(i,u){n=i;t=u;s=ft();r=et();r&amp;&amp;window.MutationObserver&amp;&amp;(f=new MutationObserver(function(n){n.forEach(function(n){a(n.target)})}))},showAdReportingInterface:function(n){var t=i(n);t&amp;&amp;y(t)},setGlobalUserId:function(n){v=n}}}(),DMUserIdentityHelper=function(){var r,t,u="dmaduid",f="dmaduid_confirm",e,o,i=[],n=0,l=function(){return SendDmAdUid?navigator.cookieEnabled!==void 0?navigator.cookieEnabled:(document.cookie="testcookie=test; max-age=10000",document.cookie.indexOf("testcookie=test")&gt;=0):!1},a=function(){var t=document.location.hostname,n=/([^.]+\.[^.]{3,})$/i.exec(t);return n?n[1]:(n=/([^.]+\.[^.]+\.[^.]{2})$/i.exec(t),n!==null?n[1]:t)},s=function(n,t,i,r,u,f){var e="",o;e=n+"="+t;i&gt;0&amp;&amp;(o=new Date,o.setTime(o.getTime()+i*864e5))&amp;&amp;(e+="; expires="+o.toGMTString());r&amp;&amp;(e+="; path="+r);u&amp;&amp;u.indexOf(".")!==-1&amp;&amp;(e+="; domain="+u);f&amp;&amp;(e+="; secure");document.cookie=e},h=function(n){var r=document.cookie,u=null,t,i;if(r!=="")for(t=r.split(";"),index=0;index&lt;t.length;index++)if(i=t[index].replace(/^\s+/,""),i.substring(0,n.length+1)===n+"="){u=i.substring(n.length+1);break}return u},v=function(n){var t=document.createElement("IFRAME");return t.width=1,t.height=1,t.src=e,t.id="DMGlobalUserIdetifierIFRAME",t.name="DMGlobalUserIdetifierIFRAME",t.style.display="none",document.body.appendChild(t),t.onload=n,t},y=function(){var i,l,n,a,e;if(r)if(i=h(u),l=h(f),!l&amp;&amp;JSON){if(n={},n.sender=location.href,n.Id=Math.random(),a=function(){o.contentWindow.postMessage(JSON.stringify(n),GlobalIdUrl)},e=function(i){var r=null,e;try{r=JSON.parse(i.data)}catch(o){}r&amp;&amp;r.Id&amp;&amp;r.Id===n.Id&amp;&amp;(e=r.DmGlobalUserId,s(u,e,365,"/",t,!1),s(f,r.DmGlobalUserConfirmResponse,365,"/",t,!1),c(e))},window.addEventListener)window.addEventListener("message",e,!1);else try{window.attachEvent("message",e)}catch(y){}o=v(a)}else i&amp;&amp;c(i)},c=function(t){for(n=t;i.length&gt;0;){var r=i.pop();typeof r=="function"&amp;&amp;r()}};return{init:function(n){e=n;r=l();t=a();y()},getGlobalUserId:function(t){return n!==0?n:t?(i.push(t),n):void 0}}}(),DMAds={PageQueryTerms:"",PageTags:null,Tile:1,CurrentDocument:null,PublisherCode:"",PublisherPageViewID:0,PublisherPageViewGuid:null,CreateAdsCalled:!1,GetTermsCalled:!1,Ads:[],GPTRenderingMode:"loading",PIIViolatingUrls:["http://www.aspsnippets.com/handlers/comments.ashx","codeproject.com/script/membership/sendpassword.aspx","http://www.dailyfreecode.com/userlogin.aspx","codeproject.com/script/membership/modify.aspx","dotnetspider.com/account/login.aspx","codeproject.com/script/membership/logon.aspx"],SetQueryTerms:function(){function u(n){for(var i,u="",t=0;t&lt;r.length;t++)if(i=r[t],n.indexOf(i.d)&gt;=0){u=i.q;break}return u}function f(n,t){var r=t.toLowerCase().indexOf(n),u,i;return r&lt;0||r+n.length&gt;=t.length?"":(u=t.indexOf("&amp;",r),u&lt;0&amp;&amp;(u=t.length),i=t.substring(r+n.length,u),i=i.replace(/\+/gi," "),i=decodeURIComponent(i),i.replace(/\"/gi,""))}function e(n){if(n===undefined)return"";var t=n.replace(/^\s+|\s+$/gi,"");return t?(t=t.replace(/\bAND\b|\bNOT\b|^NOT\b|\bOR\b|[^A-Z0-9\+\-\#\._\s]+|\b[A-Z0-9]+:/gi," "),t.replace(/\s+/g," ")):""}var r=[{d:"www.google.",q:"q="},{d:"www.bing.com",q:"q="},{d:"search.live.com",q:"q="},{d:"search.yahoo.com",q:"p="},{d:"codeproject.com",q:"q="},{d:"msdn.microsoft.com",q:"query="},{d:"www.ask.com",q:"q="},{d:"yandex.com",q:"text="},{d:"yandex.ru",q:"text="},{d:"www.baidu.com",q:"wd="},{d:"localhost",q:"q="},{d:"mkyong.com",q:"q="},{d:"codeplex.com",q:"query="},{d:"aspsnippets.com",q:"q="},{d:"trirand.com",q:"s="}],i="",n=document.URL,t=u(n);if(t!==""&amp;&amp;(i=e(f(t,n))),i===""){if(n=document.referrer.toLocaleLowerCase(),!n)return"";t=u(n);t!==""&amp;&amp;(i=e(f(t,n)))}DMAds.PageQueryTerms=i},SetPageTagsAndPixels:function(n){var t,i,r,u;if(JSON){if(DMAds.GetTermsCalled){n&amp;&amp;n();return}DMAds.GetTermsCalled=!0;t=document.URL;t.indexOf("?")&gt;0&amp;&amp;(t=t.substring(0,t.indexOf("?")));try{i=top.document.title}catch(f){i="FAILED TO GET DOCUMENT TITLE"}r={terms:DMAds.PageQueryTerms,title:i,url:t,publisher:DMAds.PublisherCode,DmGlobalUserId:DMUserIdentityHelper&amp;&amp;DMUserIdentityHelper.getGlobalUserId()||0,numberOfAdsOnPage:DMAds.Ads.length};u=function(t){if(t){var i;try{i=JSON.parse(t)}catch(r){}i&amp;&amp;(i.SearchTerms&amp;&amp;(DMAds.PageTags=i.SearchTerms),i.PublisherPageViewGuid&amp;&amp;(DMAds.PublisherPageViewGuid=i.PublisherPageViewGuid),i.aid&amp;&amp;i.aid.length&amp;&amp;i.aid.length&gt;0&amp;&amp;DMAds.InsertAudiencePixels(i.aid))}DMAds.PublisherPageViewGuid||(DMAds.PublisherPageViewGuid=1);n&amp;&amp;n()};DMAds.POSTJson(SearchTermUrl,r,u,!0,500)}},InsertAudiencePixels:function(n){var t,i;try{for(t=0,i=n.length;t&lt;i;t++){var r=Math.random()+"",u=r*1e13,f=new Image;f.src="https://pubads.g.doubleclick.net/activity;dc_iu=/6839/DFPAudiencePixel;ord="+u+";dc_seg="+n[t]+"?"}}catch(e){}},GetRandom:function(n,t){for(var u,i="",r=0;r&lt;n;r++)u=Math.floor(Math.random()*t).toString(t).toUpperCase(),i=i+u;return i},POSTJson:function(n,t,i,r,u){var f;if(JSON&amp;&amp;(f=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP"),f)){var s=!1,o=function(n){s||(s=!0,i&amp;&amp;i(n))},e=null;r&amp;&amp;(e=setTimeout(function(){try{f.abort()}catch(n){}o(null)},u));f.onreadystatechange=function(){try{f.readyState===4&amp;&amp;(e&amp;&amp;clearTimeout(e),f.status===200?o(f.responseText):o(null))}catch(n){e&amp;&amp;clearTimeout(e);o(null)}};try{f.open("POST",n,!0);f.setRequestHeader("Content-Type","application/json");f.send(JSON.stringify(t))}catch(h){e&amp;&amp;clearTimeout(e);o(null)}}},SignalSuccess:function(n){window.top&amp;&amp;window.top.postMessage&amp;&amp;setTimeout(function(){window.top.postMessage(n?"DM-enabled":"DM-disabled","*")},1e3)},CreateAds:function(n){this.PageRandomNumber=DMAds.GetRandom(32,16);var e=function(n){var t=DMAds.Ads[n];t.rendered=!0;DMAds.GPTRenderingMode==="weLoadedGPT"?DMAds.BuildGPTTag(t):DMAds.BuildInlineGPTTag(t)},l=function(n){var e=DMAds.Ads[n],h=e.theAdDiv,u=!1,i=0,r=0,t,f,o,s;try{t=h.getBoundingClientRect();typeof innerWidth=="number"?(i=window.innerWidth,r=window.innerHeight):document.documentElement&amp;&amp;(document.documentElement.clientWidth||document.documentElement.clientHeight)?(i=document.documentElement.clientWidth,r=document.documentElement.clientHeight):document.body&amp;&amp;(document.body.clientWidth||document.body.clientHeight)&amp;&amp;(i=document.body.clientWidth,r=document.body.clientHeight);f=-200;t.top===t.bottom&amp;&amp;(f+=e.height*-1);o=t.top&gt;=0&amp;&amp;t.top-200&lt;=r||t.top&lt;=0&amp;&amp;t.top&gt;=f;s=i&gt;t.left&amp;&amp;t.right&gt;=0;u=o&amp;&amp;s}catch(c){u=!0}return u},t=function(){for(var t,i=0,n=0;n&lt;DMAds.Ads.length;n++)t=DMAds.Ads[n],!t.rendered&amp;&amp;l(n)&amp;&amp;u(n)&amp;&amp;e(n),t.rendered&amp;&amp;(i++,t.sticky&amp;&amp;!t.stickySettings&amp;&amp;(t.stickySettings=s(t)),c(n));i===DMAds.Ads.length&amp;&amp;clearInterval(f)},o=function(){var n=function(){for(var c,i,r,o,s=EnableViewOnScroll,n=0;n&lt;DMAds.Ads.length;n++)c=DMAds.Ads[n],c.rendered=!1,i=c.displayOverride,i==="onscroll"||i==="true"?s=!0:(i==="always"||i==="false")&amp;&amp;(s=!1),!s&amp;&amp;u(n)&amp;&amp;e(n);if(t(),window.addEventListener)window.addEventListener("resize",function(){t();h()},!1),window.addEventListener("scroll",t,!1);else try{window.attachEvent("onresize",function(){t();h()});window.attachEvent("onscroll",t)}catch(l){}for(a(),r=!1,o=0;o&lt;DMAds.Ads.length&amp;&amp;!r;o++)if(r=!u(o),r)break;r&amp;&amp;(f=setInterval(t,100))};DMAds.GPTRenderingMode==="loading"?googletag.cmd.push(function(){n()}):n()},a=function(){var n=null;typeof document.hidden!="undefined"?n="visibilitychange":typeof document.mozHidden!="undefined"?n="mozvisibilitychange":typeof document.msHidden!="undefined"?n="msvisibilitychange":typeof document.webkitHidden!="undefined"&amp;&amp;(n="webkitvisibilitychange");n&amp;&amp;document.addEventListener&amp;&amp;document.addEventListener(n,t,!1)},s=function(n){var u=null,i,t;return n.adContainer&amp;&amp;(i=r(n.adContainer),t={},t.isStickyRequired=n.sticky&amp;&amp;n.sticky==="top",t.absoluteTop=i.y,t.absoluteLeft=i.x,t.absoluteTop!==-1&amp;&amp;(t.originalPosition=n.theAdDiv.style.position,u=t)),u},h=function(){for(i=0;i&lt;DMAds.Ads.length;i++){var n=DMAds.Ads[i];n.stickySettings&amp;&amp;n.adContainer&amp;&amp;(n.adContainer.style.position=n.stickySettings.originalPosition,n.stickySettings=s(n),c(i))}},c=function(n){var t=DMAds.Ads[n].adContainer,i=DMAds.Ads[n].stickySettings,f=DMAds.Ads[n].theAdDiv,u,h,s;if(i&amp;&amp;i.isStickyRequired&amp;&amp;t.getBoundingClientRect&amp;&amp;document.getElementsByClassName){u=document.getElementsByClassName("sticky-stop")[0];u&amp;&amp;(h=r(u),s=u.getBoundingClientRect());var c=r(t),e=t.getBoundingClientRect(),o,l=c.y+e.height+Math.abs(e.top)&gt;h.y;u&amp;&amp;l&amp;&amp;s.top&lt;e.height?o=s.top-e.height+"px":window.pageYOffset+10&gt;=i.absoluteTop&amp;&amp;(o="10px");o?(t.style.position="fixed",t.style.top=o,t.style.left=i.absoluteLeft-window.pageXOffset+"px",f.clientHeight===0&amp;&amp;(f.style.height=t.clientHeight+"px"),f.clientWidth===0&amp;&amp;(f.style.width=t.clientWidth+"px")):t.style.position=i.originalPosition}},r=function(n){var t={};if(t.x=-1,t.y=-1,n.getBoundingClientRect){var r=n.getBoundingClientRect(),i=document.documentElement,u=window.pageYOffset||i.scrollTop||document.body.scrollTop||0,f=window.pageXOffset||i.scrollLeft||document.body.scrollLeft||0,e=i.clientTop||document.body.clientTop||0,o=i.clientLeft||document.body.clientLeft||0;t.y=r.top+u-e;t.x=r.left+f-o}return t},u=function(n){var t=DMAds.Ads[n].theAdDiv,i=!1,r;return t&amp;&amp;t.style.position!=="fixed"&amp;&amp;t.offsetParent?i=!0:t&amp;&amp;t.style.position==="fixed"&amp;&amp;(r=window.getComputedStyle(t),i=r&amp;&amp;r.display!=="none"),i&amp;&amp;v()},v=function(){var t=!0,n="";return typeof document.hidden!="undefined"?n="hidden":typeof document.mozHidden!="undefined"?n="mozHidden":typeof document.msHidden!="undefined"?n="msHidden":typeof document.webkitHidden!="undefined"&amp;&amp;(n="webkitHidden"),n!==null&amp;&amp;document[n]&amp;&amp;(t=!1),t},f=f||null;n||DMAds.CreateAdsCalled?n&amp;&amp;(DMAds.Ads[DMAds.Ads.length]=DMAds.GetDivRequestData(n,DMAds.Ads.length-1),DMAds.PublisherCode=DMAds.Ads[0].publisher,DMAds.SetPageTagsAndPixels(o)):(DMAds.CreateAdsCalled=!0,DMAds.SetAdRequestData(),DMAds.Ads.length&gt;0&amp;&amp;(DMAds.PublisherCode=DMAds.Ads[0].publisher,DMAds.SetPageTagsAndPixels(o)))},ShowAd:function(n){var t=DMAds.Ads,i;if(n&amp;&amp;(DMAds.GPTRenderingMode!=="weLoadedGPT"||!DMAds.PublisherPageViewGuid))t.push(n),DMAds.GetTermsCalled||(DMAds.PublisherCode=n.sitename,DMAds.SetPageTagsAndPixels(DMAds.ShowAd));else if(DMAds.GPTRenderingMode==="weLoadedGPT"&amp;&amp;DMAds.PublisherPageViewGuid){while(t&amp;&amp;t.length&gt;0)i=t.pop(),DMAds.RequestQueuedAd(i);n&amp;&amp;DMAds.RequestQueuedAd(n)}},InitGPTLibrary:function(){if(googletag){var n=function(){if(googletag.pubadsReady)DMAds.GPTRenderingMode!=="weLoadedGPT"&amp;&amp;(DMAds.GPTRenderingMode="gptAlreadyLoaded");else{if(googletag.pubads().enableSingleRequest(),googletag.pubads().disableInitialLoad(),DMAds.Ads&amp;&amp;DMAds.Ads[0]&amp;&amp;typeof DMAds.Ads[0].cookieConsent!="undefined"){var n=DMAds.Ads[0].cookieConsent?1:0;googletag.pubads().setRequestNonPersonalizedAds(n?0:1)}googletag.pubads().enableAsyncRendering();googletag.enableServices();DMAds.GPTRenderingMode="weLoadedGPT";googletag.pubads().addEventListener("slotRenderEnded",function(n){DMAds.OnSlotRendered(n)})}};googletag.apiReady?n():googletag.cmd.push(function(){n()})}},BuildIFrameTag:function(n){var t=document.createElement("IFRAME"),i;return t.allowtransparency=!1,t.id="dm-gpt-iframe-"+n.tile,t.width=n.width,t.height=n.height,t.marginWidth=0,t.marginHeight=0,t.frameBorder=0,t.scrolling="no",i=encodeURIComponent(location.href),i.length&lt;2048&amp;&amp;(t.dc_ref=i),t},BuildInlineGPTTagScript:function(n){var t="div-gpt-ad-"+n.publisher+"-"+n.zone+"-"+n.tile,i="/6839/"+n.publisher+"/"+n.zone,r="["+n.width+", "+n.height+"]",u=(n.tags||"")+","+(DMAds.PageSearchTerms||"")+","+(DMAds.PageQueryTerms||""),f=n.cookieConsent!==undefined,e=n.cookieConsent?1:0,o="&lt;div id='"+t+"'&gt;     &lt;script type='text/javascript'&gt;         googletag.cmd.push(function() {             if ( "+f+" &amp;&amp; typeof googletag.pubads == 'function') {               googletag.pubads().setRequestNonPersonalizedAds("+e+" ? 0 : 1);            }            googletag.defineSlot('"+i+"', "+r+",'"+t+"')                 .addService(googletag.pubads())                 .setTargeting('kw', '"+u+"');             googletag.enableServices();             googletag.display('"+t+"');         });     &lt;\/script&gt; &lt;\/div&gt;";return"&lt;script type='text/javascript'&gt; var googletag = googletag || {}; googletag.cmd = googletag.cmd || []; (function() {     var gads = document.createElement('script');     gads.async = true;     gads.type = 'text/javascript';     var useSSL = 'https:' == document.location.protocol;     gads.src = (useSSL ? 'https:' : 'http:') + '//www.googletagservices.com/tag/js/gpt.js';     var node =document.getElementsByTagName('script')[0];     node.parentNode.insertBefore(gads, node); })(); &lt;\/script&gt;"+o},BuildGPTTag:function(n){var t=document.createElement("DIV"),i;t.style.height=n.height+"px";t.style.width=n.width+"px";t.style.boxSizing="border-box";t.style.border="0px";t.style.fontSize="0px";i="div-gpt-ad-"+n.publisher+"/"+n.zone+"-"+n.tile;t.id=i;t.adIndex=n.index;n.theAdDiv.appendChild(t);n.adContainer=t;googletag.cmd.push(function(){var u="/6839/"+n.publisher+"/"+n.zone,r=(n.tags||"")+","+(DMAds.PageSearchTerms||"")+","+(DMAds.PageQueryTerms||""),t;r=DMAds.EscapeSpecialCharacters({tags:r});t=googletag.defineSlot(u,[n.width,n.height],i).setTargeting("kw",r);n.articleid&amp;&amp;n.articleid&gt;0&amp;&amp;t.setTargeting("articleid",n.articleid);t.addService(googletag.pubads());n.collapse_empty&amp;&amp;t.setCollapseEmptyDiv(!0,!0);googletag.display(i);googletag.pubads().refresh([t],{changeCorrelator:!1})})},RequestQueuedAd:function(n){googletag.cmd.push(function(){var r="/6839/"+n.sitename+"/"+n.zonename,i=(n.tags||"")+","+(DMAds.PageSearchTerms||""),t;i=DMAds.EscapeSpecialCharacters({tags:i});t=googletag.defineSlot(r,[n.width,n.height],n.targetDivId).setTargeting("kw",i);n.articleid&amp;&amp;n.articleid&gt;0&amp;&amp;t.setTargeting("articleid",n.articleid);t.addService(googletag.pubads());n.collapse_empty&amp;&amp;t.setCollapseEmptyDiv(!0,!0);googletag.display(n.targetDivId);googletag.pubads().refresh([t],{changeCorrelator:!1})})},BuildInlineGPTTag:function(n){var t=DMAds.BuildIFrameTag(n),i;n.theAdDiv.appendChild(t);i=t.contentDocument||t.contentWindow.document||t.contentWindow.window.document;i.write(DMAds.BuildInlineGPTTagScript(n))},EscapeSpecialCharacters:function(n){var t=n.tags,i;t=t.replace(/\+/gi,"{plus}");t=t.replace(/\#/gi,"{sharp}");t=t.replace(/\./gi,"{dot}");t=t.replace(/[\#\*\.\(\)\+\&lt;\&gt;\[\]]/gi,"");for(var r=t.split(","),u=[];r.length&gt;0;)i=r.shift(),/[^\u0020-\u007f]/.test(i)||u.push(i);return u.join(",")},GetArticleId:function(n){var t=0,i,r;if(n&amp;&amp;n===CodeProjectPublisherId)try{i="Articles";r=window.location.href.indexOf(i);r&gt;=0&amp;&amp;(t=window.location.href.substring(r+i.length+1),t=t.substring(0,t.indexOf("/")),t=parseInt(t),isNaN(t)&amp;&amp;(t=0))}catch(u){t=0}return t},IsPagePIICompliant:function(){var t=!0,i,n,r;try{for(i=window.location.href.toLowerCase(),n=0,r=DMAds.PIIViolatingUrls.length;n&lt;r&amp;&amp;t;n++)t=!(i.indexOf(DMAds.PIIViolatingUrls[n])&gt;=0)}catch(u){console.log("Error in IsPagePIICompliant: "+u)}return t},OnSlotRendered:function(n){if(window.location.href&amp;&amp;window.location.href.includes("show_creative_id=1")&amp;&amp;n&amp;&amp;n.creativeId&amp;&amp;console.log(n.creativeId),EnableMutableAds&amp;&amp;n&amp;&amp;!n.isEmpty&amp;&amp;(!n.lineItemId||n.lineItemId&amp;&amp;n.lineItemId===0))DMAdXHelper.showAdReportingInterface(n.slot.getSlotElementId());else if(n&amp;&amp;n.isEmpty){var t=document.getElementById(n.slot.getSlotElementId());t.style.width="0px";t.style.height="0px";t.style.display="none"}DMAds.SignalSuccess(!0)},DetermineTagSize:function(n){if(n.format){var t=n.format.split("x");t.length===2&amp;&amp;(n.width=parseInt(t[0]),n.height=parseInt(t[1]))}},GetElementsByAttr:function(n,t,i,r){var o=[],u,e;i||(i=document);r||(r="*");var f=i.getElementsByTagName(r),s=f.length,h=new RegExp("(^|\\s)"+t+"(\\s|$)");for(u=0,e=0;u&lt;s;u++)h.test(f[u].getAttribute(n))&amp;&amp;(o[e]=f[u],e++);return o},GetElementsByClass:function(n,t,i){var e=[],r,f;t||(t=document);i||(i="*");var u=t.getElementsByTagName(i),o=u.length,s=new RegExp("(^|\\s)"+n+"(\\s|$)");for(r=0,f=0;r&lt;o;r++)s.test(u[r].className)&amp;&amp;(e[f]=u[r],f++);return e},SetAdRequestData:function(){var n=DMAds.GetElementsByAttr("data-type","ad",document,"div"),t;for((n===null||n.length&lt;=0)&amp;&amp;(n=DMAds.GetElementsByClass("lqm_ad",document,"div")),t=0;t&lt;n.length;t++)DMAds.Ads[DMAds.Ads.length]=DMAds.GetDivRequestData(n[t],t)},GetDivRequestData:function(n,t){for(var u,f,r,o=n.attributes,s=o.length,i={},e=0;e&lt;s;e++)u=o.item(e),u.nodeName.indexOf("lqm_")===0&amp;&amp;(f=u.nodeName.slice(4),i[f]=u.value||u.nodeValue),u.nodeName.indexOf("data-")===0&amp;&amp;(f=u.nodeName.slice(5),i[f]=u.value||u.nodeValue);return r={height:0,width:0,publisher:i.publisher,zone:i.zone||"ros",site:i.site,tags:i.tags,sitename:undefined,zonename:undefined,target:"_blank",format:i.format,index:t,tile:t+1,type:i.type,noadx:i.noadx,collapse_empty:i.collapse_empty,displayOverride:i.display||i.loadOnView,sticky:i.sticky,charity:i.charity,cookieConsent:i.cookieconsent,theAdDiv:n},r.tags&amp;&amp;(r.tags=decodeURIComponent(r.tags)),DMAds.DetermineTagSize(r),r.publisher&amp;&amp;r.publisher===CodeProjectPublisherId&amp;&amp;(r.articleid=DMAds.GetArticleId(r.publisher)),r},SetupAds:function(){DMAds.IsPagePIICompliant()&amp;&amp;(DMAds.InitGPTLibrary(),DMAds.SetQueryTerms(),DMAdXHelper.init(DMAds.Ads,{DownvoteUrl:DownvoteUrl,UndoDownvoteUrl:UndoDownvoteUrl,ReportAdUrl:ReportAdUrl,CloseAdImageUrl:CloseAdImageUrl,UndoCloseAdImageUrl:UndoCloseAdImageUrl,DmLogoImageUrl:DmLogoImageUrl}),DMUserIdentityHelper.init(GlobalIdUrl),DMAds.CreateAds())},Initialise:function(){if(DMAds.IsPagePIICompliant())if(window.googletag)DMAds.SetupAds();else{var t="https:"===document.location.protocol,n=document.createElement("script");n.async=!0;n.type="text/javascript";n.src=(t?"https:":"http:")+"//www.googletagservices.com/tag/js/gpt.js";n.onload=this.SetupAds;document.body.appendChild(n)}}};window.DMAds=DMAds}if(DMAds.IsPagePIICompliant())if(window.addEventListener)window.addEventListener("load",function(){DMAds.Initialise()},!1);else try{window.attachEvent("onload",function(){DMAds.Initialise()})}catch(e){DMAds.Initialise()}</script><script async="" type="text/javascript" src="https://www.googletagservices.com/tag/js/gpt.js"></script><script async="" type="text/javascript" src="https://www.googletagservices.com/tag/js/gpt.js"></script><canvas id="cv1" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><canvas id="cv2" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><iframe id="google_osd_static_frame_2811892806200" name="google_osd_static_frame" style="display: none; width: 0px; height: 0px;"></iframe></body></html>