<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" class="hasSidebar hasPageActions hasBreadcrumb conceptual has-default-focus js-focus-visible theme-light" lang="en-us" dir="ltr" data-css-variable-support="true" data-authenticated="false" data-auth-status-determined="true" data-target="docs" x-ms-format-detection="none" data-js-focus-visible=""><head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta property="og:title" content="DllMain entry point (Process.h) - Win32 apps" />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://docs.microsoft.com/en-us/windows/win32/dlls/dllmain" />

	<meta name="twitter:card" content="summary" />
	<meta name="twitter:site" content="@docsmsft" />


	<meta name="APILocation" content="process.h" />
<meta name="APIName" content="DllMain" />
<meta name="APIType" content="UserDefined" />
<meta name="author" content="mcleanbyron" />
<meta name="breadcrumb_path" content="/windows/desktop/breadcrumb/toc.json" />
<meta name="depot_name" content="MSDN.win32" />
<meta name="Description" content="An optional entry point into a dynamic-link library (DLL). When the system starts or terminates a process or thread, it calls the entry-point function for each loaded DLL using the first thread of the process." />
<meta name="document_id" content="21b45fcb-9adc-4f5d-a0c8-1a3a170cb7bf" />
<meta name="document_version_independent_id" content="8e365be3-0845-9499-02a8-017148c95100" />
<meta name="gitcommit" content="https://github.com/MicrosoftDocs/win32-pr/blob/2ec0df659644a793ed4f6160f238a95c9d9a9dcf/desktop-src/Dlls/dllmain.md" />
<meta name="locale" content="en-us" />
<meta name="ms.assetid" content="0c3e3083-9297-4626-b2a7-0062d1c2cf9e" />
<meta name="ms.author" content="mcleans" />
<meta name="ms.date" content="07/22/2020" />
<meta name="ms.prod" content="desktop" />
<meta name="ms.technology" content="system-services" />
<meta name="ms.topic" content="reference" />
<meta name="original_content_git_url" content="https://github.com/MicrosoftDocs/win32-pr/blob/live/desktop-src/Dlls/dllmain.md" />
<meta name="search.ms_docsetname" content="win32" />
<meta name="search.ms_product" content="MSDN" />
<meta name="search.ms_sitename" content="Docs" />
<meta name="site_name" content="Docs" />
<meta name="TopicType" content="APIRef" />
<meta name="TopicType" content="kbSyntax" />
<meta name="uhfHeaderId" content="MSDocsHeader-WinDevCenter" />
<meta name="updated_at" content="2020-12-11 11:32 PM" />
<meta name="page_type" content="conceptual" />
<meta name="toc_rel" content="toc.json" />
<meta name="pdf_url_template" content="https://docs.microsoft.com/pdfstore/en-us/MSDN.win32/{branchName}{pdfName}" />
<meta name="word_count" content="1627" />


	<meta name="scope" content="Windows, Desktop" />
<link href="https://docs.microsoft.com/en-us/windows/win32/dlls/dllmain" rel="canonical" />
	<title>DllMain entry point (Process.h) - Win32 apps | Microsoft Docs</title>

		<link rel="stylesheet" href="/_themes/docs.theme/master/zh-cn/_themes/styles/a4fd15e4.site-ltr.css " />

	<link rel="stylesheet" href="/_themes/docs.theme/master/zh-cn/_themes/styles/55917fe3.conceptual.css " />


	<script async="" src="https://lux.speedcurve.com/lux/?v=210&amp;id=409849828&amp;sid=160827958806987386&amp;uid=160827946639701915&amp;l=DllMain%20entry%20point%20(Process.h)%20-%20Win32%20apps%20%7C%20Microsoft%20Docs&amp;NT=1608279586860fs0ds2de2cs2sc67ce214qs215bs764be765ol768oi886os886oe1116oc1531ls1531le1531sr1156fc1156lc1156&amp;LJS=d0t0f2c1n3e1r30x6924l1115s1209&amp;PS=ns14bs9is1288ss2bc2ic50ia5it7dd11nd1039vh889vw912dh6888dw912ds16004ct4G_er0nt0dm8&amp;CPU=s|276,n|1,d|276,x|276,i|1156,842|276&amp;HN=docs.microsoft.com&amp;CLS=0.000000&amp;UT=LUX_end|1734"></script><script async="" defer="" crossorigin="anonymous" src="https://cdn.speedcurve.com/js/lux.js?id=409849828"></script><script async="" src="https://www.google-analytics.com/analytics.js"></script><script id="msdocs-script">
	var msDocs = {
		data: {
			timeOrigin: Date.now(),
			contentLocale: 'en-us',
			contentDir: 'ltr',
			userLocale: 'zh-cn',
			userDir: 'ltr',
			pageTemplate: 'Conceptual',
			brand: '',
			context: {

			},
			hasBinaryRating: true,
			hasGithubIssues: false,
			showFeedbackReport: false,
			enableTutorialFeedback: false,
			feedbackSystem: 'None',
			feedbackGitHubRepo: '',
			feedbackProductUrl: '',
			contentGitUrl: 'https://github.com/MicrosoftDocs/win32/blob/docs/desktop-src/Dlls/dllmain.md',
			extendBreadcrumb: false,
			isEditDisplayable: true,
			hideViewSource: false,
			hasPageActions: true,
			hasBookmark: true,
			hasShare: true,
			hasRecommendations: false,
			contributors: [
						{ name: "mcleanbyron", url: "https://github.com/mcleanbyron" },
						{ name: "drewbatgit", url: "https://github.com/drewbatgit" },
						{ name: "DCtheGeek", url: "https://github.com/DCtheGeek" },
						{ name: "GrantMeStrength", url: "https://github.com/GrantMeStrength" },
						{ name: "AlexGuteniev", url: "https://github.com/AlexGuteniev" },
						{ name: "jasonepperly", url: "https://github.com/jasonepperly" },
						{ name: "mijacobs", url: "https://github.com/mijacobs" },
						{ name: "msatranjr", url: "https://github.com/msatranjr" }
],
		},
		functions:{}
	};
	</script>
	<script src="https://wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js"></script>
	<script src="https://az725175.vo.msecnd.net/scripts/jsll-4.js"></script>
	<script nomodule="" src="/static/third-party/bluebird/3.5.0/bluebird.min.js" integrity="sha384-aD4BDeDGeLXLpPK4yKeqtZQa9dv4a/7mQ+4L5vwshIYH1Mc2BrXvHd32iHzYCQy5" crossorigin="anonymous"></script>
	<script nomodule="" src="/static/third-party/fetch/3.0.0/fetch.umd.min.js" integrity="sha384-EQIXrC5K2+7X8nGgLkB995I0/6jfAvvyG1ieZ+WYGxgJHFMD/alsG9fSDWvzb5Y1" crossorigin="anonymous"></script>
	<script nomodule="" src="/static/third-party/template/1.4.0/template.min.js" integrity="sha384-1zKzI6ldTVHMU7n0W2HpE/lhHI+UG4D9IIaxbj3kT2UhCWicdTuJkTtnKuu0CQzN" crossorigin="anonymous"></script>
	<script nomodule="" src="/static/third-party/url/0.5.7/url.min.js" integrity="sha384-vn7xBMtpSTfzaTRWxj0kVq0UcsbBrTOgZ/M1ISHqe1V358elYva+lfiEC+T8jLPc" crossorigin="anonymous"></script>
	<script src="/_themes/docs.theme/master/zh-cn/_themes/scripts/f0a172e9.index-polyfills.js"></script>
		<script src="/static/third-party/qrious/4.0.2-r1/qrious.min.js" integrity="sha384-h/SmU/qxwYnRlzklg9PKWpDwyma9UmKuOB//Pz6Cov5KkEqcaFF0vod43/XhoeyJ" crossorigin="anonymous"></script>
		<script src="/_themes/docs.theme/master/zh-cn/_themes/scripts/d52ecfc6.index-docs.js"></script><style></style>
<script async="" src="https://web.vortex.data.microsoft.com/collect/v1/t.js?ver='2.1'&amp;name='Ms.Webi.PageView'&amp;time='2020-12-18T08%3A19%3A47.972Z'&amp;os='Windows'&amp;appId='JS%3ADocs'&amp;-ver='1.0'&amp;-impressionGuid='54f58a26-0e7b-4206-93ac-fc0ec0567dca'&amp;-pageName='21b45fcb-9adc-4f5d-a0c8-1a3a170cb7bf'&amp;-uri='https%3A%2F%2Fdocs.microsoft.com%2Fzh-cn%2Fwindows%2Fwin32%2Fdlls%2Fdllmain%3Fredirectedfrom%3DMSDN'&amp;-market='zh-cn'&amp;-pageType='conceptual'&amp;-resHeight=1080&amp;-resWidth=1920&amp;-pageTags='%7B%22author%22%3A%22mcleanbyron%22%2C%22depotname%22%3A%22MSDN.win32%22%2C%22document_version_independent_id%22%3A%228e365be3-0845-9499-02a8-017148c95100%22%2C%22gitcommit%22%3A%22https%3A%2F%2Fgithub.com%2FMicrosoftDocs%2Fwin32-pr%2Fblob%2F2ec0df659644a793ed4f6160f238a95c9d9a9dcf%2Fdesktop-src%2FDlls%2Fdllmain.md%22%2C%22asst%22%3A%220c3e3083-9297-4626-b2a7-0062d1c2cf9e%22%2C%22pgauth%22%3A%22mcleans%22%2C%22date%22%3A%2207%2F22%2F2020%22%2C%22product%22%3A%22desktop%22%2C%22technology%22%3A%22system-services%22%2C%22pgtop%22%3A%22reference%22%2C%22giturl%22%3A%22https%3A%2F%2Fgithub.com%2FMicrosoftDocs%2Fwin32-pr%2Fblob%2Flive%2Fdesktop-src%2FDlls%2Fdllmain.md%22%2C%22publishtime%22%3A%222020-12-11%2011%3A32%20PM%22%2C%22contentlocale%22%3A%22en-us%22%2C%22highContrast%22%3A%22false%22%2C%22metaTags%22%3A%7B%7D%7D'&amp;-behavior=0&amp;*baseType='Ms.Content.PageView'&amp;*cookieEnabled=true&amp;*isJs=true&amp;*title='DllMain%20entry%20point%20(Process.h)%20-%20Win32%20apps%20%7C%20Microsoft%20Docs'&amp;*isLoggedIn=false&amp;*flashInstalled=false&amp;ext-javascript-ver='1.1'&amp;ext-javascript-libVer='4.3.4'&amp;ext-javascript-domain='docs.microsoft.com'&amp;ext-javascript-msfpc='GUID%3D6709bb7d43e74468a0cfe573e1dcfdf3%26HASH%3D6709%26LV%3D202012%26V%3D4%26LU%3D1608272102390'&amp;ext-javascript-userConsent=true&amp;$mscomCookies=false"></script><script async="" src="https://web.vortex.data.microsoft.com/collect/v1/t.js?ver='2.1'&amp;name='Ms.Webi.ContentUpdate'&amp;time='2020-12-18T08%3A19%3A48.493Z'&amp;os='Windows'&amp;appId='JS%3ADocs'&amp;-ver='1.0'&amp;-impressionGuid='54f58a26-0e7b-4206-93ac-fc0ec0567dca'&amp;-pageName='21b45fcb-9adc-4f5d-a0c8-1a3a170cb7bf'&amp;-uri='https%3A%2F%2Fdocs.microsoft.com%2Fzh-cn%2Fwindows%2Fwin32%2Fdlls%2Fdllmain%3Fredirectedfrom%3DMSDN'&amp;-market='zh-cn'&amp;-pageTags='%7B%22author%22%3A%22mcleanbyron%22%2C%22depotname%22%3A%22MSDN.win32%22%2C%22document_version_independent_id%22%3A%228e365be3-0845-9499-02a8-017148c95100%22%2C%22gitcommit%22%3A%22https%3A%2F%2Fgithub.com%2FMicrosoftDocs%2Fwin32-pr%2Fblob%2F2ec0df659644a793ed4f6160f238a95c9d9a9dcf%2Fdesktop-src%2FDlls%2Fdllmain.md%22%2C%22asst%22%3A%220c3e3083-9297-4626-b2a7-0062d1c2cf9e%22%2C%22pgauth%22%3A%22mcleans%22%2C%22date%22%3A%2207%2F22%2F2020%22%2C%22product%22%3A%22desktop%22%2C%22technology%22%3A%22system-services%22%2C%22pgtop%22%3A%22reference%22%2C%22giturl%22%3A%22https%3A%2F%2Fgithub.com%2FMicrosoftDocs%2Fwin32-pr%2Fblob%2Flive%2Fdesktop-src%2FDlls%2Fdllmain.md%22%2C%22publishtime%22%3A%222020-12-11%2011%3A32%20PM%22%2C%22contentlocale%22%3A%22en-us%22%2C%22highContrast%22%3A%22false%22%2C%22metaTags%22%3A%7B%7D%2C%22timing%22%3A%22%7B%5C%22first-paint%5C%22%3A1156.315000000177%2C%5C%22first-contentful-paint%5C%22%3A1156.315000000177%2C%5C%22navigationStart%5C%22%3A1608279586860%2C%5C%22unloadEventStart%5C%22%3A0%2C%5C%22unloadEventEnd%5C%22%3A0%2C%5C%22redirectStart%5C%22%3A0%2C%5C%22redirectEnd%5C%22%3A0%2C%5C%22fetchStart%5C%22%3A1608279586860%2C%5C%22domainLookupStart%5C%22%3A1608279586862%2C%5C%22domainLookupEnd%5C%22%3A1608279586862%2C%5C%22connectStart%5C%22%3A1608279586862%2C%5C%22connectEnd%5C%22%3A1608279587074%2C%5C%22secureConnectionStart%5C%22%3A1608279586927%2C%5C%22requestStart%5C%22%3A1608279587075%2C%5C%22responseStart%5C%22%3A1608279587624%2C%5C%22responseEnd%5C%22%3A1608279587625%2C%5C%22domLoading%5C%22%3A1608279587628%2C%5C%22domInteractive%5C%22%3A1608279587746%2C%5C%22domContentLoadedEventStart%5C%22%3A1608279587746%2C%5C%22domContentLoadedEventEnd%5C%22%3A1608279587976%2C%5C%22domComplete%5C%22%3A1608279588391%2C%5C%22loadEventStart%5C%22%3A1608279588391%2C%5C%22loadEventEnd%5C%22%3A1608279588391%7D%22%7D'&amp;-pageHeight=6888&amp;-vpHeight=889&amp;-vpWidth=929&amp;-behavior=0&amp;-vScrollOffset=0&amp;-hScrollOffset=0&amp;-contentVer='2.0'&amp;-content='%5B%5D'&amp;*baseType='Ms.Content.ContentUpdate'&amp;*title='DllMain%20entry%20point%20(Process.h)%20-%20Win32%20apps%20%7C%20Microsoft%20Docs'&amp;*cookieEnabled=true&amp;*isJs=true&amp;*isDomComplete=true&amp;*isLoggedIn=false&amp;*pageLoadTime=1531&amp;ext-javascript-ver='1.1'&amp;ext-javascript-libVer='4.3.4'&amp;ext-javascript-domain='docs.microsoft.com'&amp;ext-javascript-msfpc='GUID%3D6709bb7d43e74468a0cfe573e1dcfdf3%26HASH%3D6709%26LV%3D202012%26V%3D4%26LU%3D1608272102390'&amp;ext-javascript-userConsent=true&amp;$mscomCookies=false"></script><script async="" src="https://web.vortex.data.microsoft.com/collect/v1/t.js?ver='2.1'&amp;name='Ms.Webi.ContentUpdate'&amp;time='2020-12-18T08%3A19%3A47.983Z'&amp;os='Windows'&amp;appId='JS%3ADocs'&amp;-ver='1.0'&amp;-impressionGuid='54f58a26-0e7b-4206-93ac-fc0ec0567dca'&amp;-pageName='21b45fcb-9adc-4f5d-a0c8-1a3a170cb7bf'&amp;-uri='https%3A%2F%2Fdocs.microsoft.com%2Fzh-cn%2Fwindows%2Fwin32%2Fdlls%2Fdllmain%3Fredirectedfrom%3DMSDN'&amp;-market='zh-cn'&amp;-pageTags='%7B%22author%22%3A%22mcleanbyron%22%2C%22depotname%22%3A%22MSDN.win32%22%2C%22document_version_independent_id%22%3A%228e365be3-0845-9499-02a8-017148c95100%22%2C%22gitcommit%22%3A%22https%3A%2F%2Fgithub.com%2FMicrosoftDocs%2Fwin32-pr%2Fblob%2F2ec0df659644a793ed4f6160f238a95c9d9a9dcf%2Fdesktop-src%2FDlls%2Fdllmain.md%22%2C%22asst%22%3A%220c3e3083-9297-4626-b2a7-0062d1c2cf9e%22%2C%22pgauth%22%3A%22mcleans%22%2C%22date%22%3A%2207%2F22%2F2020%22%2C%22product%22%3A%22desktop%22%2C%22technology%22%3A%22system-services%22%2C%22pgtop%22%3A%22reference%22%2C%22giturl%22%3A%22https%3A%2F%2Fgithub.com%2FMicrosoftDocs%2Fwin32-pr%2Fblob%2Flive%2Fdesktop-src%2FDlls%2Fdllmain.md%22%2C%22publishtime%22%3A%222020-12-11%2011%3A32%20PM%22%2C%22contentlocale%22%3A%22en-us%22%2C%22highContrast%22%3A%22false%22%2C%22metaTags%22%3A%7B%7D%7D'&amp;-pageHeight=6888&amp;-vpHeight=932&amp;-vpWidth=929&amp;-actionType='R'&amp;-behavior=0&amp;-vScrollOffset=0&amp;-hScrollOffset=0&amp;-contentVer='2.0'&amp;-content='%5B%5D'&amp;*baseType='Ms.Content.ContentUpdate'&amp;*title='DllMain%20entry%20point%20(Process.h)%20-%20Win32%20apps%20%7C%20Microsoft%20Docs'&amp;*cookieEnabled=true&amp;*isJs=true&amp;*isDomComplete=false&amp;*isLoggedIn=false&amp;ext-javascript-ver='1.1'&amp;ext-javascript-libVer='4.3.4'&amp;ext-javascript-domain='docs.microsoft.com'&amp;ext-javascript-msfpc='GUID%3D6709bb7d43e74468a0cfe573e1dcfdf3%26HASH%3D6709%26LV%3D202012%26V%3D4%26LU%3D1608272102390'&amp;ext-javascript-userConsent=true&amp;$mscomCookies=false"></script><style type="text/css" media="print">.usabilla_live_button_container { display: none; }</style></head>

<body lang="zh-cn" dir="ltr"><div style="display: none;" id="lightningjs-usabilla_live"><div><iframe frameborder="0" id="lightningjs-frame-usabilla_live"></iframe></div></div>
<div class="header-holder has-default-focus">
	<a href="#main" class="skip-to-main-link has-outline-color-text visually-hidden-until-focused is-fixed has-inner-focus focus-visible has-top-zero has-left-zero has-right-zero has-padding-medium has-text-centered has-body-background-medium" tabindex="1">跳转至主内容</a>
	<div id="learn-together-banner-holder" class="has-default-focus has-overflow-hidden">
	</div>
	<div hidden="" id="cookie-consent-holder"></div>
	<!-- liquid-tag banners global -->
	<div id="headerAreaHolder" data-bi-name="header">
<header role="banner" itemscope="itemscope" itemtype="http://schema.org/Organization"><!----> <div class="nav-bar"><!---->  <div class="nav-bar-brand">
		<a class="nav-bar-button" itemprop="url" href="https://www.microsoft.com" aria-label="Microsoft">
			<div class="nav-bar-logo" role="presentation" aria-hidden="true" itemprop="logo" itemscope="itemscope">
				<svg xmlns="http://www.w3.org/2000/svg" width="108" height="23" viewBox="72 72 337 74" preserveAspectRatio="xMidYMin slice">
					<g data-name="MS-symbol">
						<clipPath id="a">
							<path transform="matrix(1 0 0 -1 0 216)" d="M0 216h482V0H0z"/>
						</clipPath>
						<g clip-path="url(#a)">
							<path class="has-fill-current-color has-text-subtle" d="M394.942 104.59h-10.858v25.003h-7.38V104.59h-5.182v-5.965h5.182v-4.308c0-3.254 1.06-5.92 3.178-7.998 2.12-2.079 4.835-3.118 8.15-3.118.882 0 1.666.045 2.35.135a9.37 9.37 0 011.806.407v6.296c-.24-.14-.663-.31-1.265-.512-.603-.2-1.296-.3-2.078-.3-1.528 0-2.702.476-3.526 1.43-.824.954-1.235 2.365-1.235 4.232v3.736h10.858v-6.959l7.321-2.229v9.188h7.381v5.965h-7.38v14.49c0 1.91.345 3.254 1.038 4.037.693.783 1.782 1.175 3.27 1.175.42 0 .927-.1 1.52-.3a7.178 7.178 0 001.552-.724v6.025c-.463.261-1.23.502-2.305.723a15.742 15.742 0 01-3.178.331c-3.073 0-5.378-.817-6.914-2.455-1.537-1.637-2.305-4.102-2.305-7.396zm-48.407 9.73c0 3.233.733 5.703 2.2 7.411 1.465 1.707 3.564 2.56 6.295 2.56 2.652 0 4.67-.853 6.055-2.56 1.386-1.708 2.08-4.238 2.08-7.592 0-3.334-.719-5.849-2.155-7.547-1.436-1.697-3.45-2.545-6.04-2.545-2.67 0-4.745.888-6.22 2.666-1.477 1.777-2.215 4.313-2.215 7.607m-7.592.24c0-5.12 1.446-9.177 4.338-12.17 2.892-2.993 6.91-4.489 12.05-4.489 4.841 0 8.621 1.441 11.343 4.323 2.721 2.883 4.082 6.774 4.082 11.674 0 5.021-1.447 9.018-4.338 11.99-2.892 2.973-6.829 4.458-11.81 4.458-4.8 0-8.61-1.41-11.432-4.232-2.822-2.82-4.233-6.673-4.233-11.554m-16.417-7.802c0 1.045.331 1.863.994 2.456.662.592 2.128 1.34 4.398 2.243 2.912 1.166 4.956 2.476 6.131 3.932 1.175 1.456 1.762 3.22 1.762 5.287 0 2.912-1.12 5.252-3.359 7.02-2.24 1.767-5.267 2.65-9.083 2.65-1.285 0-2.706-.155-4.263-.467-1.556-.31-2.877-.707-3.96-1.19v-7.169a17.945 17.945 0 004.277 2.198c1.526.543 2.911.814 4.157.814 1.647 0 2.862-.23 3.645-.693.784-.46 1.175-1.235 1.175-2.319 0-1.005-.406-1.853-1.22-2.546-.813-.693-2.355-1.492-4.624-2.395-2.69-1.125-4.599-2.39-5.724-3.796-1.125-1.406-1.687-3.193-1.687-5.362 0-2.792 1.11-5.086 3.33-6.884 2.217-1.797 5.095-2.696 8.63-2.696 1.084 0 2.3.12 3.645.361 1.346.242 2.47.553 3.374.934v6.93c-.964-.644-2.089-1.195-3.374-1.658-1.286-.462-2.56-.693-3.826-.693-1.386 0-2.465.271-3.238.813-.774.543-1.16 1.286-1.16 2.23m-35.066 7.562c0 3.233.733 5.703 2.2 7.411 1.465 1.707 3.564 2.56 6.295 2.56 2.652 0 4.67-.853 6.055-2.56 1.386-1.708 2.08-4.238 2.08-7.592 0-3.334-.719-5.849-2.155-7.547-1.436-1.697-3.449-2.545-6.039-2.545-2.672 0-4.745.888-6.222 2.666-1.476 1.777-2.214 4.313-2.214 7.607m-7.592.24c0-5.12 1.446-9.177 4.338-12.17 2.893-2.993 6.91-4.489 12.051-4.489 4.84 0 8.621 1.441 11.342 4.323 2.721 2.883 4.082 6.774 4.082 11.674 0 5.021-1.446 9.018-4.338 11.99-2.892 2.973-6.828 4.458-11.809 4.458-4.8 0-8.61-1.41-11.433-4.232-2.822-2.82-4.233-6.673-4.233-11.554m-3.136-16.448c.582 0 1.105.041 1.567.121.462.08.853.18 1.175.301v7.38c-.382-.28-.939-.546-1.672-.798-.733-.25-1.622-.376-2.666-.376-1.788 0-3.299.753-4.534 2.26-1.235 1.505-1.853 3.825-1.853 6.958v15.635h-7.29V98.624h7.29v4.88h.12c.663-1.687 1.667-3.007 3.013-3.96 1.346-.954 2.962-1.432 4.85-1.432m-27.956 26.18c1.084 0 2.28-.25 3.585-.754a15.06 15.06 0 003.615-1.988v6.778c-1.165.663-2.485 1.165-3.962 1.506-1.475.342-3.098.512-4.865.512-4.559 0-8.265-1.44-11.116-4.323-2.852-2.88-4.278-6.562-4.278-11.04 0-4.98 1.456-9.083 4.37-12.307 2.91-3.224 7.037-4.835 12.38-4.835 1.366 0 2.746.176 4.143.527 1.395.352 2.504.758 3.328 1.22v6.99c-1.125-.824-2.274-1.462-3.45-1.914a9.966 9.966 0 00-3.599-.678c-2.872 0-5.192.934-6.959 2.802-1.768 1.868-2.652 4.388-2.652 7.562 0 3.132.85 5.573 2.546 7.32 1.697 1.748 4.002 2.621 6.914 2.621m-22.112 5.302h-7.29V98.624h7.29zm-8.044-39.916c0-1.205.437-2.214 1.311-3.028.874-.813 1.913-1.22 3.118-1.22 1.285 0 2.35.417 3.193 1.25.844.834 1.266 1.833 1.266 2.998 0 1.185-.432 2.18-1.296 2.982-.864.804-1.918 1.205-3.163 1.205-1.246 0-2.295-.406-3.148-1.219-.854-.815-1.28-1.803-1.28-2.968m-6.274-3.284v43.2h-7.5v-33.86h-.12l-13.408 33.86h-4.97l-13.738-33.86h-.09v33.86h-6.929v-43.2h10.755l12.412 32.024h.18l13.105-32.024z"/>
							<path d="M106.214 106.214H71.996V71.996h34.218z" fill="#f25022"/>
							<path d="M143.993 106.214h-34.218V71.996h34.218z" fill="#7fba00"/>
							<path d="M106.214 143.993H71.996v-34.218h34.218z" fill="#00a4ef"/>
							<path d="M143.993 143.993h-34.218v-34.218h34.218z" fill="#ffb900"/>
						</g>
					</g>
				</svg>
			</div>
		</a>
	</div> 
			
		<div class="nav-bar-item is-hidden-tablet">
			<div class="nav-bar-menu">
				<button class="nav-bar-button is-title" title="全球导航" aria-expanded="false">
					<span class="nav-bar-menu-title"><!---->文档<!----></span>
					<div class="nav-bar-burger">
						<span></span>
						<span></span>
						<span></span>
						<span class="nav-bar-burger-label"><!---->全球导航<!----></span>
					</div>
				</button>
			</div>
		</div>
	
			
		<nav class="nav-bar-nav" role="navigation" aria-label="全球">
			<ul class="nav-bar-nav-list">
				
		<li class="nav-bar-item is-category">
			<a class="nav-bar-button is-title has-hover-underline" itemprop="url" href="/zh-cn/">
				<span><!---->Docs<!----></span>
			</a>
		</li>
	
				<!----> <li class="nav-bar-item">
				<a class="nav-bar-button has-hover-underline is-active" href="https://docs.microsoft.com/zh-cn/documentation">
					<span><!---->文档<!----></span>
				</a>
		  </li><!----> <li class="nav-bar-item">
				<a class="nav-bar-button has-hover-underline " href="https://docs.microsoft.com/zh-cn/learn/">
					<span><!---->Learn<!----></span>
				</a>
		  </li><!----> <li class="nav-bar-item">
				<a class="nav-bar-button has-hover-underline " href="https://docs.microsoft.com/zh-cn/answers/products/">
					<span><!---->Q&amp;A<!----></span>
				</a>
		  </li><!----> <li class="nav-bar-item">
				<a class="nav-bar-button has-hover-underline " href="https://docs.microsoft.com/zh-cn/samples/browse/">
					<span><!---->代码示例<!----></span>
				</a>
		  </li><!----> <li class="dropdown nav-bar-item" hidden="">
		<button aria-expanded="false" class="dropdown-trigger nav-bar-button  has-hover-underline" aria-controls="ax-61">
			<span><!---->更多<!----></span>
			<span class="nav-bar-button-chevron" aria-hidden="true">
				<span class="docon docon-chevron-down-light expanded-indicator"></span>
			</span>
		</button>
		<ul class="dropdown-menu" id="ax-61" aria-label="更多">
			<!---->
				<li class="nav-bar-item" hidden="">
					<a class="nav-bar-button " href="https://docs.microsoft.com/zh-cn/documentation"><!---->文档<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item" hidden="">
					<a class="nav-bar-button " href="https://docs.microsoft.com/zh-cn/learn/"><!---->Learn<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item" hidden="">
					<a class="nav-bar-button " href="https://docs.microsoft.com/zh-cn/answers/products/"><!---->Q&amp;A<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item" hidden="">
					<a class="nav-bar-button " href="https://docs.microsoft.com/zh-cn/samples/browse/"><!---->代码示例<!----></a>
				</li>
		  <!---->
		</ul>
	</li><!---->
			</ul>
		</nav>
	
			<span class="nav-bar-spacer"></span>
			
		<div class="nav-bar-search " id="ax-62" hidden="">
			
		<form class="nav-bar-search-form" method="GET" name="nav-bar-search-form" role="search" id="nav-bar-search-form" aria-label="搜索" aria-expanded="false" action="/zh-cn/search/">
			<div class="autocomplete" data-bi-name="autocomplete"><!----> <div class="control ">
				<input role="combobox" maxlength="100" aria-autocomplete="list" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false" id="site-search-input" class="autocomplete-input input   is-small" type="search" name="terms" aria-expanded="false" aria-owns="ax-63-listbox" aria-activedescendant="" aria-label="搜索" placeholder="搜索" />

				<span aria-hidden="true" class="icon is-small is-left" hidden="">
					<span class="has-text-primary docon docon-undefined"></span>
				</span>

				<span aria-hidden="true" class="autocomplete-loader loader has-text-primary " hidden=""></span>
			</div>

			<ul class="autocomplete-suggestions is-vertically-scrollable" role="listbox" id="ax-63-listbox" aria-label="site-search-input-suggestions" hidden="">
				
			</ul><!----></div>
			<!-- mobile safari will not dispatch submit event unless there's a submit button that is not display:none -->
			<button type="submit" class="visually-hidden" tabindex="-1" aria-hidden="true"></button>
			<input name="category" hidden="" value="" />
			<input name="scope" hidden="" value="Desktop" />
			
			
		</form>
	
		</div>
		
					<div class="nav-bar-search" hidden="">
						<!-- hidden when the width drops to tablet -->
						
		<form class="nav-bar-search-form" method="GET" name="nav-bar-search-form" role="search" id="nav-bar-search-form-desktop" aria-label="搜索" aria-expanded="false" action="/zh-cn/search/">
			<div class="autocomplete" data-bi-name="autocomplete"><!----> <div class="control has-icons-left">
				<input role="combobox" maxlength="100" aria-autocomplete="list" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false" id="ax-64" class="autocomplete-input input control has-icons-left  is-small" type="search" name="terms" aria-expanded="false" aria-owns="ax-65-listbox" aria-activedescendant="" aria-label="搜索" placeholder="搜索" />

				<span aria-hidden="true" class="icon is-small is-left">
					<span class="has-text-primary docon docon-search"></span>
				</span>

				<span aria-hidden="true" class="autocomplete-loader loader has-text-primary " hidden=""></span>
			</div>

			<ul class="autocomplete-suggestions is-vertically-scrollable" role="listbox" id="ax-65-listbox" aria-label="ax-64-suggestions" hidden="">
				
			</ul><!----></div>
			<!-- mobile safari will not dispatch submit event unless there's a submit button that is not display:none -->
			<button type="submit" class="visually-hidden" tabindex="-1" aria-hidden="true"></button>
			<input name="category" hidden="" value="" />
			<input name="scope" hidden="" value="Desktop" />
			
			
		</form>
	
					</div>
			  
		<div class="nav-bar-search ">
			<div class="nav-bar-search-form-expander">
				<button id="form-expander" class="nav-bar-button has-hover-underline " title="搜索" aria-expanded="false" aria-controls="ax-62">
					
		<span class="is-visually-hidden-mobile"><!---->搜索<!----></span>
		<span class="icon" aria-hidden="true">
			<span class="docon docon-search"></span>
		</span>
	
				</button>
			</div>
		</div>
	
			
		<div class="nav-bar-profile">
			
		<a class="docs-sign-in auth-status-determined not-authenticated" href="#"> 登录 </a>
	 
		<div class="dropdown has-caret auth-status-determined authenticated">
			<button class="dropdown-trigger button-reset" aria-controls="user-menu" aria-expanded="false" aria-label="你的帐户">
				<figure class="image is-36x36">
					<img class="has-body-background-medium is-rounded" alt="" data-profile-property="avatarUrl" />
				</figure>
			</button>
			<div class="dropdown-menu box has-flex-justify-content-start has-body-background" id="user-menu" role="menu">
				<div class="media is-user-dir">
					<div class="media-left">
						<figure class="image is-48x48" aria-hidden="true">
							<img class="has-body-background-medium is-rounded" aria-labelledby="displayName" data-profile-property="avatarUrl" />
						</figure>
					</div>
					<div class="media-content">
						<p class="title is-size-large">
							<span id="displayName" class="is-inline-truncated has-max-width-200" data-profile-property="displayName"></span>
						</p>
						<p class="subtitle is-size-small has-margin-bottom-none">
							<span class="is-inline-truncated has-max-width-200" data-profile-property="upn"></span>
						</p>
					</div>
				</div>
				<ul class="has-padding-top-small has-padding-bottom-medium">
					<li class="has-padding-top-extra-small has-padding-bottom-extra-small">
						<a href="/profile" data-profile-property="profileUrl"><!---->配置文件<!----></a>
					</li>
					<li class="has-padding-top-extra-small has-padding-bottom-extra-small">
						<a href="/profile" data-profile-property="bookmarksUrl"><!---->书签<!----></a>
					</li>
					<li class="has-padding-top-extra-small has-padding-bottom-extra-small">
						<a href="/profile" data-profile-property="collectionsUrl"><!---->集合<!----></a>
					</li>
					<li class="has-padding-top-extra-small">
						<a href="/profile" data-profile-property="challengesUrl"><!---->挑战<!----></a>
					</li>
				</ul>
				<div class="has-border-top has-padding-top-medium">
					<a class="docs-sign-out" href="#"><!---->注销<!----></a>
				</div>
			</div>
		</div>
	
		</div>
	
		 <!----></div> <div class="nav-bar has-border-top is-hidden-mobile"><!----> 
		<a class="nav-bar-button is-title has-hover-underline" itemprop="url" href="/windows/apps">
			<span>
				Windows 开发人员
				
			</span>
		</a>
	 
		
		<nav class="nav-bar-nav" role="navigation" aria-label="站点">
			<ul class="nav-bar-nav-list">
				
				<!----> <li class="dropdown nav-bar-item">
		<button aria-expanded="false" class="dropdown-trigger nav-bar-button  has-hover-underline" aria-controls="ax-73">
			<span><!---->浏览<!----></span>
			<span class="nav-bar-button-chevron" aria-hidden="true">
				<span class="docon docon-chevron-down-light expanded-indicator"></span>
			</span>
		</button>
		<ul class="dropdown-menu" id="ax-73" aria-label="浏览">
			<!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button " href="https://developer.microsoft.com/windows/get-started-windows-10"><!---->Windows 开发入门<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button " href="https://developer.microsoft.com/windows/windows-10-for-developers"><!---->Windows 10 的新增功能<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button " href="https://developer.microsoft.com/windows/enterprise"><!---->专为企业构建<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button " href="/zh-cn/windows/apps/accessibility"><!---->针对辅助功能开发<!----></a>
				</li>
		  <!---->
		</ul>
	</li><!----> <li class="dropdown nav-bar-item">
		<button aria-expanded="false" class="dropdown-trigger nav-bar-button  has-hover-underline" aria-controls="ax-74">
			<span><!---->平台<!----></span>
			<span class="nav-bar-button-chevron" aria-hidden="true">
				<span class="docon docon-chevron-down-light expanded-indicator"></span>
			</span>
		</button>
		<ul class="dropdown-menu" id="ax-74" aria-label="平台">
			<!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button " href="/zh-cn/windows/apps/desktop/"><!---->Windows PCs<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button " href="https://developer.microsoft.com/windows/iot"><!---->Windows IoT<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button " href="https://developer.microsoft.com/mixed-reality"><!---->混合现实<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button " href="https://developer.microsoft.com/games"><!---->游戏<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button " href="https://developer.microsoft.com/web"><!---->Web<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button " href="/zh-cn/windows/uwp/"><!---->UWP<!----></a>
				</li>
		  <!---->
		</ul>
	</li><!----> <li class="nav-bar-item">
				<a class="nav-bar-button has-hover-underline " href="https://developer.microsoft.com/windows/downloads">
					<span><!---->下载<!----></span>
				</a>
		  </li><!----> <li class="nav-bar-item">
				<a class="nav-bar-button has-hover-underline " href="https://developer.microsoft.com/windows/samples">
					<span><!---->示例<!----></span>
				</a>
		  </li><!----> <li class="nav-bar-item">
				<a class="nav-bar-button has-hover-underline " href="https://developer.microsoft.com/windows/support">
					<span><!---->支持<!----></span>
				</a>
		  </li><!----> <li class="dropdown nav-bar-item" hidden="">
		<button aria-expanded="false" class="dropdown-trigger nav-bar-button  has-hover-underline" aria-controls="ax-75">
			<span><!---->更多<!----></span>
			<span class="nav-bar-button-chevron" aria-hidden="true">
				<span class="docon docon-chevron-down-light expanded-indicator"></span>
			</span>
		</button>
		<ul class="dropdown-menu" id="ax-75" aria-label="更多">
			<!----> <li class="dropdown nav-bar-item" hidden="">
		<button aria-expanded="false" class="dropdown-trigger nav-bar-button  " aria-controls="ax-76">
			<span><!---->浏览<!----></span>
			<span class="nav-bar-button-chevron" aria-hidden="true">
				<span class="docon docon-chevron-right-light "></span>
			</span>
		</button>
		<ul class="dropdown-menu" id="ax-76" aria-label="浏览">
			<!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button " href="https://developer.microsoft.com/windows/get-started-windows-10"><!---->Windows 开发入门<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button " href="https://developer.microsoft.com/windows/windows-10-for-developers"><!---->Windows 10 的新增功能<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button " href="https://developer.microsoft.com/windows/enterprise"><!---->专为企业构建<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button " href="/zh-cn/windows/apps/accessibility"><!---->针对辅助功能开发<!----></a>
				</li>
		  <!---->
		</ul>
	</li><!----> <li class="dropdown nav-bar-item" hidden="">
		<button aria-expanded="false" class="dropdown-trigger nav-bar-button  " aria-controls="ax-77">
			<span><!---->平台<!----></span>
			<span class="nav-bar-button-chevron" aria-hidden="true">
				<span class="docon docon-chevron-right-light "></span>
			</span>
		</button>
		<ul class="dropdown-menu" id="ax-77" aria-label="平台">
			<!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button " href="/zh-cn/windows/apps/desktop/"><!---->Windows PCs<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button " href="https://developer.microsoft.com/windows/iot"><!---->Windows IoT<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button " href="https://developer.microsoft.com/mixed-reality"><!---->混合现实<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button " href="https://developer.microsoft.com/games"><!---->游戏<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button " href="https://developer.microsoft.com/web"><!---->Web<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item">
					<a class="nav-bar-button " href="/zh-cn/windows/uwp/"><!---->UWP<!----></a>
				</li>
		  <!---->
		</ul>
	</li><!---->
				<li class="nav-bar-item" hidden="">
					<a class="nav-bar-button " href="https://developer.microsoft.com/windows/downloads"><!---->下载<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item" hidden="">
					<a class="nav-bar-button " href="https://developer.microsoft.com/windows/samples"><!---->示例<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item" hidden="">
					<a class="nav-bar-button " href="https://developer.microsoft.com/windows/support"><!---->支持<!----></a>
				</li>
		  <!---->
		</ul>
	</li><!---->
			</ul>
		</nav>
	
		<span class="nav-bar-spacer"></span>
		
		<ol class="nav-bar-list">
			 
		<li class="nav-bar-item ">
			<a class="button is-small is-primary " href="https://partner.microsoft.com/dashboard">
				仪表板
			</a>
		</li>
	
		</ol>
	 
	 <!----></div> <!----></header>	</div>

				<div class="content-header uhf-container has-padding has-default-focus has-border-bottom-none" data-bi-name="content-header">
				<nav class="has-padding-none has-padding-left-medium-tablet has-padding-right-medium-tablet has-padding-left-none-uhf-tablet has-padding-left-none-uhf-tablet has-padding-none-desktop has-flex-grow" data-bi-name="breadcrumb" itemscope="" itemtype="http://schema.org/BreadcrumbList" role="navigation" aria-label="痕迹">
					<ul id="page-breadcrumbs" class="breadcrumbs"><!----><!---->
			<li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
				
							<a itemprop="item" href="https://docs.microsoft.com/zh-cn/windows/">
								<span itemprop="name"><!---->Windows<!----></span>
							</a>
					  
				<meta itemprop="position" content="1" />
			</li>
		<!---->
			<li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
				
							<a itemprop="item" href="https://docs.microsoft.com/zh-cn/windows/apps/">
								<span itemprop="name"><!---->Apps<!----></span>
							</a>
					  
				<meta itemprop="position" content="2" />
			</li>
		<!---->
			<li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
				
							<a itemprop="item" href="https://docs.microsoft.com/zh-cn/windows/win32/">
								<span itemprop="name"><!---->Win32<!----></span>
							</a>
					  
				<meta itemprop="position" content="3" />
			</li>
		<!---->
			<li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
				
							<a itemprop="item" href="https://docs.microsoft.com/zh-cn/windows/win32/desktop-app-technologies">
								<span itemprop="name"><!---->Desktop Technologies<!----></span>
							</a>
					  
				<meta itemprop="position" content="4" />
			</li>
		<!---->
			<li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
				
							<a itemprop="item" href="https://docs.microsoft.com/zh-cn/windows/win32/system-services">
								<span itemprop="name"><!---->System Services<!----></span>
							</a>
					  
				<meta itemprop="position" content="5" />
			</li>
		<!---->
			<li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
				
							<a itemprop="item" href="https://docs.microsoft.com/zh-cn/windows/win32/dlls/dynamic-link-libraries">
								<span itemprop="name"><!---->Dynamic-Link Libraries<!----></span>
							</a>
					  
				<meta itemprop="position" content="6" />
			</li>
		<!----><!----></ul>
				</nav>
			<div class="content-header-controls">
				<button type="button" class="contents-button button" data-bi-name="contents-expand" aria-haspopup="true">
					<span class="icon"><span class="docon docon-menu" aria-hidden="true"></span></span>
					<span class="contents-expand-title">目录</span>
				</button>
				<button type="button" class="ap-collapse-behavior ap-expanded button" data-bi-name="ap-collapse" aria-controls="action-panel">
					<span class="icon"><span class="docon docon-exit-mode" aria-hidden="true"></span></span>
					<span>退出焦点模式</span>
				</button>
			</div>
			<div class="has-padding-none-tablet has-padding-medium is-size-small is-flex-touch has-flex-justify-content-space-between-touch has-flex-grow">
				<ul class="is-hidden-mobile action-list has-flex-justify-content-start has-flex-justify-content-end-tablet is-flex is-flex-row has-flex-wrap has-flex-grow is-unstyled">
					<li>
						<button type="button" class="bookmark button is-text has-inner-focus is-small is-icon-only-touch" data-list-type="bookmarks" data-bi-name="bookmark" title="添加 DllMain entry point (Process.h) - Win32 apps | Microsoft Docs 的书签" aria-pressed="false">
							<span class="icon" aria-hidden="true">
								<span class="docon docon-single-bookmark"></span>
							</span>
							<span class="bookmark-status is-visually-hidden-touch is-hidden-portrait">书签</span>
						</button>
					</li>
							<li id="contenteditbtn">
								<a href="https://github.com/MicrosoftDocs/win32/blob/docs/desktop-src/Dlls/dllmain.md" class="button is-text has-inner-focus is-icon-only-touch is-small" title="编辑本文" data-bi-name="edit" data-original_content_git_url="https://github.com/MicrosoftDocs/win32-pr/blob/live/desktop-src/Dlls/dllmain.md" data-original_content_git_url_template="{repo}/blob/{branch}/desktop-src/Dlls/dllmain.md" data-pr_repo="" data-pr_branch="">
								<span class="icon" aria-hidden="true">
									<span class="docon docon-edit-outline"></span>
								</span>
								<span class="is-visually-hidden-touch is-hidden-portrait">编辑</span>
							</a>
						</li>
					<li>
<div class="sharing dropdown has-caret">
	<button class="dropdown-trigger button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small is-icon-only-touch" aria-controls="sharing-menu" aria-expanded="false" title="共享本文" data-bi-name="share">
		<span class="icon" aria-hidden="true">
			<span class="docon docon-sharing"></span>
		</span>
		<span class="is-visually-hidden-touch is-hidden-portrait">共享</span>
	</button>
	<div class="dropdown-menu has-padding-small" id="sharing-menu">
		<ul data-bi-name="share-links">
			<li>
				<a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-twitter" data-bi-name="twitter" href="https://twitter.com/intent/tweet?original_referer=https%3A%2F%2Fdocs.microsoft.com%2Fzh-cn%2Fwindows%2Fwin32%2Fdlls%2Fdllmain%3Fredirectedfrom%3DMSDN%26WT.mc_id%3Dtwitter&amp;text=DllMain%20entry%20point%20(Process.h)%20-%20Win32%20apps%20%7C%20Microsoft%20Docs&amp;tw_p=tweetbutton&amp;url=https%3A%2F%2Fdocs.microsoft.com%2Fzh-cn%2Fwindows%2Fwin32%2Fdlls%2Fdllmain%3Fredirectedfrom%3DMSDN%26WT.mc_id%3Dtwitter">
					<span class="icon">
						<span class="docon docon-brand-twitter has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Twitter</span>
				</a>
			</li>
			<li>
				<a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-linkedin" data-bi-name="linkedin" href="https://www.linkedin.com/cws/share?url=https%3A%2F%2Fdocs.microsoft.com%2Fzh-cn%2Fwindows%2Fwin32%2Fdlls%2Fdllmain%3Fredirectedfrom%3DMSDN%26WT.mc_id%3Dlinkedin">
					<span class="icon">
						<span class="docon docon-brand-linkedin has-text-primary" aria-hidden="true"></span>
					</span>
					<span>LinkedIn</span>
				</a>
			</li>
			<li>
				<a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-facebook" data-bi-name="facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fdocs.microsoft.com%2Fzh-cn%2Fwindows%2Fwin32%2Fdlls%2Fdllmain%3Fredirectedfrom%3DMSDN%26WT.mc_id%3Dfacebook">
					<span class="icon">
						<span class="docon docon-brand-facebook has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Facebook</span>
				</a>
			</li>
			<li>
				<a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-email" data-bi-name="email" href="mailto:?subject=%5B%E5%85%B1%E4%BA%AB%E6%96%87%E7%AB%A0%5D%20DllMain%20entry%20point%20(Process.h)%20-%20Win32%20apps%20%7C%20Microsoft%20Docs&amp;body=DllMain%20entry%20point%20(Process.h)%20-%20Win32%20apps%20%7C%20Microsoft%20Docs%0A%0Ahttps%3A%2F%2Fdocs.microsoft.com%2Fzh-cn%2Fwindows%2Fwin32%2Fdlls%2Fdllmain%3Fredirectedfrom%3DMSDN%26WT.mc_id%3Demail">
					<span class="icon">
						<span class="docon docon-mail-message-fill has-text-primary" aria-hidden="true"></span>
					</span>
					<span>电子邮件</span>
				</a>
			</li>
			<li>
				<span class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-wechat has-padding-top-extra-small has-padding-left-medium has-padding-right-medium">
					<span class="icon">
						<span class="docon docon-wechat has-text-primary" data-bi-name="wechat" aria-hidden="true"></span>
					</span>
					<span>微信</span>
				</span>
			</li>
			<li>
				<canvas class="qr-code" height="96" width="96"></canvas>
			</li>
		</ul>
	</div>
</div>					</li>
				</ul>
				<button type="button" class="has-border contents-button button is-small is-text is-hidden-tablet has-inner-focus" aria-label="目录" data-bi-name="contents-expand">
					<span class="icon">
						<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
					</span>
					<span class="contents-expand-title">目录</span>
				</button>
				<div class="is-invisible"></div>
				<div class="is-hidden-tablet level-item is-flexible level-right">
					<button type="button" class="page-actions-button button is-small is-text is-hidden-tablet has-inner-focus has-border is-full-height  has-margin-left-small" aria-label="页面操作" data-bi-name="pageactions">
						<span class="icon">
							<span class="docon docon-more-vertical" aria-hidden="true"></span>
						</span>
					</button>
				</div>
			</div>
		</div>



	<div id="disclaimer-holder" class="has-overflow-hidden has-default-focus">
			<section data-dismissable="disappearing" class="is-info alert is-banner">
				<div class="uhf-container">
					<button data-dismiss="" type="button" class="delete is-absolute has-top-zero has-right-zero has-margin-extra-small is-large"><span class="visually-hidden">消除警报</span></button>
					<div class="columns">
						<div class="column is-12">
							<div class="level">
								<div class="level-left has-flex-shrink">
									<div class="level-item has-flex-shrink">
										<p class="has-text-white-static disclaimer-title has-margin-top-extra-small has-margin-right-medium has-line-height-reset">
											<span class="icon">
												<span class="docon docon-status-error-outline" aria-hidden="true"></span>
											</span>
											<span>此内容未以你的语言提供。 以下为英语版。</span>
										</p>
									</div>
								</div>
								
							</div>
						</div>
					</div>
				</div>
			</section>
			
		<!-- liquid-tag banners sectional -->
	</div>
	</div>

	<div class="mainContainer  uhf-container has-top-padding  has-default-focus" data-bi-name="body">

		<div class="columns has-large-gaps is-gapless-mobile ">

			<div id="left-container" class="left-container is-hidden-mobile column is-one-third-tablet is-one-quarter-desktop">
				<nav id="affixed-left-container" class="is-fixed is-flex is-flex-column" role="navigation" aria-label="主要" style="width: 255.984px; top: 225.5px; bottom: 24px;" data-bi-name="left toc"><form action="javascript:" role="search" aria-label="搜索" class="has-margin-bottom-small"><label class="visually-hidden" for="ax-71">搜索</label><div class="autocomplete is-block" data-bi-name="autocomplete"><!----> <div class="control has-icons-left">
				<input role="combobox" maxlength="100" aria-autocomplete="list" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false" id="ax-71" class="autocomplete-input input control has-icons-left is-full-width is-small" type="text" aria-expanded="false" aria-owns="ax-72-listbox" aria-activedescendant="" placeholder="按标题筛选" />

				<span aria-hidden="true" class="icon is-small is-left">
					<span class="has-text-primary docon docon-filter-settings"></span>
				</span>

				<span aria-hidden="true" class="autocomplete-loader loader has-text-primary " hidden=""></span>
			</div>

			<ul class="autocomplete-suggestions is-vertically-scrollable" role="listbox" id="ax-72-listbox" aria-label="ax-71-suggestions" hidden="">
				
			</ul><!----></div></form><ul class="tree is-vertically-scrollable has-flex-grow has-flex-shrink" role="tree" aria-label="目录" data-bi-name="tree" data-is-collapsible="true"><li role="none"><a aria-setsize="4" aria-level="1" aria-posinset="1" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/zh-cn/windows/win32/dlls/dynamic-link-libraries">Dynamic-Link Libraries</a></li><li class="tree-item" aria-setsize="4" aria-level="1" aria-posinset="2" role="treeitem" tabindex="-1" id="title-2-1" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>About Dynamic-Link Libraries</span></li><li class="tree-item" aria-setsize="4" aria-level="1" aria-posinset="3" role="treeitem" tabindex="-1" id="title-3-1" aria-expanded="false"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>Using Dynamic-Link Libraries</span></li><li class="tree-item is-expanded" aria-setsize="4" aria-level="1" aria-posinset="4" role="treeitem" tabindex="-1" id="title-4-1" aria-expanded="true"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>Dynamic-Link Library Reference</span><ul class="tree-group" role="group"><li role="none"><a aria-setsize="2" aria-level="2" aria-posinset="1" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/zh-cn/windows/win32/dlls/dynamic-link-library-reference">Dynamic-Link Library Reference</a></li><li class="tree-item is-expanded" aria-setsize="2" aria-level="2" aria-posinset="2" role="treeitem" tabindex="-1" id="title-4-1_2-2" aria-expanded="true"><span data-bi-name="tree-expander" class="tree-expander"><span class="tree-expander-indicator docon docon-chevron-right-light" aria-hidden="true"></span>Dynamic-Link Library Functions</span><ul class="tree-group" role="group"><li role="none"><a aria-setsize="19" aria-level="3" aria-posinset="1" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/zh-cn/windows/win32/dlls/dynamic-link-library-functions">Dynamic-Link Library Functions</a></li><li role="none"><a aria-setsize="19" aria-level="3" aria-posinset="2" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/zh-cn/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory">AddDllDirectory</a></li><li role="none"><a aria-setsize="19" aria-level="3" aria-posinset="3" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/zh-cn/windows/desktop/api/libloaderapi/nf-libloaderapi-disablethreadlibrarycalls">DisableThreadLibraryCalls</a></li><li role="none"><a aria-setsize="19" aria-level="3" aria-posinset="4" role="treeitem" tabindex="0" class="tree-item is-leaf is-selected" data-bi-name="tree-leaf" href="https://docs.microsoft.com/zh-cn/windows/win32/dlls/dllmain" aria-current="page">DllMain</a></li><li role="none"><a aria-setsize="19" aria-level="3" aria-posinset="5" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/zh-cn/windows/desktop/api/libloaderapi/nf-libloaderapi-freelibrary">FreeLibrary</a></li><li role="none"><a aria-setsize="19" aria-level="3" aria-posinset="6" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/zh-cn/windows/desktop/api/libloaderapi/nf-libloaderapi-freelibraryandexitthread">FreeLibraryAndExitThread</a></li><li role="none"><a aria-setsize="19" aria-level="3" aria-posinset="7" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/zh-cn/windows/desktop/api/WinBase/nf-winbase-getdlldirectorya">GetDllDirectory</a></li><li role="none"><a aria-setsize="19" aria-level="3" aria-posinset="8" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/zh-cn/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulefilenamea">GetModuleFileName</a></li><li role="none"><a aria-setsize="19" aria-level="3" aria-posinset="9" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/zh-cn/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulehandlea">GetModuleHandle</a></li><li role="none"><a aria-setsize="19" aria-level="3" aria-posinset="10" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/zh-cn/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulehandleexa">GetModuleHandleEx</a></li><li role="none"><a aria-setsize="19" aria-level="3" aria-posinset="11" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/zh-cn/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress">GetProcAddress</a></li><li role="none"><a aria-setsize="19" aria-level="3" aria-posinset="12" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/zh-cn/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya">LoadLibrary</a></li><li role="none"><a aria-setsize="19" aria-level="3" aria-posinset="13" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/zh-cn/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa">LoadLibraryEx</a></li><li role="none"><a aria-setsize="19" aria-level="3" aria-posinset="14" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/zh-cn/windows/desktop/api/Winbase/nf-winbase-loadmodule">LoadModule</a></li><li role="none"><a aria-setsize="19" aria-level="3" aria-posinset="15" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/zh-cn/windows/desktop/api/Winbase/nf-winbase-loadpackagedlibrary">LoadPackagedLibrary</a></li><li role="none"><a aria-setsize="19" aria-level="3" aria-posinset="16" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/zh-cn/windows/desktop/api/libloaderapi2/nf-libloaderapi2-queryoptionaldelayloadedapi">QueryOptionalDelayLoadedAPI</a></li><li role="none"><a aria-setsize="19" aria-level="3" aria-posinset="17" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/zh-cn/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-removedlldirectory">RemoveDllDirectory</a></li><li role="none"><a aria-setsize="19" aria-level="3" aria-posinset="18" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/zh-cn/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories">SetDefaultDllDirectories</a></li><li role="none"><a aria-setsize="19" aria-level="3" aria-posinset="19" role="treeitem" tabindex="-1" class="tree-item is-leaf" data-bi-name="tree-leaf" href="https://docs.microsoft.com/zh-cn/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya">SetDllDirectory</a></li></ul></li></ul></li></ul><a class="button is-small is-text has-flex-justify-content-start has-inner-focus has-margin-top-small has-border-top has-border-bottom has-flex-shrink-none" href="https://docs.microsoft.com/zh-cn/windows/win32/opbuildpdf/dlls/toc.pdf?branch=live" data-bi-name="downloadPdf" rel="nofollow"><!----> <span class="icon is-size-extra-small has-text-subtle">
				<span aria-hidden="true" class="docon docon-dictionary-download"></span>
			</span>
			<span><!---->下载 PDF<!----></span><!----></a></nav>
			</div>

			<section class="primary-holder column is-two-thirds-tablet is-three-quarters-desktop">
				<div class="columns is-gapless-mobile has-large-gaps ">


				<div id="main-column" class="column  is-full is-four-fifths-desktop ">

					<main id="main" role="main" class="content " data-bi-name="content" lang="en-us" dir="ltr">



						<h1 id="dllmain-entry-point">DllMain entry point</h1>

						<ul class="metadata page-metadata" data-bi-name="page info" lang="zh-cn" dir="ltr">
							<li>
								<time class="" data-article-date="" aria-label="文章评审日期" datetime="2020-07-22T00:00:00.000Z" data-article-date-source="ms.date">2020/07/22</time>
							</li>
									<li class="readingTime">8 分钟可看完</li>
								<li class="contributors-holder">
									<ul class="facepile has-margin-left-none is-small" data-bi-name="contributors">
														<li class="facepile-item">
															<a href="https://github.com/mcleanbyron" title="mcleanbyron" aria-label="mcleanbyronGithub 个人资料" data-src="https://github.com/mcleanbyron.png?size=32" data-contributor-name="mcleanbyron" class="facepile-item-coin">
																<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/mcleanbyron.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';" />
																<span class="facepile-item-coin-text durable-image-fallback facepile-item-teal" aria-hidden="true">m</span>
															</a>
														</li>
														<li class="facepile-item">
															<a href="https://github.com/drewbatgit" title="drewbatgit" aria-label="drewbatgitGithub 个人资料" data-src="https://github.com/drewbatgit.png?size=32" data-contributor-name="drewbatgit" class="facepile-item-coin">
																<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/drewbatgit.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';" />
																<span class="facepile-item-coin-text durable-image-fallback facepile-item-red" aria-hidden="true">d</span>
															</a>
														</li>
														<li class="facepile-item">
															<a href="https://github.com/DCtheGeek" title="DCtheGeek" aria-label="DCtheGeekGithub 个人资料" data-src="https://github.com/DCtheGeek.png?size=32" data-contributor-name="DCtheGeek" class="facepile-item-coin">
																<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/DCtheGeek.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';" />
																<span class="facepile-item-coin-text durable-image-fallback facepile-item-blue" aria-hidden="true">D</span>
															</a>
														</li>
														<li class="facepile-item">
															<a href="https://github.com/GrantMeStrength" title="GrantMeStrength" aria-label="GrantMeStrengthGithub 个人资料" data-src="https://github.com/GrantMeStrength.png?size=32" data-contributor-name="GrantMeStrength" class="facepile-item-coin">
																<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/GrantMeStrength.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';" />
																<span class="facepile-item-coin-text durable-image-fallback facepile-item-teal" aria-hidden="true">G</span>
															</a>
														</li>
														<li class="facepile-item">
															<a href="https://github.com/AlexGuteniev" title="AlexGuteniev" aria-label="AlexGutenievGithub 个人资料" data-src="https://github.com/AlexGuteniev.png?size=32" data-contributor-name="AlexGuteniev" class="facepile-item-coin">
																<img class="facepile-item-coin-image durable-image" aria-hidden="true" src="https://github.com/AlexGuteniev.png?size=32" role="presentation" onerror="this.className='facepile-item-coin-image durable-image has-error';" />
																<span class="facepile-item-coin-text durable-image-fallback facepile-item-red" aria-hidden="true">A</span>
															</a>
														</li>
											<li class="facepile-item">
													<button aria-label="查看所有参与者" class="facepile-item-more" title="查看所有参与者">
														<div class="facepile-item-coin" aria-hidden="true">
															<span class="facepile-item-coin-text" aria-hidden="true">
																+3
															</span>
														</div>
													</button>
											</li>
									</ul>
								</li>
						</ul>

						<nav id="center-doc-outline" class="doc-outline is-hidden-desktop" data-bi-name="intopic toc" role="navigation" aria-label="文章大纲">
							<h3>本文内容</h3>
						<ol><li><a href="#example">Example</a></li><li><a href="#syntax">Syntax</a></li><li><a href="#parameters">Parameters</a></li><li><a href="#return-value">Return value</a></li><li><a href="#remarks">Remarks</a></li><li><a href="#requirements">Requirements</a></li><li><a href="#see-also">See also</a></li></ol></nav>

						<!-- <content> -->
							<p>An optional entry point into a dynamic-link library (DLL). When the system starts or terminates a process or thread, it calls the entry-point function for each loaded DLL using the first thread of the process. The system also calls the entry-point function for a DLL when it is loaded or unloaded using the <a href="/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya" data-linktype="absolute-path"><strong>LoadLibrary</strong></a> and <a href="/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary" data-linktype="absolute-path"><strong>FreeLibrary</strong></a> functions.</p>
<h2 id="example" class="heading-anchor"><a class="anchor-link docon docon-link" href="#example" aria-labelledby="example"></a>Example</h2>
<div class="codeHeader" id="code-try-0" data-bi-name="code-header"><span class="language">C++</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="复制代码">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>复制</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-large">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-cpp" data-author-content="BOOL WINAPI DllMain(&#10;    HINSTANCE hinstDLL,  // handle to DLL module&#10;    DWORD fdwReason,     // reason for calling function&#10;    LPVOID lpReserved )  // reserved&#10;{&#10;    // Perform actions based on the reason for calling.&#10;    switch( fdwReason ) &#10;    { &#10;        case DLL_PROCESS_ATTACH:&#10;         // Initialize once for each new process.&#10;         // Return FALSE to fail DLL load.&#10;            break;&#10;&#10;        case DLL_THREAD_ATTACH:&#10;         // Do thread-specific initialization.&#10;            break;&#10;&#10;        case DLL_THREAD_DETACH:&#10;         // Do thread-specific cleanup.&#10;            break;&#10;&#10;        case DLL_PROCESS_DETACH:&#10;         // Perform any necessary cleanup.&#10;            break;&#10;    }&#10;    return TRUE;  // Successful DLL_PROCESS_ATTACH.&#10;}&#10;"><span><span class="hljs-function">BOOL WINAPI <span class="hljs-title">DllMain</span><span class="hljs-params">(
    HINSTANCE hinstDLL,  <span class="hljs-comment">// handle to DLL module</span>
    DWORD fdwReason,     <span class="hljs-comment">// reason for calling function</span>
    LPVOID lpReserved )</span>  <span class="hljs-comment">// reserved</span>
</span>{
    <span class="hljs-comment">// Perform actions based on the reason for calling.</span>
    <span class="hljs-keyword">switch</span>( fdwReason ) 
    { 
        <span class="hljs-keyword">case</span> DLL_PROCESS_ATTACH:
         <span class="hljs-comment">// Initialize once for each new process.</span>
         <span class="hljs-comment">// Return FALSE to fail DLL load.</span>
            <span class="hljs-keyword">break</span>;

        <span class="hljs-keyword">case</span> DLL_THREAD_ATTACH:
         <span class="hljs-comment">// Do thread-specific initialization.</span>
            <span class="hljs-keyword">break</span>;

        <span class="hljs-keyword">case</span> DLL_THREAD_DETACH:
         <span class="hljs-comment">// Do thread-specific cleanup.</span>
            <span class="hljs-keyword">break</span>;

        <span class="hljs-keyword">case</span> DLL_PROCESS_DETACH:
         <span class="hljs-comment">// Perform any necessary cleanup.</span>
            <span class="hljs-keyword">break</span>;
    }
    <span class="hljs-keyword">return</span> TRUE;  <span class="hljs-comment">// Successful DLL_PROCESS_ATTACH.</span>
}
</span></code></pre>
<p>This is an example from the <a href="dynamic-link-library-entry-point-function" data-linktype="relative-path">Dynamic-Link Library Entry-Point Function</a>.</p>
<div class="alert is-warning">
<p class="alert-title"><span class="docon docon-status-warning-outline" aria-hidden="true"></span> 警告</p>
<p>There are significant limits on what you can safely do in a DLL entry point. See <a href="dynamic-link-library-best-practices" data-linktype="relative-path">General Best Practices</a> for specific Windows APIs that are unsafe to call in DllMain. If you need anything but the simplest initialization then do that in an initialization function for the DLL. You can require applications to call the initialization function after DllMain has run and before they call any other functions in the DLL.</p>
</div>
<h2 id="syntax" class="heading-anchor"><a class="anchor-link docon docon-link" href="#syntax" aria-labelledby="syntax"></a>Syntax</h2>
<div class="codeHeader" id="code-try-1" data-bi-name="code-header"><span class="language">C++</span><button type="button" class="action is-relative" data-bi-name="copy" aria-label="复制代码">
				<span class="icon">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>复制</span>
				<div class="successful-copy-alert is-absolute has-right-zero has-top-zero has-left-zero has-bottom-zero is-flex has-flex-align-items-center has-flex-justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon is-size-large">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code class="lang-C++" data-author-content="BOOL WINAPI DllMain(&#10;  _In_ HINSTANCE hinstDLL,&#10;  _In_ DWORD     fdwReason,&#10;  _In_ LPVOID    lpvReserved&#10;);&#10;"><span><span class="hljs-function">BOOL WINAPI <span class="hljs-title">DllMain</span><span class="hljs-params">(
  _In_ HINSTANCE hinstDLL,
  _In_ DWORD     fdwReason,
  _In_ LPVOID    lpvReserved
)</span></span>;
</span></code></pre>
<h2 id="parameters" class="heading-anchor"><a class="anchor-link docon docon-link" href="#parameters" aria-labelledby="parameters"></a>Parameters</h2>
<dl> <dt>
<p><em>hinstDLL</em> [in]</p>
</dt> <dd>
<p>A handle to the DLL module. The value is the base address of the DLL. The <strong>HINSTANCE</strong> of a DLL is the same as the <strong>HMODULE</strong> of the DLL, so <em>hinstDLL</em> can be used in calls to functions that require a module handle.</p>
</dd> <dt>
<p><em>fdwReason</em> [in]</p>
</dt> <dd>
<p>The reason code that indicates why the DLL entry-point function is being called. This parameter can be one of the following values.</p>
<div class="table-scroll-wrapper"><table class="table"><caption class="visually-hidden">表 1</caption>
<thead>
<tr>
<th>Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><span id="DLL_PROCESS_ATTACH"></span><span id="dll_process_attach"></span><dl> <dt><strong>DLL_PROCESS_ATTACH</strong></dt> <dt>1</dt> </dl></td>
<td>The DLL is being loaded into the virtual address space of the current process as a result of the process starting up or as a result of a call to <a href="/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya" data-linktype="absolute-path"><strong>LoadLibrary</strong></a>. DLLs can use this opportunity to initialize any instance data or to use the <a href="/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-tlsalloc" data-linktype="absolute-path"><strong>TlsAlloc</strong></a> function to allocate a thread local storage (TLS) index.<br /> The <em>lpReserved</em> parameter indicates whether the DLL is being loaded statically or dynamically.<br /></td>
</tr>
<tr>
<td><span id="DLL_PROCESS_DETACH"></span><span id="dll_process_detach"></span><dl> <dt><strong>DLL_PROCESS_DETACH</strong></dt> <dt>0</dt> </dl></td>
<td>The DLL is being unloaded from the virtual address space of the calling process because it was loaded unsuccessfully or the reference count has reached zero (the processes has either terminated or called <a href="/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary" data-linktype="absolute-path"><strong>FreeLibrary</strong></a> one time for each time it called <a href="/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya" data-linktype="absolute-path"><strong>LoadLibrary</strong></a>).<br /> The <em>lpReserved</em> parameter indicates whether the DLL is being unloaded as a result of a <a href="/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary" data-linktype="absolute-path"><strong>FreeLibrary</strong></a> call, a failure to load, or process termination.<br /> The DLL can use this opportunity to call the <a href="/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-tlsfree" data-linktype="absolute-path"><strong>TlsFree</strong></a> function to free any TLS indices allocated by using <a href="/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-tlsalloc" data-linktype="absolute-path"><strong>TlsAlloc</strong></a> and to free any thread local data.<br /> Note that the thread that receives the <strong>DLL_PROCESS_DETACH</strong> notification is not necessarily the same thread that received the <strong>DLL_PROCESS_ATTACH</strong> notification.<br /></td>
</tr>
<tr>
<td><span id="DLL_THREAD_ATTACH"></span><span id="dll_thread_attach"></span><dl> <dt><strong>DLL_THREAD_ATTACH</strong></dt> <dt>2</dt> </dl></td>
<td>The current process is creating a new thread. When this occurs, the system calls the entry-point function of all DLLs currently attached to the process. The call is made in the context of the new thread. DLLs can use this opportunity to initialize a TLS slot for the thread. A thread calling the DLL entry-point function with <strong>DLL_PROCESS_ATTACH</strong> does not call the DLL entry-point function with <strong>DLL_THREAD_ATTACH</strong>. <br /> Note that a DLL's entry-point function is called with this value only by threads created after the DLL is loaded by the process. When a DLL is loaded using <a href="/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya" data-linktype="absolute-path"><strong>LoadLibrary</strong></a>, existing threads do not call the entry-point function of the newly loaded DLL.<br /></td>
</tr>
<tr>
<td><span id="DLL_THREAD_DETACH"></span><span id="dll_thread_detach"></span><dl> <dt><strong>DLL_THREAD_DETACH</strong></dt> <dt>3</dt> </dl></td>
<td>A thread is exiting cleanly. If the DLL has stored a pointer to allocated memory in a TLS slot, it should use this opportunity to free the memory. The system calls the entry-point function of all currently loaded DLLs with this value. The call is made in the context of the exiting thread.<br /></td>
</tr>
</tbody>
</table></div>
</dd> <dt>
<p><em>lpvReserved</em> [in]</p>
</dt> <dd>
<p>If <em>fdwReason</em> is <strong>DLL_PROCESS_ATTACH</strong>, <em>lpvReserved</em> is <strong>NULL</strong> for dynamic loads and non-NULL for static loads.</p>
<p>If <em>fdwReason</em> is <strong>DLL_PROCESS_DETACH</strong>, <em>lpvReserved</em> is <strong>NULL</strong> if <a href="/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary" data-linktype="absolute-path"><strong>FreeLibrary</strong></a> has been called or the DLL load failed and non-<strong>NULL</strong> if the process is terminating.</p>
</dd> </dl>
<h2 id="return-value" class="heading-anchor"><a class="anchor-link docon docon-link" href="#return-value" aria-labelledby="return-value"></a>Return value</h2>
<p>When the system calls the <strong>DllMain</strong> function with the <strong>DLL_PROCESS_ATTACH</strong> value, the function returns <strong>TRUE</strong> if it succeeds or <strong>FALSE</strong> if initialization fails. If the return value is <strong>FALSE</strong> when <strong>DllMain</strong> is called because the process uses the <a href="/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya" data-linktype="absolute-path"><strong>LoadLibrary</strong></a> function, <strong>LoadLibrary</strong> returns NULL. (The system immediately calls your entry-point function with <strong>DLL_PROCESS_DETACH</strong> and unloads the DLL.) If the return value is <strong>FALSE</strong> when <strong>DllMain</strong> is called during process initialization, the process terminates with an error. To get extended error information, call <a href="/en-us/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror" data-linktype="absolute-path"><strong>GetLastError</strong></a>.</p>
<p>When the system calls the <strong>DllMain</strong> function with any value other than <strong>DLL_PROCESS_ATTACH</strong>, the return value is ignored.</p>
<h2 id="remarks" class="heading-anchor"><a class="anchor-link docon docon-link" href="#remarks" aria-labelledby="remarks"></a>Remarks</h2>
<p><strong>DllMain</strong> is a placeholder for the library-defined function name. You must specify the actual name you use when you build your DLL. For more information, see the documentation included with your development tools.</p>
<p>During initial process startup or after a call to <a href="/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya" data-linktype="absolute-path"><strong>LoadLibrary</strong></a>, the system scans the list of loaded DLLs for the process. For each DLL that has not already been called with the <strong>DLL_PROCESS_ATTACH</strong> value, the system calls the DLL's entry-point function. This call is made in the context of the thread that caused the process address space to change, such as the primary thread of the process or the thread that called <strong>LoadLibrary</strong>. Access to the entry point is serialized by the system on a process-wide basis. Threads in <em>DllMain</em> hold the loader lock so no additional DLLs can be dynamically loaded or initialized.</p>
<p>If the DLL's entry-point function returns FALSE following a <strong>DLL_PROCESS_ATTACH</strong> notification, it receives a <strong>DLL_PROCESS_DETACH</strong> notification and the DLL is unloaded immediately. However, if the <strong>DLL_PROCESS_ATTACH</strong> code throws an exception, the entry-point function will not receive the <strong>DLL_PROCESS_DETACH</strong> notification.</p>
<p>There are cases in which the entry-point function is called for a terminating thread even if the entry-point function was never called with <strong>DLL_THREAD_ATTACH</strong> for the thread:</p>
<ul>
<li>The thread was the initial thread in the process, so the system called the entry-point function with the <strong>DLL_PROCESS_ATTACH</strong> value.</li>
<li>The thread was already running when a call to the <a href="/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya" data-linktype="absolute-path"><strong>LoadLibrary</strong></a> function was made, so the system never called the entry-point function for it.</li>
</ul>
<p>When a DLL is unloaded from a process as a result of an unsuccessful load of the DLL, termination of the process, or a call to <a href="/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary" data-linktype="absolute-path"><strong>FreeLibrary</strong></a>, the system does not call the DLL's entry-point function with the <strong>DLL_THREAD_DETACH</strong> value for the individual threads of the process. The DLL is only sent a <strong>DLL_PROCESS_DETACH</strong> notification. DLLs can take this opportunity to clean up all resources for all threads known to the DLL.</p>
<p>When handling <strong>DLL_PROCESS_DETACH</strong>, a DLL should free resources such as heap memory only if the DLL is being unloaded dynamically (the <em>lpReserved</em> parameter is <strong>NULL</strong>). If the process is terminating (the <em>lpvReserved</em> parameter is non-<strong>NULL</strong>), all threads in the process except the current thread either have exited already or have been explicitly terminated by a call to the <a href="/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-exitprocess" data-linktype="absolute-path"><strong>ExitProcess</strong></a> function, which might leave some process resources such as heaps in an inconsistent state. In this case, it is not safe for the DLL to clean up the resources. Instead, the DLL should allow the operating system to reclaim the memory.</p>
<p>If you terminate a process by calling <a href="/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-terminateprocess" data-linktype="absolute-path"><strong>TerminateProcess</strong></a> or <a href="/en-us/windows/desktop/api/jobapi2/nf-jobapi2-terminatejobobject" data-linktype="absolute-path"><strong>TerminateJobObject</strong></a>, the DLLs of that process do not receive <strong>DLL_PROCESS_DETACH</strong> notifications. If you terminate a thread by calling <a href="/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-terminatethread" data-linktype="absolute-path"><strong>TerminateThread</strong></a>, the DLLs of that thread do not receive <strong>DLL_THREAD_DETACH</strong> notifications.</p>
<p>The entry-point function should perform only simple initialization or termination tasks. It must not call the <a href="/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya" data-linktype="absolute-path"><strong>LoadLibrary</strong></a> or <a href="/en-us/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa" data-linktype="absolute-path"><strong>LoadLibraryEx</strong></a> function (or a function that calls these functions), because this may create dependency loops in the DLL load order. This can result in a DLL being used before the system has executed its initialization code. Similarly, the entry-point function must not call the <a href="/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary" data-linktype="absolute-path"><strong>FreeLibrary</strong></a> function (or a function that calls <strong>FreeLibrary</strong>) during process termination, because this can result in a DLL being used after the system has executed its termination code.</p>
<p>Because Kernel32.dll is guaranteed to be loaded in the process address space when the entry-point function is called, calling functions in Kernel32.dll does not result in the DLL being used before its initialization code has been executed. Therefore, the entry-point function can call functions in Kernel32.dll that do not load other DLLs. For example, <em>DllMain</em> can create <a href="/en-us/windows/desktop/Sync/synchronization-objects" data-linktype="absolute-path">synchronization objects</a> such as critical sections and mutexes, and use TLS. Unfortunately, there is not a comprehensive list of safe functions in Kernel32.dll.</p>
<p>Calling functions that require DLLs other than Kernel32.dll may result in problems that are difficult to diagnose. For example, calling User, Shell, and COM functions can cause access violation errors, because some functions load other system components. Conversely, calling functions such as these during termination can cause access violation errors because the corresponding component may already have been unloaded or uninitialized.</p>
<p>Because DLL notifications are serialized, entry-point functions should not attempt to communicate with other threads or processes. Deadlocks may occur as a result.</p>
<p>For information on best practices when writing a DLL, see <a href="/en-us/windows/win32/dlls/dynamic-link-library-best-practices" data-linktype="absolute-path">https://docs.microsoft.com/windows/win32/dlls/dynamic-link-library-best-practices</a>.</p>
<p>If your DLL is linked with the C run-time library (CRT), the entry point provided by the CRT calls the constructors and destructors for global and static C++ objects. Therefore, these restrictions for <em>DllMain</em> also apply to constructors and destructors and any code that is called from them.</p>
<p>Consider calling <a href="/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-disablethreadlibrarycalls" data-linktype="absolute-path"><strong>DisableThreadLibraryCalls</strong></a> when receiving <strong>DLL_PROCESS_ATTACH</strong>, unless your DLL is linked with static C run-time library (CRT).</p>
<h2 id="requirements" class="heading-anchor"><a class="anchor-link docon docon-link" href="#requirements" aria-labelledby="requirements"></a>Requirements</h2>
<div class="table-scroll-wrapper"><table class="table"><caption class="visually-hidden">Requirements</caption>
<thead>
<tr>
<th>Requirement</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minimum supported client<br /></td>
<td>Windows XP [desktop apps only]<br /></td>
</tr>
<tr>
<td>Minimum supported server<br /></td>
<td>Windows Server 2003 [desktop apps only]<br /></td>
</tr>
<tr>
<td>Header<br /></td>
<td><dl> <dt>Process.h</dt> </dl></td>
</tr>
</tbody>
</table></div>
<h2 id="see-also" class="heading-anchor"><a class="anchor-link docon docon-link" href="#see-also" aria-labelledby="see-also"></a>See also</h2>
<dl> <dt>
<p><a href="dynamic-link-library-entry-point-function" data-linktype="relative-path">Dynamic-Link Library Entry-Point Function</a></p>
</dt> <dt>
<p><a href="dynamic-link-library-functions" data-linktype="relative-path">Dynamic-Link Library Functions</a></p>
</dt> <dt>
<p><a href="/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary" data-linktype="absolute-path"><strong>FreeLibrary</strong></a></p>
</dt> <dt>
<p><a href="/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-getmodulefilenamea" data-linktype="absolute-path"><strong>GetModuleFileName</strong></a></p>
</dt> <dt>
<p><a href="/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya" data-linktype="absolute-path"><strong>LoadLibrary</strong></a></p>
</dt> <dt>
<p><a href="/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-tlsalloc" data-linktype="absolute-path"><strong>TlsAlloc</strong></a></p>
</dt> <dt>
<p><a href="/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-tlsfree" data-linktype="absolute-path"><strong>TlsFree</strong></a></p>
</dt> <dt>
<p><a href="/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-disablethreadlibrarycalls" data-linktype="absolute-path"><strong>DisableThreadLibraryCalls</strong></a></p>
</dt> </dl>

						<!-- </content> -->

						</main>

						<!-- page rating section -->
								<div class="is-hidden-desktop has-border-top has-margin-top-large has-padding-top-small">
									
									
<div class="feedback-verbatim has-border-bottom has-padding-bottom-small has-margin-bottom-small" data-bi-name="rating">
    <div class="binary-rating">
        <div class="binary-rating-buttons">
            <h3 class="has-text-weight-semibold has-margin-top-none has-margin-bottom-small">此页面有帮助吗?</h3>
            <div>
                <button class="thumb-rating like has-inner-focus has-padding-left-extra-small has-padding-right-extra-small" title="是" data-bi-name="rating-yes" aria-expanded="false" data-bi-sat="1" aria-controls="rating-container-mobile">
                    <span aria-hidden="true" class="icon docon docon-like"></span>
                    <span>是</span>
                </button>
                <button class="thumb-rating dislike has-inner-focus has-padding-none has-padding-right-extra-small" title="否" data-bi-name="rating-no" data-bi-sat="0" aria-expanded="false" aria-controls="rating-container-mobile">
                    <span aria-hidden="true" class="icon docon docon-dislike"></span>
                    <span>否</span>
                </button>
            </div>
        </div>
        <form class="feedback-verbatim-form is-hidden" id="rating-container-mobile">
            <div class="verbatim-textarea box is-relative has-box-shadow-none has-border has-margin-top-small has-padding-extra-small is-size-extra-small">
                <label for="rating-textarea-mobile" class="visually-hidden">还有其他反馈吗？</label>
                <textarea id="rating-textarea-mobile" rows="4" maxlength="999" placeholder="还有其他反馈吗？" required="" class="textarea has-border-none has-box-shadow-none has-inner-focus"></textarea>
            </div>
            <div class="buttons is-right has-margin-top-medium has-margin-right-extra-small">
                <button class="skip-rating button is-transparent has-text-primary is-small has-border-none" type="button">跳过</button>
                <button class="submit-rating button is-primary is-small" data-bi-name="rating-verbatim" disabled="" type="submit">提交</button>
            </div>
        </form>
    </div>
    <div class="thankyou-rating is-hidden" tabindex="-1">
        <p>谢谢。</p>
    </div>
</div>								</div>
						<!-- end page rating section -->


						<!-- recommendations section -->
						<!-- end recommendations section -->

						<!-- feedback section -->
						<!-- end feedback section -->

						<!-- feedback report section -->
						<!-- end feedback report section -->

						<div class="footerContainer is-visible-interactive has-default-focus ">



	<footer id="footer-interactive" data-bi-name="footer" class="footer-layout">

    <div class="is-flex is-full-height has-padding-right-extra-large-desktop">
			<a data-mscc-ic="false" class="locale-selector-link has-flex-shrink-none" href="/zh-cn/locale?target=https://docs.microsoft.com/zh-cn/windows/win32/dlls/dllmain?redirectedfrom=MSDN" data-bi-name="select-locale"><span class="icon docon docon-world is-size-large has-margin-right-small" aria-hidden="true"></span><span class="local-selector-link-text">中文 (简体)</span></a>
		<div class="has-margin-left-medium has-margin-right-medium has-flex-shrink-none">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button is-transparent is-small is-icon-only-touch has-inner-focus theme-dropdown-trigger" aria-controls="theme-menu-interactive" aria-expanded="false" title="主题" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>主题</span>
	</button>
	<div class="dropdown-menu" id="theme-menu-interactive" role="menu">
		<ul class="theme-selector has-padding-small">
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth has-flex-justify-content-start is-selected" data-theme-to="light" aria-pressed="true">
					<span class="theme-light has-margin-right-small">
						<span class="theme-selector-icon css-variable-support has-border is-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"/>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"/>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"/>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"/>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"/>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"/>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"/>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"/>
							</svg>
						</span>
					</span>
					<span role="menuitem">
亮					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth has-flex-justify-content-start" data-theme-to="dark" aria-pressed="false">
					<span class="theme-dark has-margin-right-small">
						<span class="has-border theme-selector-icon css-variable-support is-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"/>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"/>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"/>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"/>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"/>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"/>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"/>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"/>
							</svg>
						</span>
					</span>
					<span role="menuitem">
暗					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth has-flex-justify-content-start" data-theme-to="high-contrast" aria-pressed="false">
					<span class="theme-high-contrast has-margin-right-small">
						<span class="has-border theme-selector-icon css-variable-support is-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"/>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"/>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"/>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"/>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"/>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"/>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"/>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"/>
							</svg>
						</span>
					</span>
					<span role="menuitem">
高对比度					</span>
				</button>
			</li>
		</ul>
	</div>
</div>		</div>
	</div>
    <ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden=""></li>
			<li><a data-mscc-ic="false" href="https://docs.microsoft.com/zh-cn/previous-versions/" data-bi-name="archivelink">旧版文档</a></li>
			<li><a data-mscc-ic="false" href="https://docs.microsoft.com/zh-cn/teamblog" data-bi-name="bloglink">博客</a></li>
			<li><a data-mscc-ic="false" href="https://docs.microsoft.com/zh-cn/contribute" data-bi-name="contributorGuide">参与</a></li>
				<li><a data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">隐私和 Cookie</a></li>
			<li><a data-mscc-ic="false" href="https://docs.microsoft.com/zh-cn/legal/termsofuse" data-bi-name="termsofuse">使用条款</a></li>
				<li><a data-mscc-ic="false" href="https://aka.ms/sitefeedback" data-bi-name="feedback">网站反馈</a></li>
			<li><a data-mscc-ic="false" href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-bi-name="trademarks">商标</a></li>
		<li>© Microsoft 2020</li>
    </ul>
</footer>
						</div>
					</div>

					<div class="is-size-small right-container column is-one-quarter is-one-fifth-desktop is-hidden-mobile is-hidden-tablet-only" data-bi-name="pageactions" role="complementary" aria-label="页面操作">
						<div id="affixed-right-container" class="doc-outline is-fixed is-vertically-scrollable" style="top: 225.5px; bottom: 24px;">
								
								
<div class="feedback-verbatim has-border-bottom has-padding-bottom-small has-margin-bottom-small" data-bi-name="rating">
    <div class="binary-rating">
        <div class="binary-rating-buttons">
            <h3 class="has-text-weight-semibold has-margin-top-none has-margin-bottom-small">此页面有帮助吗?</h3>
            <div>
                <button class="thumb-rating like has-inner-focus has-padding-left-extra-small has-padding-right-extra-small" title="是" data-bi-name="rating-yes" aria-expanded="false" data-bi-sat="1" aria-controls="rating-container-desktop">
                    <span aria-hidden="true" class="icon docon docon-like"></span>
                    <span>是</span>
                </button>
                <button class="thumb-rating dislike has-inner-focus has-padding-none has-padding-right-extra-small" title="否" data-bi-name="rating-no" data-bi-sat="0" aria-expanded="false" aria-controls="rating-container-desktop">
                    <span aria-hidden="true" class="icon docon docon-dislike"></span>
                    <span>否</span>
                </button>
            </div>
        </div>
        <form class="feedback-verbatim-form is-hidden" id="rating-container-desktop">
            <div class="verbatim-textarea box is-relative has-box-shadow-none has-border has-margin-top-small has-padding-extra-small is-size-extra-small">
                <label for="rating-textarea-desktop" class="visually-hidden">还有其他反馈吗？</label>
                <textarea id="rating-textarea-desktop" rows="4" maxlength="999" placeholder="还有其他反馈吗？" required="" class="textarea has-border-none has-box-shadow-none has-inner-focus"></textarea>
            </div>
            <div class="buttons is-right has-margin-top-medium has-margin-right-extra-small">
                <button class="skip-rating button is-transparent has-text-primary is-small has-border-none" type="button">跳过</button>
                <button class="submit-rating button is-primary is-small" data-bi-name="rating-verbatim" disabled="" type="submit">提交</button>
            </div>
        </form>
    </div>
    <div class="thankyou-rating is-hidden" tabindex="-1">
        <p>谢谢。</p>
    </div>
</div>							<nav id="side-doc-outline" data-bi-name="intopic toc" role="navigation" aria-label="文章大纲">
								<h3>本文内容</h3>
							<ol><li class="selected"><a href="#example">Example</a></li><li><a href="#syntax">Syntax</a></li><li><a href="#parameters">Parameters</a></li><li><a href="#return-value">Return value</a></li><li><a href="#remarks">Remarks</a></li><li><a href="#requirements">Requirements</a></li><li><a href="#see-also">See also</a></li></ol></nav>
						</div>
					</div>

					<!--end of div.columns -->
				</div>

			<!--end of .primary-holder -->
			</section>

			<aside id="interactive-container" class="interactive-container is-visible-interactive column has-body-background-dark ">
			</aside>
		</div>

		<!--end of .mainContainer -->
	</div>

	<div id="openFeedbackContainer" class="openfeedback-container"></div>

	<div class="footerContainer has-default-focus is-hidden-interactive ">



	<footer id="footer" data-bi-name="footer" class="footer-layout uhf-container has-padding" role="contentinfo">

    <div class="is-flex is-full-height has-padding-right-extra-large-desktop">
			<a data-mscc-ic="false" class="locale-selector-link has-flex-shrink-none" href="/zh-cn/locale?target=https://docs.microsoft.com/zh-cn/windows/win32/dlls/dllmain?redirectedfrom=MSDN" data-bi-name="select-locale"><span class="icon docon docon-world is-size-large has-margin-right-small" aria-hidden="true"></span><span class="local-selector-link-text">中文 (简体)</span></a>
		<div class="has-margin-left-medium has-margin-right-medium has-flex-shrink-none">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button is-transparent is-small is-icon-only-touch has-inner-focus theme-dropdown-trigger" aria-controls="theme-menu" aria-expanded="false" title="主题" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>主题</span>
	</button>
	<div class="dropdown-menu" id="theme-menu" role="menu">
		<ul class="theme-selector has-padding-small">
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth has-flex-justify-content-start is-selected" data-theme-to="light" aria-pressed="true">
					<span class="theme-light has-margin-right-small">
						<span class="theme-selector-icon css-variable-support has-border is-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"/>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"/>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"/>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"/>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"/>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"/>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"/>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"/>
							</svg>
						</span>
					</span>
					<span role="menuitem">
亮					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth has-flex-justify-content-start" data-theme-to="dark" aria-pressed="false">
					<span class="theme-dark has-margin-right-small">
						<span class="has-border theme-selector-icon css-variable-support is-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"/>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"/>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"/>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"/>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"/>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"/>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"/>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"/>
							</svg>
						</span>
					</span>
					<span role="menuitem">
暗					</span>
				</button>
			</li>
			<li class="theme is-block">
				<button class="button is-text is-small theme-control is-fullwidth has-flex-justify-content-start" data-theme-to="high-contrast" aria-pressed="false">
					<span class="theme-high-contrast has-margin-right-small">
						<span class="has-border theme-selector-icon css-variable-support is-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"/>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"/>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"/>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"/>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"/>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"/>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"/>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"/>
							</svg>
						</span>
					</span>
					<span role="menuitem">
高对比度					</span>
				</button>
			</li>
		</ul>
	</div>
</div>		</div>
	</div>
    <ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden=""></li>
			<li><a data-mscc-ic="false" href="https://docs.microsoft.com/zh-cn/previous-versions/" data-bi-name="archivelink">旧版文档</a></li>
			<li><a data-mscc-ic="false" href="https://docs.microsoft.com/zh-cn/teamblog" data-bi-name="bloglink">博客</a></li>
			<li><a data-mscc-ic="false" href="https://docs.microsoft.com/zh-cn/contribute" data-bi-name="contributorGuide">参与</a></li>
				<li><a data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">隐私和 Cookie</a></li>
			<li><a data-mscc-ic="false" href="https://docs.microsoft.com/zh-cn/legal/termsofuse" data-bi-name="termsofuse">使用条款</a></li>
				<li><a data-mscc-ic="false" href="https://aka.ms/sitefeedback" data-bi-name="feedback">网站反馈</a></li>
			<li><a data-mscc-ic="false" href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-bi-name="trademarks">商标</a></li>
		<li>© Microsoft 2020</li>
    </ul>
</footer>
	</div>

	<div id="action-panel" role="region" aria-label="操作面板" class="action-panel has-default-focus" tabindex="-1"></div>


<div class="usabilla_live_button_container" role="button" tabindex="0" style="margin-top: 0px; position: fixed; width: 0px; height: 0px; z-index: 99999990; right: 0px; top: 50%; display: none;" aria-label="Usabilla Feedback Button"><iframe src="" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" data-tags="right" title="Usabilla Feedback Button" style="width: 0px; height: 0px; margin: 0px; padding: 0px; border: 0px; overflow: hidden; z-index: 9998; position: absolute; left: 0px; top: 0px; box-shadow: 0px 0px 0px; background-color: transparent;"></iframe></div></body></html>