---
title : 自动快照存档
---

* TIME: 2021-03-02 11:10:07
* URL: <https://github.com/shinchiro/mpv-winbuild-cmake>

-----

Skip to content

[ ](https://github.com/)

[ Sign up
](/join?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-
name%3E%2F%3Crepo-name%3E&source=header-repo)

  * Why GitHub? 

[Features →](/features)

    * [Mobile →](/mobile)
    * [Actions →](/features/actions)
    * [Codespaces →](/features/codespaces)
    * [Packages →](/features/packages)
    * [Security →](/features/security)
    * [Code review →](/features/code-review/)
    * [Project management →](/features/project-management/)
    * [Integrations →](/features/integrations)
    * [GitHub Sponsors →](/sponsors)
    * [Customer stories→](/customer-stories)
    * [Security →](/security)

  * [Team](/team)
  * [Enterprise](/enterprise)
  * Explore 

    * [Explore GitHub →](/explore)

#### Learn and contribute

    * [Topics →](/topics)
    * [Collections →](/collections)
    * [Trending →](/trending)
    * [Learning Lab →](https://lab.github.com/)
    * [Open source guides →](https://opensource.guide)

#### Connect with others

    * [The ReadME Project →](https://github.com/readme)
    * [Events →](https://github.com/events)
    * [Community forum →](https://github.community)
    * [GitHub Education →](https://education.github.com)
    * [GitHub Stars program →](https://stars.github.com)

  * [Marketplace](/marketplace)
  * Pricing 

[Plans →](/pricing)

    * [Compare plans →](/pricing#feature-comparison)
    * [Contact Sales →](https://enterprise.github.com/contact)
    * [Nonprofit →](/nonprofit)
    * [Education →](https://education.github.com)

![](https://github.githubassets.com/images/search-key-slash.svg)

  * [ ![]() In this repository  All GitHub  ↵ Jump to ↵ ]()

  * No suggested jump to results

  * [ ![]() In this repository  All GitHub  ↵ Jump to ↵ ]()
  * [ ![]() In this user  All GitHub  ↵ Jump to ↵ ]()
  * [ ![]() In this repository  All GitHub  ↵ Jump to ↵ ]()

[ Sign in ](/login?return_to=%2Fshinchiro%2Fmpv-winbuild-cmake) [ Sign up
](/join?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-
name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=shinchiro%2Fmpv-
winbuild-cmake)

{{ message }}

#  [shinchiro](/shinchiro) / **[mpv-winbuild-cmake](/shinchiro/mpv-winbuild-
cmake) **

  * [ Notifications ](/login?return_to=%2Fshinchiro%2Fmpv-winbuild-cmake)
  * [ Star ](/login?return_to=%2Fshinchiro%2Fmpv-winbuild-cmake) [ 63 ](/shinchiro/mpv-winbuild-cmake/stargazers)
  * [ Fork ](/login?return_to=%2Fshinchiro%2Fmpv-winbuild-cmake) [ 19 ](/shinchiro/mpv-winbuild-cmake/network/members)

CMake-based MinGW-w64 Cross Toolchain

[ 63 stars ](/shinchiro/mpv-winbuild-cmake/stargazers) [ 19 forks
](/shinchiro/mpv-winbuild-cmake/network/members)

[ Star ](/login?return_to=%2Fshinchiro%2Fmpv-winbuild-cmake)

[ Notifications ](/login?return_to=%2Fshinchiro%2Fmpv-winbuild-cmake)

  * [ Code ](/shinchiro/mpv-winbuild-cmake)
  * [ Issues 2 ](/shinchiro/mpv-winbuild-cmake/issues)
  * [ Pull requests 0 ](/shinchiro/mpv-winbuild-cmake/pulls)
  * [ Actions ](/shinchiro/mpv-winbuild-cmake/actions)
  * [ Projects 0 ](/shinchiro/mpv-winbuild-cmake/projects)
  * [ Wiki ](/shinchiro/mpv-winbuild-cmake/wiki)
  * [ Security ](/shinchiro/mpv-winbuild-cmake/security)
  * [ Insights ](/shinchiro/mpv-winbuild-cmake/pulse)

More

  * [ Code ](/shinchiro/mpv-winbuild-cmake)
  * [ Issues ](/shinchiro/mpv-winbuild-cmake/issues)
  * [ Pull requests ](/shinchiro/mpv-winbuild-cmake/pulls)
  * [ Actions ](/shinchiro/mpv-winbuild-cmake/actions)
  * [ Projects ](/shinchiro/mpv-winbuild-cmake/projects)
  * [ Wiki ](/shinchiro/mpv-winbuild-cmake/wiki)
  * [ Security ](/shinchiro/mpv-winbuild-cmake/security)
  * [ Insights ](/shinchiro/mpv-winbuild-cmake/pulse)

master

Switch branches/tags

Branches Tags

Nothing to show

[ {{ refName }} default ](https://github.com/shinchiro/mpv-winbuild-
cmake/tree/{{ urlEncodedRefName }}) [View all branches](/shinchiro/mpv-
winbuild-cmake/branches)

Nothing to show

[ {{ refName }} default ](https://github.com/shinchiro/mpv-winbuild-
cmake/tree/{{ urlEncodedRefName }})

[View all tags](/shinchiro/mpv-winbuild-cmake/tags)

[ **1** branch ](/shinchiro/mpv-winbuild-cmake/branches) [ **0** tags
](/shinchiro/mpv-winbuild-cmake/tags)

[ Go to file ](/shinchiro/mpv-winbuild-cmake/find/master) Code

[ ](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone

HTTPS  GitHub CLI

Use Git or checkout with SVN using the web URL.

Work fast with our official CLI. [Learn more](https://cli.github.com).

  * [ Open with GitHub Desktop ](https://desktop.github.com)
  * [ Download ZIP ](/shinchiro/mpv-winbuild-cmake/archive/master.zip)

#### Launching GitHub Desktop

If nothing happens, [download GitHub Desktop](https://desktop.github.com/) and
try again.

Go back

#### Launching GitHub Desktop

If nothing happens, [download GitHub Desktop](https://desktop.github.com/) and
try again.

Go back

#### Launching Xcode

If nothing happens, [download Xcode](https://developer.apple.com/xcode/) and
try again.

Go back

#### Launching Visual Studio

If nothing happens, [download the GitHub extension for Visual
Studio](https://visualstudio.github.com/) and try again.

Go back

## Latest commit

[
![@garoto](https://avatars.githubusercontent.com/u/11768175?s=60&u=3571e13320f17a638643fb1784cd0a28a3ab6e16&v=4)
](/garoto)

[garoto](/shinchiro/mpv-winbuild-cmake/commits?author=garoto "View all commits
by garoto") [mpv: re-enable PDF build of the manual](/shinchiro/mpv-winbuild-
cmake/commit/63f1b80d996e31b71a50246a2e8860a5b97a757e "mpv: re-enable PDF
build of the manual

At this date, it builds successfully yet again")

…

[63f1b80](/shinchiro/mpv-winbuild-
cmake/commit/63f1b80d996e31b71a50246a2e8860a5b97a757e) [ 19 days ago
](/shinchiro/mpv-winbuild-
cmake/commit/63f1b80d996e31b71a50246a2e8860a5b97a757e)

[mpv: re-enable PDF build of the manual](/shinchiro/mpv-winbuild-
cmake/commit/63f1b80d996e31b71a50246a2e8860a5b97a757e)

    
    
    At this date, it builds successfully yet again

63f1b80

## Git stats

  * [ **1,046** commits  ](/shinchiro/mpv-winbuild-cmake/commits/master)

## Files

[Permalink](/shinchiro/mpv-winbuild-
cmake/tree/63f1b80d996e31b71a50246a2e8860a5b97a757e)

Failed to load latest commit information.

Type

Name

Latest commit message

Commit time

[packages](/shinchiro/mpv-winbuild-cmake/tree/master/packages "packages")

[mpv: re-enable PDF build of the manual](/shinchiro/mpv-winbuild-
cmake/commit/63f1b80d996e31b71a50246a2e8860a5b97a757e "mpv: re-enable PDF
build of the manual

At this date, it builds successfully yet again")

19 days ago

[scripts](/shinchiro/mpv-winbuild-cmake/tree/master/scripts "scripts")

[autobuild.sh: build only when mpv-* folder is not exist](/shinchiro/mpv-
winbuild-cmake/commit/052ddb96bbd9c49592a30a3477ccf16cd3567407 "autobuild.sh:
build only when mpv-* folder is not exist")

3 months ago

[toolchain](/shinchiro/mpv-winbuild-cmake/tree/master/toolchain "toolchain")

[gcc: update to 10.2.1+20210130](/shinchiro/mpv-winbuild-
cmake/commit/411a45f03496928c68021e66d3d38101f6d6eefc "gcc: update to
10.2.1+20210130")

last month

[.gitignore](/shinchiro/mpv-winbuild-cmake/blob/master/.gitignore
".gitignore")

[add .gitignore](/shinchiro/mpv-winbuild-
cmake/commit/dfbb9731d8f5db10829359a68f47fa927398e149 "add .gitignore")

3 years ago

[CMakeLists.txt](/shinchiro/mpv-winbuild-cmake/blob/master/CMakeLists.txt
"CMakeLists.txt")

[cmake: bump minimum version](/shinchiro/mpv-winbuild-
cmake/commit/11c102d7a981efb6d875d2cd05c195cb348924a2 "cmake: bump minimum
version")

12 months ago

[README.md](/shinchiro/mpv-winbuild-cmake/blob/master/README.md "README.md")

[gmp: update to 6.2.1](/shinchiro/mpv-winbuild-
cmake/commit/029a98c80326626f19fb051740409a0b426894be "gmp: update to 6.2.1")

last month

[debpatch](/shinchiro/mpv-winbuild-cmake/blob/master/debpatch "debpatch")

[lame: partially revert](/shinchiro/mpv-winbuild-
cmake/commit/e32312c42889f2f543f2462b54ecac6f6b3143c4 "lame: partially revert
a54bc19") [`a54bc19`](https://github.com/shinchiro/mpv-winbuild-
cmake/commit/a54bc19bedd3a6ebe2d785cc6482638bf4a4e1ec)

3 years ago

[exec.in](/shinchiro/mpv-winbuild-cmake/blob/master/exec.in "exec.in")

[exec: changed shebang line](/shinchiro/mpv-winbuild-
cmake/commit/59c5982f9341a598afac07e60b4f9fbc61a45395 "exec: changed shebang
line")

3 years ago

[meson_cross.txt.in](/shinchiro/mpv-winbuild-
cmake/blob/master/meson_cross.txt.in "meson_cross.txt.in")

[meson_cross: commented 'exe_wrapper'](/shinchiro/mpv-winbuild-
cmake/commit/8d0fc2af8911dcd32ae82a737f7fdce6a7824b19 "meson_cross: commented
'exe_wrapper'

since I dont want wine installed in build machine")

3 years ago

[toolchain.cmake.in](/shinchiro/mpv-winbuild-
cmake/blob/master/toolchain.cmake.in "toolchain.cmake.in")

[vulkan: add new hack to build vulkan git](/shinchiro/mpv-winbuild-
cmake/commit/27ce10608237e61685f7d8713f69d62a6ab47399 "vulkan: add new hack to
build vulkan git

Thanks khronos for making it even more harder to compile.")

2 years ago

View code

##  README.md

# CMake-based MinGW-w64 Cross Toolchain

This thing’s primary use is to build Windows binaries of mpv.

Alternatively, you can download the builds from
[here](https://sourceforge.net/projects/mpv-player-windows/files/).

## Prerequisites

  * You should also install Ninja and use CMake’s Ninja build file generator. It’s not only much faster than GNU Make, but also far less error-prone, which is important for this project because CMake’s ExternalProject module tends to generate makefiles which confuse GNU Make’s jobserver thingy.

  * As a build environment, any modern Linux distribution _should_ work.

  * Compiling on Cygwin / MSYS2 is supported, but it tends to be slower than compiling on Linux.

## Information about packages

  * Git/Hg

    * ANGLE
    * FFmpeg
    * xz
    * x264
    * x265 (multilib)
    * uchardet
    * rubberband
    * opus
    * openal-soft
    * mpv
    * luajit
    * libvpx
    * libwebp
    * libpng
    * libsoxr
    * libzimg
    * libdvdread
    * libdvdnav
    * libdvdcss
    * libbluray
    * libass
    * libmysofa
    * lcms2
    * lame
    * harfbuzz
    * game-music-emu
    * freetype2
    * flac
    * opus-tools
    * mujs
    * libarchive
    * libjpeg
    * shaderc (with spirv-headers, spirv-tools, glslang)
    * vulkan
    * spirv-cross
    * fribidi
    * nettle
    * curl
    * libxml2
    * amf-headers
    * avisynth-headers
    * nvcodec-headers
    * libmfx
    * megasdk (with termcap, readline, cryptopp, sqlite, libuv, libsodium)
    * aom
    * dav1d
    * libplacebo
    * fontconfig
    * libbs2b
    * libssh
  * Zip

    * expat (2.2.10)
    * bzip (1.0.8)
    * zlib (1.2.11)
    * xvidcore (1.3.7)
    * vorbis (1.3.7)
    * speex (1.2.0)
    * ogg (1.3.4)
    * lzo (2.10)
    * libmodplug (0.8.9.0)
    * libopenmpt (0.5.4)
    * libiconv (1.16)
    * gmp (6.2.1)
    * vapoursynth (R52)
    * libsdl2 (2.0.14)
    * libressl (3.1.2)

## Setup Build Environment

### Manjaro / Arch Linux

These packages need to be installed first before compiling mpv:

    
    
    pacman -S git gyp mercurial subversion ninja cmake meson ragel yasm nasm asciidoc enca gperf unzip p7zip gcc-multilib clang python-pip curl
    
    pip3 install rst2pdf mako
    

### Ubuntu Linux / WSL (Windows 10)

    
    
    apt-get install build-essential checkinstall bison flex gettext git mercurial subversion ninja-build gyp cmake yasm nasm automake pkg-config libtool libtool-bin gcc-multilib g++-multilib clang libgmp-dev libmpfr-dev libmpc-dev libgcrypt-dev gperf ragel texinfo autopoint re2c asciidoc python3-pip docbook2x unzip p7zip-full curl
    
    pip3 install rst2pdf meson mako
    

**Note:**

  * Use [apt-fast](https://github.com/ilikenwf/apt-fast) if apt-get is too slow.
  * It is advised to use bash over dash. Set `sudo ln -sf /bin/bash /bin/sh`. Revert back by `sudo ln -sf /bin/dash /bin/sh`.
  * On WSL platform, compiling 32bit require qemu. Refer to [this](https://github.com/Microsoft/WSL/issues/2468#issuecomment-374904520).
  * To update package installed by pip, run `pip3 install <package> --upgrade`.

### Cygwin

Download Cygwin installer and run:

    
    
    setup-x86_64.exe -R "C:\cygwin64" -q --packages="bash,binutils,bzip2,cygwin,gcc-core,gcc-g++,cygwin32-gcc-core,cygwin32-gcc-g++,gzip,m4,pkg-config,make,unzip,zip,diffutils,wget,git,patch,cmake,gperf,yasm,nasm,enca,asciidoc,bison,flex,gettext-devel,mercurial,python-devel,python-docutils,docbook2X,texinfo,libmpfr-devel,libgmp-devel,libmpc-devel,libtool,autoconf2.5,automake,automake1.9,libxml2-devel,libxslt-devel"
    

Additionally, some packages, `re2c`, `ninja`, `ragel`, `gyp`, `rst2pdf` need
to be [installed
manually](https://gist.github.com/shinchiro/705b0afcc7b6c0accffba1bedb067abf).

### MSYS2

Install MSYS2 and run it via `MSYS2 MSYS` shortcut. Don't use `MSYS2 MinGW
32-bit` or `MSYS2 MinGW 64-bit` shortcuts, that's important!

These packages need to be installed first before compiling mpv:

    
    
    pacman -S base-devel cmake gcc yasm nasm git mercurial subversion gyp tar gmp-devel mpc-devel mpfr-devel python zlib-devel unzip zip p7zip
    

Don't install anything from the `mingw32` and `mingw64` repositories, it's
better to completely disable them in `/etc/pacman.conf` just to be safe.

Additionally, some packages, `re2c`, `ninja`, `ragel`, `libjpeg`, `rst2pdf`
need to be [installed
manually](https://gist.github.com/shinchiro/705b0afcc7b6c0accffba1bedb067abf).

## Building Software (First Time)

To set up the build environment, create a directory to store build files in:

    
    
    mkdir build64
    cd build64
    

Once you’ve changed into that directory, run CMake, e.g.

    
    
    cmake -DTARGET_ARCH=x86_64-w64-mingw32 -G Ninja ..
    

or for 32bit:

    
    
    cmake -DTARGET_ARCH=i686-w64-mingw32 -G Ninja ..
    

First, you need to build toolchain. By default, it will be installed in
`install` folder. This take ~20 minutes on my 4-core machine.

    
    
    ninja gcc
    

After it done, you're ready to build mpv and all its dependencies:

    
    
    ninja mpv
    

This will take a while (about ~10 minutes on my machine).

The final `build64` folder's size will be around ~3GB.

## Building Software (Second Time)

To build mpv for a second time:

    
    
    ninja update
    

After that, build mpv as usual:

    
    
    ninja mpv
    

This will also build all packages that `mpv` depends on.

## Available Commands

  * **ninja package** -> compile a package

  * **ninja clean** -> remove all stamp files in all packages.

  * **ninja package-fullclean** -> Remove all stamp files of a package.

  * **ninja package-liteclean** -> Remove build, clean stamp files only. This will skip re-configure in next running `ninja package` (after first time compile). Updating repo or patching need to do manually. Ideally, all `DEPENDS` target in `package.cmake` should be temporarily commented or deleted. Might be useful in some case.

  * **ninja package-removebuild** -> Remove 'build' directory of a package.

  * **ninja update** -> Update all git repos. When a package pulling new changes, all of its stamp files will be deleted and will be force rebuild. If there is not changes, it will not remove the stamp files and not rebuild occur. Use this instead of `ninja clean` if you don't want rebuild everything in next run.

`package` is package's name found in `packages` folder.

## Acknowledgements

This project originally created and maintained
[lachs0r](https://github.com/lachs0r/mingw-w64-cmake). Since then, it heavily
modified to suit my own need.

## About

CMake-based MinGW-w64 Cross Toolchain

### Resources

Readme

##  [ Releases ](/shinchiro/mpv-winbuild-cmake/releases)

No releases published

##  [ Packages 0 ](/users/shinchiro/packages?repo_name=mpv-winbuild-cmake)

No packages published  

##  [ Contributors 16 ](/shinchiro/mpv-winbuild-cmake/graphs/contributors)

  * [ ![@shinchiro](https://avatars.githubusercontent.com/u/9623615?s=64&v=4) ](/shinchiro)
  * [ ![@mia-0](https://avatars.githubusercontent.com/u/652892?s=64&v=4) ](/mia-0)
  * [ ![@myfreeer](https://avatars.githubusercontent.com/u/17702502?s=64&v=4) ](/myfreeer)
  * [ ![@NotTsunami](https://avatars.githubusercontent.com/u/4589807?s=64&v=4) ](/NotTsunami)
  * [ ![@wiiaboo](https://avatars.githubusercontent.com/u/111605?s=64&v=4) ](/wiiaboo)
  * [ ![@mathstuf](https://avatars.githubusercontent.com/u/97253?s=64&v=4) ](/mathstuf)
  * [ ![@pavelxdd](https://avatars.githubusercontent.com/u/7561226?s=64&v=4) ](/pavelxdd)
  * [ ![@rossy](https://avatars.githubusercontent.com/u/162837?s=64&v=4) ](/rossy)
  * [ ![@nshtg](https://avatars.githubusercontent.com/u/5219415?s=64&v=4) ](/nshtg)
  * [ ![@amayra](https://avatars.githubusercontent.com/u/7657277?s=64&v=4) ](/amayra)
  * [ ![@chhe](https://avatars.githubusercontent.com/u/1743377?s=64&v=4) ](/chhe)

[ \+ 5 contributors ](/shinchiro/mpv-winbuild-cmake/graphs/contributors)

## Languages

  * [ CMake 69.1% ](/shinchiro/mpv-winbuild-cmake/search?l=cmake)
  * [ C 27.5% ](/shinchiro/mpv-winbuild-cmake/search?l=c)
  * [ Shell 3.4% ](/shinchiro/mpv-winbuild-cmake/search?l=shell)

  * © 2021 GitHub, Inc.
  * [Terms](https://github.com/site/terms)
  * [Privacy](https://github.com/site/privacy)
  * [Security](https://github.com/security)
  * [Status](https://www.githubstatus.com/)
  * [Docs](https://docs.github.com)

[ ](https://github.com "GitHub")

  * [Contact GitHub](https://support.github.com)
  * [Pricing](https://github.com/pricing)
  * [API](https://docs.github.com)
  * [Training](https://services.github.com)
  * [Blog](https://github.blog)
  * [About](https://github.com/about)

You can’t perform that action at this time.

You signed in with another tab or window. [Reload]() to refresh your session.
You signed out in another tab or window. [Reload]() to refresh your session.

