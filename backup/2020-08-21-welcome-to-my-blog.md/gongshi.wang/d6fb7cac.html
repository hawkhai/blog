<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><script src="https://hm.baidu.com/hm.js?d88c3d2ca47e455c320ae7d951a8d0ca"></script><script>
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?d88c3d2ca47e455c320ae7d951a8d0ca";
          var s = document.getElementsByTagName("script")[0]; 
          s.parentNode.insertBefore(hm, s);
        })();
    </script>
    
        <title>公式王 公式图片转Word格式</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
        <meta content="width=device-width, minimum-scale=1.0,maximum-scale=1, initial-scale=1, user-scalable=no" name="viewport" servergenerated="true" />
        <!-- 忽略页面中的数字识别为电话，忽略email识别 -->
        <meta content="telephone=no,email=no" name="format-detection" />
        <!-- 不让百度转码 -->
        <meta http-equiv="Cache-Control" content="no-siteapp" />
        <!-- WebApp全屏模式：伪装app，离线应用。 -->
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta content="yes" name="apple-touch-fullscreen" />

        <meta name="apple-mobile-web-app-status-bar-style" content="black" />
        <!-- 浏览器内核控制 webkit内核高速浏览 -->
        <meta name="renderer" content="webkit" />
        <!--<meta name="full-screen"content="yes">-->
        <meta name="screen-orientation" content="portrait" />
        <!--<meta name="x5-fullscreen"content="true">-->
        <meta name="x5-orientation" content="portrait" />

        <!-- 页面描述:content不超过150个字符 -->
        <meta name="description" content="" />
        <meta name="keywords" content="" />
        <meta name="baidu_union_verify" content="b2a75ec0d9ce1dfe4fb37a9a4df8d6cd" />
        <style type="text/css">
            body {
                text-align: center;
            }
            #logo-default {
                background-image: url(static/gongshiwang250.png);
                background-repeat: no-repeat;
                margin-bottom: 20px;
                height: 64px;
                display: inline-block;
                width: 250px;
            }
            .container {
                position: relative;
                display: inline-block;
                margin-top: 30px;
                width: 500px;
            }
            .selector {
                position: relative;
                height: 150px;
                border: 3px solid #ccc;
                /* line-height: 300px; */
                /* text-align: center; */
                display: flex;
                align-items: center;
                justify-content: center;
            }
            .button {
                display: inline-block;
                padding: 8px 16px;
                border-radius: 5px;
                background-color: #4CAF50;
                color: #fff;
                text-decoration: none;
                border-width: 0px;
                margin-bottom: 20px;
                transition: all .3s;
            }
            .buttongray {
                background-color: #e7e7e7; /* Green */
                border: none;
                color: #555555;
                padding: 15px 32px;
                text-align: center;
                text-decoration: none;
                display: inline-block;
                font-size: 16px;
            }
            #resulttextlatex {
                margin-top: 20px;
                position: relative;
                width: 494px;
                height: 30px;
                border: 3px solid #ccc;
                text-align: left;
            }
            #resulttextmml {
                margin-top: 20px;
                position: relative;
                width: 494px;
                height: 30px;
                border: 3px solid #ccc;
                text-align: left;
            }
            .buttoncss {
                text-align: right;
            }
            #ocrresult {
                margin-top: 20px;
                /* height: 50px;
                border: 3px solid #ccc; */
            }
            [name="file"] {
                position: absolute;
                top: 0;
                left: 0;
                z-index: 2;
                width: 100%;
                height: 100%;
                opacity: 0;
            }
            img {
                max-width: 100%;
                max-height: 100%;
            }
            .zanshang {
                position: relative;
                margin-top: 50px;        
            }
            #tip {
                position: relative;
                z-index: 1;
                color: #ccc;
            }
            /* .over {
                display: none;
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: #f5f5f5;
                opacity:0.5;
                z-index: 1000;
            }
            .layout {
                
                display: none;
                position: absolute;
                top: 40%;
                left: 40%;
                width: 20%;
                height: 20%;
                z-index: 1001;
                text-align:center;
            } */
        </style>
    <style type="text/css">.CtxtMenu_InfoClose {  top:.2em; right:.2em;}
.CtxtMenu_InfoContent {  overflow:auto; text-align:left; font-size:80%;  padding:.4em .6em; border:1px inset; margin:1em 0px;  max-height:20em; max-width:30em; background-color:#EEEEEE;  white-space:normal;}
.CtxtMenu_Info.CtxtMenu_MousePost {outline:none;}
.CtxtMenu_Info {  position:fixed; left:50%; width:auto; text-align:center;  border:3px outset; padding:1em 2em; background-color:#DDDDDD;  color:black;  cursor:default; font-family:message-box; font-size:120%;  font-style:normal; text-indent:0; text-transform:none;  line-height:normal; letter-spacing:normal; word-spacing:normal;  word-wrap:normal; white-space:nowrap; float:none; z-index:201;  border-radius: 15px;                     /* Opera 10.5 and IE9 */  -webkit-border-radius:15px;               /* Safari and Chrome */  -moz-border-radius:15px;                  /* Firefox */  -khtml-border-radius:15px;                /* Konqueror */  box-shadow:0px 10px 20px #808080;         /* Opera 10.5 and IE9 */  -webkit-box-shadow:0px 10px 20px #808080; /* Safari 3 &amp; Chrome */  -moz-box-shadow:0px 10px 20px #808080;    /* Forefox 3.5 */  -khtml-box-shadow:0px 10px 20px #808080;  /* Konqueror */  filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color="gray", Positive="true"); /* IE */}
</style><style type="text/css">.CtxtMenu_MenuClose {  position:absolute;  cursor:pointer;  display:inline-block;  border:2px solid #AAA;  border-radius:18px;  -webkit-border-radius: 18px;             /* Safari and Chrome */  -moz-border-radius: 18px;                /* Firefox */  -khtml-border-radius: 18px;              /* Konqueror */  font-family: "Courier New", Courier;  font-size:24px;  color:#F0F0F0}
.CtxtMenu_MenuClose span {  display:block; background-color:#AAA; border:1.5px solid;  border-radius:18px;  -webkit-border-radius: 18px;             /* Safari and Chrome */  -moz-border-radius: 18px;                /* Firefox */  -khtml-border-radius: 18px;              /* Konqueror */  line-height:0;  padding:8px 0 6px     /* may need to be browser-specific */}
.CtxtMenu_MenuClose:hover {  color:white!important;  border:2px solid #CCC!important}
.CtxtMenu_MenuClose:hover span {  background-color:#CCC!important}
.CtxtMenu_MenuClose:hover:focus {  outline:none}
</style><style type="text/css">.CtxtMenu_Menu {  position:absolute;  background-color:white;  color:black;  width:auto; padding:5px 0px;  border:1px solid #CCCCCC; margin:0; cursor:default;  font: menu; text-align:left; text-indent:0; text-transform:none;  line-height:normal; letter-spacing:normal; word-spacing:normal;  word-wrap:normal; white-space:nowrap; float:none; z-index:201;  border-radius: 5px;                     /* Opera 10.5 and IE9 */  -webkit-border-radius: 5px;             /* Safari and Chrome */  -moz-border-radius: 5px;                /* Firefox */  -khtml-border-radius: 5px;              /* Konqueror */  box-shadow:0px 10px 20px #808080;         /* Opera 10.5 and IE9 */  -webkit-box-shadow:0px 10px 20px #808080; /* Safari 3 &amp; Chrome */  -moz-box-shadow:0px 10px 20px #808080;    /* Forefox 3.5 */  -khtml-box-shadow:0px 10px 20px #808080;  /* Konqueror */}
.CtxtMenu_MenuItem {  padding: 1px 2em;  background:transparent;}
.CtxtMenu_MenuArrow {  position:absolute; right:.5em; padding-top:.25em; color:#666666;  font-family: null; font-size: .75em}
.CtxtMenu_MenuActive .CtxtMenu_MenuArrow {color:white}
.CtxtMenu_MenuArrow.CtxtMenu_RTL {left:.5em; right:auto}
.CtxtMenu_MenuCheck {  position:absolute; left:.7em;  font-family: null}
.CtxtMenu_MenuCheck.CtxtMenu_RTL { right:.7em; left:auto }
.CtxtMenu_MenuRadioCheck {  position:absolute; left: .7em;}
.CtxtMenu_MenuRadioCheck.CtxtMenu_RTL {  right: .7em; left:auto}
.CtxtMenu_MenuInputBox {  padding-left: 1em; right:.5em; color:#666666;  font-family: null;}
.CtxtMenu_MenuInputBox.CtxtMenu_RTL {  left: .1em;}
.CtxtMenu_MenuComboBox {  left:.1em; padding-bottom:.5em;}
.CtxtMenu_MenuLabel {  padding: 1px 2em 3px 1.33em;  font-style:italic}
.CtxtMenu_MenuRule {  border-top: 1px solid #DDDDDD;  margin: 4px 3px;}
.CtxtMenu_MenuDisabled {  color:GrayText}
.CtxtMenu_MenuActive {  background-color: #606872;  color: white;}
.CtxtMenu_MenuDisabled:focus {  background-color: #E8E8E8}
.CtxtMenu_MenuLabel:focus {  background-color: #E8E8E8}
.CtxtMenu_ContextMenu:focus {  outline:none}
.CtxtMenu_ContextMenu .CtxtMenu_MenuItem:focus {  outline:none}
.CtxtMenu_Menu .CtxtMenu_MenuClose {  top:-10px; left:-10px}
</style><style type="text/css">#donate-modal-container {
  position: fixed;
  height: 100%;
  width: 100%;
  top: 0;
  left: 0;
  z-index: 999;
  transform: scale(0);
}
#donate-modal-container.active {
  transform: scale(1);
}
#donate-modal-container .donate-quote {
  padding: 0;
  margin: 0;
}
#donate-modal-container .donate-quote-left {
  display: inline-block;
  vertical-align: text-bottom;
  width: 32px;
  height: 32px;
  background: url("https://ooo.0o0.ooo/2017/03/09/58c158afac35c.png");
}
#donate-modal-container .donate-quote-word {
  font-size: 20px;
  color: #333;
}
#donate-modal-container .donate-quote-right {
  display: inline-block;
  vertical-align: text-bottom;
  width: 32px;
  height: 32px;
  background: url("https://ooo.0o0.ooo/2017/03/09/58c1584d5fd9d.png");
}
#donate-modal-container .donate-tab {
  margin-top: 20px;
  font-size: 0;
}
#donate-modal-container .donate-tab a {
  display: inline-block;
  padding: 10px 0;
  width: 120px;
  font-size: 16px;
  text-decoration: none;
  color: #333;
  background-color: #eee;
  transition: all .3s;
}
#donate-modal-container .donate-tab .donate-wechat.active {
  background-color: #44b549;
  color: #fff;
}
#donate-modal-container .donate-tab .donate-alipay.active {
  background-color: #059AE3;
  color: #fff;
}
#donate-modal-container .donate-image {
  display: none;
  max-width: 300px;
  margin: 20px auto;
}
#donate-modal-container .donate-image.active {
  display: block;
}
#donate-modal-container .donate-modal-background {
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.8);
}
#donate-modal-container .donate-modal-background .donate-modal {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  box-sizing: border-box;
  background: #fff;
  max-width: 900px;
  padding: 50px;
  border-radius: 3px;
  font-weight: 300;
}
.donate-btn {
  display: inline-block;
  padding: 8px 16px;
  border-radius: 5px;
  background-color: #000000;
  color: #fff;
  text-decoration: none;
  margin-bottom: 20px;
  transition: all .3s;
}
.donate-btn:hover {
  opacity: .8;
}
.donate-btn .donate-qrcode {
  display: inline-block;
  padding-right: 5px;
  vertical-align: -2px;
  width: 16px;
  height: 16px;
  background: url("https://ooo.0o0.ooo/2017/03/09/58c16b1f3eaa4.png") no-repeat;
}
@media (max-width: 768px) {
  #donate-modal-container .donate-modal-background .donate-modal {
    padding: 20px;
    width: 100%;
  }
  #donate-modal-container .donate-modal-background .donate-image {
    width: 100%;
  }
}
</style><style id="MJX-SVG-styles">
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] &gt; svg {
  overflow: visible;
}

mjx-container[jax="SVG"] &gt; svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] &gt; g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] &gt; rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] &gt; line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] &gt; rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] &gt; .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] &gt; .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] &gt; g &gt; svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool &gt; mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool &gt; mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}
</style></head>
    <body>
        <div class="container">
            <div id="logo-default"></div>
            <div class="selector">
                <input id="file" type="file" name="file" />
                <img id="img" src="" alt="" />
                <span id="tip">请选择本地图片或粘贴图片</span>
            </div>
            <!-- <div id="ocrresult">
    
            </div> -->
            <div>
                <div>
                    <textarea id="resulttextlatex" placeholder="Latex格式的公式拷贝后，直接粘贴到WPS、马克飞象、简书等编辑器中"></textarea>
                </div>
                <div class="buttoncss">
                    <button class="button" id="latexButton" data-clipboard-target="#resulttextlatex" data-clipboard-ac="">拷贝laTex</button>
                </div>
            </div>
            <div>
                <div>
                    <textarea id="resulttextmml" placeholder="MathML格式的公式拷贝后，直接粘贴到Word文档中"></textarea>
                </div>
                <div class="buttoncss">
                    <button class="button" id="mmlButton" data-clipboard-target="#resulttextmml" data-clipboard-ac="">拷贝MathML</button>
                </div>
            </div>
        </div>
        <div id="donate" class="zanshang">
      <a href="javascript:;" class="donate-btn"><i class="donate-qrcode"></i>赞赏</a>
    </div>
        <!-- <div class="zanshang" align="center">
            <script type="text/javascript">var jd_union_pid="3002664051";var jd_union_euid="";</script><script type="text/javascript" src="//ads-union.jd.com/static/js/union.js"></script>
            <script type="text/javascript">var jd_union_pid="3002660154";var jd_union_euid="";</script><script type="text/javascript" src="//ads-union.jd.com/static/js/union.js"></script> 
        </div> -->
        <!-- <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script> -->
        <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
        <script src="https://cdn.bootcdn.net/ajax/libs/zepto/1.2.0/zepto.min.js"></script>
        <script src="https://cdn.bootcdn.net/ajax/libs/mathjax/3.0.5/es5/tex-svg.js"></script>
        <script src="static/vdonate.js"></script>
        <script>
            //初始化ClipboardJS.
            new ClipboardJS('.button');

            new vdonate({
                title: "如果节省了你一点点时间，就直白的赞赏一下吧",
                el: document.getElementById("donate"),
                btnText: "赞赏",
                wechatImage: "static/wechat200.png",
                alipayImage: "static/alipay200.png"
            });


            //最大文件大小2M
            var maxFileSize = 1024*1024*2;
            var input = document.getElementById('file');
            var tip = document.getElementById('tip');
            var img = document.getElementById('img');
            var resultPanelLatex = document.getElementById('resulttextlatex');
            var resultPanelMml = document.getElementById('resulttextmml');
            input.addEventListener('change', function(e){
                loadPictrue((e.target || e.srcElement).files[0]);
            });
            setPasteImg();
            //获取粘贴板上的图片
            function setPasteImg(){
                //粘贴事件
                document.addEventListener('paste', function(event){
                    if (event.clipboardData || event.originalEvent) {
                        var clipboardData = (event.clipboardData || event.originalEvent.clipboardData);
                        if(clipboardData.items){
                            var blob;
                            for (var i = 0; i &lt; clipboardData.items.length; i++) {
                                if (clipboardData.items[i].type.indexOf("image") !== -1) {
                                    blob = clipboardData.items[i].getAsFile();
                                }
                            }
                            loadPictrue(blob);
                        }
                    }
                })
            }
            // 加载图片
            function loadPictrue(blob) {
                //禁止上传大于2M的图片
                if(blob.size &gt; maxFileSize){
                    Toast("请上传小于2M的图片", 3000);
                    return;
                }
                var render = new FileReader();
                render.onload = function (evt) {
                    //输出base64编码
                    var base64 = evt.target.result;
                    tip.style.display = 'none';
                    img.setAttribute('src', base64);
                }
                render.readAsDataURL(blob);
                requestOcr(blob);
            }

            
            function Toast(msg, duration) {
                duration = isNaN(duration) ? 3000 : duration;
                var m = document.createElement('div');
                m.innerHTML = msg;
                m.style.cssText = "font-family:siyuan;max-width:60%;min-width: 150px;padding:0 14px;height: 40px;color: rgb(255, 255, 255);line-height: 40px;text-align: center;border-radius: 4px;position: fixed;top: 50%;left: 50%;transform: translate(-50%, -50%);z-index: 999999;background: rgba(0, 0, 0,.7);font-size: 16px;";
                document.body.appendChild(m);
                setTimeout(function() {
                    var d = 0.5;
                    m.style.webkitTransition = '-webkit-transform ' + d + 's ease-in, opacity ' + d + 's ease-in';
                    m.style.opacity = '0';
                    setTimeout(function() {
                        document.body.removeChild(m)
                    }, d * 1000);
                }, duration);
            }

            function requestOcr(blob){
                var formData = new FormData();
                formData.append('file', blob);
                $.ajax({
                    type: 'post',
                    url: '/upload',
                    data: formData,
                    processData: false,
                    contentType: false,
                    beforeSend: function() {
                        showLoading();
                    },
                    success: function(res) {
                        if(res.latex_styled != null &amp;&amp; res.latex_styled !=undefined){
                            resultPanelLatex.innerText = res.latex_styled;
                            convert2mml();
                        }
                        else{
                            resultPanelLatex.innerText = "公式王只支持图片公式和手写公式识别";
                            resultPanelMml.innerText = "公式王只支持图片公式和手写公式识别";
                        }
                        // convert();
                        completeLoading();
                    },
                    error: function(err) {
                        if(err.status == 429){
                            Toast("操作太快，请稍候再试", 3000)
                        }
                        if(err.status == 1003){
                            Toast("公式王只支持图片公式和手写公式识别", 3000)
                        }
                        // Toast(err.innerHTML, 2000)
                        completeLoading();
                        console.log(err)
                    }
                })
            }

            function convert2mml() {
                var input = document.getElementById("resulttextlatex").value.trim();

                MathJax.tex2mmlPromise(input).then(function (mml) {
                    resultPanelMml.innerText = mml;
                }).catch(function (err) {
                    //
                    //  If there was an error, put the message into the output instead
                    //
                }).then(function () {

                });
            }
            var _LoadingHtml = '&lt;div id="loadingDiv" style="display: none; "&gt;&lt;div id="over" style=" position: absolute;top: 0;left: 0; width: 100%;height: 100%; background-color: #f5f5f5;opacity:0.5;z-index: 1000;"&gt;&lt;/div&gt;&lt;div id="layout" style="position: absolute;top: 40%; left: 40%;width: 20%; height: 20%;  z-index: 1001;text-align:center;"&gt;&lt;img src="static/loading.gif" /&gt;&lt;/div&gt;&lt;/div&gt;';
            document.write(_LoadingHtml);

            function showLoading(){
                document.getElementById("loadingDiv").style.display="block";
            }
            
            function completeLoading() {  
                document.getElementById("loadingDiv").style.display="none";
            }
        </script><div id="donate-modal-container">
      <div class="donate-modal-background">
        <div class="donate-modal">
          <p class="donate-quote">
            <i class="donate-quote-left"></i>
            <span class="donate-quote-word">如果节省了你一点点时间，就直白的赞赏一下吧</span>
            <i class="donate-quote-right"></i>
          </p>
          <div class="donate-tab">
            <a href="javascript:;" class="donate-wechat active" data-index="0">微信</a>
            <a href="javascript:;" class="donate-alipay" data-index="1">支付宝</a>
            <img src="static/wechat200.png" alt="wechat" class="donate-image active" />
            <img src="static/alipay200.png" alt="alipay" class="donate-image" />
          </div>
        </div>
      </div>
    </div><div id="loadingDiv" style="display: none; "><div id="over" style=" position: absolute;top: 0;left: 0; width: 100%;height: 100%; background-color: #f5f5f5;opacity:0.5;z-index: 1000;"></div><div id="layout" style="position: absolute;top: 40%; left: 40%;width: 20%; height: 20%;  z-index: 1001;text-align:center;"><img src="static/loading.gif" /></div></div>
    
</body></html>