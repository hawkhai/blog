<!DOCTYPE HTML>


<html lang="en">
<head>

	

	
	<link rel="preconnect" href="https://apps.developermedia.com">
	<link rel="preconnect" href="https://cdn1.developermedia.com">
	<link rel="preconnect" href="https://cdn.ampproject.org">
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://ajax.googleapis.com">
	<link rel="preconnect" href="https://adservice.google.com">
	<link rel="preconnect" href="https://www.googletagservices.com">
	<link rel="preconnect" href="https://www.googletagmanager.com">
	<link rel="preconnect" href="https://www.google.com">
	<link rel="preconnect" href="https://www.google-analytics.com">
	<link rel="preconnect" href="https://pagead2.googlesyndication.com">

	<link rel="preconnect" href="https://www.codeproject.com">

	<title>Enumerating windows device - CodeProject</title> 
    
	<link type="text/css" rel="stylesheet" href="https://www.codeproject.com/App_Themes/CodeProject/Css/Main.min.css?dt=2.8.20201207.1">


    <script type="text/javascript" src="https://www.codeproject.com/script/JS/jquery-2.2.4.min.js" defer ></script>
<script type="text/javascript" src="https://www.codeproject.com/script/Articles/JS/article.min.js?dt=2.8.20201207.1" defer ></script>
<script type="text/javascript" src="/script/Membership/JS/MemberProfilePopup.min.js?v=1.4" defer ></script>
<script type="text/javascript" src="/a.min.js?v=1.3" defer ></script>

	
<meta http-equiv="content-language" content="en-US">
<meta charset="UTF-8">
<meta name="Description" content="Enumerating the device using the SetupDi* API provided with WinXP">
<meta name="Keywords" content="VC6, Win2K, WinXP, Win2003, C++, Windows, Visual-Studio, Dev, Intermediate,Win32/64 SDK &amp; OS,Platforms, Frameworks &amp; Libraries,Free source code, tutorials">
<meta name="Author" content="Chuan-Liang Teng">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">

<link rel="dns-prefetch" href="//ajax.googleapis.com"> 
<link rel="canonical" href="/Articles/14412/Enumerating-windows-device" />
<meta name="twitter: card" content="summary" />
<meta name="twitter: site" content="@CodeProject" />
<meta property="og:url" content="https://www.codeproject.com/Articles/14412/Enumerating-windows-device" />
<meta property="og:title" content="Enumerating windows device" />
<meta property="og:description" content="Enumerating the device using the SetupDi* API provided with WinXP" />
<meta property="og:image" content="https://www.codeproject.com/KB/winsdk/SimpleSetup/Thumb-14412.jpg" />

<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All Topics" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=1" />
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Artificial Intelligence" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=31" />
<link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="https://www.codeproject.com/webservices/LoungeRSS.aspx" />
<meta name="robots" content="index, follow" />
<link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="https://www.codeproject.com/info/OpenSearch.xml">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="144x144" href="/favicon/apple-touch-icon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"> 
<link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"> 
<link rel="manifest" href="/favicon/manifest.json"> 
<link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#ff9900">
	<script type='application/ld+json'>{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codeproject.com/Articles/14412/Enumerating-windows-device"
   },
  "name": "Enumerating windows device",
  "headline": "Enumerating windows device",
  "url": "https://www.codeproject.com/Articles/14412/Enumerating-windows-device",
  "discussionUrl": "https://www.codeproject.com/Articles/14412/Enumerating-windows-device#_comments",
  "isFamilyFriendly": "true",
  "image": "https://www.codeproject.com/KB/winsdk/SimpleSetup/Thumb-14412.jpg",
  "keywords": "VC6,Win2K,WinXP,Win2003,C++,Windows,Visual-Studio,Dev,Intermediate",
  "commentCount": "37",
  "editor" : {
    "@type" : "Person",
    "name" : "Retired Editor",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx"
  },
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  },
  "description": "Enumerating the device using the SetupDi* API provided with WinXP",
  "articleSection": "Win32/64 SDK & OS",
  "author" : [{
      "@type" : "Person",
      "name" : "Chuan-Liang Teng",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=64973"
    }],
  "datePublished": "2006-06-11",
  "dateCreated": "2006-06-11",
  "dateModified": "2006-06-17"
,
  "aggregateRating" : {
    "@type" : "AggregateRating",
    "ratingValue" : 4.66,
    "ratingCount" : 48,
    "bestRating" : 5,
    "worstRating" : 1
  }
}</script>

<script type='application/ld+json'>{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/Chapters/8/Platforms-Frameworks-Libraries",
      "name" : "Platforms, Frameworks & Libraries"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/KB/winsdk/",
      "name" : "Win32/64 SDK & OS"
    }
  }]
}</script>


	<base target="_top" />
	
    


<script type='text/javascript'>
function defrm () { /* thanks twitter */
    document.write = '';
    window.top.location = window.self.location;
    setTimeout(function() { document.body.innerHTML = ''; }, 0);
    window.self.onload = function(evt) { document.body.innerHTML = ''; };
}

if (window.top !== window.self) {
    try {
        if (window.top.location.host) { /* will throw for all except chrome */ }
        else { defrm(); /* chrome */ }
    } catch (ex) { defrm(); /* everyone else */ }
}

// Specific case where a site is screwing with us.
if (typeof(DemoUrl) !== 'undefined') {
    document.write(unescape('%3Cme') + 'ta http' + '-equiv="re' + 'fresh con' +
                           'tent="1;url=' + DemoUrl + unescape('"%3CE'));
}
</script>
	





<!-- Global site tag (gtag.js) - Google Analytics -->
    <script async type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=UA-1735123-1"></script>
    <script type="text/javascript">
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-1735123-1' );
    </script>


</head>	

<body class="python-urllib python-urllib3">

<a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="https://www.codeproject.com/images/t.gif" /></a>




<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed">
        <div class="main-content">
            

<div class="container memberbar clearfix flex-container flex-extend">

	<div id="ctl00_MemberBar_GenInfo" class="flex-item align-left">14,702,098 members</div>

	<div class="flex-item">
		
	</div>

	<div class="flex-item align-right">

		

		

		

			<script type="text/javascript">//<!--
			function doSubmit(secure)
			{
				if (secure)
					document.signinForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f14412%2fEnumerating-windows-device"
				else
					document.signinForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f14412%2fEnumerating-windows-device"
				document.signinForm.submit();
				return true;
			}//-->
			</script>

			<a name="SignUp"></a>
			<span class="member-signin tooltip openable">
				<span><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f14412%2fEnumerating-windows-device">Sign in</a>
                    <img src="https://www.codeproject.com/App_Themes/CodeProject/Img/login32.png"
                        width="16px" height="16px" style="vertical-align:middle;"/>
				</span>

				<div class="tooltip-flyout">
					<form name="signinForm" id="signinForm" action="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f14412%2fEnumerating-windows-device" method="post"
						class="tight">

						
						<input id="FormName" name="FormName" value="MenuBarForm" type="hidden" />

						<div>Email</div>
						<div><input class="small-text" type="email" name="Email" id="Email" autocomplete="email" /></div>
						<div>Password</div>
						<div><input class="small-text" type="password" name="Password" id="Password" 
							autocomplete="current-password" /></div>
						<div class="action">
                            <input id='joinBtn' type='button' class='create hidden' onclick='return Join();' value='Join' />
                            <input type='hidden' name='fld_quicksign' value='true' />
							<input type="submit" value="Sign in" class="signin" onclick="return doSubmit(false);" />
						</div>

						<div class="container">
							
							&nbsp;
							<a id="ctl00_MemberBar_SendPassword" class="forgot float-right" href="/script/Membership/SendPassword.aspx?rp=/Articles/14412/Enumerating-windows-device">Forgot your password?</a>
						</div>
					</form>

					<hr class="divider-dark" />

					Sign in with <a class="oauth" alt="Sign in using Github" title="Sign in using Github" href="/script/Membership/OAuthLogOn.aspx?auth=GitHub"><img src="/script/Membership/Images/octicons_github.png" style="vertical-align:middle;padding-right:3px;border:0;" /></a>
<a class="oauth" alt="Sign in using Facebook" title="Sign in using Facebook" href="/script/Membership/OAuthLogOn.aspx?auth=Facebook"><img src="/script/Membership/Images/facebook.png" style="vertical-align:middle;padding-right:3px;border:0;" /></a>
<a class="oauth" alt="Sign in using Google" title="Sign in using Google" href="/script/Membership/OAuthLogOn.aspx?auth=Google"><img src="/script/Membership/Images/google-plus.png" style="vertical-align:middle;padding-right:3px;border:0;" /></a>
<a class="oauth" alt="Sign in using Microsoft" title="Sign in using Microsoft" href="/script/Membership/OAuthLogOn.aspx?auth=Microsoft"><img src="/script/Membership/Images/microsoft.png" style="vertical-align:middle;padding-right:3px;border:0;" /></a>

				</div>
            </span>
		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed">
        <div class="main-content">
            <div class="logo"><a href="/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="https://www.codeproject.com/App_Themes/CodeProject/Img/logo250x135.gif" alt="Home" height="135" width="250" border="0" /></a></div>
            <div class="promo"><div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/Win32-64-SDK-OS/Windows-General"  data-country='US' data-tags='VC6, Win2K, WinXP, Win2003, C++, Windows, Visual-Studio, Dev, Intermediate,rating4.5'><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Win32-64-SDK-OS/Windows-General&sz=728x90&c=319667"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Win32-64-SDK-OS/Windows-General&sz=728x90&c=319667"  width="728px" height="90px" target="_blank"/></a></noscript></div></div>
        </div>
    </div>

	
	<div id="ctl00_TPR" class="sub-headerbar clearfix fixed">
    <div class="float-right">
		

<div class="searchbar">

<form method="get" action="/search.aspx?sbo=kw" name="Search" class="tight">


<table border="0" cellspacing="0" cellpadding="0" class="search"><tr><td><input TabIndex="2" class="search " id="sb_tb" autocomplete="off" value="" name="q" /></td><td><input type="image" src="https://www.codeproject.com/images/search.gif" /></td></tr></table>

<div class="hover-container">
	<div id="SearchFilter" class="search-advanced popup small-text align-left">
	<b>Search within:<br /></b>
		
		<input type="radio" id="sb_kw" name="sbo" value="kw" checked="checked"><label for="sb_kw">Articles</label><br>
<input type="radio" id="sb_qa" name="sbo" value="qa"><label for="sb_qa">Quick Answers</label><br>
<input type="radio" id="sb_fm" name="sbo" value="fm"><label for="sb_fm">Messages</label><br>


		
		

		
		
	</div>
</div>
</form>

</div>
    </div>
    <div class="float-left">
		

<div class="navbar clearfix">
<ul class="navmenu openable">

<li class="desktop-only"><a id="ctl00_TopNavBar_Home" href="https://www.codeproject.com">home</a>


<li class="openable"><a id="ctl00_TopNavBar_Art" class="down selected" href="/script/Articles/Latest.aspx">articles</a>

	<ul>
		<li class="openable"><a id="ctl00_TopNavBar_ArtTopicList" class="fly" onmouseover="navBarMenu.ShowMap(this, &#39;ctl00_TopNavBar_MapFlyout&#39;);" href="/script/Content/SiteMap.aspx">Chapters and Sections<span class="has-submenu">&gt;</span></a><ul id="ctl00_TopNavBar_MapFlyout" class="taxonomy">
			<li>
				<div id="siteMap"></div>
			</li>
			</ul>
		</li>
		<li><a id="ctl00_TopNavBar_ArtLatestArts" class="fly" href="/script/Articles/Latest.aspx">Latest Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtTop" class="fly" href="/script/Articles/TopArticles.aspx?ta_so=5">Top Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtGuide" class="fly" href="/info/Submit.aspx">Posting/Update Guidelines</a></li>
		<li><a id="ctl00_TopNavBar_ArtHelpForum" class="fly" href="/Forums/1641/Article-Writing">Article Help Forum</a></li>
		<li><a id="ctl00_TopNavBar_ArtPostArticle" class="fly highlight1" href="/script/Articles/Submit.aspx">
			<img src="https://www.codeproject.com/images/write13.png" width="13" height="13" /> Submit an article or tip
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtImportGitHub" class="fly highlight3" href="/script/Articles/ImportArticle.aspx">
			<img src="https://www.codeproject.com/images/write13.png" width="13" height="13" /> Import GitHub Project
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtPostBlog" class="fly highlight2" href="/script/Articles/BlogFeed.aspx">
			<img src="https://www.codeproject.com/images/write13.png" width="13" height="13" /> Import your Blog
			</a></li>		
        
        <li class="last"></li>
	</ul>

</li>



<li class="openable">
<a id="ctl00_TopNavBar_Answers" href="/script/Answers/List.aspx?tab=active">
    <span class="desktop-only tablet-only">quick answers</span><span class="mobile-only">Q&amp;A</span>
</a>
	<ul>
		<li id="ctl00_TopNavBar_AQL"><a id="ctl00_TopNavBar_ArticleQuestion" class="fly highlight1" href="#_comments">
			<img src="https://www.codeproject.com/images/write13.png" width="13" height="13" /> Ask a Question about this 
			article</a>
		</li>

		<li><a id="ctl00_TopNavBar_QAAsk" class="fly highlight2" href="/Questions/ask.aspx"><img 
			src="https://www.codeproject.com/images/write13.png" width="13" height="13" /> Ask a Question</a></li>

		<li><a id="ctl00_TopNavBar_QAUnanswered" class="fly" href="/script/Answers/List.aspx?tab=unanswered">View Unanswered Questions</a></li>
		<li><a id="ctl00_TopNavBar_QALatest" class="fly" href="/script/Answers/List.aspx?tab=active">View All Questions</a></li>
        
				<li><a id="ctl00_TopNavBar_QATR_ctl00_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=81" style="padding-left:30px">View C# questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl01_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=842" style="padding-left:30px">View VB.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl02_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=93" style="padding-left:30px">View SQL questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl03_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=78" style="padding-left:30px">View C++ questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl04_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=87" style="padding-left:30px">View Javascript questions</a></li>
			
    
		<li class="last"></li>
	</ul>

</li>



<li class="openable"><a id="ctl00_TopNavBar_Forums" href="/script/Forums/List.aspx">
        <span class="desktop-only tablet-only">discussions</span><span class="mobile-only">forums</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_MessageBoardsAll" class="fly" href="/script/Forums/List.aspx">All Message Boards...</a></li>
		<li class="openable"><a class="fly" style="padding-left:30px" href="/Forums/1580997/Application-Lifecycle">Application Lifecycle<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="/Forums/1533717/Running-a-Business">Running a Business</a></li>
<li><a class="fly" href="/Forums/1533716/Sales-Marketing">Sales / Marketing</a></li>
<li><a class="fly" href="/Forums/1651/Collaboration-Beta-Testing">Collaboration / Beta Testing</a></li>
<li><a class="fly" href="/Forums/3304/Work-Issues">Work  Issues</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="/Forums/369270/Design-and-Architecture">Design and Architecture</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/12076/ASP-NET">ASP.NET</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1580226/JavaScript">JavaScript</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="/Forums/1647/C-Cplusplus-MFC">C / C++ / MFC<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="/Forums/4486/ATL-WTL-STL">ATL /  WTL / STL</a></li>
<li><a class="fly" href="/Forums/3785/Managed-Cplusplus-CLI">Managed C++/CLI</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1649/Csharp">C#</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1627782/Free-Tools">Free Tools</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1827460/Objective-C-and-Swift">Objective-C and Swift</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1725/Database">Database</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="/Forums/186301/Hardware-Devices">Hardware &amp; Devices<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="/Forums/1644/System-Admin">System Admin</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1606152/Hosting-and-Servers">Hosting and Servers</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1643/Java">Java</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1942421/Linux-Programming">Linux Programming</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1650/NET-Core-and-Framework">.NET (Core and Framework)</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1848626/Android">Android</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1876716/iOS">iOS</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/13695/Mobile">Mobile</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1540733/SharePoint">SharePoint</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1004257/Silverlight-WPF">Silverlight / WPF</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1646/Visual-Basic">Visual Basic</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1640/Web-Development">Web Development</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/suggestions.aspx">Site Bugs / Suggestions</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1652005/Spam-and-Abuse-Watch">Spam and Abuse Watch</a>
</li>

		<li class="last"></li>
	</ul>

</li>

<li class="openable"><a id="ctl00_TopNavBar_Features" href="/Feature/">
      <span class="desktop-only tablet-only">features</span><span class="mobile-only">stuff</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_Comps" class="fly" href="/script/Contests/CurrentCompetitions.aspx?cmpTpId=3&amp;amp;awsac=true">Competitions</a></li>
        
		<li><a id="ctl00_TopNavBar_Conferences" class="fly" href="/script/Conferences/List.aspx">Conferences</a></li>
		
		<li><a id="ctl00_TopNavBar_News" class="fly" href="/script/News/List.aspx">News</a></li>
		<li><a id="ctl00_TopNavBar_Insider" class="fly" href="/Feature/Insider/">The Insider Newsletter</a></li>
    	<li><a id="ctl00_TopNavBar_DailyBuild" class="fly" href="/Feature/DailyBuild">The Daily Build Newsletter</a></li>
		<li><a id="ctl00_TopNavBar_Newsletters" class="fly" href="/script/Mailouts/Archive.aspx?mtpid=1">Newsletter archive</a></li>
		<li><a id="ctl00_TopNavBar_Surveys" class="fly" href="/script/Surveys/List.aspx">Surveys</a></li>
		<li><a id="ctl00_TopNavBar_Showcase" class="fly" href="/KB/showcase/">Product Showcase</a></li>
        
		<li><a id="ctl00_TopNavBar_Stuff" class="fly" href="/Info/Stuff.aspx">CodeProject Stuff</a></li>
		<li class="last"></li>
	</ul>

</li>


<li  class="openable"><a id="ctl00_TopNavBar_Lounge" href="/Lounge.aspx">
            <span class="desktop-only tablet-only">community</span><span class="mobile-only">lounge</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_WhosWho" class="fly" href="/script/Membership/Profiles.aspx">Who's Who</a></li>
		<li><a id="ctl00_TopNavBar_MVPs" class="fly break" href="/script/Contests/Winners.aspx?obtid=1&amp;amp;cmpTpId=2&amp;amp;cid=0">Most Valuable Professionals</a></li>

		<li><a id="ctl00_TopNavBar_LoungeLnk" class="fly highlight2" href="/Lounge.aspx">The Lounge  </a></li>
		<li><a id="ctl00_TopNavBar_WhereAmILink" class="fly" href="/Forums/1939564/Where-I-am-Member-Photos">Where I Am: Member Photos</a></li>
		<li><a id="ctl00_TopNavBar_InsiderLnk" class="fly" href="/Insider.aspx">The Insider News</a></li>
		<li><a id="ctl00_TopNavBar_WeirdWonderful" class="fly" href="/Feature/WeirdAndWonderful.aspx">The Weird & The Wonderful</a></li>

		<li class="last"></li>
	</ul>

</li>


<li class="openable" style="margin-left:20px"><a id="ctl00_TopNavBar_Help" href="/KB/FAQs/">
    <span class="desktop-only tablet-only">help</span><span class="mobile-only">?</span>
</a>


	<ul>
		<li><a id="ctl00_TopNavBar_HelpWhatIs" class="fly" href="/info/guide.aspx">What is 'CodeProject'?</a></li>
		<li><a id="ctl00_TopNavBar_HelpGeneral" class="fly break" href="/KB/FAQs/">General FAQ</a></li>
		<li><a id="ctl00_TopNavBar_HelpPostQuestion" class="fly break highlight2" href="/Questions/ask.aspx">Ask a Question</a></li>
		<li><a id="ctl00_TopNavBar_HelpBugs" class="fly" href="/suggestions.aspx">Bugs and Suggestions</a></li>
		<li><a id="ctl00_TopNavBar_HelpArticles" class="fly" href="/Forums/1641/Article-Writing">Article Help Forum</a></li>
		
		
		
		
		<li><a id="ctl00_TopNavBar_HelpAboutUs" class="fly" href="/info/about.aspx">About Us</a></li>
		<li class="last"></li>
	</ul>

</li>

</ul>

</div>
    </div>
	<div class="sub-headerbar-divider"></div>
	</div>		
	

	<div id="A" class="container-content-wrap fixed"> 

	<div class="container-content">

        
		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div>Articles &#187; Platforms, Frameworks & Libraries &#187; Win32/64 SDK & OS &#187; Windows General</div>
			</div>

            <div class="float-left">
				
			</div>

			<div class="edit-links float-right">
				



 
&nbsp;










			</div>

			<div class="article-nav float-right">
				


<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    
</div>



 

<a id="ctl00_ActionLinks_PrintMd" data-tooltip="Print" data-enabletooltip="true" data-width="auto" href="/Articles/14412/Enumerating-windows-device?display=Print">
   <img src="/App_Themes/CodeProject/Img/print48.png" 
	    width="24px" height="24px" style="border:0">
</a>



<span id="ctl00_ActionLinks_R">
    
    
</span>
			</div>
		</div>

        
		<div class="extended article-container-parts">

			
		    <div id="ctl00_LeftSideBar" class="article-left-sidebar">

                <div id="ctl00_StickyBlock" class="article-left-sidebar-inner">
                    
    		        

<div class="tabs">
	<div class=" selected">Article</div>
<div><a href="/script/Articles/Statistics.aspx?aid=14412">View Stats</a></div>
<div><a href="/script/Articles/ListVersions.aspx?aid=14412">Revisions</a></div>
<div><a href="#_comments">Comments (37)</a></div>
<div>Posted 11 Jun 2006</div>


    
</div>



			        

			        <div>
                        <h4 id="ctl00_TaggedAsWrapper">Tagged as</h4>
			            <span id="ctl00_TagList_TagWrp" class="tags vertical">

	
	

	
	<span id="ctl00_TagList_VisibleTags"><div class="t"><a rel="tag" href="/Tags/VC6" data-id="4">VC6</a></div><div class="t"><a rel="tag" href="/Tags/Win2K" data-id="23">Win2K</a></div><div class="t"><a rel="tag" href="/Tags/WinXP" data-id="24">WinXP</a></div><div class="t"><a rel="tag" href="/Tags/Win2003" data-id="26">Win2003</a></div><div class="t"><a rel="tag" href="/Tags/Cplusplus" data-id="78">C++</a></div><div class="t"><a rel="tag" href="/Tags/Windows" data-id="94">Windows</a></div><div class="t"><a rel="tag" href="/Tags/Visual-Studio" data-id="103">Visual-Studio</a></div></span> 

	
	
</span>


			        </div>

                    <div id="ctl00_VerticalStatsWrapper" class="stats">
                    <h4>Stats</h4>
                    <div id="ctl00_VerticalStats"><div class="stats"><div>271.3K views</div><div>18.8K downloads</div><div>127 bookmarked</div></div></div>
                    </div>

                    
                </div>
		    </div>
            

			
			<div id="AT" class="article-container  fixed"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="./View.aspx" id="aspnetForm" style="margin:0;padding:0">
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="f7yMayEwjkxLRCUFddmG3vp2IVBRpaj1lo6/t1hSiaYi4HQWL3vBiki3RNlrX3YEVDq+9yJ4eKJwutqRJmgwmI8b6GTHaq8TgP738+iQinS9QmXzNa59xtdXb2X6/a+20Tzwl5H3jYIvkAVRJ/O56q6r7wRtzn2mIsSugs8ZjymOPMAoOcJgQeR03RklQx3LXBVPMDh4z0cvBR1/8+aCmf+KONU6eNotZDMbP6xG8hbb7oV6FiNpujpxvuo8896HRzrGMoT1x5kNVqoyGlPcQLrERxKXT6ks7AdYlIiY64DSJU6nIlprciUlvrSoS5oVmhU8BNszn8vk5qwsg+WfnUDXKD6/zj0vt9OjUCoR1UzjN3GDLXFO5JHhCdY5BVDKg0MWP6P5wOOQtPphQZz+ZuqOcLz3STjkiGsm6cyaesbBQVSTtRWRRXLhrqaT5Gcru1moA5oMLB1k/lUgJMYUa6DwvArqd3qSyr99yJ+jQ9Bjs+FB2QKEkhviq/WkUxl2kON1r2sstz/GYX1EG4QDQr6fnU1AqaxXTjWA7XPqCmIlW3g2Kr/mnwZh9r1/lb6mHNi8dUy7UKLjrwwKOJG3HiiOmp6Bxhde+iFeq+iJ0uX7VFlBxukWytmiwITkd8ut8DmzXTZsilu83tGeDsMUTdhjr0STMefte9uUuQChEPlufhf+KweulKPgKwtZNYkaRgrvaHNdWs29BVhb5WZtnRqPsy8VvYLpEKSUhs094+LkQBOMp+pM4pCLt/SVAeNNWr1sGaovfAkma6VNXAyCyKFSEZgf+lhWgm5gfmGsvypRxaBUJ741YQ3p692qYSBsYvML5lL77fe9yDliS6LmVUR792Cl+R6CGIcbk3tvuGCcGM2tCaXt8uRnjCTqHcrUYvIeaIXBytGgDwwiiqO/3Wgs0U4t/G9f7Bt3pJBOVD3efzSzvjYRYQcFjGevZc2zUkY+j8L722edlq7gzj9ZdT8MtDlUW0G/sucGjCoyyGbHIY5jxnf7ROc0b2IlMheVT/g4uFxowHKqKUvoxSdcVprwPviBJCB2ttNyoeQgYhz2y2+UICqmGBhWLK2tkC5aPCO7RPmKBePcoPWqYnT3TrzcY9yHGKHFnbKAMC9hPrWk5dl4pgLM8bIANdhBhbnVA8eXVeBS86mhDoKzgweAqA1hAud4ceZHRr+GNR8TAtUbUcVaWyioxawFcjQjTn7lTqyiYdbEFTio+1gjSaxz+zOBUd9v8uPsfUH48u9D7TYZQcGK56P4hM2T6Jb67LU5US8q+WXAE8mZ9T6+qy812vBqKFyvOwt1OhM+MjvNKv2LgUTs5XObXjPbUs4ayfOmYjZej7dK0Pj3nJDedko+gE6HAZesQOe81pJkixLe9fHzb6cA" />

<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69" />

					
					 
					<div class="header">
					    <a name="Main"></a>

					    
					    <a name="_articleTop" id="_articleTop"></a>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">Enumerating windows device</h1>
					    </div>

                        <div>
					        
					        <div class="entry flex-container">

                                

                                <div class="flex-item" style="flex:1 1 auto">
                                    <div class="flex-container" style="justify-content:space-between;flex-wrap:wrap-reverse">
                                       <span id="ctl00_Authors" class="author flex-item"><a href="/script/Membership/View.aspx?mid=64973" rel="author">Chuan-Liang Teng</a></span> 

                                        <div class="flex-item" style="margin-top:-4px;">
                                            <div id="ctl00_RateArticle_RatingTable" class="small-text" data-objectref="2_14412">

	<meta itemprop="upvoteCount" content="36">


	<div id="ctl00_RateArticle_RatingRow" class="flex-container rating-container large-stars">

					
		<div id="ctl00_RateArticle_Prompt" class="rating-prompt nowrap">Rate me:</a></div>

		
		<div class="nowrap tooltip">

			
			
			

			
			<div id="ctl00_RateArticle_RatingHistWrap" class="tooltip">

				
				<div id="ctl00_RateArticle_ResultWithHist" class="rating-result"><div class="flex-container rating-stars large-stars"><div><img src='https://www.codeproject.com/script/Ratings/Images/star-fill-lg.png' style='width:24px;height:24px'></div><div><img src='https://www.codeproject.com/script/Ratings/Images/star-fill-lg.png' style='width:24px;height:24px'></div><div><img src='https://www.codeproject.com/script/Ratings/Images/star-fill-lg.png' style='width:24px;height:24px'></div><div><img src='https://www.codeproject.com/script/Ratings/Images/star-fill-lg.png' style='width:24px;height:24px'></div><div style='width:15px;' class='clipped'><img src='https://www.codeproject.com/script/Ratings/Images/star-fill-lg.png' style='width:24px;height:24px'></div><div style='width:9px;position:relative' class='clipped'><img src='https://www.codeproject.com/script/Ratings/Images/star-empty-lg.png' style='width:24px;height:24px;position:absolute;top:0px;right:0'></div></div></div>
				

				<div class="speech-bubble-container-up-right" style="width:170px">
					<div class="speech-bubble-up-right">
						<div class="histogram"></div>
					</div>
					<div class="speech-bubble-pointer-up-right">
						<div class="speech-bubble-pointer-up-right-inner"></div>
					</div>
				</div>
			</div>

			
            

			
            <span id="ctl00_RateArticle_RatingSignin" class="speech-bubble-container-down">
		        <div class="speech-bubble-down">
                    Please <a id="ctl00_RateArticle_SignUp" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f14412%2fEnumerating-windows-device">Sign up or sign in</a> 
                    to vote.
		        </div>
		        <div class="speech-bubble-pointer-down">
			        <div class="speech-bubble-pointer-down-inner"></div>
		        </div>
	        </span>    

		</div>
		
	
		
		<div id="ctl00_RateArticle_VoteCountNoHist" class="rating-votes nowrap">4.66/5  (48 votes)</div>	

		

		
		<div class="rating-undo" title="Undo vote" style="margin-left:5px;display:none"></div>

		
		
	</div>

	
	

</div>

                                        </div>
                                    </div>

                                    <div  class="flex-container">
                                        <span id="ctl00_LastUpdated" class="date flex-item-tight" title="Date last updated">16 Jun 2006</span>
                                    </div>
                                </div>
					        </div>

                            

                        </div>

                        <div id="ctl00_DescriptionSpot" class="summary">Enumerating the device using the SetupDi* API provided with WinXP</div><span id="ctl00_ThumbnailUrl" class="date" content="https://www.codeproject.com/KB/winsdk/SimpleSetup/Thumb-14412.jpg"></span>			

                    </div>
                    
					
					

					

					
					

					
					
					
					

						
					

					

						
						<div id="contentdiv" class="text">
						



<html><head></head><body><ul class="download">
<li><a href="/KB/winsdk/SimpleSetup/DevMgr-SRC.zip">Download source files - 57.8 Kb</a> 
</li><li><a href="/KB/winsdk/SimpleSetup/DevMgr-DEMO.zip">Download demo project - 29.8 Kb</a> </li></ul>
<h2><img alt="Sample screenshot" src="/KB/winsdk/SimpleSetup/Full.jpg" style="width: 650px; height: 540px" class="lazyload" data-sizes="auto" data-srcset="/KB/winsdk/SimpleSetup/Full-r-400.jpg 400w, /KB/winsdk/SimpleSetup/Full.jpg 650w"></h2>
<h2>Introduction</h2>
<p>Windows has a rich collection of APIs to get useful information about installed devices. In this article, I will show how you can enumerate devices on a machine using SetupDiXXX API and CM_XXXX API.</p>
<p>The program has a simple GUI: only a a treeview control that shows all of the installed devices. All the information about a device (such as name and its icon) is grabbed from Windows SetupDiXXX API.</p>
<h2>SetupDiXXX API</h2>
<p>The Setup application programming interface (API) provides a set of functions that your setup application can call to perform installation operations or get several information about installed devices, their class and also their GUID (a unique identifier for every device).</p><pre><strong>WINSETUPAPI BOOL WINAPI
&nbsp; SetupDiGetClassImageList(
&nbsp;&nbsp;&nbsp; OUT PSP_CLASSIMAGELIST_DATA&nbsp; ClassImageListData);</strong></pre>
<p>The <font size="2"><code>SetupDiGetClassImageList</code> function builds an image list that contains bitmaps for every installed class and returns the list in a data structure.</font></p><pre><strong>WINSETUPAPI BOOL WINAPI
&nbsp; SetupDiDestroyClassImageList(
&nbsp;&nbsp;&nbsp; IN PSP_CLASSIMAGELIST_DATA&nbsp; ClassImageListData);</strong></pre>
<p>The <font size="2"><code>SetupDiDestroyClassImageList</code> function destroys a class image list that was built by a call to <code>SetupDiGetClassImageList</code>.</font></p><pre><strong>WINSETUPAPI BOOL WINAPI
&nbsp; SetupDiGetClassImageIndex(
&nbsp;&nbsp;&nbsp; IN PSP_CLASSIMAGELIST_DATA&nbsp; ClassImageListData,
&nbsp;&nbsp;&nbsp; IN LPGUID&nbsp; ClassGuid,
&nbsp;&nbsp;&nbsp; OUT PINT&nbsp; ImageIndex);</strong></pre>
<p>The <font size="2"><code>SetupDiGetClassImageIndex</code> function retrieves the index within the class image list of a specified class.</font></p>
<p class="MsoNormal" style="margin: 0 0 0 24pt; text-indent: -24pt"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><img height="11" alt="*" width="11"><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">Get device info set for device class (<span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><font size="3">SetupDiGetClassDevs </font><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">function) , when first call , the first and second parameters for this function should be set to “&lt;st1:chmetcnv tcsc="0" numbertype="1" negative="False" hasspace="False" sourcevalue="0" unitname="”" w:st="on"&gt;0”, the last parameter should be set property <span lang="EN-US" style="font-size: 8.5pt; color: rgba(0, 0, 0, 1); font-family: Verdana">DIGCF_ALLCLASSES constant to get all class device.</span></span></span></span></span></span></span></p>
<p class="MsoNormal" style="margin: 0 0 0 24pt; text-indent: -24pt"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 8.5pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&lt;o:p&gt;&nbsp;</span></span></span></span></span></span></span></span></p>
<p class="MsoNormal" style="background-color: rgba(251, 237, 187, 1); margin: 0"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span><strong>HDEVINFO<br>&nbsp; SetupDiGetClassDevs(<br>&nbsp;&nbsp;&nbsp; IN LPGUID&nbsp; ClassGuid,&nbsp; OPTIONAL<br>&nbsp;&nbsp;&nbsp; IN PCTSTR&nbsp; Enumerator,&nbsp; OPTIONAL<br>&nbsp;&nbsp;&nbsp; IN HWND&nbsp; hwndParent,&nbsp; OPTIONAL<br>&nbsp;&nbsp;&nbsp; IN DWORD&nbsp; Flags);</strong><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span><strong>&nbsp;</strong></span></span></span></span></span></span></span></span></span></span></p><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span><span lang="EN-US" style="font-size: 13pt; color: rgba(255, 153, 0, 1); font-family: Verdana">
<p class="MsoNormal" style="margin: 0"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&nbsp;</span></p><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">
<p class="MsoNormal" style="margin: 0"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&nbsp;<span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(255, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&nbsp;</span></span></span></span></span></p>
<p class="MsoNormal" style="background-color: rgba(251, 237, 187, 1); margin: 0"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;">hDevInfo = <strong>SetupDiGetClassDevs</strong>(0L,&nbsp;&nbsp; //<strong>Retrieve all classes</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0L,&nbsp; // <strong>no enumerator</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _hDlg, // <strong>Parent Windows, usually set to “0”</strong></span></p>
<p class="MsoNormal" style="background-color: rgba(251, 237, 187, 1); margin: 0"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //control options used in building the device information set</strong><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DIGCF_PRESENT |&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DIGCF_ALLCLASSES |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DIGCF_PROFILE);<span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span></span></span></span></span></span></p><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span><span><span><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span><span><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">
<p class="MsoNormal" style="margin: 0"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 13pt; color: rgba(255, 153, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span><span lang="EN-US" style="font-size: 13pt; color: rgba(255, 153, 0, 1); font-family: Verdana"><strong></strong>&nbsp;</span></span></span></span></span></p>
<p class="MsoNormal" style="margin: 0"><span lang="EN-US" style="font-size: 13pt; color: rgba(255, 153, 0, 1); font-family: Verdana"><strong>Getting the Info&lt;o:p&gt;</strong></span></p>
<p class="MsoNormal" style="margin: 0 0 0 24pt; text-indent: -24pt"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span>&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0 0 0 24pt; text-indent: -24pt"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><img height="11" alt="*" width="11"><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">Using (SetupDiEnumDeviceInfo function) to enumeration all class devices.</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0 0 0 24pt; text-indent: -24pt"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&lt;o:p&gt;&nbsp;</span></span></span></span></p>
<p class="MsoNormal" style="background-color: rgba(251, 237, 187, 1); margin: 0"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><strong>WINSETUPAPI BOOL WINAPI<br>&nbsp; SetupDiEnumDeviceInfo(<br>&nbsp;&nbsp;&nbsp; IN HDEVINFO&nbsp; DeviceInfoSet,<br>&nbsp;&nbsp;&nbsp; IN DWORD&nbsp; MemberIndex,<br>&nbsp;&nbsp;&nbsp; OUT PSP_DEVINFO_DATA&nbsp; DeviceInfoData);</strong><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"></span></span></span></p><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">
<p class="MsoNormal" style="margin: 0"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&lt;o:p&gt;&nbsp;</span></p>
<p class="MsoNormal" style="margin: 0"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&lt;o:p&gt;The function returns TRUE if it is successful. Otherwise, it returns FALSE and the logged error can be retrieved with a call to GetLastError.</span></p><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">
<p class="MsoNormal" style="margin: 0"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&nbsp;</span></span></p><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">
<p class="MsoNormal" style="background-color: rgba(251, 237, 187, 1); margin: 0"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;">wIndex = 0;<br><strong>spDevInfoData.cbSize = sizeof(SP_DEVINFO_DATA);</strong><br>while (1)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp; if (<strong>SetupDiEnumDeviceInfo</strong>(hDevInfo,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wIndex,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;spDevInfoData))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; . <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .<br>};</span></p>
<p class="MsoNormal" style="margin: 0"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">
<p class="MsoNormal" style="margin: 0"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">The second parameter is Supplies the zero-based index of the device information element to retrieve.</span></p>
<p class="MsoNormal" style="margin: 0"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&nbsp;</span></p>
<p class="MsoNormal" style="margin: 0"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">The Last parameter is <span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">Supplies a pointer to an <span lang="EN-US" style="font-size: 10pt; color: rgba(255, 0, 0, 1); font-family: Verdana">SP_DEVINFO_DATA<span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"> structure to receive information about this element. The caller must set cbSize to sizeof(SP_DEVINFO_DATA).&nbsp;</span></span></span></span></p><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">
<p class="MsoNormal" style="margin: 0">&nbsp;</p>
<p class="MsoNormal" style="margin: 0"><span lang="EN-US" style="font-size: 8.5pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><img height="11" alt="*" width="11"><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span lang="EN-US" style="font-size: 10pt; font-family: Verdana">Get device name from Registry via <span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><font size="3">SetupDiGetDeviceRegistryPropertyA </font><span lang="EN-US" style="font-size: 10pt; font-family: Verdana">function</span></span></span></span></span></span></span></p>
<p class="MsoNormal" style="margin: 0"><span lang="EN-US" style="font-size: 8.5pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&lt;o:p&gt;&nbsp;</span></span></span></span></span></span></span></span></p>
<p class="MsoNormal" style="background-color: rgba(251, 237, 187, 1); margin: 0"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><strong>WINSETUPAPI BOOL WINAPI<br>&nbsp; SetupDiGetDeviceRegistryProperty(<br>&nbsp;&nbsp;&nbsp; IN HDEVINFO&nbsp; DeviceInfoSet,<br>&nbsp;&nbsp;&nbsp; IN PSP_DEVINFO_DATA&nbsp; DeviceInfoData,<br>&nbsp;&nbsp;&nbsp; IN DWORD&nbsp; Property,<br>&nbsp;&nbsp;&nbsp; OUT PDWORD&nbsp; PropertyRegDataType,&nbsp; OPTIONAL<br>&nbsp;&nbsp;&nbsp; OUT PBYTE&nbsp; PropertyBuffer,<br>&nbsp;&nbsp;&nbsp; IN DWORD&nbsp; PropertyBufferSize,<br>&nbsp;&nbsp;&nbsp; OUT PDWORD&nbsp; RequiredSize&nbsp; OPTIONAL);</strong><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"></span></span></span></span></span></span></span></p><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span><span><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 8.5pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span>
<p class="MsoNormal" style="margin: 0"><b><span lang="EN-US" style="font-size: 13pt; color: rgba(255, 153, 0, 1); font-family: Verdana"></span></b>&nbsp;</p>
<p class="MsoNormal" style="margin: 0"><span lang="EN-US" style="font-size: 13pt; color: rgba(255, 153, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&nbsp;</span></span></p><span lang="EN-US" style="font-size: 13pt; color: rgba(255, 153, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">
<p class="MsoNormal" style="background-color: rgba(251, 237, 187, 1); margin: 0"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;">if (!<strong>SetupDiGetDeviceRegistryProperty</strong>(hDevInfo,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;spDevInfoData,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>SPDRP_CLASS, //Retrieve property type</strong>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0L,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (PBYTE)szBuf,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2048,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0)) {<br>&nbsp;&nbsp;&nbsp; wIndex++;<br>&nbsp;&nbsp;&nbsp; continue;<br>};</span></p>
<p class="MsoNormal" style="background-color: rgba(251, 237, 187, 1); margin: 0"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;">//retrieves the index within the class image list of a specified class</span></p>
<p class="MsoNormal" style="background-color: rgba(251, 237, 187, 1); margin: 0"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;">if (<strong>SetupDiGetClassImageIndex</strong>(&amp;_spImageData,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;spDevInfoData.ClassGuid,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (int*)&amp;wImageIdx)){ </span></p>
<p class="MsoNormal" style="background-color: rgba(251, 237, 187, 1); margin: 0"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .</span></p>
<p class="MsoNormal" style="background-color: rgba(251, 237, 187, 1); margin: 0"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //retrieves the class description associated with the specified setup class GUID<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!<strong>SetupDiGetClassDescription</strong>(&amp;spDevInfoData.ClassGuid,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; szBuf,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MAX_PATH,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;dwRequireSize)){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; };<br>};</span></p>
<p class="MsoNormal" style="margin: 0"><span lang="EN-US" style="font-size: 13pt; color: rgba(255, 153, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin: 0"><span lang="EN-US" style="font-size: 13pt; color: rgba(255, 153, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&nbsp;</span></span></p><span lang="EN-US" style="font-size: 13pt; color: rgba(255, 153, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 13pt; color: rgba(255, 153, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 13pt; color: rgba(255, 153, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 13pt; color: rgba(255, 153, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 13pt; color: rgba(255, 153, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 13pt; color: rgba(255, 153, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">
<p class="MsoNormal" style="margin: 0"><b><span lang="EN-US" style="font-size: 13pt; color: rgba(255, 153, 0, 1); font-family: Verdana"></span></b></p>
<p class="MsoNormal" style="margin: 0"><b><span lang="EN-US" style="font-size: 13pt; color: rgba(255, 153, 0, 1); font-family: Verdana">Get Device Resource&lt;o:p&gt;</span></b></p>
<p class="MsoNormal" style="margin: 0"><font size="3"><font face="Times New Roman"><span lang="EN-US"></span></font></font>&nbsp;</p>
<p class="MsoNormal" style="margin: 0"><font size="3"><font face="Times New Roman"><span lang="EN-US">All devices in the system join in the device classes. As you can see in the below picture, the class has name and GUID (so it can be found in Registry). The class can also have a description. For example, for class "Ports" the description is "Ports (COM &amp; LPT)". Class also has devices that are present in the configuration.</span></font></font></p>
<p class="MsoNormal" style="margin: 0"><font size="3"><font face="Times New Roman"><span lang="EN-US"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(255, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"></span></span></span></span></font></font>&nbsp;</p><font size="3"><font face="Times New Roman"><span lang="EN-US"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(255, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">
<p class="MsoNormal" style="margin: 0 0 0 24pt; text-indent: -24pt"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">Get information about current configuration (<span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><font size="3">CM_Get_First_Log_Conf</font><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"> function).</span></span></span></span></span></span></p>
<p class="MsoNormal" style="margin: 0 0 0 24pt; text-indent: -24pt"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(255, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&nbsp;</span></span></span></span></span></span></span></span></span></p>
<p class="MsoNormal" style="background-color: rgba(251, 237, 187, 1); margin: 0"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><strong>CMAPI CONFIGRET WINAPI<br>&nbsp; CM_Get_First_Log_Conf(<br>&nbsp;&nbsp;&nbsp; OUT PLOG_CONF&nbsp; plcLogConf,&nbsp; OPTIONAL<br>&nbsp;&nbsp;&nbsp; IN DEVINST&nbsp; dnDevInst,<br>&nbsp;&nbsp;&nbsp; IN ULONG&nbsp; ulFlags);<span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span></span></span></strong></span></p><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"></span></span></span></span></span></font></font><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><font face="Times New Roman"><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:">
<p class="MsoNormal" style="margin: 0 0 0 24pt; text-indent: -24pt"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&nbsp;</span></span></span></span></p>
<p class="MsoNormal" style="margin: 0 0 0 24pt; text-indent: -24pt"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">Get resource descriptor from current configuration (<span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><font size="3">CM_Get_Next_Res_Des</font><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"> function, do this and follow steps for every resource till they exist) </span></span></span></span></span></span></p>
<p class="MsoNormal" style="margin: 0 0 0 24pt; text-indent: -24pt"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&nbsp;</span></span></span></span></span></span></p><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">
<p class="MsoNormal" style="background-color: rgba(251, 237, 187, 1); margin: 0"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><strong>CMAPI CONFIGRET WINAPI<br>&nbsp; CM_Get_Next_Res_Des(<br>&nbsp;&nbsp;&nbsp; OUT PRES_DES&nbsp; prdResDes,<br>&nbsp;&nbsp;&nbsp; IN RES_DES&nbsp; rdResDes,<br>&nbsp;&nbsp;&nbsp; IN RESOURCEID&nbsp; ForResource,<br>&nbsp;&nbsp;&nbsp; OUT PRESOURCEID&nbsp; pResourceID,<br>&nbsp;&nbsp;&nbsp; IN ULONG&nbsp; ulFlags);<span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span></span></span></strong></span></p>
<p class="MsoNormal" style="margin: 0 0 0 24pt; text-indent: -24pt"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&nbsp;</span></span></span></span></span></span></p>
</span></span></span></span></span></span></span></font><p class="MsoNormal" style="margin: 0 0 0 24pt; text-indent: -24pt"><font face="Times New Roman"></font><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">Get information about size of resource data (<span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><font size="3">CM_Get_Res_Des_Data_Size</font><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"> function) </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p class="MsoNormal" style="margin: 0 0 0 24pt; text-indent: -24pt"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&nbsp;</span></span></span></span></span></span></span></span></span></span></p><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">
<p class="MsoNormal" style="background-color: rgba(251, 237, 187, 1); margin: 0"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><strong>CMAPI CONFIGRET WINAPI<br>&nbsp; CM_Get_Res_Des_Data_Size(<br>&nbsp;&nbsp;&nbsp; OUT PULONG&nbsp; pulSize,<br>&nbsp;&nbsp;&nbsp; IN RES_DES&nbsp; rdResDes,<br>&nbsp;&nbsp;&nbsp; IN ULONG&nbsp; ulFlags);<span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span></span></span></strong></span></p>
<p class="MsoNormal" style="margin: 0 0 0 24pt; text-indent: -24pt"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&nbsp;</span></span></span></span></span></span></span></span></span></span></p>
<p class="MsoNormal" style="margin: 0 0 0 24pt; text-indent: -24pt"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">Get resource data (<span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><font size="3">CM_Get_Res_Des_Data</font><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"> function) </span></span></span></span></span></span></span></span></span></span></span></span></p>
<p class="MsoNormal" style="margin: 0 0 0 24pt; text-indent: -24pt"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&nbsp;</span></span></span></span></span></span></p><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">
<p class="MsoNormal" style="background-color: rgba(251, 237, 187, 1); margin: 0"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><strong>CMAPI CONFIGRET WINAPI<br>&nbsp; CM_Get_Res_Des_Data(<br>&nbsp;&nbsp;&nbsp; IN RES_DES&nbsp; rdResDes,<br>&nbsp;&nbsp;&nbsp; OUT PVOID&nbsp; Buffer,<br>&nbsp;&nbsp;&nbsp; IN ULONG&nbsp; BufferLen,<br>&nbsp;&nbsp;&nbsp; IN ULONG&nbsp; ulFlags);<span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span></span></span></strong></span></p><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">
<p class="MsoNormal" style="margin: 0 0 0 24pt; text-indent: -24pt"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&nbsp;</span></span></span></span></span></span></p><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">
<p class="MsoNormal" style="background-color: rgba(251, 237, 187, 1); margin: 0"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;">cmRet = <strong>CM_Get_First_Log_Conf</strong>(&amp;firstLogConf, DevInst, <strong>ALLOC_LOG_CONF</strong>);<br>if (cmRet != CR_SUCCESS) {<br>&nbsp;&nbsp;&nbsp; cmRet = <strong>CM_Get_First_Log_Conf</strong>(&amp;firstLogConf, DevInst, <strong>BOOT_LOG_CONF</strong>);<br>&nbsp;&nbsp;&nbsp; if (cmRet != CR_SUCCESS)&nbsp; return;<br>};<br>cmRet = <strong>CM_Get_Next_Res_Des</strong>(&amp;nextLogConf,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; firstLogConf,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dwResType,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0L,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0L);<br>if (cmRet != CR_SUCCESS){<br>&nbsp;&nbsp;&nbsp; <strong>CM_Free_Res_Des_Handle</strong>(firstLogConf);<br>&nbsp;&nbsp;&nbsp; return;<br>};<br>while (1) {<br>&nbsp;&nbsp;&nbsp; ulSize = 0;<br>&nbsp;&nbsp;&nbsp; cmRet = <strong>CM_Get_Res_Des_Data_Size</strong>(&amp;ulSize, nextLogConf, 0L);<br>&nbsp;&nbsp;&nbsp; if (cmRet != CR_SUCCESS) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>CM_Free_Res_Des_Handle</strong>(nextLogConf);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;<br>&nbsp;&nbsp;&nbsp; };<br>&nbsp;&nbsp;&nbsp; pBuf = (char*)LocalAlloc(LPTR, 2048);<br>&nbsp;&nbsp;&nbsp; if (!pBuf)&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ShowErrorMsg(_hDlg, GetLastError(), "LocalAlloc");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>CM_Free_Res_Des_Handle</strong>(nextLogConf);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;<br>&nbsp;&nbsp;&nbsp; };<br>&nbsp;&nbsp;&nbsp; cmRet = <strong>CM_Get_Res_Des_Data</strong>(nextLogConf, pBuf, ulSize, 0L);<br>&nbsp;&nbsp;&nbsp; if (cmRet != CR_SUCCESS) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; . };<br>};<span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span></span></span></span></p>
<p class="MsoNormal" style="margin: 0 0 0 24pt; text-indent: -24pt"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&nbsp;</span></span></span></span></span></span></p><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">
<p class="MsoNormal" style="margin: 0 0 0 24pt; text-indent: -24pt"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Wingdings"><span><span style="font-family: &quot;Times New Roman&quot;; font-size: 7pt; font-variant: ; font-weight: ; font-style: ; line-height:"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="color: rgba(153, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><b><span lang="EN-US" style="font-size: 13pt; color: rgba(255, 153, 0, 1); font-family: Verdana"></span></b><b><span lang="EN-US" style="font-size: 13pt; color: rgba(255, 153, 0, 1); font-family: Verdana"></span></b></span></span></span></span></span></span></p>
<p class="MsoNormal" style="margin: 0"><b><span lang="EN-US" style="font-size: 13pt; color: rgba(255, 153, 0, 1); font-family: Verdana">Load/Unload Non-PNP Driver&lt;o:p&gt;</span></b></p>
<p class="MsoNormal" style="margin: 0"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&nbsp;</span></p>
<p class="MsoNormal" style="margin: 0"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">Windows allows loading drivers at runtime using the <b><span lang="EN-US" style="font-size: 10pt; color: rgba(255, 0, 0, 1); font-family: Verdana">Service Control Manager</span></b><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">. Yes, the Service Control Manager in Windows not only can be used to load and manage services. You can use it with device drivers as you use it to load/unload/start/stop windows services.</span></span></p>
<p class="MsoNormal" style="margin: 0"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(255, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&nbsp;</span></span></span></p>
<p class="MsoNormal" style="margin: 0"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(255, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">The OpenSCManager function establishes a connection to the service control manager on the specified computer and opens the specified service control manager database.</span></span></span></p>
<p class="MsoNormal" style="margin: 0"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(255, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&nbsp;</span></span></span></p><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(255, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">
<p class="MsoNormal" style="background-color: rgba(251, 237, 187, 1); margin: 0"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><strong>SC_HANDLE OpenSCManager(<br>&nbsp; IN LPCTSTR lpMachineName,<br>&nbsp; IN LPCTSTR lpDatabaseName,<br>&nbsp; IN DWORD dwDesiredAccess);</strong><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span></span></span></span></span></span></p>
<p class="MsoNormal" style="margin: 0">&lt;o:p&gt;&nbsp;</p>
<p class="MsoNormal" style="margin: 0">&lt;o:p&gt;The CreateService function creates a service object and installs it in the service control manager database by creating a key with the same name as the service under the following registry key:<br></p>
<p class="MsoNormal" style="margin: 0">&lt;o:p&gt;<strong>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services</strong></p>
<p class="MsoNormal" style="margin: 0">&lt;o:p&gt;&nbsp;</p>&lt;o:p&gt;
<p class="MsoNormal" style="background-color: rgba(251, 237, 187, 1); margin: 0"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><strong>SC_HANDLE CreateService(<br>&nbsp;&nbsp;&nbsp; IN SC_HANDLE hSCManager,<br>&nbsp;&nbsp;&nbsp; IN LPCTSTR lpServiceName,<br>&nbsp;&nbsp;&nbsp; IN LPCTSTR lpDisplayName,<br>&nbsp;&nbsp;&nbsp; IN DWORD dwDesiredAccess,<br>&nbsp;&nbsp;&nbsp; IN DWORD dwServiceType,<br>&nbsp;&nbsp;&nbsp; IN DWORD dwStartType,<br>&nbsp;&nbsp;&nbsp; IN DWORD dwErrorControl,<br>&nbsp;&nbsp;&nbsp; IN LPCTSTR lpBinaryPathName,<br>&nbsp;&nbsp;&nbsp; IN LPCTSTR lpLoadOrderGroup,<br>&nbsp;&nbsp;&nbsp; IN LPDWORD lpdwTagId,<br>&nbsp;&nbsp;&nbsp; IN LPCTSTR lpDependencies,<br>&nbsp;&nbsp;&nbsp; IN LPCTSTR lpServiceStartName,<br>&nbsp;&nbsp;&nbsp; IN LPCTSTR lpPassword);</strong><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span></span></span></span></span></span></p>
<p class="MsoNormal" style="margin: 0">&lt;o:p&gt;&nbsp;</p>
<p class="MsoNormal" style="margin: 0">&lt;o:p&gt;The OpenService function opens an existing service.</p>
<p class="MsoNormal" style="margin: 0">&lt;o:p&gt;&nbsp;</p>&lt;o:p&gt;
<p class="MsoNormal" style="background-color: rgba(251, 237, 187, 1); margin: 0"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><strong>SC_HANDLE OpenService(<br>&nbsp; IN&nbsp;SC_HANDLE hSCManager,<br>&nbsp; IN&nbsp;LPCTSTR lpServiceName,<br>&nbsp; IN&nbsp;DWORD dwDesiredAccess);</strong><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span></span></span></span></span></span></p>
<p class="MsoNormal" style="margin: 0">&lt;o:p&gt;&nbsp;</p>&lt;o:p&gt;
<p class="MsoNormal" style="background-color: rgba(251, 237, 187, 1); margin: 0"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;">hSCManager = <strong>OpenSCManager</strong>(0L,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0L,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SC_MANAGER_ALL_ACCESS);<br>if (hSCManager){&nbsp; //Create new device service<br>&nbsp;&nbsp;&nbsp; hService = <strong>CreateService</strong>(hSCManager,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lpszServiceName,&nbsp; //DosDeviceName<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lpszServiceName, //DosDeviceName<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SERVICE_ALL_ACCESS,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SERVICE_KERNEL_DRIVER,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wStart,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wError,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lpszDriverPath,&nbsp;&nbsp; // Image path<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0L,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0L,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0L,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0L,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0L);<br>&nbsp;&nbsp;&nbsp; if (!hService) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DWORD dwErrorCode = GetLastError();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (dwErrorCode == ERROR_SERVICE_EXISTS) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //If service already existed? Open it.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; hService = <strong>OpenService</strong>(hSCManager, lpszServiceName, SERVICE_ALL_ACCESS);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ShowErrorMsg(_hDlg, dwErrorCode, "CreateService");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; };<br>&nbsp;&nbsp;&nbsp; };<br>&nbsp;&nbsp;&nbsp; if (hService) { // Start new service<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!<strong>StartService</strong>(hService, 0, 0L)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>CloseServiceHandle</strong>(hService);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ShowErrorMsg(_hDlg, GetLastError(), "StartService");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; };<br>&nbsp;&nbsp;&nbsp; };<br>&nbsp;&nbsp;&nbsp; CloseServiceHandle(hSCManager);<br>};<span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span></span></span></span></span></span></p><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">
<p class="MsoNormal" style="margin: 0"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&nbsp;</span></p>
<p class="MsoNormal" style="margin: 0"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">If you want to send/receive data to the device driver loaded, to allow this, you have to get a handle to the driver. For this purpose you can use the function <b><span lang="EN-US" style="font-size: 12pt; color: rgba(255, 0, 0, 1); font-family: &quot;Courier New&quot;">CreateFile</span></b><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">, and pass the driver name as the file name. You can see Windows is so abstract in this aspect.</span></span></p>
<p><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><img alt="Sample screenshot" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="/KB/winsdk/SimpleSetup/AddLegacy.jpg" class="lazyload" style="max-width: 700px; height: auto"></span></p><span lang="EN-US">
<p class="MsoNormal" style="margin: 0"><b><span lang="EN-US" style="font-size: 13pt; color: rgba(255, 153, 0, 1); font-family: Verdana">Load/Unload&nbsp;WDM Driver&lt;o:p&gt;</span></b></p>
<p><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">Windows also allows loading drivers at runtime using the <span lang="EN-US" style="font-size: 10pt; color: rgba(255, 0, 0, 1); font-family: Verdana"><strong>SetupDiXXX API</strong><font color="#000000">.</font><font color="#000000"> The first we need to call SetuiDiGetINFClass to get the </font><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(255, 0, 0, 1); font-family: Verdana"><font color="#000000">class of a specified device INF file.</font><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(255, 0, 0, 1); font-family: Verdana"><font color="#000000"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(255, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">&nbsp;</span></span></span></font></span></span></span></span></span></span></p>
<p><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(255, 0, 0, 1); font-family: Verdana"><font color="#000000"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(255, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><img alt="Sample screenshot" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="/KB/winsdk/SimpleSetup/INFInst.jpg" class="lazyload" style="max-width: 700px; height: auto"></span></span></span></font></span></span></p><font color="#000000">
<p class="MsoNormal" style="background-color: rgba(251, 237, 187, 1); margin: 0"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><strong>WINSETUPAPI BOOL WINAPI<br>&nbsp; SetupDiGetINFClass(<br>&nbsp;&nbsp;&nbsp; IN PCTSTR&nbsp; InfName,<br>&nbsp;&nbsp;&nbsp; OUT LPGUID&nbsp; ClassGuid,<br>&nbsp;&nbsp;&nbsp; OUT PTSTR&nbsp; ClassName,<br>&nbsp;&nbsp;&nbsp; IN DWORD&nbsp; ClassNameSize,<br>&nbsp;&nbsp;&nbsp; OUT PDWORD&nbsp; RequiredSize&nbsp; OPTIONAL);</strong><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span></span></span></span></span></span></span></span></p></font>
<p><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">The second parameter, Receives the class GUID for the specified INF file. If the INF file does not specify a class name, this variable is set to GUID_NULL. Call <strong>SetupDiClassGuidsFromName</strong> to determine if one or more classes with this name are already installed.</span></p>
<p><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">When function return TRUE, NOW we need create an empty device information set and optionally associates the set with a device setup class and a top-level window. Use <b>SetupDiCreateDeviceInfo</b> function creates a new device information element and adds it as a new member to the specified device information set.</span></p>
<p class="MsoNormal" style="background-color: rgba(251, 237, 187, 1); margin: 0"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><strong>HDEVINFO<br>&nbsp; SetupDiCreateDeviceInfoList(<br>&nbsp;&nbsp;&nbsp; IN LPGUID&nbsp; ClassGuid,&nbsp; OPTIONAL<br>&nbsp;&nbsp;&nbsp; IN HWND&nbsp; hwndParent&nbsp; OPTIONAL);</strong><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"></span></span></p>
<p><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">The caller of this function must delete the returned device information set when it is no longer needed by calling <strong>SetupDiDestroyDeviceInfoList</strong>. <br>To create a device information list for a remote machine use <strong>SetupDiCreateDeviceInfoListEx</strong>.</span></p><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">
<p class="MsoNormal" style="background-color: rgba(251, 237, 187, 1); margin: 0"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><strong>WINSETUPAPI BOOL WINAPI<br>&nbsp; SetupDiCreateDeviceInfo(<br>&nbsp;&nbsp;&nbsp; IN HDEVINFO&nbsp; DeviceInfoSet,<br>&nbsp;&nbsp;&nbsp; IN PCTSTR&nbsp; DeviceName,<br>&nbsp;&nbsp;&nbsp; IN LPGUID&nbsp; ClassGuid,<br>&nbsp;&nbsp;&nbsp; IN PCTSTR&nbsp; DeviceDescription,&nbsp; OPTIONAL<br>&nbsp;&nbsp;&nbsp; IN HWND&nbsp; hwndParent,&nbsp; OPTIONAL<br>&nbsp;&nbsp;&nbsp; IN DWORD&nbsp; CreationFlags,<br>&nbsp;&nbsp;&nbsp; OUT PSP_DEVINFO_DATA&nbsp; DeviceInfoData&nbsp; OPTIONAL);</strong><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"></span></span></p>
<p style="margin-right: 0"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">The sixth parameter. Controls how the device information element is created. Can be a combination of the following values: </span></p>
<p style="margin-right: 0"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><strong>DICD_GENERATE_ID&nbsp;</strong><br> If this flag is specified, DeviceName contains only a Root-enumerated device ID and the system creates a unique device instance key for it. This unique device instance key is generated as: <br><strong>Enum\Root\DeviceName\InstanceID</strong><br>where InstanceID is a four-digit, base-10 number that is unique among all subkeys under Enum\Root\DeviceName. Call SetupDiGetDeviceInstanceId to find out what ID was generated for this device information element. </span></p>
<p><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><strong>DICD_INHERIT_CLASSDRVS</strong> <br>If this flag is specified, the resulting device information element inherits the class driver list, if any, associated with the device information set. In addition, if there is a selected driver for the device information set, that same driver is selected for the new device information element. </span></p><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">
<p class="MsoNormal" style="background-color: rgba(251, 237, 187, 1); margin: 0"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;">if (!<strong>SetupDiGetINFClass</strong>(szINFName, &amp;guid, className, MAX_CLASS_NAME_LEN, 0)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0;<br>};<br>hDevInfo = <strong>SetupDiCreateDeviceInfoList</strong>(&amp;guid, 0);<br>if (hDevInfo == (void*)-1) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0;<br>};<br>spDevData.cbSize = sizeof(SP_DEVINFO_DATA);<br>if (!<strong>SetupDiCreateDeviceInfo</strong>(hDevInfo,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; className,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;guid,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0L,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0L,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DICD_GENERATE_ID,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;spDevData)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>SetupDiDestroyDeviceInfoList</strong>(hDevInfo);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0;<br>};<span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"></span></span></p>
<p><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">If this device instance is being added to a set that has an associated class, the device class must be the same or the call fails. In this case, a call to GetLastError returns <strong>ERROR_CLASS_MISMATCH</strong>.</span></p>
<p><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">If the specified device instance is the same as an existing device instance key in the registry, the call fails. In this case, a call to GetLastError returns <strong>ERROR_DEVINST_ALREADY_EXISTS</strong>. This occurs only if the <strong>DICD_GENERATE_ID</strong> flag is not set.</span></p>
<p><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana">If the new device information element was successfully created but the caller-supplied DeviceInfoData buffer is invalid, the function returns FALSE. In this case, a call to GetLastError returns <strong>ERROR_INVALID_USER_BUFFER</strong>. However, the device information element will have been added as a new member of the set already.<span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 9pt; color: rgba(0, 0, 0, 1); font-family: &quot;Courier New&quot;"><span lang="EN-US" style="font-size: 10pt; color: rgba(0, 0, 0, 1); font-family: Verdana"></span></span></span></span></span></span></span></span></span></p>
<p>That's it! If you have any suggestions or problems to report, post them here. There are plenty of ways this idea could be extended if you are of an inclination to do so.&lt;o:p&gt;</p></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></body></html>


						</div>
						

						

						<div class="float-right" style="margin:20px 0 0 10px;border:1px solid #ccc">
						<div class="msg-300x250" data-format="300x250" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/Win32-64-SDK-OS/Windows-General"  data-country='US' data-loadOnView='true'  data-tags='VC6, Win2K, WinXP, Win2003, C++, Windows, Visual-Studio, Dev, Intermediate,rating4.5'><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Win32-64-SDK-OS/Windows-General&sz=300x250&c=319667"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Win32-64-SDK-OS/Windows-General&sz=300x250&c=319667"  width="300px" height="250px" target="_blank"/></a></noscript></div>
						</div>
                        
                        
						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article has no explicit license attached to it but may contain usage terms in the article text or the download files themselves. If in doubt please contact the author via the discussion board below.</p><p>A list of licenses authors might use can be found <a href="/info/Licenses.aspx">here</a></p></div>
						<h2>Share</h2>
				        <div class="share-list">
					        

    <ul class="rrssb-buttons clearfix">
        <li id="ctl00_SocialLike_Email" class="email compact">
            <a href="mailto:?subject=Enumerating%20windows%20device%20-%20CodeProject&amp;body=Here%27s%20an%20interesting%20article%20on%20for%20you%20on%20codeproject.com%0a%0aEnumerating%20the%20device%20using%20the%20SetupDi*%20API%20provided%20with%20WinXP%0a%0ahttps%3a%2f%2fwww.codeproject.com%2fArticles%2f14412%2fEnumerating-windows-device%0a">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                        version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" 
                        enable-background="new 0 0 28 28" xml:space="preserve">
                        <g>
                            <path d="M20.111 26.147c-2.336 1.051-4.361 1.401-7.125 1.401c-6.462 0-12.146-4.633-12.146-12.265 
                                c0-7.94 5.762-14.833 14.561-14.833c6.853 0 11.8 4.7 11.8 11.252c0 5.684-3.194 9.265-7.399 
                                9.3 c-1.829 0-3.153-0.934-3.347-2.997h-0.077c-1.208 1.986-2.96 2.997-5.023 2.997c-2.532 
                                0-4.361-1.868-4.361-5.062 c0-4.749 3.504-9.071 9.111-9.071c1.713 0 3.7 0.4 4.6 0.973l-1.169 
                                7.203c-0.388 2.298-0.116 3.3 1 3.4 c1.673 0 3.773-2.102 3.773-6.58c0-5.061-3.27-8.994-9.303-8.994c-5.957 
                                0-11.175 4.673-11.175 12.1 c0 6.5 4.2 10.2 10 10.201c1.986 0 4.089-0.43 5.646-1.245L20.111 
                                26.147z M16.646 10.1 c-0.311-0.078-0.701-0.155-1.207-0.155c-2.571 0-4.595 2.53-4.595 5.529c0 
                                1.5 0.7 2.4 1.9 2.4 c1.441 0 2.959-1.828 3.311-4.087L16.646 10.068z"></path>
                        </g>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Twitter" class="twitter compact">
            <a href="http://twitter.com/home?status=Enumerating+windows+device+-+CodeProject+-+https%3a%2f%2fwww.codeproject.com%2fArticles%2f14412%2fEnumerating-windows-device" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                        x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M24.253,8.756C24.689,17.08,18.297,24.182,9.97,24.62c-3.122,0.162-6.219-0.646-8.861-2.32
                        c2.703,0.179,5.376-0.648,7.508-2.321c-2.072-0.247-3.818-1.661-4.489-3.638c0.801,0.128,1.62,0.076,2.399-0.155
                        C4.045,15.72,2.215,13.6,2.115,11.077c0.688,0.275,1.426,0.407,2.168,0.386c-2.135-1.65-2.729-4.621-1.394-6.965
                        C5.575,7.816,9.54,9.84,13.803,10.071c-0.842-2.739,0.694-5.64,3.434-6.482c2.018-0.623,4.212,0.044,5.546,1.683
                        c1.186-0.213,2.318-0.662,3.329-1.317c-0.385,1.256-1.247,2.312-2.399,2.942c1.048-0.106,2.069-0.394,3.019-0.851
                        C26.275,7.229,25.39,8.196,24.253,8.756z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Facebook" class="facebook compact">
            
            <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.codeproject.com%2fArticles%2f14412%2fEnumerating-windows-device" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                        x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M27.825,4.783c0-2.427-2.182-4.608-4.608-4.608H4.783c-2.422,0-4.608,2.182-4.608,4.608v18.434
                            c0,2.427,2.181,4.608,4.608,4.608H14V17.379h-3.379v-4.608H14v-1.795c0-3.089,2.335-5.885,5.192-5.885h3.718v4.608h-3.726
                            c-0.408,0-0.884,0.492-0.884,1.236v1.836h4.609v4.608h-4.609v10.446h4.916c2.422,0,4.608-2.188,4.608-4.608V4.783z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_LinkedIn" class="linkedin compact">
            <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f14412%2fEnumerating-windows-device&amp;title=Enumerating+windows+device+-+CodeProject&amp;summary=Enumerating+the+device+using+the+SetupDi*+API+provided+with+WinXP&amp;source=codeproject.com" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                        x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M25.424,15.887v8.447h-4.896v-7.882c0-1.979-0.709-3.331-2.48-3.331c-1.354,0-2.158,0.911-2.514,1.803
                            c-0.129,0.315-0.162,0.753-0.162,1.194v8.216h-4.899c0,0,0.066-13.349,0-14.731h4.899v2.088c-0.01,0.016-0.023,0.032-0.033,0.048
                            h0.033V11.69c0.65-1.002,1.812-2.435,4.414-2.435C23.008,9.254,25.424,11.361,25.424,15.887z M5.348,2.501
                            c-1.676,0-2.772,1.092-2.772,2.539c0,1.421,1.066,2.538,2.717,2.546h0.032c1.709,0,2.771-1.132,2.771-2.546
                            C8.054,3.593,7.019,2.501,5.343,2.501H5.348z M2.867,24.334h4.897V9.603H2.867V24.334z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Reddit" class="reddit compact">
            <a href="http://www.reddit.com/submit?url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f14412%2fEnumerating-windows-device&amp;title=Enumerating+windows+device+-+CodeProject">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" 
                        x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" 
                        enable-background="new 0 0 28 28" xml:space="preserve"><g>
                    <path d="M11.794 15.316c0-1.029-0.835-1.895-1.866-1.895c-1.03 0-1.893 0.865-1.893 1.895s0.863 1.9 1.9 1.9 C10.958 17.2 11.8 16.3 11.8 15.316z"></path>
                    <path d="M18.1 13.422c-1.029 0-1.895 0.864-1.895 1.895c0 1 0.9 1.9 1.9 1.865c1.031 0 1.869-0.836 1.869-1.865 C19.969 14.3 19.1 13.4 18.1 13.422z"></path>
                    <path d="M17.527 19.791c-0.678 0.678-1.826 1.006-3.514 1.006c-0.004 0-0.009 0-0.014 0c-0.004 0-0.01 0-0.015 0 
                    c-1.686 0-2.834-0.328-3.51-1.005c-0.264-0.265-0.693-0.265-0.958 0c-0.264 0.265-0.264 0.7 0 1 c0.943 0.9 2.4 1.4 
                    4.5 1.402c0.005 0 0 0 0 0c0.005 0 0 0 0 0c2.066 0 3.527-0.459 4.47-1.402 c0.265-0.264 0.265-0.693 0.002-0.958C18.221 
                    19.5 17.8 19.5 17.5 19.791z"></path><path d="M27.707 13.267c0-1.785-1.453-3.237-3.236-3.237c-0.793 0-1.518 0.287-2.082 
                    0.761c-2.039-1.295-4.646-2.069-7.438-2.219 l1.483-4.691l4.062 0.956c0.071 1.4 1.3 2.6 2.7 2.555c1.488 0 2.695-1.208 
                    2.695-2.695C25.881 3.2 24.7 2 23.2 2 c-1.059 0-1.979 0.616-2.42 1.508l-4.633-1.091c-0.344-0.081-0.693 0.118-0.803 
                    0.455l-1.793 5.7 C10.548 8.6 7.7 9.4 5.6 10.75C5.006 10.3 4.3 10 3.5 10.029c-1.785 0-3.237 1.452-3.237 3.2 c0 1.1 0.6 
                    2.1 1.4 2.69c-0.04 0.272-0.061 0.551-0.061 0.831c0 2.3 1.3 4.4 3.7 5.9 c2.299 1.5 5.3 2.3 8.6 2.325c3.228 0 6.271-0.825 
                    8.571-2.325c2.387-1.56 3.7-3.66 3.7-5.917 c0-0.26-0.016-0.514-0.051-0.768C27.088 15.5 27.7 14.4 27.7 13.267z M23.186 
                    3.355c0.74 0 1.3 0.6 1.3 1.3 c0 0.738-0.6 1.34-1.34 1.34s-1.342-0.602-1.342-1.34C21.844 4 22.4 3.4 23.2 3.355z M1.648 
                    13.3 c0-1.038 0.844-1.882 1.882-1.882c0.31 0 0.6 0.1 0.9 0.209c-1.049 0.868-1.813 1.861-2.26 2.9 C1.832 14.2 1.6 13.8 1.6 
                    13.267z M21.773 21.57c-2.082 1.357-4.863 2.105-7.831 2.105c-2.967 0-5.747-0.748-7.828-2.105 
                    c-1.991-1.301-3.088-3-3.088-4.782c0-1.784 1.097-3.484 3.088-4.784c2.081-1.358 4.861-2.106 7.828-2.106 c2.967 0 5.7 
                    0.7 7.8 2.106c1.99 1.3 3.1 3 3.1 4.784C24.859 18.6 23.8 20.3 21.8 21.57z M25.787 14.6 
                    c-0.432-1.084-1.191-2.095-2.244-2.977c0.273-0.156 0.59-0.245 0.928-0.245c1.035 0 1.9 0.8 1.9 1.9 
                    C26.354 13.8 26.1 14.3 25.8 14.605z"></path></g></svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Pinterest" class="pinterest compact">
            <a href="http://pinterest.com/pin/create/bookmarklet/?is_video=false&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f14412%2fEnumerating-windows-device&amp;description=Enumerating+windows+device+-+CodeProject">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                        x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M14.021,1.57C6.96,1.57,1.236,7.293,1.236,14.355c0,7.062,5.724,12.785,12.785,12.785c7.061,0,12.785-5.725,12.785-12.785
                        C26.807,7.294,21.082,1.57,14.021,1.57z M15.261,18.655c-1.161-0.09-1.649-0.666-2.559-1.219c-0.501,2.626-1.113,5.145-2.925,6.458
                        c-0.559-3.971,0.822-6.951,1.462-10.116c-1.093-1.84,0.132-5.545,2.438-4.632c2.837,1.123-2.458,6.842,1.099,7.557
                        c3.711,0.744,5.227-6.439,2.925-8.775c-3.325-3.374-9.678-0.077-8.897,4.754c0.19,1.178,1.408,1.538,0.489,3.168
                        C7.165,15.378,6.53,13.7,6.611,11.462c0.131-3.662,3.291-6.227,6.46-6.582c4.007-0.448,7.771,1.474,8.29,5.239
                        c0.579,4.255-1.816,8.865-6.102,8.533L15.261,18.655z"></path>
                    </svg>
                </span>
                
            </a>
        </li>

    </ul>



				        </div> 
    			        
                        <h2 id="ctl00_AboutHeading">About the Author</h2>
						    

<div class="author-wrapper">

    <div class="pic-wrapper"> 
        <img id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto" class="profile-pic" src="https://www.codeproject.com/script/Membership/Images/member_unknown.gif" border="0" style="transform:rotate(-2deg);" />
    </div>

    <div class="container-member">  
        <b><a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink" class="author" href="/Members/Chuan-Liang-Teng">Chuan-Liang Teng</a></b>

        <table>
        <tr>
            <td rowspan="2" nowrap valign="middle">
            
            </td>
            <td nowrap="nowrap">
                <div class="company">
                    <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle">Software Developer (Senior)</span>
	                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberCompany">Shan Hon Co., Ltd.</span>
                </div>
            </td>
            <td rowspan="2" style="padding-left:15px">
                
            </td>
        </tr>
        <tr>
            <td>
                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation">Taiwan <img src="/script/Geo/Images/TW.gif" alt="Taiwan" width="16px" height="11px" /></span>
            </td>
        </tr>
        </table>
    </div>

    <div class="description">
        No Biography provided

        
    </div>

</div><br />
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    <div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/Win32-64-SDK-OS/Windows-General"  data-country='US' data-loadOnView='true'  data-tags='VC6, Win2K, WinXP, Win2003, C++, Windows, Visual-Studio, Dev, Intermediate,rating4.5,pos_bottom'><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Win32-64-SDK-OS/Windows-General&sz=728x90&c=319667"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Win32-64-SDK-OS/Windows-General&sz=728x90&c=319667"  width="728px" height="90px" target="_blank"/></a></noscript></div>
				</div>
				
                
                

				
				

					<h2>Comments and Discussions</h2>
					<a class="float-left" name="_comments" id="_comments">&nbsp;</a><div id="_MessageBoardctl00_MessageBoard" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(event, null)">
<table id="ForumTable" class="forum relaxed" cellpadding="0" cellspacing="0">
<tr>
<td><a name="xx0xx"></a><table border="0" cellpadding="2px" cellspacing="0" width="100%">
<tr class="navbar">
<td></td><td align="right" width="50%"></td><td align="right" nowrap="nowrap"><span class="nav-link disabled">First</span> <span class="nav-link disabled">Prev</span><a class="nav-link" name="Frm_HoverNL" href="/Articles/14412/Enumerating-windows-device?fid=315712&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;fr=26#xx0xx">Next</a></td>
</tr>
</table></td>
</tr><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%" class="fixed-layout blank-background">
<tr id="F5439020_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx5439020xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="5439020" parent="0" thread="5439020" href="/Messages/5439020/Is-there-a-way-to-detect-the-Driverversion-of-the">Is there a way to detect the Driverversion of the Networkcard?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Member 11313032</span><span class="date">27-Sep-17  8:10</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=11313032">Member 11313032</a></span></td><td class="date"><span>27-Sep-17  8:10&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F5439020_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="11313032" data-objectref="3_5439020" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">I want to know the Driver Version no without the need of using WMI.<br />
With WMI its easy but i want to know how this works without it.<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4949481_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx4949481xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="4949481" parent="0" thread="4949481" href="/Messages/4949481/Get-specified-device-info">Get specified device info</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Mr.ExA-MaN</span><span class="date">23-Nov-14  0:49</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=9706049">Mr.ExA-MaN</a></span></td><td class="date"><span>23-Nov-14  0:49&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F4949481_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="9706049" data-objectref="3_4949481" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">Is there a way to get info about the specified device only?<br />
I want to get the name of the processor and the GPU, without enumerating all other devices ...<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4750271_h0" class="header hover-row root">
<td class="subject-line normal vote-hi " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx4750271xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="4750271" parent="0" thread="4750271" href="/Messages/4750271/Are-you-able-to-read-the-Fields-in-the-Details-Fie">Are you able to read the Fields in the "Details" Field of a Property Tab????</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Member 2217600</span><span class="date">3-Feb-14  3:00</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=2217600">Member 2217600</a></span></td><td class="date"><span>3-Feb-14  3:00&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F4750271_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="2217600" data-objectref="3_4750271" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">Its a great code but , have you been able to read the Fields in the "Details" Field of a Property Tab (when you right click the device in the device manager)<br />
Eagerly Waiting to Know this !<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4663904_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx4663904xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="4663904" parent="0" thread="4663904" href="/Messages/4663904/This-programm-does-not-iterate-the-video-devices-c">This programm does not iterate the video devices correctly</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Seikilos</span><span class="date">20-Sep-13  2:55</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=3600656">Seikilos</a></span></td><td class="date"><span>20-Sep-13  2:55&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F4663904_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="3600656" data-objectref="3_4663904" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">I have two different screens attached and the tool outputs the same parameters and name for both.<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4575274_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx4575274xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="4575274" parent="0" thread="4575274" href="/Messages/4575274/Enumerating-Devices-Used-by-Each-Process">Enumerating Devices Used by Each Process?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Darwin Airola</span><span class="date">29-May-13  8:48</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=1202639">Darwin Airola</a></span></td><td class="date"><span>29-May-13  8:48&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F4575274_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="1202639" data-objectref="3_4575274" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">Is there a way to determine which hardware devices each process is using on a Windows system?<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4390810_h0" class="header hover-row root">
<td class="subject-line normal vote-hi " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx4390810xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="4390810" parent="0" thread="4390810" href="/Messages/4390810/Windows-8-issue">Windows 8 issue</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Hellmaster6669</span><span class="date">8-Oct-12  0:14</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=6139376">Hellmaster6669</a></span></td><td class="date"><span>8-Oct-12  0:14&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F4390810_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="6139376" data-objectref="3_4390810" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">There seems to be a problem with Windows 8. I am always getting CR_CALL_NOT_IMPLEMENTED 0x00000034 code with CM_Get_First_Log_Conf method. Is there any workaround or they changed API?<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4745060_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="38px" class="indent"><a name="xx4745060xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer" /></td><td class="subject hover-container"><a class="message-link" name="4745060" parent="4390810" thread="4390810" href="/Messages/4745060/Re-Windows-8-issue">Re: Windows 8 issue</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">arnoudmulder</span><span class="date">26-Jan-14  5:00</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=4117261">arnoudmulder</a></span></td><td class="date"><span>26-Jan-14  5:00&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F4745060_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="38"><span class="rating-vote vertical" data-ownerid="4117261" data-objectref="3_4745060" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4390810);" href="/Messages/4390810/Windows-8-issue"><img src="https://www.codeproject.com/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent"  style="width:16px;height:16px;border:0" /></a></div>see msdn, if running a 64 bit OS you need to create a 64 bit application and vica versa.<br />
<br />
<a href="http://msdn.microsoft.com/en-us/library/windows/hardware/ff538522(v=vs.85).aspx">http://msdn.microsoft.com/en-us/library/windows/hardware/ff538522(v=vs.85).aspx</a>[<a href="http://msdn.microsoft.com/en-us/library/windows/hardware/ff538522(v=vs.85).aspx" target="_blank" title="New Window">^</a>]<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4042812_h0" class="header hover-row root">
<td class="subject-line normal vote-hi " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx4042812xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="4042812" parent="0" thread="4042812" href="/Messages/4042812/How-can-I-get-information-about-devices-that-were">How can I get information about devices that were not successfully installed?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">debby21</span><span class="date">4-Oct-11  7:11</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=7117176">debby21</a></span></td><td class="date"><span>4-Oct-11  7:11&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F4042812_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="7117176" data-objectref="3_4042812" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">Hi,<br />
<br />
first of all, Great article! excellent work.<br />
I need to find devices that are not successfully installed.<br />
They apear in the device manager as "other devices"<br />
but I can't fugure out how to get them using the setupDiXXX methods.<br />
<br />
<br />
Thanks<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F3968679_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx3968679xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="3968679" parent="0" thread="3968679" href="/Messages/3968679/Thanks-Is-there-any-way-to-modify-device-orrder">Thanks! Is there any way to modify device orrder??</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">tbfisher</span><span class="date">23-Jul-11  8:02</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=6212086">tbfisher</a></span></td><td class="date"><span>23-Jul-11  8:02&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F3968679_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="6212086" data-objectref="3_3968679" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">Great article. Do you know of any way to change the order that similar devices such as capture devices appear? For example, I have a native C++ app that will only connect to the first video capture device that it detects. Since I don't have the source, I cannot change this behavior. Any ideas, suggestions are appreciated.<br />
<br />
TB<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F3890977_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx3890977xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="3890977" parent="0" thread="3890977" href="/Messages/3890977/The-regedits-information-of-LPTIO-is-deleted-when">The regedit's information of LPTIO is deleted when restart PC</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Member 7900533</span><span class="date">12-May-11  23:18</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=7900533">Member 7900533</a></span></td><td class="date"><span>12-May-11  23:18&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F3890977_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="7900533" data-objectref="3_3890977" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">Hi,<br />
I use your DevMgr.exe to install a LPTIO.inf file(for parallel port), after installing, it works well. But when I restart PC, the information (GUID,HardID etc)in the regedit will be deleted sometimes, so would you like give me some advice? Tjanks!<br />
the LPTIO.inf file like below<br />
<pre>[Version]
Signature="$WINDOWS NT$"
Class=LPTIO
ClassGuid={78A1C341-4539-11d3-B88D-00C04FAD5171}
Provider=%Realsil%
DriverVer=09/14/2009,6.0.5736.1
CatalogFile=LPTIO.cat

[DestinationDirs]
DefaultDestDir = 12

; ================= Class section =====================

[ClassInstall32]
Addreg=LPTIOClassReg     

[LPTIOClassReg]
HKR,,,0,%ClassName%
HKR,,Icon,,-5
HKR,,DeviceCharacteristics,0x10001,0x100     ;Use same security checks on relative opens
HKR,,Security,,"D:P(A;;GA;;;SY)(A;;GA;;;BA)" ;Allow generic all access to system and built-in Admin. 


; ================= Device Install section =====================

[Manufacturer]
%Realsil%=Realsil,NTamd64

; For Win2K
[Realsil]
%LPTIO.DRVDESC%=LPTIO_Inst,root\LPTIO

; For XP and later
[Realsil.NTamd64]
%LPTIO.DRVDESC%=LPTIO_Inst,root\LPTIO

[LPTIO_Inst.NT]
CopyFiles=LPTIO.CopyFiles
LogConfig=LPTIO.LC0, LPTIO.LC1

[LPTIO.CopyFiles]
LPTIO.sys

[LPTIO_Inst.NT.Services]
AddService=LPTIO,0x00000002,LPTIO_Service 

;Uncomment following lines if your device can only work with factory default settings
;[LPTIO.NT.FactDef]
;ConfigPriority=HARDRECONFIG
;IOConfig=300-303(3ff::)  ; 10 bit decode ranging from 300 - 303

[LPTIO.LC0]
ConfigPriority=DESIRED 
IOConfig=300-303(3ff::)  ; 10 bit decode ranging from 300 - 303

[LPTIO.LC1]
ConfigPriority=NORMAL
IOConfig=4@300-3ff(3ff::) ; 4 ports starting anywhere between 300 and 3fc

[LPTIO_Service]
DisplayName    = %LPTIO.SVCDESC%                            
ServiceType    = 1                  ; SERVICE_KERNEL_DRIVER
StartType      = 3                  ; SERVICE_DEMAND_START
ErrorControl   = 1                  ; SERVICE_ERROR_NORMAL
ServiceBinary  = %12%\LPTIO.sys                            

[SourceDisksFiles]
LPTIO.sys=1,,

[SourceDisksNames]
1 = %DiskId1%,,,""

; ADDING NEW ---------------------------

[DestinationDirs]
LPTIO_Device_CoInstaller_CopyFiles = 11

[LPTIO_Device.NT.CoInstallers]
AddReg=LPTIO_Device_CoInstaller_AddReg
CopyFiles=LPTIO_Device_CoInstaller_CopyFiles

[LPTIO_Device_CoInstaller_AddReg]
HKR,,CoInstallers32,0x00010000, "wdfcoinstaller$KMDFCOINSTALLERVERSION$.dll,WdfCoInstaller"

[LPTIO_Device_CoInstaller_CopyFiles]
WdfCoInstaller$KMDFCOINSTALLERVERSION$.dll

[SourceDisksFiles]
wdfcoinstaller$KMDFCOINSTALLERVERSION$.dll=1 ; make sure the number matches with SourceDisksNames

[LPTIO_Device.NT.Wdf]
KmdfService =  LPTIO, LPTIO_wdfsect

[LPTIO_wdfsect]
KmdfLibraryVersion = $KMDFVERSION$

; DONE ADDING NEW ----------------------------
[Strings]
Realsil = "Realsil"
ClassName = "LPTIO Device Drivers"
LPTIO.SVCDESC = "LPTIO Device Service"
LPTIO.DRVDESC = "LPTIO Device Driver"
DiskId1 = "LPTIO Device Install Disk"</pre><br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F3572722_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx3572722xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="3572722" parent="0" thread="3572722" href="/Messages/3572722/Getting-Device-Information">Getting Device Information</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">gilmarshow</span><span class="date">21-Aug-10  4:03</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=3039891">gilmarshow</a></span></td><td class="date"><span>21-Aug-10  4:03&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F3572722_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="3039891" data-objectref="3_3572722" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">Hi,<br />
Is it possible to get the device information in a device connected in COM port, such as the serial number of the device, its manufacturer, etc?<br />
<br />
regards<br />
g<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F2921750_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx2921750xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="2921750" parent="0" thread="2921750" href="/Messages/2921750/Can-I-get-the-status-of-the-device">Can I get the status of the device</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">jkally</span><span class="date">12-Feb-09  2:46</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=151605">jkally</a></span></td><td class="date"><span>12-Feb-09  2:46&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F2921750_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="151605" data-objectref="3_2921750" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">If it's enabled or disabled<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F3485949_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="38px" class="indent"><a name="xx3485949xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer" /></td><td class="subject hover-container"><a class="message-link" name="3485949" parent="2921750" thread="2921750" href="/Messages/3485949/Re-Can-I-get-the-status-of-the-device">Re: Can I get the status of the device</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Babybaer</span><span class="date">27-May-10  20:46</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=61025">Babybaer</a></span></td><td class="date"><span>27-May-10  20:46&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F3485949_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="38"><span class="rating-vote vertical" data-ownerid="61025" data-objectref="3_3485949" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,2921750);" href="/Messages/2921750/Can-I-get-the-status-of-the-device"><img src="https://www.codeproject.com/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent"  style="width:16px;height:16px;border:0" /></a></div>Maybe it helps <a href="">http://www.codeproject.com/KB/cs/HardwareHelper.aspx</a><br />
<div class="signature">Mfg@Babybaer</div><br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F3488129_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="56px" class="indent"><a name="xx3488129xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="3488129" parent="3485949" thread="2921750" href="/Messages/3488129/Re-Can-I-get-the-status-of-the-device">Re: Can I get the status of the device</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Chuan-Liang Teng</span><span class="date">30-May-10  6:21</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=64973">Chuan-Liang Teng</a></span></td><td class="date"><span>30-May-10  6:21&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F3488129_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="56"><span class="rating-vote vertical" data-ownerid="64973" data-objectref="3_3488129" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,3485949);" href="/Messages/3485949/Re-Can-I-get-the-status-of-the-device"><img src="https://www.codeproject.com/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent"  style="width:16px;height:16px;border:0" /></a></div>Dear,<br />
I don't know what you mean, So could you tell me more and what you want?<br />
Sorry, my English is pool.<br />
Best Regards<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F2882829_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx2882829xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="2882829" parent="0" thread="2882829" href="/Messages/2882829/Link-Error-help-me-please">Link Error, help me, please</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">fuqiang_6347</span><span class="date">15-Jan-09  22:57</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=5530594">fuqiang_6347</a></span></td><td class="date"><span>15-Jan-09  22:57&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F2882829_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="5530594" data-objectref="3_2882829" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">I compile your code with .Net 2005, but show the error as follow:<br />
<br />
--------------------Configuration: DevMgr - Win32 Debug--------------------<br />
Compiling resources...<br />
Compiling...<br />
DevMgr.c<br />
GetTypeInfo.c<br />
Setup.c<br />
SysSetup.c<br />
Util.c<br />
WDMSetup.c<br />
Linking...<br />
Util.obj : error LNK2001: unresolved external symbol __chvalidator<br />
Debug/DevMgr.exe : fatal error LNK1120: 1 unresolved externals<br />
Error executing link.exe.<br />
<br />
DevMgr.exe - 2 error(s), 0 warning(s)<br />
<br />
<br />
Please tell me how can I do, please help me!!!!!!<br />
<br />
Many thanks...... <img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/smiley_smile.gif" align="top" alt="Smile | :)" /><br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F5201972_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="38px" class="indent"><a name="xx5201972xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="5201972" parent="2882829" thread="2882829" href="/Messages/5201972/Re-Link-Error-help-me-please">Re: Link Error, help me, please</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">gonalo</span><span class="date">16-Feb-16  5:53</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=1439576">gonalo</a></span></td><td class="date"><span>16-Feb-16  5:53&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F5201972_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="38"><span class="rating-vote vertical" data-ownerid="1439576" data-objectref="3_5201972" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,2882829);" href="/Messages/2882829/Link-Error-help-me-please"><img src="https://www.codeproject.com/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent"  style="width:16px;height:16px;border:0" /></a></div>Bad ddk versión. You have to use <br />
"Windows XP SP1 DRIVER DVELOPEMENT KIT", November 14, 2002<br />
2600.1106    !!<br />
<div class="signature">hola</div><br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F2846424_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx2846424xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="2846424" parent="0" thread="2846424" href="/Messages/2846424/SetupDiCreateDeviceInterface-and-device-setup-clas">SetupDiCreateDeviceInterface and device setup class GUID</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">t12345678900987654321</span><span class="date">16-Dec-08  4:59</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=1832784">t12345678900987654321</a></span></td><td class="date"><span>16-Dec-08  4:59&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F2846424_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="1832784" data-objectref="3_2846424" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">GetDeviceInterfaceInfo() function looks icorrect for me because it uses setup class GUID from SP_DEVINFO_DATA struct in SetupDiCreateDeviceInterface() API call, while MSDN declares this param as interface class GUID. No error returned, but final DevicePath is unusable because includes setup GUID as it's tail, while I expected to see interface GUID on this place. And CreateFile() always fails on this Devicepath with error "The system cannot find the file specified." You can test this on CD ROM, for example. Also I am not sure if it is possible to add interface info to HDEVINFO set created for setup class enumeration, but no error returned in this call. So my question - is it possible to get correct DevicePath's for all system devices (if device has it of course)?<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F2668172_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx2668172xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="2668172" parent="0" thread="2668172" href="/Messages/2668172/Debug-error">Debug error</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">jenakumarpradyumna</span><span class="date">7-Aug-08  1:16</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=5418222">jenakumarpradyumna</a></span></td><td class="date"><span>7-Aug-08  1:16&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F2668172_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="5418222" data-objectref="3_2668172" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">hi,<br />
  when ever building the project in Debug mode in Win32 compiler(.NET 2005) i'm facing a crash as below- <br />
    <br />
  " Run-Time Check Failure #2 - Stack around the variable 'spDrvInfoDetail' was corrupted. "<br />
<br />
Can any one please help me out,wht may be the solution .<br />
<br />
Thank U <br />
<br />
 <img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/smiley_redface.gif" align="top" alt="Blush | :O" /><br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F2814667_h0" class="header hover-row">
<td class="subject-line normal vote-hi " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="38px" class="indent"><a name="xx2814667xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer" /></td><td class="subject hover-container"><a class="message-link" name="2814667" parent="2668172" thread="2668172" href="/Messages/2814667/Re-Debug-error">Re: Debug error</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Tim McCaffrey</span><span class="date">20-Nov-08  13:24</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=5713675">Tim McCaffrey</a></span></td><td class="date"><span>20-Nov-08  13:24&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F2814667_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="38"><span class="rating-vote vertical" data-ownerid="5713675" data-objectref="3_2814667" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,2668172);" href="/Messages/2668172/Debug-error"><img src="https://www.codeproject.com/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent"  style="width:16px;height:16px;border:0" /></a></div>Replace all the "short" to "int".<br />
<br />
Fix the following lines around line 647 in setup.c<br />
                char szBuf[2048] = {0};<br />
//<br />
                spDrvInfoDetail.cbSize = sizeof(SP_DRVINFO_DETAIL_DATA);<br />
                memcpy(szBuf, &amp;spDrvInfoDetail, sizeof(SP_DRVINFO_DETAIL_DATA));<br />
                dwRequireSize = 0;<br />
                if (SetupDiGetDriverInfoDetail(hDevInfo,<br />
                                               &amp;spDevInfoData,<br />
                                               &amp;spDrvInfoData,<br />
                                               (PSP_DRVINFO_DETAIL_DATA)szBuf,<br />
                                               2048,<br />
                                               &amp;dwRequireSize))<br />
                {<br />
                   SYSTEMTIME sysTime   = {0};<br />
                    char       szTmp[256] = {0};<br />
//<br />
                    memcpy(&amp;spDrvInfoDetail, szBuf, sizeof(SP_DRVINFO_DETAIL_DATA));<br />
					strncpy(szHardware,spDrvInfoDetail.HardwareID, sizeof(szHardware));<br />
<pre>
</pre><br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F5439018_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="56px" class="indent"><a name="xx5439018xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="5439018" parent="2814667" thread="2668172" href="/Messages/5439018/Re-Debug-error">Re: Debug error</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Member 11313032</span><span class="date">27-Sep-17  8:06</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=11313032">Member 11313032</a></span></td><td class="date"><span>27-Sep-17  8:06&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F5439018_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="56"><span class="rating-vote vertical" data-ownerid="11313032" data-objectref="3_5439018" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,2814667);" href="/Messages/2814667/Re-Debug-error"><img src="https://www.codeproject.com/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent"  style="width:16px;height:16px;border:0" /></a></div>Your are the man! <img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/smiley_smile.gif" align="top" alt="Smile | :)" /><br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F2589845_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx2589845xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="2589845" parent="0" thread="2589845" href="/Messages/2589845/Enumerating-windows-device-amp-gt-amp-gt-Console-b">Enumerating windows device &amp;gt;&amp;gt; Console-based version?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Destinyii</span><span class="date">9-Jun-08  17:11</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=3001054">Destinyii</a></span></td><td class="date"><span>9-Jun-08  17:11&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F2589845_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="3001054" data-objectref="3_2589845" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">Hi, nice article there. I was wondering if you happen to have a console-based version of this program which just prints the devices with their corresponding details. If you do, can you also post it up?<br />
Or email to me? <img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/smiley_smile.gif" align="top" alt="Smile | :)" /><br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F2590596_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="38px" class="indent"><a name="xx2590596xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer" /></td><td class="subject hover-container"><a class="message-link" name="2590596" parent="2589845" thread="2589845" href="/Messages/2590596/Re-Enumerating-windows-device-amp-gt-amp-gt-Consol">Re: Enumerating windows device &amp;gt;&amp;gt; Console-based version?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">baternest</span><span class="date">10-Jun-08  3:33</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=2149669">baternest</a></span></td><td class="date"><span>10-Jun-08  3:33&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F2590596_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="38"><span class="rating-vote vertical" data-ownerid="2149669" data-objectref="3_2590596" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,2589845);" href="/Messages/2589845/Enumerating-windows-device-amp-gt-amp-gt-Console-b"><img src="https://www.codeproject.com/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent"  style="width:16px;height:16px;border:0" /></a></div>Check Microsoft DevCon command-line utility<br />
<a href="http://support.microsoft.com/kb/311272">http://support.microsoft.com/kb/311272</a><a href="http://support.microsoft.com/kb/311272" target="_blank" title="New Window"></a><br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F2476738_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx2476738xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="2476738" parent="0" thread="2476738" href="/Messages/2476738/fatal-error-C1083-Cannot-open-include-file-cfg-h-N">fatal error C1083: Cannot open include file: 'cfg.h': No such file or directory</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Thanks for all the fish</span><span class="date">22-Mar-08  5:14</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=3878176">Thanks for all the fish</a></span></td><td class="date"><span>22-Mar-08  5:14&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F2476738_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="3878176" data-objectref="3_2476738" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">i tried to compile the code in VS2003 (had to convert the .dsw file to .sln), and got this error, and the same with newdev.h. how can i fix it?<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F2131637_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx2131637xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="2131637" parent="0" thread="2131637" href="/Messages/2131637/Interact-with-Human-Interface-Devices">Interact with Human Interface Devices</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">IScribe</span><span class="date">15-Jul-07  16:11</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=4196181">IScribe</a></span></td><td class="date"><span>15-Jul-07  16:11&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F2131637_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="4196181" data-objectref="3_2131637" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">Hello Sir,<br />
<br />
I have a task to interact with a "Human Interface Device".<br />
Your example really helped me understand the basics. Thanks.<br />
<br />
But, do you know a way on how to interact with "Human Interface Device"?<br />
For Example, when there is a click of a button on a device, Can we capture that?<br />
Does it send messages? If so, can you guide me on how to get there?<br />
<br />
Thanks in advance.<br />
- VV<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F2098547_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx2098547xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="2098547" parent="0" thread="2098547" href="/Messages/2098547/setupcreatedeviceinfo-error">setupcreatedeviceinfo error</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">karan31c1</span><span class="date">25-Jun-07  4:34</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=3989687">karan31c1</a></span></td><td class="date"><span>25-Jun-07  4:34&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F2098547_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="3989687" data-objectref="3_2098547" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">Hi , <br />
I am using SetUpCreateDeviceInfo()API in my application, It works fine on XP as well as on Vista with UAC OFF, but it fails on Vista with UAC ON. The SetUpCreateDeviceInfo() fails but GetLastError() function returns 0. Can anyone please tell the solution?<br />
 <br />
<br />
Thanks..<br />
Karan<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr>
<td><table width="100%" cellpadding="2px" cellspacing="0">
<tr class="footer">
<td><span class="last-visit desktop-only tablet-only">Last Visit: 7-Dec-20  20:42 &nbsp; &nbsp; Last Update: 7-Dec-20  20:42</span></td><td><a rel="nofollow" href="/Articles/14412/Enumerating-windows-device?fid=315712&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True">Refresh</a></td><td align="right" nowrap="nowrap"><input id="_mbnUrl" type="hidden" value="/Articles/14412/Enumerating-windows-device?fid=315712&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;fr=26" /><span class="nav-link selected">1</span><a class="nav-link" name="Frm_HoverNL" href="/Articles/14412/Enumerating-windows-device?fid=315712&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;fr=26#xx0xx">2</a> <a class="nav-link" name="Frm_HoverNL" href="/Articles/14412/Enumerating-windows-device?fid=315712&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;fr=26#xx0xx">Next ᐅ</a></td>
</tr>
</table></td>
</tr>
</table>
</div><p class="small-text"><img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" width="16px" height="16px" alt="General" /> General &nbsp;&nbsp; <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_news.gif" width="16px" height="16px" alt="News" /> News &nbsp;&nbsp; <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_idea.gif" width="16px" height="16px" alt="Suggestion" /> Suggestion &nbsp;&nbsp; <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" width="16px" height="16px" alt="Question" /> Question &nbsp;&nbsp; <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_bug.gif" width="16px" height="16px" alt="Bug" /> Bug &nbsp;&nbsp; <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_answer.gif" width="16px" height="16px" alt="Answer" /> Answer &nbsp;&nbsp; <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_joke.gif" width="16px" height="16px" alt="Joke" /> Joke &nbsp;&nbsp; <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_kudos.gif" width="16px" height="16px" alt="Praise" /> Praise &nbsp;&nbsp; <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_rant.gif" width="16px" height="16px" alt="Rant" /> Rant &nbsp;&nbsp; <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_admin.gif" width="16px" height="16px" alt="Admin" /> Admin &nbsp;&nbsp; </p><p class="small-text">Use Ctrl+Left/Right to switch messages, Ctrl+Up/Down to switch threads, Ctrl+Shift+Left/Right to switch pages.</p>
				

			</div>
			

            
            <div id="ctl00_RightSideBar" class="article-right-sidebar">

				

                <div id="RHSticky" class="container-article-info-sticky">

        		    

<div class="article-summary">

    
    

</div>

				    <div id="ctl00_SectionSponsor" class="padded-top" style="width:160px;margin:10px auto">
					    <div class="msg-160x200" data-format="160x200" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/Win32-64-SDK-OS/Windows-General"  data-country='US' data-showindicator="true"  data-tags='VC6, Win2K, WinXP, Win2003, C++, Windows, Visual-Studio, Dev, Intermediate,rating4.5'><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Win32-64-SDK-OS/Windows-General&sz=160x200&c=475784"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Win32-64-SDK-OS/Windows-General&sz=160x200&c=475784"  width="160px" height="200px" target="_blank"/></a></noscript></div>
				    </div>

				    <div style="width:160px;margin: 10px auto;">
					    <div class="msg-160x600" data-format="160x600" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Platforms-Frameworks-Libraries/Win32-64-SDK-OS/Windows-General"  data-country='US' data-tags='VC6, Win2K, WinXP, Win2003, C++, Windows, Visual-Studio, Dev, Intermediate,rating4.5'><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Win32-64-SDK-OS/Windows-General&sz=160x600&c=475784"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Platforms-Frameworks-Libraries/Win32-64-SDK-OS/Windows-General&sz=160x600&c=475784"  width="160px" height="600px" target="_blank"/></a></noscript></div>
				    </div>

                    

				    

				    

                    <div class="anchorLink gototop" id="gototop">
                        <a id="ctl00_GoToTop" href="/Articles/14412/Enumerating-windows-device#_articleTop">Go to top</a>
                    </div>

			    </div>
            </div>
            

        </div>
        

		
		<div class="theme1-background" style="height:2px;margin:5px 0" id="stickyStop"></div>

		<div class="site-footer">
			<div class="align-left">
				<a id="ctl00_PermaLink" href="/Articles/14412/Enumerating-windows-device">Permalink</a><br>
				<a id="ctl00_AdvertiseLink" href="http://developermedia.com/">Advertise </a><br>
				<a id="ctl00_PrivacyLink" href="/info/privacy.aspx">Privacy</a><br>
    			<a id="ctl00_CookiePolicyLink" href="/info/cookie.aspx">Cookies</a><br>
                <a id="ctl00_TermsOfUseLink" href="/info/TermsOfUse.aspx">Terms of Use</a><br>
			</div>

            <div class="align-center">
				


<div class="page-width">
    Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="/Articles/14412/Enumerating-windows-device?PageFlow=FixedWidth">fixed</a>
    |
    <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="/Articles/14412/Enumerating-windows-device?PageFlow=Fluid">fluid</a>
</div>


				

				

	            

                <br>
			</div>
                
			<div class="align-right">
				Article Copyright 2006 by Chuan-Liang Teng<br />Everything else
				Copyright &copy; <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2020 <br />
                <br>
				Web04 
				2.8.20201207.1<br>
			</div>
		</div>
		

		<br clear="all" />
		
			

	</div> 
	</div> 
</div>



<img id="ctl00_Audience" src="https://pubads.g.doubleclick.net/activity;dc_iu=/6839/DFPAudiencePixel;ord=&#39;637429885652693986&#39;;dc_seg=33705250?" border="0" height="1" width="1" />



<script type="text/javascript"> // IMMEDIATE script

function Join() {
                                     document.location.href = 'https://www.codeproject.com/script/Membership/Modify.aspx';
                                     return false;
                                  }

var qqruwoyhxy = function(n){var t=!1;n=n||{};var r=n.RetrievalServiceUrl||"/script/content/webservices/RetrieveContent.aspx/GetContent",u=n.RetrievalServiceRetries||3,f=n.RetrievalServiceTimeout||5e3,e=function(){t||(t=!0,$(window).on("resize scroll",i),i())},i=function(){if(typeof DMAds=="undefined"){var n=$('[data-type="ad"]');n.each(function(){var n=$(this),u=n.attr("data-format")||"",f=n.attr("data-publisher")||"",e=n.attr("data-zone")||"",t=n.attr("data-loadonview"),i=n.attr("data-noadx"),h=n.attr("data-tags")||"",c=n.find("iframe").length!==0||n.find("img").length!==0,r=n.attr("data-processed");t=typeof t=="string"&&t.toLowerCase()==="true";i=typeof i=="string"&&i.toLowerCase()==="true";r=typeof r=="string"&&r.toLowerCase()==="true";r||c||t&&!s(this)||(o(n,u,f,e,i,h),n.attr("data-processed","true"))})}},o=function(n,t,i,e,o,s){var h=new $.Deferred,c=JSON.stringify({format:t,publisherCode:i,zone:e,noAdX:o,keywords:s});$.ajax({url:r,cache:!1,type:"POST",data:c,contentType:"application/json; charset=utf-8",dataType:"json",tryCount:0,retryLimit:u,timeout:f}).done(function(t){var i=t?t.d:null;h.resolve(i); i && i.html && n.html(i.html)}).fail(function(n,t){h.reject(t)})},s=function(n){var t,f,e,o;if(!h(n))return!1;var u=!1,i=0,r=0;try{t=n.getBoundingClientRect();typeof innerWidth=="number"?(i=window.innerWidth,r=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(i=document.documentElement.clientWidth,r=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(i=document.body.clientWidth,r=document.body.clientHeight);f=-200;t.top===t.bottom&&(f+=n.height*-1);e=t.top>=0&&t.top-200<=r||t.top<=0&&t.top>=f;o=i>t.left&&t.right>=0;u=e&&o}catch(s){u=!0}return u},h=function(n){var t=!1,i;return n&&n.style.position!=="fixed"&&n.offsetParent?t=!0:n&&n.style.position==="fixed"&&(i=window.getComputedStyle(n),t=i&&i.display!=="none"),t&&c()},c=function(){var t=!0,n="";return typeof document.hidden!="undefined"?n="hidden":typeof document.mozHidden!="undefined"?n="mozHidden":typeof document.msHidden!="undefined"?n="msHidden":typeof document.webkitHidden!="undefined"&&(n="webkitHidden"),n!==null&&document[n]&&(t=!1),t};return{init:e}};
document.addEventListener('DOMContentLoaded', function() {
var n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP"),t;n.onreadystatechange=function(){try{if(n.readyState==4)if(n.status==200){var t=document.createElement("script");t.type="text/javascript";t.innerHTML=n.responseText;document.getElementsByTagName("body")[0].appendChild(t)}else(new qqruwoyhxy).init()}catch(i){(new qqruwoyhxy).init()}};try{t='/a.min.js?v=1.3';n.open("GET",t,!0);n.send()}catch(i){(new qqruwoyhxy).init()}

  $('div[data-type="ad"][data-showindicator="true"]').before('<div class="small-text muted hidden">Advertisement</div>');
  setTimeout(function(){ 
    $('div[data-type="ad"][data-showindicator="true"]').each(function( index ) {
      if ($(this).height() > 0) {
       $(this).prev().removeClass('hidden');
      }
    });
  }, 2000);

});

var ratingCtrl_ctl00_RateArticle;

var forumConfig_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard_forumMsgFlag;
var forumCtrl_ctl00_MessageBoard_rating;
var forumCtrl_ctl00_MessageBoard_ratingConfig;

var subscriptionConfig_ctl00_MessageBoard = {
 ParentId      : 'ctl00_MessageBoard_SubscribeDiv',
 NewId         : 'ctl00_MessageBoard_SubscribeNew',
 ReplyId       : 'ctl00_MessageBoard_SubscribeReplies',
 InstantId     : 'ctl00_MessageBoard_SubscribeInstant',
 DailyId       : 'ctl00_MessageBoard_SubscribeDaily',
 MessageTypeId : 'ctl00_MessageBoard_MessageType',
 GetInfoUrl    : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/GetSubscriptions',
 UpdateInfoUrl : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/UpdateSubscription',
 ForumId       : 315712,
};
var subscriptions_ctl00_MessageBoard;
</script>

<script type="text/javascript"> // DEFERRED script

document.addEventListener('DOMContentLoaded', function() {

	ProcessCodeBlocks.Initialise('#contentdiv');
	
	$('.author-wrapper .description').shorten({showChars: 400});
	
	anchorAnimate();
	$('#RHSticky').sticky($('#stickyStop'));
	$('#ctl00_StickyBlock').sticky($('#stickyStop'));
	
	$('#__EVENTVALIDATION').attr('autocomplete', 'off');
	
	$('#joinBtn').css('visibility', 'visible');
	
	$('.oauth').click(function () {
	    $this = $(this);
	    href = $this.attr('href');
	    var myWindow = window.open(href, 'popup',
	                              'width=800,height=600,location=0,menubar=0,resizeable=0,scrollbars=0,toolbar=0');
	    myWindow.focus();
	    var timer = setInterval(function () {
	        if (myWindow.closed) {
	            clearInterval(timer);
	            // window.location.reload(); // May do a POST reload, shows a warning
	            window.location = window.location; // force a GET reload
	        }
	    }, 200);
	    return false;
	});
	
	var oSrchFlt = false, oSrchBox=false, srchBoxFoc=false;
	var sbar     = $('#sb_tb');
	var sfilter  = $('#SearchFilter');
	
	if (typeof(InitWatermark) !== 'undefined')
	  InitWatermark('sb_tb', 'Search for articles, questions, tips');
	if (sbar && sfilter) {
	  sfilter.removeClass('popup'); sfilter.hide(); sfilter.removeClass('open');
	  sbar.blur(function() {
	    if (!oSrchFlt) { sfilter.hide(); sfilter.removeClass('open'); }
	    srchBoxFoc = false;
	  });
	  sbar.focus(function() {
	    oSrchFlt   = false;
	    srchBoxFoc = true;
	    sfilter.show();
	    sfilter.addClass('open');
	  });
	  sbar.mouseleave(function()    { oSrchBox = false; });
	  sbar.mouseover(function()     { oSrchBox = true; });
	  sfilter.mouseleave(function() {
	    oSrchFlt=false;
	    if (!srchBoxFoc && !oSrchBox) { sfilter.hide(); sfilter.removeClass('open'); }
	  });
	  sfilter.mouseover(function()  { oSrchFlt = true; });
	}
	
	var ratingConfig_ctl00_RateArticle = {
	  objectRef:          '2_14412',
	  objectSubtypeId:    1,
	  objectTypeName:     'article',
	  ownerId:            64973,
	  votingType:         'None',
	  ratingDisplayMode:  'LargeStars',
	  resultDisplayMode:  'LargeStars',
	  ratingCallback:     null,
	  staticServer:       'https://www.codeproject.com',
	  baseDir:            '/script/Ratings/',
	  ratingUrl:          'ajax/RateItem.aspx',
	  histogramUrl:       'ajax/Histogram.aspx',
	  getRatingUrl:       'ajax/GetRatings.aspx',
	  width:              130,
	  forceComment:       false,
	  lowVoteThreshold:   0,
	  minRating:          1,
	  maxRating:          5
	};
	ratingCtrl_ctl00_RateArticle = new RatingControl('#ctl00_RateArticle_RatingTable',ratingConfig_ctl00_RateArticle);
	
	forumConfig_ctl00_MessageBoard_ratingConfig = {
	  objectTypeId:       3,
	  objectTypeName:     'message',
	  bulkResultSelector: '#_MessageBoardctl00_MessageBoard',
	  votingType:         'GoodOrBad',
	  staticServer:       'https://www.codeproject.com',
	  forceComment:       false,
	  ratingDisplayMode:  'TextOnly',
	  resultDisplayMode:  'TextOnly'
	};
	forumCtrl_ctl00_MessageBoard_rating = new RatingControl('#_MessageBoardctl00_MessageBoard .content', forumConfig_ctl00_MessageBoard_ratingConfig);
	forumConfig_ctl00_MessageBoard = {
	    objectName          : 'forumCtrl_ctl00_MessageBoard',
	    messageTypeId       : 3,
	    searchPrompt        : 'Search Comments',
	    smoothScroll        : true,
	    allowReporting      : false,
	    allowRating         : false,
	    allowRatingDisplay  : true,
	    forumDir            : '/script/Forums/',
	    staticServer        : 'https://www.codeproject.com',
	    switchMsgCallback   : null,
	    ratingControl       : forumCtrl_ctl00_MessageBoard_rating,
	    getReportFormMethod : getReportFormHtml,
	    voteHiThreshold     : 5 - 0.5,
	    reportOptions       : [
	       { reportTypeId : 19, name : 'Abusive / Trolling'},
	       { reportTypeId : 20, name : 'Inappropriate'},
	       { reportTypeId : 5, name : 'Spam'},
	    ],
	};
	forumCtrl_ctl00_MessageBoard = new ForumControl('#ForumTable',forumConfig_ctl00_MessageBoard, -1);
	forumCtrl_ctl00_MessageBoard_rating.setConfig('ratingCallback', forumCtrl_ctl00_MessageBoard.showMessageRating);
	forumCtrl_ctl00_MessageBoard.Initialise();
	
	subscriptions_ctl00_MessageBoard = new Subscriptions(subscriptionConfig_ctl00_MessageBoard);
	subscriptions_ctl00_MessageBoard.initialise();
	
	cookieconsent.initialise({
	                                    enabled : true,
	                                    cookie  : { domain: 'codeproject.com' },
	                                    palette : {
	                                        popup: { background: '#ff9900' },
	                                        button: { background: '#f5d948' }
	                                    },
	                                    law :  {
	                                        showForAllRegions : true, 
	                                        countryCode : 'US' 
	                                    },
	                                    theme: 'edgeless',
	                                    type : 'opt-in',
	                                    content: {
	                                        message: 'Like every other website we use cookies. By using our site you acknowledge that you have read and understand our <a href=\'/info/cookie.aspx\'>Cookie Policy</a>, <a href=\'/info/privacy.aspx\'>Privacy Policy</a>, and our <a href=\'/info/TermsOfUse.aspx\'>Terms of Service</a>.',
	                                        href:    'https://www.codeproject.com/info/privacy.aspx',
	                                        dismiss: 'Ask me later'
	                                    },
	                                    revokable:true,
	                                    onStatusChange: function(status) {
	                                        $.ajax({
	                                		    dataType  : 'json',
	                                            data: JSON.stringify({ allowCookies : this.hasConsented() }),
	                                            url: '/script/membership/webservices/LoggedOnMemberservices.aspx/SetCookieConsent',
	                                            cache: false,
	                                            type: 'POST',
	                                            contentType: 'application/json'
	                                        })
	                                        console.log(this.hasConsented() ? 'enable cookies' : 'disable cookies');
	                                        console.log(this.hasAnswered() ? 'has answered' : 'did not answer');
	                                    },
	                                });

})
</script>








</body>

</html>