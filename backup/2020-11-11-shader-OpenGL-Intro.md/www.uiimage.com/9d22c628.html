<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="zh" itemscope="" itemtype="http://schema.org/WebPage"><head><meta charset="utf-8" /><meta http-equiv="x-ua-compatible" content="IE=edge" /><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" /><title>OpenGL ES in iOS - 2. 画一个三角形 - Kim's Blog</title><meta name="description" content="本篇主要目的是 使用 OpenGL ES 画一个三角形，包含 直接上传顶点、使用 VAO、VBO、EBO 他们的组合渲染方式。&#10;建议配合 Demo 工程 食用。" /><meta name="author" content="Kim" /><script type="application/ld+json">{"@context":"http://schema.org","@type":"WebSite","name":"Kim\x27s Blog","url":"https:\/\/www.uiimage.com\/"}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Organization","name":"","url":"https:\/\/www.uiimage.com\/"}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/www.uiimage.com\/","name":"home"}},{"@type":"ListItem","position":3,"item":{"@id":"https:\/\/www.uiimage.com\/post\/blog\/opengl-es\/opengl-es-2-draw-a-triangle\/","name":"Open g l e s in i o s 2. 画一个三角形"}}]}</script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","author":{"name":"Kim"},"headline":"OpenGL ES in iOS - 2. 画一个三角形","description":"本篇主要目的是 使用 OpenGL ES 画一个三角形，包含 直接上传顶点、使用 VAO、VBO、EBO 他们的组合渲染方式。\n建议配合 Demo 工程 食用。\n","inLanguage":"zh","wordCount":1068,"datePublished":"2019-04-29T23:00:00","dateModified":"2019-04-29T23:00:00","image":"https:\/\/www.uiimage.com\/img\/avatar.JPG","keywords":["iOS, OpenGL ES, 音视频"],"mainEntityOfPage":"https:\/\/www.uiimage.com\/post\/blog\/opengl-es\/opengl-es-2-draw-a-triangle\/","publisher":{"@type":"Organization","name":"https:\/\/www.uiimage.com\/","logo":{"@type":"ImageObject","url":"https:\/\/www.uiimage.com\/img\/avatar.JPG","height":60,"width":60}}}</script><meta property="og:title" content="OpenGL ES in iOS - 2. 画一个三角形" /><meta property="og:description" content="本篇主要目的是 使用 OpenGL ES 画一个三角形，包含 直接上传顶点、使用 VAO、VBO、EBO 他们的组合渲染方式。&#10;建议配合 Demo 工程 食用。" /><meta property="og:image" content="https://www.uiimage.com/img/avatar.JPG" /><meta property="og:url" content="https://www.uiimage.com/post/blog/opengl-es/opengl-es-2-draw-a-triangle/" /><meta property="og:type" content="website" /><meta property="og:site_name" content="Kim's Blog" /><meta name="twitter:title" content="OpenGL ES in iOS - 2. 画一个三角形" /><meta name="twitter:description" content="本篇主要目的是 使用 OpenGL ES 画一个三角形，包含 直接上传顶点、使用 VAO、VBO、EBO 他们的组合渲染方式。&#10;建议配合 Demo 工程 食用。" /><meta name="twitter:image" content="https://www.uiimage.com/img/avatar.JPG" /><meta name="twitter:card" content="summary" /><link href="https://www.uiimage.com/img/avatar.JPG" rel="icon" type="image/x-icon" /><meta name="generator" content="Hugo 0.69.2" /><link rel="alternate" href="https://www.uiimage.com/index.xml" type="application/rss+xml" title="Kim's Blog" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous" /><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous" /><link rel="stylesheet" href="https://www.uiimage.com/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" /><link rel="stylesheet" href="https://www.uiimage.com/css/syntax.css" /><link rel="stylesheet" href="https://www.uiimage.com/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css" /><style type="text/css">.v[data-class=v]{font-size:16px;text-align:left}.v[data-class=v] *{-webkit-box-sizing:border-box;box-sizing:border-box;line-height:1.75}.v[data-class=v] .status-bar,.v[data-class=v] .veditor,.v[data-class=v] .vinput,.v[data-class=v] p,.v[data-class=v] pre code{color:#555}.v[data-class=v] .vsys,.v[data-class=v] .vtime{color:#b3b3b3}.v[data-class=v] .text-right{text-align:right}.v[data-class=v] .text-center{text-align:center}.v[data-class=v] img{max-width:100%;border:none}.v[data-class=v] hr{margin:.825em 0;border-color:#f6f6f6;border-style:dashed}.v[data-class=v].hide-avatar .vimg{display:none}.v[data-class=v] a{position:relative;cursor:pointer;color:#1abc9c;text-decoration:none;display:inline-block}.v[data-class=v] a:hover{color:#d7191a}.v[data-class=v] code,.v[data-class=v] pre{background-color:#f8f8f8;padding:.2em .4em;border-radius:3px;font-size:85%;margin:0}.v[data-class=v] pre{padding:10px;overflow:auto;line-height:1.45}.v[data-class=v] pre code{padding:0;background:transparent;white-space:pre-wrap;word-break:keep-all}.v[data-class=v] blockquote{color:#666;margin:.5em 0;padding:0 0 0 1em;border-left:8px solid hsla(0,0%,93%,.5)}.v[data-class=v] .vinput{border:none;resize:none;outline:none;padding:10px 5px;max-width:100%;font-size:.775em}.v[data-class=v] input[type=checkbox],.v[data-class=v] input[type=radio]{display:inline-block;vertical-align:middle;margin-top:-2px}.v[data-class=v] .vicon{cursor:pointer;display:inline-block;overflow:hidden;fill:#555;vertical-align:middle}.v[data-class=v] .vicon+.vicon{margin-left:10px}.v[data-class=v] .vicon.actived{fill:#66b1ff}.v[data-class=v] .vrow{font-size:0;padding:10px 0}.v[data-class=v] .vrow .vcol{display:inline-block;vertical-align:middle;font-size:14px}.v[data-class=v] .vrow .vcol.vcol-20{width:20%}.v[data-class=v] .vrow .vcol.vcol-30{width:30%}.v[data-class=v] .vrow .vcol.vcol-40{width:40%}.v[data-class=v] .vrow .vcol.vcol-50{width:50%}.v[data-class=v] .vrow .vcol.vcol-60{width:60%}.v[data-class=v] .vrow .vcol.vcol-70{width:70%}.v[data-class=v] .vrow .vcol.vcol-80{width:80%}.v[data-class=v] .vrow .vcol.vctrl{font-size:12px}.v[data-class=v] .emoji,.v[data-class=v] .vemoji{max-width:25px;vertical-align:middle;margin:0 1px;display:inline-block}.v[data-class=v] .vwrap{border:1px solid #f0f0f0;border-radius:4px;margin-bottom:10px;overflow:hidden;position:relative;padding:10px}.v[data-class=v] .vwrap input{background:transparent}.v[data-class=v] .vwrap .vedit{position:relative;padding-top:10px}.v[data-class=v] .vwrap .cancel-reply-btn{position:absolute;right:5px;top:5px;cursor:pointer}.v[data-class=v] .vwrap .vemojis{display:none;font-size:18px;max-height:145px;overflow:auto;padding-bottom:10px;-webkit-box-shadow:0 0 1px #f0f0f0;box-shadow:0 0 1px #f0f0f0}.v[data-class=v] .vwrap .vemojis i{font-style:normal;padding-top:7px;width:36px;cursor:pointer;text-align:center;display:inline-block;vertical-align:middle}.v[data-class=v] .vwrap .vpreview{padding:7px;-webkit-box-shadow:0 0 1px #f0f0f0;box-shadow:0 0 1px #f0f0f0}.v[data-class=v] .vwrap .vheader .vinput{width:33.33%;border-bottom:1px dashed #dedede}.v[data-class=v] .vwrap .vheader.item2 .vinput{width:50%}.v[data-class=v] .vwrap .vheader.item1 .vinput{width:100%}.v[data-class=v] .vwrap .vheader .vinput:focus{border-bottom-color:#eb5055}@media screen and (max-width:520px){.v[data-class=v] .vwrap .vheader.item2 .vinput,.v[data-class=v] .vwrap .vheader .vinput{width:100%}}.v[data-class=v] .vpower{color:#999;font-size:.75em;padding:.5em 0}.v[data-class=v] .vpower a{font-size:.75em}.v[data-class=v] .vcount{padding:5px;font-weight:600;font-size:1.25em}.v[data-class=v] ol,.v[data-class=v] ul{padding:0;margin-left:1.25em}.v[data-class=v] .txt-center{text-align:center}.v[data-class=v] .txt-right{text-align:right}.v[data-class=v] .pd5{padding:5px}.v[data-class=v] .pd10{padding:10px}.v[data-class=v] .veditor{width:100%;min-height:8.75em;font-size:.875em;background:transparent;resize:vertical;-webkit-transition:all .25s ease;transition:all .25s ease}.v[data-class=v] .vbtn{-webkit-transition-duration:.4s;transition-duration:.4s;text-align:center;color:#555;border:1px solid #ededed;border-radius:.3em;display:inline-block;background:transparent;margin-bottom:0;font-weight:400;vertical-align:middle;-ms-touch-action:manipulation;touch-action:manipulation;cursor:pointer;white-space:nowrap;padding:.5em 1.25em;font-size:.875em;line-height:1.42857143;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;outline:none}.v[data-class=v] .vbtn+.vbtn{margin-left:1.25em}.v[data-class=v] .vbtn:active,.v[data-class=v] .vbtn:hover{color:#3090e4;border-color:#3090e4}.v[data-class=v] .vbtn:disabled{border-color:#e1e1e1;color:#e1e1e1;background-color:#fdfafa;cursor:not-allowed}.v[data-class=v] .vempty{padding:1.25em;text-align:center;color:#555;overflow:auto}.v[data-class=v] .vsys{display:inline-block;padding:.2em .5em;font-size:.75em;border-radius:.2em;margin-right:.3em}@media screen and (max-width:520px){.v[data-class=v] .vsys{display:none}}.v[data-class=v] .vcards{width:100%}.v[data-class=v] .vcards .vcard{padding-top:1.25em;position:relative;display:block}.v[data-class=v] .vcards .vcard:after{content:"";clear:both;display:block}.v[data-class=v] .vcards .vcard .vimg{width:3.125em;height:3.125em;float:left;border-radius:50%;margin-right:.7525em;border:1px solid #f5f5f5;padding:.125em}@media screen and (max-width:720px){.v[data-class=v] .vcards .vcard .vimg{width:2.5em;height:2.5em}}.v[data-class=v] .vcards .vcard .vhead{line-height:1.5;margin-top:0}.v[data-class=v] .vcards .vcard .vhead .vnick{position:relative;font-size:.875em;font-weight:500;margin-right:.875em;cursor:pointer;text-decoration:none;display:inline-block}.v[data-class=v] .vcards .vcard .vhead .vnick:hover{color:#d7191a}.v[data-class=v] .vcards .vcard .vh{overflow:hidden;padding-bottom:.5em;border-bottom:1px dashed #f5f5f5}.v[data-class=v] .vcards .vcard .vh .vtime{font-size:.75em;margin-right:.875em}.v[data-class=v] .vcards .vcard .vh .vmeta{line-height:1;position:relative}.v[data-class=v] .vcards .vcard .vh .vmeta .vat{font-size:.8125em;color:#ef2f11;cursor:pointer;float:right}.v[data-class=v] .vcards .vcard:last-child .vh{border-bottom:none}.v[data-class=v] .vcards .vcard .vcontent{word-wrap:break-word;word-break:break-all;font-size:.875em;line-height:2;position:relative;margin-bottom:.75em;padding-top:.625em}.v[data-class=v] .vcards .vcard .vcontent.expand{cursor:pointer;max-height:8em;overflow:hidden}.v[data-class=v] .vcards .vcard .vcontent.expand:before{display:block;content:"";position:absolute;width:100%;left:0;top:0;bottom:3.15em;background:-webkit-gradient(linear,left top,left bottom,from(hsla(0,0%,100%,0)),to(hsla(0,0%,100%,.9)));background:linear-gradient(180deg,hsla(0,0%,100%,0),hsla(0,0%,100%,.9));z-index:999}.v[data-class=v] .vcards .vcard .vcontent.expand:after{display:block;content:attr(data-expand);text-align:center;color:#828586;position:absolute;width:100%;height:3.15em;line-height:3.15em;left:0;bottom:0;z-index:999;background:hsla(0,0%,100%,.9)}.v[data-class=v] .vcards .vcard .vquote{padding-left:1em;border-left:1px dashed hsla(0,0%,93%,.5)}.v[data-class=v] .vcards .vcard .vquote .vimg{width:2.225em;height:2.225em}.v[data-class=v] .vpage .vmore{margin:1em 0}.v[data-class=v] .clear{content:"";display:block;clear:both}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@-webkit-keyframes pulse{50%{background:#dcdcdc}}@keyframes pulse{50%{background:#dcdcdc}}.v[data-class=v] .vspinner{width:22px;height:22px;display:inline-block;border:6px double #a0a0a0;border-top-color:transparent;border-bottom-color:transparent;border-radius:50%;-webkit-animation:spin 1s infinite linear;animation:spin 1s infinite linear;position:relative;vertical-align:middle;margin:0 5px}.dark .v[data-class=v] .status-bar,.dark .v[data-class=v] .veditor,.dark .v[data-class=v] .vinput,.dark .v[data-class=v] p,.dark .v[data-class=v] pre code,.night .v[data-class=v] .status-bar,.night .v[data-class=v] .veditor,.night .v[data-class=v] .vinput,.night .v[data-class=v] p,.night .v[data-class=v] pre code,.theme__dark .v[data-class=v] .status-bar,.theme__dark .v[data-class=v] .veditor,.theme__dark .v[data-class=v] .vinput,.theme__dark .v[data-class=v] p,.theme__dark .v[data-class=v] pre code,[data-theme=dark] .v[data-class=v] .status-bar,[data-theme=dark] .v[data-class=v] .veditor,[data-theme=dark] .v[data-class=v] .vinput,[data-theme=dark] .v[data-class=v] p,[data-theme=dark] .v[data-class=v] pre code{color:#b2b2b5}.dark .v[data-class=v] .vsys,.dark .v[data-class=v] .vtime,.night .v[data-class=v] .vsys,.night .v[data-class=v] .vtime,.theme__dark .v[data-class=v] .vsys,.theme__dark .v[data-class=v] .vtime,[data-theme=dark] .v[data-class=v] .vsys,[data-theme=dark] .v[data-class=v] .vtime{color:#929298}.dark .v[data-class=v] code,.dark .v[data-class=v] pre,.dark .v[data-class=v] pre code,.night .v[data-class=v] code,.night .v[data-class=v] pre,.night .v[data-class=v] pre code,.theme__dark .v[data-class=v] code,.theme__dark .v[data-class=v] pre,.theme__dark .v[data-class=v] pre code,[data-theme=dark] .v[data-class=v] code,[data-theme=dark] .v[data-class=v] pre,[data-theme=dark] .v[data-class=v] pre code{color:#929298;background-color:#151414}.dark .v[data-class=v] .vwrap,.night .v[data-class=v] .vwrap,.theme__dark .v[data-class=v] .vwrap,[data-theme=dark] .v[data-class=v] .vwrap{border-color:#b2b2b5}.dark .v[data-class=v] .vicon,.night .v[data-class=v] .vicon,.theme__dark .v[data-class=v] .vicon,[data-theme=dark] .v[data-class=v] .vicon{fill:#b2b2b5}.dark .v[data-class=v] .vicon.actived,.night .v[data-class=v] .vicon.actived,.theme__dark .v[data-class=v] .vicon.actived,[data-theme=dark] .v[data-class=v] .vicon.actived{fill:#66b1ff}.dark .v[data-class=v] .vbtn,.night .v[data-class=v] .vbtn,.theme__dark .v[data-class=v] .vbtn,[data-theme=dark] .v[data-class=v] .vbtn{color:#b2b2b5;border-color:#b2b2b5}.dark .v[data-class=v] .vbtn:hover,.night .v[data-class=v] .vbtn:hover,.theme__dark .v[data-class=v] .vbtn:hover,[data-theme=dark] .v[data-class=v] .vbtn:hover{color:#66b1ff;border-color:#66b1ff}.dark .v[data-class=v] a:hover,.night .v[data-class=v] a:hover,.theme__dark .v[data-class=v] a:hover,[data-theme=dark] .v[data-class=v] a:hover{color:#d7191a}.dark .v[data-class=v] .vcards .vcard .vcontent.expand:before,.night .v[data-class=v] .vcards .vcard .vcontent.expand:before,.theme__dark .v[data-class=v] .vcards .vcard .vcontent.expand:before,[data-theme=dark] .v[data-class=v] .vcards .vcard .vcontent.expand:before{background:-webkit-gradient(linear,left top,left bottom,from(rgba(0,0,0,.3)),to(rgba(0,0,0,.7)));background:linear-gradient(180deg,rgba(0,0,0,.3),rgba(0,0,0,.7))}.dark .v[data-class=v] .vcards .vcard .vcontent.expand:after,.night .v[data-class=v] .vcards .vcard .vcontent.expand:after,.theme__dark .v[data-class=v] .vcards .vcard .vcontent.expand:after,[data-theme=dark] .v[data-class=v] .vcards .vcard .vcontent.expand:after{background:rgba(0,0,0,.7)}@media (prefers-color-scheme:dark){.v[data-class=v] .status-bar,.v[data-class=v] .veditor,.v[data-class=v] .vinput,.v[data-class=v] p,.v[data-class=v] pre code{color:#b2b2b5}.v[data-class=v] .vsys,.v[data-class=v] .vtime{color:#929298}.v[data-class=v] code,.v[data-class=v] pre,.v[data-class=v] pre code{color:#929298;background-color:#151414}.v[data-class=v] .vwrap{border-color:#b2b2b5}.v[data-class=v] .vicon{fill:#b2b2b5}.v[data-class=v] .vicon.actived{fill:#66b1ff}.v[data-class=v] .vbtn{color:#b2b2b5;border-color:#b2b2b5}.v[data-class=v] .vbtn:hover{color:#66b1ff;border-color:#66b1ff}.v[data-class=v] a:hover{color:#d7191a}.v[data-class=v] .vcards .vcard .vcontent.expand:before{background:-webkit-gradient(linear,left top,left bottom,from(rgba(0,0,0,.3)),to(rgba(0,0,0,.7)));background:linear-gradient(180deg,rgba(0,0,0,.3),rgba(0,0,0,.7))}.v[data-class=v] .vcards .vcard .vcontent.expand:after{background:rgba(0,0,0,.7)}}</style></head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class="container-fluid"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
<span class="sr-only">切换导航</span>
<span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button>
<a class="navbar-brand" href="https://www.uiimage.com/">Kim's Blog</a></div><div class="collapse navbar-collapse" id="main-navbar"><ul class="nav navbar-nav navbar-right"><li><a title="Home" href="/">Home</a></li><li><a title="Tags" href="/tags">Tags</a></li><li><a title="About" href="/page/about/">About</a></li></ul></div><div class="avatar-container"><div class="avatar-img-border"><a title="Kim's Blog" href="https://www.uiimage.com/"><img class="avatar-img" src="https://www.uiimage.com/img/avatar.JPG" alt="Kim's Blog" /></a></div></div></div></nav><div class="pswp" tabindex="-1" role="dialog" aria-hidden="true"><div class="pswp__bg"></div><div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div><div class="pswp__item"></div><div class="pswp__item"></div></div><div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title="Share"></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div><header class="header-section"><div class="intro-header no-img"><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class="post-heading"><h1>OpenGL ES in iOS - 2. 画一个三角形</h1><span class="post-meta"><i class="fas fa-calendar"></i> 发表于 April 29, 2019
 | <i class="fas fa-clock"></i> 6 分钟
 | <i class="fas fa-book"></i> 1068 个字
 | <i class="fas fa-user"></i> Kim</span></div></div></div></div></div></header><div class="container" role="main"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><aside class="toc-article"><nav id="TableOfContents"><ul><li><a href="#一设置-context">一、设置 Context</a></li><li><a href="#二配置-eaglayer">二、配置 EAGLayer</a></li><li><a href="#三创建-rbo--fbo并且将-rbo-和-layer-链接绑定-rbo-和-fbo">三、创建 RBO &amp; FBO，并且将 RBO 和 layer 链接，绑定 RBO 和 FBO</a><ul><li><a href="#1-先创建-rbo并且绑定到缓冲区">1. 先创建 RBO，并且绑定到缓冲区</a></li><li><a href="#2-再创建-fbo并且将-rbo-附着到其-gl_color_attachment0-上">2. 再创建 FBO，并且将 RBO 附着到其 <code>GL_COLOR_ATTACHMENT0</code> 上</a></li></ul></li><li><a href="#四创建-shaders-和-链接到-glprogram">四、创建 shaders 和 链接到 glProgram</a></li><li><a href="#五清屏--设置-viewport">五、清屏 &amp; 设置 Viewport</a><ul><li><a href="#清屏">清屏</a></li><li><a href="#设置-viewport">设置 Viewport</a></li></ul></li><li><a href="#六离屏渲染顶点上传--绘制-important">六、<strong>离屏渲染（顶点上传 &amp; 绘制）</strong> （important！）</a><ul><li><a href="#1-注意点">1. 注意点</a></li><li><a href="#2-不使用-ebo">2. 不使用 EBO</a></li><li><a href="#3-使用顶点索引">3 使用顶点索引</a></li></ul></li><li><a href="#七展示离屏渲染的-renderbuffer">七、展示离屏渲染的 <code>RenderBuffer</code></a></li><li><a href="#总结">总结</a></li></ul></nav></aside><article role="main" class="blog-post"><p>本篇主要目的是 <strong>使用 OpenGL ES 画一个三角形</strong>，包含 直接上传顶点、使用 VAO、VBO、EBO 他们的组合渲染方式。</p><p>建议配合 <a href="https://github.com/SourceKim/OpenGLES-iOS">Demo 工程</a> 食用。</p><p>使用 OpenGL ES 渲染一个三角形，主要有如下步骤：</p><ul><li><ol><li>设置 Context</li></ol></li><li><ol start="2"><li>配置 EAGLayer</li></ol></li><li><ol start="3"><li>创建 RBO &amp; FBO，并且将 RBO 和 layer 链接，绑定 RBO 和 FBO</li></ol></li><li><ol start="4"><li>创建 shaders 和 链接到 glProgram</li></ol></li><li><ol start="5"><li>清屏 &amp; 配置 ViewPort</li></ol></li><li><ol start="6"><li>离屏渲染 （VAO / VBO / EBO）到 RBO 上</li></ol></li><li><ol start="7"><li>展示 layer 的 RBO</li></ol></li></ul><h2 id="一设置-context">一、设置 Context</h2><p>构造一个 OpenGL ES 3.0 的 context，并设置到当前的线程</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-objc" data-lang="objc">    _ctx <span style="color:#f92672">=</span> [[EAGLContext alloc] initWithAPI: kEAGLRenderingAPIOpenGLES3];
    [EAGLContext setCurrentContext: _ctx];
</code></pre></div><h2 id="二配置-eaglayer">二、配置 EAGLayer</h2><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-objc" data-lang="objc">    _glLayer <span style="color:#f92672">=</span> [CAEAGLLayer layer];
    _glLayer.opaque <span style="color:#f92672">=</span> true;
    _glLayer.drawableProperties <span style="color:#f92672">=</span> <span style="color:#ae81ff">@{</span>
        kEAGLDrawablePropertyRetainedBacking: <span style="color:#ae81ff">@(</span>false<span style="color:#ae81ff">)</span>,
        kEAGLDrawablePropertyColorFormat: kEAGLColorFormatRGBA8,
    <span style="color:#ae81ff">}</span>;
    _glLayer.frame <span style="color:#f92672">=</span> self.view.bounds;
    [self.view.layer addSublayer: _glLayer];
</code></pre></div><h2 id="三创建-rbo--fbo并且将-rbo-和-layer-链接绑定-rbo-和-fbo">三、创建 RBO &amp; FBO，并且将 RBO 和 layer 链接，绑定 RBO 和 FBO</h2><h3 id="1-先创建-rbo并且绑定到缓冲区">1. 先创建 RBO，并且绑定到缓冲区</h3><pre><code>绑定：用当前的 context，将上述的 layer 的储存区分配到 GL_RENDERBUFFER（即刚刚 bind 的 RBO）
</code></pre><h3 id="2-再创建-fbo并且将-rbo-附着到其-gl_color_attachment0-上">2. 再创建 FBO，并且将 RBO 附着到其 <code>GL_COLOR_ATTACHMENT0</code> 上</h3><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-objc" data-lang="objc">    <span style="color:#75715e">// 创建 Render Buffer Object
</span><span style="color:#75715e"></span>    glGenRenderbuffers(<span style="color:#ae81ff">1</span>, <span style="color:#f92672">&amp;</span>_RBO);
    glBindRenderbuffer(GL_RENDERBUFFER, _RBO);
    [_ctx renderbufferStorage: GL_RENDERBUFFER fromDrawable: _glLayer];
    
    <span style="color:#75715e">// 创建 Frame Buffer Object
</span><span style="color:#75715e"></span>    glGenFramebuffers(<span style="color:#ae81ff">1</span>, <span style="color:#f92672">&amp;</span>_FBO);
    glBindFramebuffer(GL_FRAMEBUFFER, _FBO);
    glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_RENDERBUFFER, _RBO);
</code></pre></div><h2 id="四创建-shaders-和-链接到-glprogram">四、创建 shaders 和 链接到 glProgram</h2><ul><li><ol><li>先新建两个文件 <code>passthrough.vsh</code> &amp; <code>passthrough.fsh</code>，分别对应 顶点着色器 &amp; 片元着色器。</li></ol><p>vsh:</p><p>从外部传入 position &amp; vColor</p><p>其中 position 对应的是顶点的位置，vColor 是给 fragment shader 渲染用的</p><p>outColor 使用 varying（可变的） 修饰，意味着会传入到 fragment shader，且默认会进行线性插值</p><blockquote><p>片段的颜色由附近片段</p></blockquote><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-glsl" data-lang="glsl"><span style="color:#66d9ef">attribute</span> <span style="color:#66d9ef">vec4</span> position;
<span style="color:#66d9ef">attribute</span> <span style="color:#66d9ef">vec3</span> vColor;

<span style="color:#66d9ef">varying</span> <span style="color:#66d9ef">highp</span> <span style="color:#66d9ef">vec3</span> outColor;

<span style="color:#66d9ef">void</span> main()
{
    outColor <span style="color:#f92672">=</span> vColor;
    gl_Position <span style="color:#f92672">=</span> position;
      
}
</code></pre></div><p>fsh:</p><p>由于 outColor 是经过顶点着色器插值之后得到的，因此直接使用该颜色，即可得到前文中的渐变色三角形</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-glsl" data-lang="glsl"><span style="color:#66d9ef">varying</span> <span style="color:#66d9ef">highp</span> <span style="color:#66d9ef">vec3</span> outColor;

<span style="color:#66d9ef">void</span> main()
{
    gl_FragColor <span style="color:#f92672">=</span> <span style="color:#66d9ef">vec4</span>(outColor, <span style="color:#ae81ff">1.0</span>);
}
</code></pre></div></li></ul><h2 id="五清屏--设置-viewport">五、清屏 &amp; 设置 Viewport</h2><h3 id="清屏">清屏</h3><p>这里没有用到 深度和模板，直接清除 颜色 即可</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-objc" data-lang="objc">    glClearColor(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>);
    glClear(GL_COLOR_BUFFER_BIT);
</code></pre></div><ul><li><p>glClearColor 设置 颜色 buffer 的清除颜色，这里是黑色</p></li><li><p>glClear 清除 context 的颜色 buffer</p></li></ul><blockquote><p>如果要设置 depth buffer 的清理参数，可以这么做 <code>glClearDepth(1.0)</code></p></blockquote><blockquote><p>也可以同时清理 depth buffer &amp; color buffer，可以用掩码同时设：<code>glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT)</code></p></blockquote><h3 id="设置-viewport">设置 Viewport</h3><p>Viewport 是可见区域，这里将左下角与视图的左下角重合、宽高一致即可</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-objc" data-lang="objc">    glViewport(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, self.view.bounds.size.width, self.view.bounds.size.height);
</code></pre></div><h2 id="六离屏渲染顶点上传--绘制-important">六、<strong>离屏渲染（顶点上传 &amp; 绘制）</strong> （important！）</h2><p>顶点上传分两个大类：使用 EBO（索引），不使用 EBO，</p><p>而是否使用索引又可以分为：使用 VBO 、使用 VAO、VBO &amp; VAO 都不使用，</p><p>组合之后一共 6 种。</p><h3 id="1-注意点">1. 注意点</h3><h4 id="11-绘制参数-drawarray--gldrawelements">1.1 绘制参数 （<code>DrawArray &amp; glDrawElements</code>）</h4><p>顶点绘制有如下两个两个方法，分别对应是否使用 EBO：</p><ul><li><p>不使用 EBO 时，用 <code>glDrawArrays (GLenum mode, GLint first, GLsizei count)</code> 绘制</p><ul><li>mode 绘制方式</li><li>first 数组的起点，一般是 0</li><li>count 顶点数量，如果画一个三角形，需要 3 个顶点，传入 3 即可</li></ul></li><li><p>使用 EBO 时，用 <code>glDrawElements (GLenum mode, GLsizei count, GLenum type, const GLvoid* indices)</code> 绘制</p><ul><li>mode 绘制方式</li><li>count 面的数量 * 组成每个面的顶点的数量。比如画一个三角形，需要 1 个 3 个顶点的面，传入 1 * 3 即可</li><li>type 索引的数据类型，使用 <code>GL_UNSIGNED_SHORT</code> 即可</li><li>indices <strong>分两种情况：使用了 VAO / VBO，传入其偏移（一般是 0）；没有使用的话传入 索引数组 指针</strong></li></ul></li></ul><h4 id="12-顶点上传到-shader-的-attribute-glvertexattribpointer">1.2 顶点上传到 shader 的 attribute <code>（glVertexAttribPointer）</code></h4><p><code>glVertexAttribPointer (GLuint indx, GLint size, GLenum type, GLboolean normalized, GLsizei stride, const GLvoid* ptr)</code></p><ul><li><p>index 对应 shader 的序号，可以通过 <code>glGetAttribLocation(_glProgram, "name");</code> 获取</p></li><li><p>size 组成每个顶点用的元素的个数，该值只能是 1 2 3 4。比如说纹理坐标是 4 个顶点，每个顶点由 x y 组成，就传入 2</p></li><li><p>type 元素的数据类型 一般是 <code>GL_FLOAT</code></p></li><li><p>normalized 是否需要归一化到 0 - 1</p></li><li><p>stride 偏移量，两个元素之间间隔多少个字节 （一般取 0，代表紧凑数据）</p></li><li><p>pointer 有两种传入方式：首个元素的指针 或者 VBO 的字节偏移量</p><ul><li><p>如果没有使用 VBO / VAO 则传入 首个元素的指针</p></li><li><p>使用了 VBO / VAO 则传入 数据在 VBO 的字节偏移量，一般是 0</p></li></ul></li></ul><h4 id="13-ebo--vbo">1.3 EBO &amp; VBO</h4><p>EBO &amp; VBO 都是对数据的缓冲区，在构造和使用都类似：</p><ul><li><p>构造：都是通过 <code>glGenBuffers</code> 即可构造，返回一个缓冲区的句柄</p></li><li><p>使用：</p><ul><li><p>都要先 <code>glBindBuffer</code> 再 <code>glBufferData</code>，但是传入的第一个参数不一样：EBO 要传入 <code>GL_ELEMENT_ARRAY_BUFFER</code>，而 VBO 则传入 <code>GL_ARRAY_BUFFER</code></p></li><li><p>对于 VBO 来说，一般需要和属性对应，因此还需要 上传到 shader &amp; 激活 两个操作，分别对应 <code>glVertexAttribPointer</code> 和 <code>glEnableVertexAttribArray</code> api。</p></li></ul></li></ul><h3 id="2-不使用-ebo">2. 不使用 EBO</h3><h4 id="21-不使用-vbo--vao不使用-ebo">2.1 不使用 VBO &amp; VAO，不使用 EBO</h4><ul><li><p>a、 上传顶点 到 shader <code>glVertexAttribPointer</code> <strong>注意，最后一个参数传入顶点的指针地址</strong></p></li><li><p>b、 激活顶点属性 <code>glEnableVertexAttribArray</code></p></li><li><p>c、 画出顶点即可 <code>glDrawArrays</code></p></li></ul><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-objc" data-lang="objc">- (<span style="color:#66d9ef">void</span>)<span style="color:#a6e22e">renderVertex_Directly</span> {
    
    <span style="color:#75715e">// 1. 上传顶点
</span><span style="color:#75715e"></span>    glVertexAttribPointer(_positionLoc, <span style="color:#ae81ff">3</span>, GL_FLOAT, GL_FALSE, <span style="color:#ae81ff">0</span>, vertices);
    glEnableVertexAttribArray(_positionLoc);
    
    glVertexAttribPointer(_colorLoc, <span style="color:#ae81ff">3</span>, GL_FLOAT, GL_FALSE, <span style="color:#ae81ff">0</span>, color_data);
    glEnableVertexAttribArray(_colorLoc);
    
    <span style="color:#75715e">// 2. 渲染
</span><span style="color:#75715e"></span>    glDrawArrays(GL_TRIANGLES, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">3</span>);
}
</code></pre></div><h4 id="22-使用-vbo不使用-ebo">2.2 使用 VBO，不使用 EBO</h4><ul><li><p>a、先生成 VBO <code>glGenBuffers</code></p></li><li><p>b、往 VBO 中填充数据 <code>glBindBuffer</code> &amp; <code>glBufferData</code></p></li><li><p>c、上传顶点 到 shader <code>glVertexAttribPointer</code>，<strong>注意，最后一个参数传入 0</strong></p></li><li><p>d、激活顶点属性 <code>glEnableVertexAttribArray</code></p></li><li><p>e、画出顶点即可 <code>glDrawArrays</code></p></li></ul><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-objc" data-lang="objc">- (<span style="color:#66d9ef">void</span>)<span style="color:#a6e22e">renderVertex_VBO</span> {
    
    <span style="color:#75715e">// 1. 初始化 &amp; 激活 VBO
</span><span style="color:#75715e"></span>    GLuint VBO[<span style="color:#ae81ff">2</span>];
    glGenBuffers(<span style="color:#ae81ff">2</span>, VBO);
    
    glBindBuffer(GL_ARRAY_BUFFER, VBO[<span style="color:#ae81ff">0</span>]); <span style="color:#75715e">// 使用这个缓冲对象（缓冲区有两个对象，需要告诉 OGL 下面的代码要使用哪一个
</span><span style="color:#75715e"></span>    glBufferData(GL_ARRAY_BUFFER, <span style="color:#66d9ef">sizeof</span>(vertices), vertices, GL_STATIC_DRAW);
    glVertexAttribPointer(_positionLoc, <span style="color:#ae81ff">3</span>, GL_FLOAT, GL_FALSE, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>);
    glEnableVertexAttribArray(_positionLoc);
    
    glBindBuffer(GL_ARRAY_BUFFER, VBO[<span style="color:#ae81ff">1</span>]);
    glBufferData(GL_ARRAY_BUFFER, <span style="color:#66d9ef">sizeof</span>(color_data), color_data, GL_STATIC_DRAW);
    glVertexAttribPointer(_colorLoc, <span style="color:#ae81ff">3</span>, GL_FLOAT, GL_FALSE, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>);
    glEnableVertexAttribArray(_colorLoc);

    <span style="color:#75715e">// 3. 渲染
</span><span style="color:#75715e"></span>    glDrawArrays(GL_TRIANGLES, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">3</span>);
}
</code></pre></div><h4 id="23-使用-vao不使用-ebo">2.3 使用 VAO，不使用 EBO</h4><ul><li><p>a、创建 <code>glGenVertexArrays</code> 并且 使用 <code>glBindVertexArray</code> VAO，这样接下来的 顶点操作 都会被加入到 VBO 中</p></li><li><p>b、构造 VBO <code>glGenBuffers</code></p></li><li><p>c、往 VBO 中填充数据 <code>glBindBuffer</code> &amp; <code>glBufferData</code></p></li><li><p>d、上传顶点 到 shader <code>glVertexAttribPointer</code>，<strong>注意，最后一个参数传入 0</strong></p></li><li><p>e、激活顶点属性 <code>glEnableVertexAttribArray</code></p></li><li><p>f、画出顶点即可 <code>glDrawArrays</code></p></li></ul><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-objc" data-lang="objc">- (<span style="color:#66d9ef">void</span>)<span style="color:#a6e22e">renderVertex_VAO</span> {

    <span style="color:#75715e">// 1. 初始化 VAO （接下来所有操作顶点操作都将加入到 VAO 中）
</span><span style="color:#75715e"></span>    GLuint VAO;
    glGenVertexArrays(<span style="color:#ae81ff">1</span>, <span style="color:#f92672">&amp;</span>VAO);
    glBindVertexArray(VAO);
    
    <span style="color:#75715e">// 1.1 构造 &amp; 激活 VBO
</span><span style="color:#75715e"></span>    GLuint VBO[<span style="color:#ae81ff">2</span>];
    glGenBuffers(<span style="color:#ae81ff">2</span>, VBO);
    
    glBindBuffer(GL_ARRAY_BUFFER, VBO[<span style="color:#ae81ff">0</span>]);
    glBufferData(GL_ARRAY_BUFFER, <span style="color:#66d9ef">sizeof</span>(vertices), vertices, GL_STATIC_DRAW);
    glVertexAttribPointer(_positionLoc, <span style="color:#ae81ff">3</span>, GL_FLOAT, GL_FALSE, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>);
    glEnableVertexAttribArray(_positionLoc);
    
    glBindBuffer(GL_ARRAY_BUFFER, VBO[<span style="color:#ae81ff">1</span>]);
    glBufferData(GL_ARRAY_BUFFER, <span style="color:#66d9ef">sizeof</span>(color_data), color_data, GL_STATIC_DRAW);
    glVertexAttribPointer(_colorLoc, <span style="color:#ae81ff">3</span>, GL_FLOAT, GL_FALSE, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>);
    glEnableVertexAttribArray(_colorLoc);
    
    <span style="color:#75715e">// 1.2 停用当前 VAO &amp; VBO，注意顺序 （好习惯，单个的时候可以不写）
</span><span style="color:#75715e"></span>    glBindVertexArray(<span style="color:#ae81ff">0</span>);
    
    glBindBuffer(VBO[<span style="color:#ae81ff">0</span>], <span style="color:#ae81ff">0</span>);
    glBindBuffer(VBO[<span style="color:#ae81ff">1</span>], <span style="color:#ae81ff">0</span>);
    
    <span style="color:#75715e">// 2. 渲染
</span><span style="color:#75715e"></span>    
    <span style="color:#75715e">// 2.1 使用 VAO，因为在 1.2 中停用了
</span><span style="color:#75715e"></span>    glBindVertexArray(VAO);
    
    <span style="color:#75715e">// 2.2 渲染
</span><span style="color:#75715e"></span>    glDrawArrays(GL_TRIANGLES, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">3</span>);
}
</code></pre></div><h3 id="3-使用顶点索引">3 使用顶点索引</h3><h4 id="31-不使用-vbo--vao使用索引-indices">3.1 不使用 VBO &amp; VAO，使用索引 indices</h4><p>流程和 <code>【2.1 不使用 VBO &amp; VAO，不使用 EBO】</code> 基本一样，仅是把 <code>glDrawArrays</code> 使用 <code>glDrawElements</code> 替换。</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-objc" data-lang="objc">- (<span style="color:#66d9ef">void</span>)<span style="color:#a6e22e">renderVertex_Directly_Index</span> {
    
    <span style="color:#75715e">// 1. 上传顶点
</span><span style="color:#75715e"></span>    glVertexAttribPointer(_positionLoc, <span style="color:#ae81ff">3</span>, GL_FLOAT, GL_FALSE, <span style="color:#ae81ff">0</span>, vertices);
    glEnableVertexAttribArray(_positionLoc);
    
    glVertexAttribPointer(_colorLoc, <span style="color:#ae81ff">3</span>, GL_FLOAT, GL_FALSE, <span style="color:#ae81ff">0</span>, color_data);
    glEnableVertexAttribArray(_colorLoc);
    
    <span style="color:#75715e">// 2. 渲染
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// 1 * 3 代表： 1 个面，每个面由 3 个顶点组成
</span><span style="color:#75715e"></span>    glDrawElements(GL_TRIANGLE_STRIP, <span style="color:#ae81ff">1</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">3</span>, GL_UNSIGNED_SHORT, indices);
}
</code></pre></div><h4 id="32-使用-vbo使用-ebo">3.2 使用 VBO，使用 EBO</h4><p>流程和 <code>【2.2 使用 VBO，不使用 EBO】</code> 基本一样，</p><p>有两处不同：</p><ul><li><p>不同之处 ①：把 索引数据 绑定到 <code>GL_ELEMENT_ARRAY_BUFFER</code>。</p><p>过程和 VBO 相似，但是不需要与 attribute 相关的两个操作：<code>glVertexAttribPointer</code> &amp; <code>glEnableVertexAttribArray</code></p><p>仅需要：</p><ul><li><p>a、构造 <code>glGenBuffers</code></p></li><li><p>b、填充索引数据 <code>glBindBuffer</code> &amp; <code>glBufferData</code></p></li></ul></li><li><p>不同之处 ②：把 <code>glDrawArrays</code> 使用 <code>glDrawElements</code> 替换</p></li></ul><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-objc" data-lang="objc">- (<span style="color:#66d9ef">void</span>)<span style="color:#a6e22e">renderVertex_VBO_Index</span> {
    
    <span style="color:#75715e">// 1. 初始化 &amp; 激活 VBO
</span><span style="color:#75715e"></span>    GLuint VBO[<span style="color:#ae81ff">2</span>];
    glGenBuffers(<span style="color:#ae81ff">2</span>, VBO);
    
    
    glBindBuffer(GL_ARRAY_BUFFER, VBO[<span style="color:#ae81ff">0</span>]); <span style="color:#75715e">// 使用这个缓冲对象（缓冲区有两个对象，需要告诉 OGL 下面的代码要使用哪一个
</span><span style="color:#75715e"></span>    glBufferData(GL_ARRAY_BUFFER, <span style="color:#66d9ef">sizeof</span>(vertices), vertices, GL_STATIC_DRAW);
    glVertexAttribPointer(_positionLoc, <span style="color:#ae81ff">3</span>, GL_FLOAT, GL_FALSE, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>);
    glEnableVertexAttribArray(_positionLoc);
    
    glBindBuffer(GL_ARRAY_BUFFER, VBO[<span style="color:#ae81ff">1</span>]);
    glBufferData(GL_ARRAY_BUFFER, <span style="color:#66d9ef">sizeof</span>(color_data), color_data, GL_STATIC_DRAW);
    glVertexAttribPointer(_colorLoc, <span style="color:#ae81ff">3</span>, GL_FLOAT, GL_FALSE, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>);
    glEnableVertexAttribArray(_colorLoc);
    
    <span style="color:#75715e">// 1.1 初始化 &amp; 激活 索引 VBO
</span><span style="color:#75715e"></span>    GLuint indexVBO;
    glGenBuffers(<span style="color:#ae81ff">1</span>, <span style="color:#f92672">&amp;</span>indexVBO);
    
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, indexVBO);
    glBufferData(GL_ELEMENT_ARRAY_BUFFER, <span style="color:#66d9ef">sizeof</span>(indices), indices, GL_STATIC_DRAW);

    <span style="color:#75715e">// 3. 渲染
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// 1 * 3 代表： 1 个面，每个面由 3 个顶点组成
</span><span style="color:#75715e"></span>    glDrawElements(GL_TRIANGLE_STRIP, <span style="color:#ae81ff">1</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">3</span>, GL_UNSIGNED_SHORT, <span style="color:#ae81ff">0</span>);
}
</code></pre></div><h4 id="33-使用-vao使用-ebo">3.3 使用 VAO，使用 EBO</h4><p>流程也是类似，结合代码看吧。</p><p>需要注意的是：EBO 数据也需要加到 VAO 中。</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-objc" data-lang="objc">    <span style="color:#75715e">// 1. 初始化 VAO （接下来所有操作顶点操作都将加入到 VAO 中）
</span><span style="color:#75715e"></span>    GLuint VAO;
    glGenVertexArrays(<span style="color:#ae81ff">1</span>, <span style="color:#f92672">&amp;</span>VAO);
    glBindVertexArray(VAO);
    
    <span style="color:#75715e">// 1.1 构造 &amp; 激活 VBO
</span><span style="color:#75715e"></span>    GLuint VBO[<span style="color:#ae81ff">2</span>];
    glGenBuffers(<span style="color:#ae81ff">2</span>, VBO);
    
    glBindBuffer(GL_ARRAY_BUFFER, VBO[<span style="color:#ae81ff">0</span>]);
    glBufferData(GL_ARRAY_BUFFER, <span style="color:#66d9ef">sizeof</span>(vertices), vertices, GL_STATIC_DRAW);
    glVertexAttribPointer(_positionLoc, <span style="color:#ae81ff">3</span>, GL_FLOAT, GL_FALSE, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>);
    glEnableVertexAttribArray(_positionLoc);
    
    glBindBuffer(GL_ARRAY_BUFFER, VBO[<span style="color:#ae81ff">1</span>]);
    glBufferData(GL_ARRAY_BUFFER, <span style="color:#66d9ef">sizeof</span>(color_data), color_data, GL_STATIC_DRAW);
    glVertexAttribPointer(_colorLoc, <span style="color:#ae81ff">3</span>, GL_FLOAT, GL_FALSE, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>);
    glEnableVertexAttribArray(_colorLoc);
    
    <span style="color:#75715e">// 1.1.1 初始化 &amp; 激活 索引 VBO
</span><span style="color:#75715e"></span>    GLuint indexVBO;
    glGenBuffers(<span style="color:#ae81ff">1</span>, <span style="color:#f92672">&amp;</span>indexVBO);
    
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, indexVBO);
    glBufferData(GL_ELEMENT_ARRAY_BUFFER, <span style="color:#66d9ef">sizeof</span>(indices), indices, GL_STATIC_DRAW);
    
    <span style="color:#75715e">// 1.2 停用当前 VAO &amp; VBO，注意顺序 （好习惯，单个的时候可以不写）
</span><span style="color:#75715e"></span>    glBindVertexArray(<span style="color:#ae81ff">0</span>);
    
    glBindBuffer(VBO[<span style="color:#ae81ff">0</span>], <span style="color:#ae81ff">0</span>);
    glBindBuffer(VBO[<span style="color:#ae81ff">1</span>], <span style="color:#ae81ff">0</span>);
    
    <span style="color:#75715e">// 2. 渲染
</span><span style="color:#75715e"></span>    
    <span style="color:#75715e">// 2.1 使用 VAO，因为在 1.2 中停用了
</span><span style="color:#75715e"></span>    glBindVertexArray(VAO);
    
    <span style="color:#75715e">// 2.2 渲染
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// 1 * 3 代表： 1 个面，每个面由 3 个顶点组成
</span><span style="color:#75715e"></span>    glDrawElements(GL_TRIANGLE_STRIP, <span style="color:#ae81ff">1</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">3</span>, GL_UNSIGNED_SHORT, <span style="color:#ae81ff">0</span>);
</code></pre></div><h2 id="七展示离屏渲染的-renderbuffer">七、展示离屏渲染的 <code>RenderBuffer</code></h2><p>在 <code>iOS</code> 中，通过调用 <code>EAGLContext</code> 实例的 <code>- (BOOL)presentRenderbuffer:(NSUInteger)target</code> 方法，即可将离屏渲染的 <code>RenderBuffer</code> 展示出来。</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-objc" data-lang="objc">    [_ctx presentRenderbuffer: GL_RENDERBUFFER];
</code></pre></div><h2 id="总结">总结</h2><p>OpenGL ES 画一个三角形有如下步骤：</p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-objc" data-lang="objc">    [self setupContext]; <span style="color:#75715e">// 1
</span><span style="color:#75715e"></span>    [self setupLayer]; <span style="color:#75715e">// 2
</span><span style="color:#75715e"></span>    [self createBuffers]; <span style="color:#75715e">// 3
</span><span style="color:#75715e"></span>    [self setupProgram]; <span style="color:#75715e">// 4
</span><span style="color:#75715e"></span>    [self setupDrawable]; <span style="color:#75715e">// 5
</span><span style="color:#75715e"></span>    [self renderVertex_VAO_Index]; <span style="color:#75715e">// 6
</span><span style="color:#75715e"></span>    [self present]; <span style="color:#75715e">// 7
</span></code></pre></div><p>分别是</p><ul><li><ol><li>设置 Context</li></ol></li><li><ol start="2"><li>配置 EAGLayer</li></ol></li><li><ol start="3"><li>创建 RBO &amp; FBO，并且将 RBO 和 layer 链接，绑定 RBO 和 FBO</li></ol></li><li><ol start="4"><li>创建 shaders 和 链接到 glProgram</li></ol></li><li><ol start="5"><li>清屏 &amp; 配置 ViewPort</li></ol></li><li><ol start="6"><li>离屏渲染 （VAO / VBO / EBO）到 RBO 上</li></ol></li><li><ol start="7"><li>展示 layer 的 RBO</li></ol></li></ul><p>其中在渲染的时候有多重的组合方式：</p><p>VBO / VAO / EBO</p><p>建议使用顶点缓冲区，但是是否索引可以参考他们的优劣：</p><ul><li><p><code>glDrawArrays</code> 传输或指定的数据是最终的真实数据，在绘制时效能更好</p></li><li><p><code>glDrawElements</code> 指定的是真实数据的调用索引，在内存/显存占用上更节省</p></li></ul><div class="blog-tags"><a href="https://www.uiimage.com//tags/ios/">iOS</a> 
<a href="https://www.uiimage.com//tags/opengl-es/">OpenGL ES</a> 
<a href="https://www.uiimage.com//tags/%E9%9F%B3%E8%A7%86%E9%A2%91/">音视频</a> </div><hr /><section id="social-share"><div class="list-inline footer-links"><div class="share-box" aria-hidden="true"><ul class="share"><li><a href="//twitter.com/share?url=https%3a%2f%2fwww.uiimage.com%2fpost%2fblog%2fopengl-es%2fopengl-es-2-draw-a-triangle%2f&amp;text=OpenGL%20ES%20in%20iOS%20-%202.%20%e7%94%bb%e4%b8%80%e4%b8%aa%e4%b8%89%e8%a7%92%e5%bd%a2&amp;via=" target="_blank" title="Share on Twitter"><i class="fab fa-twitter"></i></a></li><li><a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.uiimage.com%2fpost%2fblog%2fopengl-es%2fopengl-es-2-draw-a-triangle%2f" target="_blank" title="Share on Facebook"><i class="fab fa-facebook"></i></a></li><li><a href="//reddit.com/submit?url=https%3a%2f%2fwww.uiimage.com%2fpost%2fblog%2fopengl-es%2fopengl-es-2-draw-a-triangle%2f&amp;title=OpenGL%20ES%20in%20iOS%20-%202.%20%e7%94%bb%e4%b8%80%e4%b8%aa%e4%b8%89%e8%a7%92%e5%bd%a2" target="_blank" title="Share on Reddit"><i class="fab fa-reddit"></i></a></li><li><a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fwww.uiimage.com%2fpost%2fblog%2fopengl-es%2fopengl-es-2-draw-a-triangle%2f&amp;title=OpenGL%20ES%20in%20iOS%20-%202.%20%e7%94%bb%e4%b8%80%e4%b8%aa%e4%b8%89%e8%a7%92%e5%bd%a2" target="_blank" title="Share on LinkedIn"><i class="fab fa-linkedin"></i></a></li><li><a href="//www.stumbleupon.com/submit?url=https%3a%2f%2fwww.uiimage.com%2fpost%2fblog%2fopengl-es%2fopengl-es-2-draw-a-triangle%2f&amp;title=OpenGL%20ES%20in%20iOS%20-%202.%20%e7%94%bb%e4%b8%80%e4%b8%aa%e4%b8%89%e8%a7%92%e5%bd%a2" target="_blank" title="Share on StumbleUpon"><i class="fab fa-stumbleupon"></i></a></li><li><a href="//www.pinterest.com/pin/create/button/?url=https%3a%2f%2fwww.uiimage.com%2fpost%2fblog%2fopengl-es%2fopengl-es-2-draw-a-triangle%2f&amp;description=OpenGL%20ES%20in%20iOS%20-%202.%20%e7%94%bb%e4%b8%80%e4%b8%aa%e4%b8%89%e8%a7%92%e5%bd%a2" target="_blank" title="Share on Pinterest"><i class="fab fa-pinterest"></i></a></li></ul></div></div></section><h4 class="see-also">也可以看看</h4><ul><li><a href="/post/blog/developing-normal-issues/instrument-not-symbolized/">Instrument 的函数未被符号化的问题</a></li><li><a href="/post/blog/ios/sidetables/">iOS SideTables 简单介绍</a></li><li><a href="/post/blog/developing-normal-issues/uibutton-stretch-displaying/">UIButton 图片拉伸显示</a></li><li><a href="/post/blog/ios/ios-oop/">iOS 面向对象编程</a></li><li><a href="/post/blog/developing-normal-issues/attempt-to-set-a-non-property-list-object/">[User Defaults] Attempt to set a non-property-list object 崩溃</a></li></ul></article><ul class="pager blog-pager"><li class="previous"><a href="https://www.uiimage.com/post/blog/network/http2.0/" data-toggle="tooltip" data-placement="top" title="HTTP2.0">← 前一篇</a></li><li class="next"><a href="https://www.uiimage.com/post/blog/ios/weak/" data-toggle="tooltip" data-placement="top" title="iOS 中 weak 详细介绍">后一篇 →</a></li></ul><span id="/post/blog/opengl-es/opengl-es-2-draw-a-triangle/" class="leancloud_visitors" data-flag-title="OpenGL ES in iOS - 2. 画一个三角形"><p></p></span><div id="vcomments" class=" v" data-class="v"><div class="vpanel"><div class="vwrap"><p class="cancel-reply text-right" style="display:none;" title="取消回复"><svg class="vicon cancel-reply-btn" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4220" width="22" height="22"><path d="M796.454 985H227.545c-50.183 0-97.481-19.662-133.183-55.363-35.7-35.701-55.362-83-55.362-133.183V227.545c0-50.183 19.662-97.481 55.363-133.183 35.701-35.7 83-55.362 133.182-55.362h568.909c50.183 0 97.481 19.662 133.183 55.363 35.701 35.702 55.363 83 55.363 133.183v568.909c0 50.183-19.662 97.481-55.363 133.183S846.637 985 796.454 985zM227.545 91C152.254 91 91 152.254 91 227.545v568.909C91 871.746 152.254 933 227.545 933h568.909C871.746 933 933 871.746 933 796.454V227.545C933 152.254 871.746 91 796.454 91H227.545z" p-id="4221"/><path d="M568.569 512l170.267-170.267c15.556-15.556 15.556-41.012 0-56.569s-41.012-15.556-56.569 0L512 455.431 341.733 285.165c-15.556-15.556-41.012-15.556-56.569 0s-15.556 41.012 0 56.569L455.431 512 285.165 682.267c-15.556 15.556-15.556 41.012 0 56.569 15.556 15.556 41.012 15.556 56.569 0L512 568.569l170.267 170.267c15.556 15.556 41.012 15.556 56.569 0 15.556-15.556 15.556-41.012 0-56.569L568.569 512z" p-id="4222"/></svg></p><div class="vheader item3"><input name="nick" placeholder="昵称" class="vnick vinput" type="text" /><input name="mail" placeholder="邮箱" class="vmail vinput" type="email" /><input name="link" placeholder="网址(http://)" class="vlink vinput" type="text" /></div><div class="vedit"><textarea id="veditor" class="veditor vinput" placeholder="有不当之处，求大佬指正~"></textarea><div class="vrow"><div class="vcol vcol-60 status-bar"></div><div class="vcol vcol-40 vctrl text-right"><span title="表情" class="vicon vemoji-btn"><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="16172" width="22" height="22"><path d="M512 1024a512 512 0 1 1 512-512 512 512 0 0 1-512 512zM512 56.888889a455.111111 455.111111 0 1 0 455.111111 455.111111 455.111111 455.111111 0 0 0-455.111111-455.111111zM312.888889 512A85.333333 85.333333 0 1 1 398.222222 426.666667 85.333333 85.333333 0 0 1 312.888889 512z" p-id="16173"/><path d="M512 768A142.222222 142.222222 0 0 1 369.777778 625.777778a28.444444 28.444444 0 0 1 56.888889 0 85.333333 85.333333 0 0 0 170.666666 0 28.444444 28.444444 0 0 1 56.888889 0A142.222222 142.222222 0 0 1 512 768z" p-id="16174"/><path d="M782.222222 391.964444l-113.777778 59.733334a29.013333 29.013333 0 0 1-38.684444-10.808889 28.444444 28.444444 0 0 1 10.24-38.684445l113.777778-56.888888a28.444444 28.444444 0 0 1 38.684444 10.24 28.444444 28.444444 0 0 1-10.24 36.408888z" p-id="16175"/><path d="M640.568889 451.697778l113.777778 56.888889a27.875556 27.875556 0 0 0 38.684444-10.24 27.875556 27.875556 0 0 0-10.24-38.684445l-113.777778-56.888889a28.444444 28.444444 0 0 0-38.684444 10.808889 28.444444 28.444444 0 0 0 10.24 38.115556z" p-id="16176"/></svg></span><span title="预览" class="vicon vpreview-btn"><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="17688" width="22" height="22"><path d="M502.390154 935.384615a29.538462 29.538462 0 1 1 0 59.076923H141.430154C79.911385 994.461538 29.538462 946.254769 29.538462 886.153846V137.846154C29.538462 77.745231 79.950769 29.538462 141.390769 29.538462h741.218462c61.44 0 111.852308 48.206769 111.852307 108.307692v300.268308a29.538462 29.538462 0 1 1-59.076923 0V137.846154c0-26.899692-23.355077-49.230769-52.775384-49.230769H141.390769c-29.420308 0-52.775385 22.331077-52.775384 49.230769v748.307692c0 26.899692 23.355077 49.230769 52.775384 49.230769h360.999385z" p-id="17689"/><path d="M196.923077 216.615385m29.538461 0l374.153847 0q29.538462 0 29.538461 29.538461l0 0q0 29.538462-29.538461 29.538462l-374.153847 0q-29.538462 0-29.538461-29.538462l0 0q0-29.538462 29.538461-29.538461Z" p-id="17690"/><path d="M649.846154 846.769231a216.615385 216.615385 0 1 0 0-433.230769 216.615385 216.615385 0 0 0 0 433.230769z m0 59.076923a275.692308 275.692308 0 1 1 0-551.384616 275.692308 275.692308 0 0 1 0 551.384616z" p-id="17691"/><path d="M807.398383 829.479768m20.886847-20.886846l0 0q20.886846-20.886846 41.773692 0l125.321079 125.321079q20.886846 20.886846 0 41.773693l0 0q-20.886846 20.886846-41.773693 0l-125.321078-125.321079q-20.886846-20.886846 0-41.773693Z" p-id="17692"/></svg></span></div></div></div><div class="vrow"><div class="vcol vcol-30"><a alt="Markdown is supported" href="https://guides.github.com/features/mastering-markdown/" class="vicon" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" class="markdown" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M14.85 3H1.15C.52 3 0 3.52 0 4.15v7.69C0 12.48.52 13 1.15 13h13.69c.64 0 1.15-.52 1.15-1.15v-7.7C16 3.52 15.48 3 14.85 3zM9 11H7V8L5.5 9.92 4 8v3H2V5h2l1.5 2L7 5h2v6zm2.99.5L9.5 8H11V5h2v3h1.5l-2.51 3.5z"/></svg></a></div><div class="vcol vcol-70 text-right"><button type="button" title="Cmd|Ctrl+Enter" class="vsubmit vbtn">提交</button></div></div><div class="vemojis" style="display:none;"></div><div class="vinput vpreview" style="display:none;"></div><div style="display:none;" class="vmark"></div></div></div><div class="vcount" style="display:none;"><span class="vnum">0</span> 评论</div><div class="vload-top text-center" style="display:none;"><i class="vspinner" style="width:30px;height:30px;"></i></div><div class="vcards"></div><div class="vload-bottom text-center" style="display:none;"><i class="vspinner" style="width:30px;height:30px;"></i></div><div class="vempty" style="display: block;">来发评论吧~</div><div class="vpage txt-center" style="display:none"><button type="button" class="vmore vbtn">加载更多...</button></div><div class="vpower txt-right">Powered By <a href="https://valine.js.org" target="_blank">Valine</a><br />v1.4.14</div></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script type="text/javascript">new Valine({el:'#vcomments',appId:'Ld2PPgvVUNucDd8KP4B0kNNB-gzGzoHsz',appKey:'rijpKLUzykFXX0DGsbzHezk5',notify:false,verify:false,avatar:'robohash',placeholder:'有不当之处，求大佬指正~',visitor:false});</script></div></div></div><footer><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"><li><a href="mailto:18666269733@163.com" title="Email me"><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i><i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a href="https://github.com/SourceKim" title="GitHub"><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i><i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li><li><a href="" title="RSS"><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i><i class="fas fa-rss fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="credits copyright text-muted"><a href="https://uiimage.com">Kim</a>
 • ©
2020
 • 
<a href="https://www.uiimage.com/">Kim's Blog</a></p><p class="credits theme-by text-muted">由 <a href="https://gohugo.io">Hugo v0.69.2</a> 强力驱动  •  主题 <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a> 移植自 <a href="https://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a></p></div></div></div></footer><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.js" integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/contrib/auto-render.min.js" integrity="sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe" crossorigin="anonymous"></script><script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><script src="https://www.uiimage.com/js/main.js"></script><script>renderMathInElement(document.body);</script><script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script><script src="https://www.uiimage.com/js/load-photoswipe.js"></script></body></html>