<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="zh" data-hairline="true" data-theme="light" data-react-helmet="data-theme"><head><meta charset="utf-8" /><title>(1 封私信 / 80 条消息) windows api设计的如何？ - 知乎</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" /><meta name="renderer" content="webkit" /><meta name="force-rendering" content="webkit" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="google-site-verification" content="FTeR0c8arOPKh8c5DYh_9uu98_zJbaWw53J-Sch9MTg" /><meta data-react-helmet="true" name="description" property="og:description" content="C语言怎么从函数中返回未知长度的字符串，可以让它的调用者优雅地接收？" /><meta data-react-helmet="true" name="keywords" content="Microsoft Windows" /><link data-react-helmet="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-152.a53ae37b.png" /><link data-react-helmet="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-152.a53ae37b.png" sizes="152x152" /><link data-react-helmet="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-120.bbce8f18.png" sizes="120x120" /><link data-react-helmet="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-76.cbade8f9.png" sizes="76x76" /><link data-react-helmet="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-60.8f6c52aa.png" sizes="60x60" /><link crossorigin="" rel="shortcut icon" type="image/x-icon" href="https://static.zhihu.com/heifetz/favicon.ico" /><link crossorigin="" rel="search" type="application/opensearchdescription+xml" href="https://static.zhihu.com/heifetz/search.xml" title="知乎" /><link rel="dns-prefetch" href="//static.zhimg.com" /><link rel="dns-prefetch" href="//pic1.zhimg.com" /><link rel="dns-prefetch" href="//pic2.zhimg.com" /><link rel="dns-prefetch" href="//pic3.zhimg.com" /><link rel="dns-prefetch" href="//pic4.zhimg.com" /><style>
.u-safeAreaInset-top {
  height: constant(safe-area-inset-top) !important;
  height: env(safe-area-inset-top) !important;
  
}
.u-safeAreaInset-bottom {
  height: constant(safe-area-inset-bottom) !important;
  height: env(safe-area-inset-bottom) !important;
  
}
</style><link href="https://static.zhihu.com/heifetz/main.app.216a26f4.8d8ad0c80e6d83fc39d8.css" crossorigin="" rel="stylesheet" /><link crossorigin="" href="https://static.zhihu.com/heifetz/main.question-routes.216a26f4.918210301ee824655a92.css" rel="stylesheet" /><script defer="" crossorigin="anonymous" src="https://unpkg.zhimg.com/@cfe/sentry-script@latest/dist/init.js" data-sentry-config="{&quot;dsn&quot;:&quot;https://2d8d764432cc4f6fb3bc78ab9528299d@crash2.zhihu.com/1224&quot;,&quot;sampleRate&quot;:0.1,&quot;release&quot;:&quot;2023-eeedb725&quot;,&quot;ignoreErrorNames&quot;:[&quot;NetworkError&quot;,&quot;SecurityError&quot;],&quot;ignoreErrors&quot;:[&quot;origin message&quot;,&quot;Network request failed&quot;,&quot;无法 fetch&quot;,&quot;这个系统不支持该功能。&quot;,&quot;Can't find variable: webkit&quot;,&quot;Can't find variable: $&quot;,&quot;内存不足&quot;,&quot;out of memory&quot;,&quot;DOM Exception 18&quot;,&quot;The operation is insecure&quot;,&quot;[object Event]&quot;,&quot;[object FileError]&quot;,&quot;[object DOMError]&quot;,&quot;[object Object]&quot;,&quot;拒绝访问。&quot;,&quot;Maximum call stack size exceeded&quot;,&quot;缺少 JavaScript 对象&quot;,&quot;componentWillEnter&quot;,&quot;componentWillLeave&quot;,&quot;componentWillAppear&quot;,&quot;getInlineStyleAt&quot;,&quot;getCharacterList&quot;,&quot;draft-js&quot;,&quot;UploadError&quot;,{},{},{},&quot;Non-Error exception captured&quot;],&quot;whitelistUrls&quot;:[&quot;static.zhihu.com&quot;]}"></script><style data-emotion-css="qqgmyv">.css-qqgmyv{width:auto;max-width:1156px;min-width:1000px;padding-left:16px;padding-right:30px;}.css-qqgmyv .AppHeader-userInfo{margin-left:30px;width:auto;}.css-qqgmyv .AppHeader-TabsLink.is-active,.css-qqgmyv .AppHeader-TabsLink:hover{color:#121212;}</style><style data-emotion-css="g0ay3v">.css-g0ay3v{margin-left:25px;margin-right:15px;}.css-g0ay3v .AppHeader-Tab{padding-left:15px;padding-right:15px;}.css-g0ay3v .Tabs-link.is-active::after{height:4px;}</style><style data-emotion-css="1acwmmj">.css-1acwmmj{box-sizing:border-box;margin:0;min-width:0;-webkit-flex:1;-ms-flex:1;flex:1;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><style data-emotion-css="10fy1q8">.css-10fy1q8{max-width:482px;}.css-10fy1q8 .SearchBar-input{border-radius:999px;padding-left:16px;}.css-10fy1q8 .SearchBar-askButton{border-radius:999px;width:70px;margin-left:12px;}.css-10fy1q8 .SearchBar-searchButton{border-bottom-right-radius:999px;border-top-right-radius:999px;}</style><style data-emotion-css="79elbk">.css-79elbk{position:relative;}</style><style data-emotion-css="eew49z">.css-eew49z{min-height:10px;}</style><style data-emotion-css="1cd9gw4">.css-1cd9gw4{margin-left:.3em;}</style><style data-emotion-css="n99yhz">.css-n99yhz{box-sizing:border-box;margin:0;min-width:0;color:#175199;display:inline-block;margin-left:.3em;}</style><style data-emotion-css="g9eqf4-StrutAlign">.css-g9eqf4-StrutAlign{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><style data-emotion-css="svsrxm-Octangle">.css-svsrxm-Octangle{overflow:visible!important;}</style><style data-emotion-css="h5al4j">.css-h5al4j{box-sizing:border-box;margin:0;min-width:0;color:#8590A6;font-size:14px;margin-top:10px;margin-bottom:-4px;}</style><style data-emotion-css="1cd9gw4">.css-1cd9gw4{margin-left:.3em;}</style><style data-emotion-css="h5al4j">.css-h5al4j{box-sizing:border-box;margin:0;min-width:0;color:#8590A6;font-size:14px;margin-top:10px;margin-bottom:-4px;}</style><script charset="utf-8" src="https://static.zhihu.com/heifetz/main.zswsdid.89d5bb9488d981af9eab.js" crossorigin="anonymous"></script><script charset="utf-8" src="https://static.zhihu.com/heifetz/main.mqtt.111243f58ecbafd7924d.js" crossorigin="anonymous"></script><link rel="stylesheet" type="text/css" href="https://static.zhihu.com/heifetz/main.richinput.216a26f4.088977a5eb9f7a552c47.css" crossorigin="anonymous" /><script charset="utf-8" src="https://static.zhihu.com/heifetz/main.richinput.33f35fcc8967c85a043d.js" crossorigin="anonymous"></script><link rel="stylesheet" type="text/css" href="https://static.zhihu.com/heifetz/main.modals.216a26f4.784b0017efd295e5ec5d.css" crossorigin="anonymous" /><script charset="utf-8" src="https://static.zhihu.com/heifetz/main.modals.96ffd56c64ac2aadf308.js" crossorigin="anonymous"></script><link rel="stylesheet" type="text/css" href="https://static.zhihu.com/heifetz/main.navbar-notifications.216a26f4.5e4e83f9b77f85cc209d.css" crossorigin="anonymous" /><script charset="utf-8" src="https://static.zhihu.com/heifetz/main.navbar-notifications.9ddd488ba2830a4a5e2c.js" crossorigin="anonymous"></script><link rel="stylesheet" type="text/css" href="https://static.zhihu.com/heifetz/main.navbar-messages.216a26f4.e2ac74dff1444591fc67.css" crossorigin="anonymous" /><script charset="utf-8" src="https://static.zhihu.com/heifetz/main.navbar-messages.4611d36937197ae5b56b.js" crossorigin="anonymous"></script><link rel="stylesheet" type="text/css" href="https://static.zhihu.com/heifetz/main.Labels.216a26f4.7d19d2afdc588e36471f.css" crossorigin="anonymous" /><script charset="utf-8" src="https://static.zhihu.com/heifetz/main.Labels.17eb97bdcec4013e0156.js" crossorigin="anonymous"></script><link rel="stylesheet" type="text/css" href="https://static.zhihu.com/heifetz/main.GoodsRecommendGoodsCardList.216a26f4.1930ee7752cc56d5e7d4.css" crossorigin="anonymous" /><script charset="utf-8" src="https://static.zhihu.com/heifetz/main.GoodsRecommendGoodsCardList.c60ceb59bff8de80615e.js" crossorigin="anonymous"></script><link rel="stylesheet" type="text/css" href="https://static.zhihu.com/heifetz/main.user-hover-card.216a26f4.87a23e16328050c6757d.css" crossorigin="anonymous" /><script charset="utf-8" src="https://static.zhihu.com/heifetz/main.user-hover-card.37bd998ee40078be8f49.js" crossorigin="anonymous"></script><style data-emotion="css"></style><link rel="stylesheet" type="text/css" href="https://static.zhihu.com/heifetz/main.signflow.216a26f4.9911fd7944b49d6d7997.css" crossorigin="anonymous" /><script charset="utf-8" src="https://static.zhihu.com/heifetz/main.signflow.8f81b198a8500a66ffd6.js" crossorigin="anonymous"></script></head><body style="overflow: auto;"><div id="root"><div><div class="LoadingBar"></div><div><header role="banner" class="Sticky AppHeader is-hidden is-fixed" data-za-module="TopNavBar" style="width: 100%; top: 0px;"><div class="AppHeader-inner css-qqgmyv"><a href="//www.zhihu.com" aria-label="知乎"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 30" fill="#0066FF" width="64" height="30"><path d="M29.05 4.582H16.733V25.94h3.018l.403 2.572 4.081-2.572h4.815V4.582zm-5.207 18.69l-2.396 1.509-.235-1.508h-1.724V7.233h6.78v16.04h-2.425zM14.46 14.191H9.982c0-.471.033-.954.039-1.458v-5.5h5.106V5.935a1.352 1.352 0 0 0-.404-.957 1.378 1.378 0 0 0-.968-.396H5.783c.028-.088.056-.177.084-.255.274-.82 1.153-3.326 1.153-3.326a4.262 4.262 0 0 0-2.413.698c-.57.4-.912.682-1.371 1.946-.532 1.453-.997 2.856-1.31 3.693C1.444 8.674.28 11.025.28 11.025a5.85 5.85 0 0 0 2.52-.61c1.119-.593 1.679-1.502 2.054-2.883l.09-.3h2.334v5.5c0 .5-.045.982-.073 1.46h-4.12c-.71 0-1.39.278-1.893.775a2.638 2.638 0 0 0-.783 1.874h6.527a17.717 17.717 0 0 1-.778 3.649 16.796 16.796 0 0 1-3.012 5.273A33.104 33.104 0 0 1 0 28.74s3.13 1.175 5.425-.954c1.388-1.292 2.631-3.814 3.23-5.727a28.09 28.09 0 0 0 1.12-5.229h5.967v-1.37a1.254 1.254 0 0 0-.373-.899 1.279 1.279 0 0 0-.909-.37z"/><path d="M11.27 19.675l-2.312 1.491 5.038 7.458a6.905 6.905 0 0 0 .672-2.218 3.15 3.15 0 0 0-.28-2.168l-3.118-4.563zM51.449 15.195V5.842c4.181-.205 7.988-.405 9.438-.483l.851-.05c.387-.399.885-2.395.689-3.021-.073-.25-.213-.666-.638-.555a33.279 33.279 0 0 1-4.277.727c-2.766.321-3.97.404-7.804.682-6.718.487-12.709.72-12.709.72a2.518 2.518 0 0 0 .788 1.834 2.567 2.567 0 0 0 1.883.706c2.278-.095 5.598-.25 8.996-.41v9.203h-12.78c0 .703.281 1.377.783 1.874a2.69 2.69 0 0 0 1.892.777h10.105v7.075c0 .887-.464 1.192-1.231 1.214h-3.92a4.15 4.15 0 0 0 .837 1.544 4.2 4.2 0 0 0 1.403 1.067 6.215 6.215 0 0 0 2.71.277c1.36-.066 2.967-.826 2.967-3.57v-7.607h11.28c.342 0 .67-.135.91-.374.242-.239.378-.563.378-.902v-1.375H51.449z"/><path d="M42.614 8.873a2.304 2.304 0 0 0-1.508-.926 2.334 2.334 0 0 0-1.727.405l-.376.272 4.255 5.85 2.24-1.62-2.884-3.98zM57.35 8.68l-3.125 4.097 2.24 1.663 4.517-5.927-.375-.277a2.32 2.32 0 0 0-1.722-.452 2.327 2.327 0 0 0-1.536.896z"/></svg></a><ul role="navigation" class="Tabs AppHeader-Tabs css-g0ay3v"><li role="tab" class="Tabs-item AppHeader-Tab Tabs-item--noMeta"><a class="Tabs-link AppHeader-TabsLink" href="//www.zhihu.com/" data-za-not-track-link="true">首页</a></li><li role="tab" class="Tabs-item AppHeader-Tab Tabs-item--noMeta"><a class="Tabs-link AppHeader-TabsLink" href="//www.zhihu.com/xen/vip-web" data-za-not-track-link="true">会员</a></li><li role="tab" class="Tabs-item AppHeader-Tab Tabs-item--noMeta"><a class="Tabs-link AppHeader-TabsLink" href="//www.zhihu.com/explore" data-za-not-track-link="true">发现</a></li><li role="tab" class="Tabs-item AppHeader-Tab Tabs-item--noMeta"><a class="Tabs-link AppHeader-TabsLink" href="//www.zhihu.com/question/waiting" data-za-not-track-link="true">等你来答</a></li></ul><div class="css-1acwmmj"><div class="SearchBar AppHeader-SearchBar css-10fy1q8" role="search" data-za-module="PresetWordItem"><form class="SearchBar-tool"><div><div class="Popover"><label class="SearchBar-input Input-wrapper Input-wrapper--grey"><input type="text" maxlength="100" autocomplete="off" role="combobox" aria-expanded="false" aria-autocomplete="list" aria-activedescendant="AutoComplete3--1" id="Popover2-toggle" aria-haspopup="true" aria-owns="Popover2-content" class="Input" placeholder="清明" value="" /><button aria-label="搜索" type="button" class="Button SearchBar-searchButton Button--primary"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Search SearchBar-searchIcon" fill="currentColor" viewBox="0 0 24 24" width="18" height="18"><path d="M17.068 15.58a8.377 8.377 0 0 0 1.774-5.159 8.421 8.421 0 1 0-8.42 8.421 8.38 8.38 0 0 0 5.158-1.774l3.879 3.88c.957.573 2.131-.464 1.488-1.49l-3.879-3.878zm-6.647 1.157a6.323 6.323 0 0 1-6.316-6.316 6.323 6.323 0 0 1 6.316-6.316 6.323 6.323 0 0 1 6.316 6.316 6.323 6.323 0 0 1-6.316 6.316z" fill-rule="evenodd"/></svg></span></button></label></div></div></form><button type="button" class="Button SearchBar-askButton Button--primary Button--blue">提问</button><div></div></div></div><div class="AppHeader-userInfo"><div class="Popover"><button aria-label="80条通知" id="Popover34-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover34-content" type="button" class="Button AppHeader-notifications css-79elbk Button--plain"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Bell" fill="currentColor" viewBox="0 0 24 24" width="22" height="22"><path d="M4.523 15.076l.804-6.757a6.753 6.753 0 0 1 4.945-5.7 1.823 1.823 0 0 1 3.623 0 6.753 6.753 0 0 1 4.945 5.7l.804 6.757a2.293 2.293 0 0 0 1.712 2.108 1.093 1.093 0 0 1-.297 2.15H3.108a1.093 1.093 0 0 1-.297-2.15 2.293 2.293 0 0 0 1.712-2.108zM12.083 23a2.758 2.758 0 0 1-2.753-2.509.229.229 0 0 1 .232-.24h5.043a.229.229 0 0 1 .232.24 2.759 2.759 0 0 1-2.753 2.51z"/></svg></span><div class="css-ybodb">80</div></button></div><div><div class="Popover"><button aria-label="1条私信" id="Popover35-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover35-content" type="button" class="Button AppHeader-messages css-79elbk Button--plain"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Comments" fill="currentColor" viewBox="0 0 24 24" width="22" height="22"><path d="M11 2c5.571 0 9 4.335 9 8 0 6-6.475 9.764-11.481 8.022-.315-.07-.379-.124-.78.078-1.455.54-2.413.921-3.525 1.122-.483.087-.916-.25-.588-.581 0 0 .677-.417.842-1.904.064-.351-.14-.879-.454-1.171A8.833 8.833 0 0 1 2 10c0-3.87 3.394-8 9-8zm10.14 9.628c.758.988.86 2.009.86 3.15 0 1.195-.619 3.11-1.368 3.938-.209.23-.354.467-.308.722.12 1.073.614 1.501.614 1.501.237.239-.188.562-.537.5-.803-.146-1.495-.42-2.546-.811-.29-.146-.336-.106-.563-.057-2.043.711-4.398.475-6.083-.927 5.965-.524 8.727-3.03 9.93-8.016z" fill-rule="evenodd"/></svg></span><div class="css-ybodb">1</div></button></div></div><div class="AppHeader-profile"><div class="Popover AppHeader-menu"><button id="Popover12-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover12-content" type="button" class="Button AppHeader-profileEntry Button--plain"><img class="Avatar AppHeader-profileAvatar AppHeader-profileAvatar--old" width="30" height="30" src="https://pic3.zhimg.com/f1fbab298af0760f5e2c63554e086a15_is.jpg" srcset="https://pic3.zhimg.com/f1fbab298af0760f5e2c63554e086a15_im.jpg 2x" /></button></div><div class="Popover AppHeaderProfileMenu-creatorHintPopover"><div class="AppHeaderProfileMenu-creatorHintToggler" id="Popover13-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover13-content"></div></div></div></div></div><div><div class="PageHeader is-shown"><div class="QuestionHeader-content"><div class="QuestionHeader-main"><h1 class="QuestionHeader-title">windows api设计的如何？</h1></div><div class="QuestionHeader-side" data-za-detail-view-path-module="ToolBar" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Question&quot;,&quot;token&quot;:&quot;33058061&quot;}}}"><div class="QuestionButtonGroup"><button type="button" class="Button FollowButton Button--primary Button--blue">关注问题</button><button type="button" class="Button Button--blue"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Edit QuestionButton-icon" fill="currentColor" viewBox="0 0 24 24" width="16" height="16"><path d="M4.076 16.966a4.19 4.19 0 0 1 1.05-1.76l8.568-8.569a.524.524 0 0 1 .741 0l2.928 2.927a.524.524 0 0 1 0 .74l-8.568 8.57c-.49.49-1.096.852-1.761 1.051l-3.528 1.058a.394.394 0 0 1-.49-.488l1.06-3.53zM20.558 4.83c.59.59.59 1.546 0 2.136l-1.693 1.692a.503.503 0 0 1-.712 0l-2.812-2.812a.504.504 0 0 1 0-.712l1.693-1.693a1.51 1.51 0 0 1 2.135 0l1.389 1.389z"/></svg></span>写回答</button></div></div></div></div></div></header><div class="Sticky--holder" style="position: relative; inset: 0px; display: block; float: none; margin: 0px; height: 52px;"></div></div><main role="main" class="App-main"><div class="QuestionPage" itemscope="" itemtype="http://schema.org/Question" data-za-detail-view-path-module="QuestionItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Question&quot;,&quot;token&quot;:&quot;33058061&quot;}}}"><meta itemprop="name" content="windows api设计的如何？" /><meta itemprop="url" content="https://www.zhihu.com/question/33058061" /><meta itemprop="keywords" content="Microsoft Windows" /><meta itemprop="answerCount" content="5" /><meta itemprop="commentCount" content="0" /><meta itemprop="dateCreated" content="2015-07-21T08:58:04.000Z" /><meta itemprop="dateModified" content="2015-07-21T08:58:04.000Z" /><meta itemprop="zhihu:visitsCount" /><meta itemprop="zhihu:followerCount" content="67" /><div data-zop-question="{&quot;title&quot;:&quot;windows api设计的如何？&quot;,&quot;topics&quot;:[{&quot;name&quot;:&quot;Microsoft Windows&quot;,&quot;id&quot;:&quot;19552612&quot;}],&quot;id&quot;:33058061,&quot;isEditable&quot;:true}"><div class="QuestionStatus"></div><div data-za-detail-view-path-module="QuestionDescription" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Question&quot;,&quot;token&quot;:&quot;33058061&quot;}}}"><div class="QuestionHeader"><div class="QuestionHeader-content"><div class="QuestionHeader-main"><div class="QuestionHeader-tags"><div class="QuestionHeader-topics"><div class="Tag QuestionTopic" data-za-detail-view-path-module="TopicItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Topic&quot;,&quot;token&quot;:&quot;19552612&quot;}}}"><span class="Tag-content"><a class="TopicLink" href="//www.zhihu.com/topic/19552612" target="_blank"><div class="Popover"><div id="Popover4-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover4-content">Microsoft Windows</div></div></a></span></div></div></div><h1 class="QuestionHeader-title">windows api设计的如何？</h1><div class="LabelContainer-wrapper"></div><a href="/topic/19552612" target="_blank" rel="noopener noreferrer" data-za-not-track-link="true" data-za-detail-view-path-module="TopicItem" data-za-detail-view-path-module_name="n_goods" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Topic&quot;,&quot;token&quot;:&quot;19552612&quot;,&quot;sub_type&quot;:&quot;MetaCard&quot;}}}"><div class="Card QuestionHeaderTopicMeta"><div class="QuestionHeaderTopicMeta-CardMain"><img class="ImageAlias QuestionHeaderTopicMeta-SideImg QuestionHeaderTopicMeta-SideImg--goods" alt="Microsoft Windows" src="https://pic1.zhimg.com/80/v2-ff6c969503eedfe9a279532f7aaf301c_qhd.jpg" /><div class="QuestionHeaderTopicMeta-Content"><div class="QuestionTopicReviewCardExtraInfo-cardTitleContainer"><h3 class="QuestionTopicReviewCardExtraInfo-cardTitle">Microsoft Windows</h3><div> <span class="QuestionTopicReviewCardExtraInfo-percentNum">86%</span> <span>知友推荐 · 13,655 人评价</span></div></div><div class="QuestionHeaderTopicMeta-Info">Microsoft Windows（视窗操作系统）是微软公司推出的一系列操作系统。它问世于1985年，当时是DOS之下的操作环境，而后其后续版本作逐渐发展成为个人电脑和服务器用户设计的操作系统。</div><span class="VotableTopicCard"><span class="VotableTopicCard-RecommendStatus"><div class="TopicVoteCheckbox TopicVoteCheckbox--recommend VotableTopicCard-VoteCheckbox" data-tooltip="推荐"><input id="topic-recommend" type="checkbox" /><label for="topic-recommend"><svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Like" fill="currentColor" viewBox="0 0 24 24" width="19" height="19"><path d="M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z" fill-rule="evenodd"/></svg><div class="TopicVoteCheckbox-Sparkle"></div><div class="TopicVoteCheckbox-Sparkle"></div><div class="TopicVoteCheckbox-Sparkle"></div><div class="TopicVoteCheckbox-Sparkle"></div><div class="TopicVoteCheckbox-Sparkle"></div><div class="TopicVoteCheckbox-Sparkle"></div><div class="TopicVoteCheckbox-Sparkle"></div><div class="TopicVoteCheckbox-Sparkle"></div></label></div><div class="TopicVoteCheckbox TopicVoteCheckbox--against VotableTopicCard-VoteCheckbox" data-tooltip="不推荐"><input id="topic-against" type="checkbox" /><label for="topic-against"><svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Like" fill="currentColor" viewBox="0 0 24 24" width="19" height="19"><path d="M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z" fill-rule="evenodd"/></svg></label></div></span></span></div></div></div></a><div><div class="css-eew49z"><div class="QuestionRichText QuestionRichText--collapsed"><div><span class="RichText ztext" itemprop="text">C语言怎么从函数中返回未知长度的字符串，可以让它的调用者优雅地接收？</span></div></div></div></div></div><div class="QuestionHeader-side"><div class="QuestionHeader-follow-status"><div class="QuestionFollowStatus"><div class="NumberBoard QuestionFollowStatus-counts NumberBoard--divider"><button type="button" class="Button NumberBoard-item Button--plain"><div class="NumberBoard-itemInner"><div class="NumberBoard-itemName">关注者</div><strong class="NumberBoard-itemValue" title="67">67</strong></div></button><div class="NumberBoard-item"><div class="NumberBoard-itemInner"><div class="NumberBoard-itemName">被浏览</div><strong class="NumberBoard-itemValue" title="7477">7,477</strong></div></div></div></div></div></div></div><div class="QuestionHeader-footer"><div class="QuestionHeader-footer-inner"><div class="QuestionHeader-main QuestionHeader-footer-main"><div class="QuestionButtonGroup"><button type="button" class="Button FollowButton Button--primary Button--blue">关注问题</button><button type="button" class="Button Button--blue"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Edit QuestionButton-icon" fill="currentColor" viewBox="0 0 24 24" width="16" height="16"><path d="M4.076 16.966a4.19 4.19 0 0 1 1.05-1.76l8.568-8.569a.524.524 0 0 1 .741 0l2.928 2.927a.524.524 0 0 1 0 .74l-8.568 8.57c-.49.49-1.096.852-1.761 1.051l-3.528 1.058a.394.394 0 0 1-.49-.488l1.06-3.53zM20.558 4.83c.59.59.59 1.546 0 2.136l-1.693 1.692a.503.503 0 0 1-.712 0l-2.812-2.812a.504.504 0 0 1 0-.712l1.693-1.693a1.51 1.51 0 0 1 2.135 0l1.389 1.389z"/></svg></span>写回答</button></div><div class="QuestionHeaderActions"><button type="button" class="Button Button--grey Button--withIcon Button--withLabel" style="margin-right: 16px;"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Invite Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M4 10V8a1 1 0 1 1 2 0v2h2a1 1 0 0 1 0 2H6v2a1 1 0 0 1-2 0v-2H2a1 1 0 0 1 0-2h2zm10.455 2c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm-7 6c0-2.66 4.845-4 7.272-4C17.155 14 22 15.34 22 18v1.375c0 .345-.28.625-.625.625H8.08a.625.625 0 0 1-.625-.625V18z" fill-rule="evenodd"/></svg></span>邀请回答</button><div class="GoodQuestionAction"><button type="button" class="Button GoodQuestionAction-commonBtn Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Like Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M14.445 9h5.387s2.997.154 1.95 3.669c-.168.51-2.346 6.911-2.346 6.911s-.763 1.416-2.86 1.416H8.989c-1.498 0-2.005-.896-1.989-2v-7.998c0-.987.336-2.032 1.114-2.639 4.45-3.773 3.436-4.597 4.45-5.83.985-1.13 3.2-.5 3.037 2.362C15.201 7.397 14.445 9 14.445 9zM3 9h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V10a1 1 0 0 1 1-1z" fill-rule="evenodd"/></svg></span>好问题</button></div><div class="QuestionHeader-Comment"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"/></svg></span>添加评论</button></div><div class="Popover ShareMenu"><div class="ShareMenu-toggler" id="Popover5-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover5-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"/></svg></span>分享</button></div></div><div class="Popover"><button aria-label="更多" id="Popover6-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover6-content" type="button" class="Button Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"/></svg></span></button></div><div></div></div><div class="QuestionHeader-actions"></div></div></div></div></div></div><div><div class="Sticky is-fixed" style="width: 912px; top: 52px; left: 0px;"></div><div class="Sticky--holder" style="position: static; inset: auto; display: block; float: none; margin: 0px; height: 0px;"></div></div></div><div class="Question-main"><div class="Question-mainColumn"><div><div class="QuestionAnswers-statusWrapper"></div><div id="QuestionAnswers-answers" class="QuestionAnswers-answers" data-zop-feedlistmap="0,0,1,0" data-za-detail-view-path-module="ContentList" data-za-extra-module="{}"><div class="Card AnswersNavWrapper"><div class="ListShortcut"><div class="List"><div class="List-header"><h4 class="List-headerText"><span>5 个回答</span></h4><div class="List-headerOptions"><div class="Popover"><button role="combobox" aria-expanded="false" id="Popover7-toggle" aria-haspopup="true" aria-owns="Popover7-content" type="button" class="Button InputLike InputButton Select-button Select-plainButton Button--plain">默认排序<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Select Select-arrow" fill="currentColor" viewBox="0 0 24 24" width="24" height="24"><path d="M12 16.183l2.716-2.966a.757.757 0 0 1 1.064.001.738.738 0 0 1 0 1.052l-3.247 3.512a.758.758 0 0 1-1.064 0L8.22 14.27a.738.738 0 0 1 0-1.052.758.758 0 0 1 1.063 0L12 16.183zm0-9.365L9.284 9.782a.758.758 0 0 1-1.064 0 .738.738 0 0 1 0-1.052l3.248-3.512a.758.758 0 0 1 1.065 0L15.78 8.73a.738.738 0 0 1 0 1.052.757.757 0 0 1-1.063.001L12 6.818z" fill-rule="evenodd"/></svg></button></div></div></div><div><div class=""><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="0" data-zop="{&quot;authorName&quot;:&quot;Tim Chen&quot;,&quot;itemId&quot;:55896568,&quot;title&quot;:&quot;windows api设计的如何？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="55896568" itemprop="acceptedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="0" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;55896568&quot;,&quot;upvote_num&quot;:6,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;33058061&quot;,&quot;author_member_hash_id&quot;:&quot;5f8dec5f4fec496de6e11c3886951d4f&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Tim Chen" /><meta itemprop="image" content="https://pic4.zhimg.com/88c444be01bc6eb8cbfdc360ccc60651_l.jpg?source=1940ef5c" /><meta itemprop="url" content="https://www.zhihu.com/people/tim-chen-21" /><meta itemprop="zhihu:followerCount" content="38295" /><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover24-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover24-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="//www.zhihu.com/people/tim-chen-21"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="https://pic4.zhimg.com/88c444be01bc6eb8cbfdc360ccc60651_xs.jpg?source=1940ef5c" srcset="https://pic4.zhimg.com/88c444be01bc6eb8cbfdc360ccc60651_l.jpg?source=1940ef5c 2x" alt="Tim Chen" /></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover25-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover25-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="//www.zhihu.com/people/tim-chen-21">Tim Chen</a></div></div><a href="https://www.zhihu.com/topic/20054793" target="_blank" class="css-n99yhz" aria-label="编程话题下的优秀答主" data-tooltip="编程话题下的优秀答主"><span class="css-g9eqf4-StrutAlign">​<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="css-svsrxm-Octangle" width="18" height="18"><svg viewBox="0 0 24 24" x="-3" y="-3" fill="#FFFFFF" width="30" height="30"><path d="M3.56231227,13.8535307 C2.40051305,12.768677 2.41398885,11.0669203 3.59484487,9.99979213 L3.59222085,9.99654885 C4.26730143,9.45036719 4.79446755,8.21005186 4.7184197,7.34453784 L4.72305873,7.34412719 C4.66942824,5.75539997 5.8824188,4.56066914 7.47188965,4.64242381 L7.47229112,4.6386236 C8.33515314,4.72977993 9.58467253,4.22534048 10.1426329,3.55925173 L10.1462611,3.56228565 C11.2316055,2.40008701 12.9353108,2.41394456 14.0015072,3.59634088 L14.0047263,3.59374004 C14.5498229,4.26841874 15.7896857,4.79521622 16.6545744,4.71844347 L16.6549836,4.72304294 C18.245027,4.66894057 19.4396947,5.88213996 19.3575031,7.47241135 L19.3623099,7.47292747 C19.2704388,8.3358681 19.7742711,9.58421483 20.4407199,10.1424506 L20.437686,10.1460789 C21.5997217,11.2312209 21.5860695,12.9345218 20.4042441,14.0007396 L20.4072865,14.0045125 C19.7325967,14.5495925 19.2055209,15.7896954 19.2815865,16.6561959 L19.2770449,16.6565978 C19.3315454,18.2453037 18.1173775,19.4393568 16.5274188,19.3571512 L16.5269029,19.3619539 C15.6647098,19.270083 14.415408,19.7741709 13.8573671,20.4403558 L13.8537409,20.4373235 C12.76842,21.5995708 11.0650432,21.5864553 9.99899434,20.4039226 L9.99527367,20.406923 C9.45025436,19.7323399 8.21017638,19.2051872 7.34461983,19.2812352 L7.344304,19.2776405 C5.75448683,19.3312904 4.55977145,18.1170085 4.64254978,16.527117 L4.63769921,16.5265942 C4.72957031,15.6644394 4.22547659,14.4151814 3.55928015,13.8571569 L3.56231227,13.8535307 Z"/></svg><path d="M2.63951518,13.3895441 C3.70763333,14.2842292 4.44777637,16.1226061 4.30075305,17.5023312 L4.32211542,17.3063047 C4.17509209,18.6910561 5.17786655,19.7063729 6.5613937,19.5844846 L6.364106,19.6008202 C7.75140298,19.4789319 9.57474349,20.2554985 10.4468305,21.3349009 L10.3224262,21.1803415 C11.1982831,22.2647703 12.6257916,22.2723098 13.5167278,21.2079863 L13.3898102,21.3600325 C14.2845162,20.2919393 16.1229361,19.5518136 17.5026934,19.6988334 L17.3054057,19.6774716 C18.6914461,19.8244915 19.7067866,18.8217404 19.5836389,17.4395022 L19.6012314,17.6367853 C19.4793403,16.2482641 20.255925,14.4249662 21.3353526,13.5528995 L21.1807897,13.677301 C22.2639871,12.8014646 22.2727834,11.3739894 21.2084351,10.483074 L21.3604848,10.6099886 C20.2923667,9.71530351 19.5522236,7.87818322 19.6992469,6.49720154 L19.6778846,6.69448464 C19.8249079,5.30847665 18.8221335,4.2944164 17.4386063,4.41630468 L17.635894,4.39871256 C16.248597,4.52185742 14.4252565,3.74529084 13.5531695,2.66588842 L13.6775738,2.81919121 C12.8017169,1.73601905 11.3742084,1.72722299 10.4832722,2.79154644 L10.6101898,2.63950024 C9.71548377,3.70759343 7.87706394,4.44771919 6.49730661,4.30195588 L6.69459432,4.32206116 C5.30855394,4.17504128 4.29447,5.17904888 4.41636114,6.56128713 L4.3987686,6.36400404 C4.52065973,7.75126861 3.74407501,9.57456653 2.66464737,10.4478898 L2.81921035,10.3222318 C1.73601288,11.1993248 1.72721662,12.6255433 2.79156494,13.5164587 L2.63951518,13.3895441 Z" fill="#FF9607"/><svg class="Zi Zi--Star" fill="#fff" x="6" y="6" viewBox="0 0 24 24" width="12" height="12"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"/></svg></svg></span></a></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">编程话题下的优秀答主</div></div></div></div></div><div class="LabelContainer-wrapper"></div><div class="css-h5al4j"><span><span class="Voters"><button type="button" class="Button Button--plain">6 人赞同了该回答</button></span></span></div></div><meta itemprop="image" /><meta itemprop="upvoteCount" content="6" /><meta itemprop="url" content="https://www.zhihu.com/question/33058061/answer/55896568" /><meta itemprop="dateCreated" content="2015-07-21T10:20:08.000Z" /><meta itemprop="dateModified" content="2015-07-21T10:20:08.000Z" /><meta itemprop="commentCount" content="0" /><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text"><p>因为牵涉到如何分配并释放内存，这并不是件简单的事。</p><p>一种做法是让调用方分配内存，这种一般要先调用一次返回给你需要分配的大小然后分配内存后再调用一次。这样当然释放内存也是调用方来做。</p>还有一种是被调用的函数内部负责分配内存，这种就需要规定好由谁来释放内存。因为不同组件的allocator实现不一样，如果由调用者来释放是件挺麻烦的事情，除非说好了使用某种特定的allocator。而由被调用方来释放的问题是需要有个机制使被调用方知道何时可以释放，比如通过调用另一个函数来释放。</span></div><div><div class="ContentItem-time"><a target="_blank" href="//www.zhihu.com/question/33058061/answer/55896568"><span data-tooltip="发布于 2015-07-21 18:20">发布于 2015-07-21</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 6 " type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"/></svg></span>赞同 6</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"/></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"/></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover22-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover22-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"/></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"/></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"/></svg></span>喜欢</button><div class="Popover ContentItem-action"><button aria-label="更多" id="Popover23-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover23-content" type="button" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"/></svg></span></button></div></div></div><div></div><div class="ModalWrap"><div><div class=""></div><div class="ModalExp-content"><div class="ModalWrap-content"><div class="ModalWrap-title">继续浏览内容</div><div class="ModalWrap-item"><div class="ModalWrap-itemImg"><img src="https://pic4.zhimg.com/80/v2-88158afcff1e7f4b8b00a1ba81171b61_720w.png" /></div><div class="ModalWrap-itemContent"><div class="ModalWrap-itemTitle">知乎</div><div class="ModalWrap-itemDesc">发现更大的世界</div></div><div class="ModalWrap-itemBtn">打开</div></div><div class="ModalWrap-item"><div class="ModalWrap-itemImg"><img src="https://picb.zhimg.com/80/v2-a448b133c0201b59631ccfa93cb650f3_1440w.png" /></div><div class="ModalWrap-itemContent"><div class="ModalWrap-itemTitle">Chrome</div></div><div class="ModalWrap-itemBtn">继续</div></div></div></div></div></div><div><div><div class=""></div><div class="ModalLoading-content"><svg width="30" height="30" viewBox="0 0 66 66" xmlns="http://www.w3.org/2000/svg" class="CircleLoadingBar" aria-hidden="true"><g><circle class="path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"/></g></svg></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="1" data-zop="{&quot;authorName&quot;:&quot;Siam Chen&quot;,&quot;itemId&quot;:55951154,&quot;title&quot;:&quot;windows api设计的如何？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="55951154" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="1" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;55951154&quot;,&quot;upvote_num&quot;:1,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;33058061&quot;,&quot;author_member_hash_id&quot;:&quot;28e02f4158cb57e164c6d82de83b3511&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Siam Chen" /><meta itemprop="image" content="https://pic1.zhimg.com/26db889e2b2923d3fd026c60b05e65c2_l.jpg?source=1940ef5c" /><meta itemprop="url" content="https://www.zhihu.com/people/CXuesong" /><meta itemprop="zhihu:followerCount" content="5092" /><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover26-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover26-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="//www.zhihu.com/people/CXuesong"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="https://pic1.zhimg.com/26db889e2b2923d3fd026c60b05e65c2_xs.jpg?source=1940ef5c" srcset="https://pic1.zhimg.com/26db889e2b2923d3fd026c60b05e65c2_l.jpg?source=1940ef5c 2x" alt="Siam Chen" /></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover27-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover27-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="//www.zhihu.com/people/CXuesong">Siam Chen</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">L"沉迷SPARQL难以自拔的猫武士中文维基行政员"</div></div></div></div></div><div class="LabelContainer-wrapper"></div><div class="css-h5al4j"><span><span class="Voters"><button type="button" class="Button Button--plain">1 人赞同了该回答</button></span></span></div></div><meta itemprop="image" /><meta itemprop="upvoteCount" content="1" /><meta itemprop="url" content="https://www.zhihu.com/question/33058061/answer/55951154" /><meta itemprop="dateCreated" content="2015-07-22T00:30:50.000Z" /><meta itemprop="dateModified" content="2015-07-22T03:07:07.000Z" /><meta itemprop="commentCount" content="0" /><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text">一般来说，为了避免由于跨模块调用（尤其是使用动态链接库）的时候，内存分配方和释放方不同而可能引发的问题（一般是由于分配方与释放方使用了不同的堆），肯定是要坚持“谁分配，谁释放”的原则的。<br />因此大部分的API一般是由调用方提供一个字符串缓冲区以及缓冲区可以接受字符的最大长度，然后由被调用方将自己的字符串复制到调用方指定的位置去的。<br />不过，作为函数的被调用方，你也可以使用 char** 或者返回 char*，但是需要暴露一个专门的函数，用于回收你分配的内存。例如：<br /><div class="highlight"><pre><code class="language-cpp"><span class="c1">// 假设你已经根据实际情况定义好了 _DLLEXPORT 用于导出函数。
</span><span class="c1"></span><span class="n">_DLLEXPORT</span> <span class="kt">char</span><span class="o">*</span> <span class="nf">CreateString</span><span class="p">();</span>
<span class="n">_DLLEXPORT</span> <span class="kt">void</span> <span class="nf">DeleteString</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">pString</span><span class="p">);</span>

<span class="kt">char</span><span class="o">*</span> <span class="nf">CreateString</span><span class="p">()</span>
<span class="p">{</span>
	<span class="kt">char</span><span class="o">*</span> <span class="n">mystr</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="p">[</span><span class="mi">100</span><span class="p">];</span>
	<span class="n">strcpy</span><span class="p">(</span><span class="n">mystr</span><span class="p">,</span> <span class="s">"这是一个测试。</span><span class="se">\n</span><span class="s">稍后你可以用其他内容填充这片内存。"</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">mystr</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">DeleteString</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">pString</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">delete</span> <span class="p">[]</span> <span class="n">pString</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>然后另一个模块内想要使用 CreateString ，那么就需要这样<br /><div class="highlight"><pre><code class="language-cpp"> 	<span class="kt">char</span><span class="o">*</span> <span class="n">client</span> <span class="o">=</span> <span class="n">CreateString</span><span class="p">();</span>
	<span class="c1">// 对 client 做你想做的事情。
</span><span class="c1"></span>	<span class="n">DeleteString</span><span class="p">(</span><span class="n">client</span><span class="p">);</span>
</code></pre></div>然而在 Windows API 中，字符串的处理方法以第一种情况居多，就是由调用方来分配缓冲区。这一点与 sprintf 类似。<br />例如，如果我们拿到了一个窗口的句柄，想要获取窗口的标题，可以使用 GetWindowText 函数：<br /><div class="highlight"><pre><code class="language-text">int WINAPI GetWindowText(
  _In_   HWND hWnd,
  _Out_  LPTSTR lpString,
  _In_   int nMaxCount
); </code></pre></div>其中，<br /><blockquote> lpString [out] <br />Type: LPTSTR<br />The buffer that will receive the text. If the string is as long or longer than the buffer, the string is truncated and terminated with a null character.<br /><br />nMaxCount [in] <br />Type: int<br />The maximum number of characters to copy to the buffer, including the null character. If the text exceeds this limit, it is truncated.</blockquote>也就是说，首先，lpString的内存是由调用方提供的，GetWindowText 仅负责把字符填入指定的内存中去；其次如果发现窗口标题文本的实际长度大于 nMaxCount - 1，那么文本会被截断。<br />可能你会有一个问题，我们能否在获取文本之前，确定窗口标题究竟有多长？ 这样，我们就可以分配最合适的内存长度。Windows API 当然已经考虑到这一点了，于是就有了 GetWindowTextLength 函数：<br /><div class="highlight"><pre><code class="language-text">int WINAPI GetWindowTextLength(
  _In_  HWND hWnd
); </code></pre></div>我们来看看它的描述<br /><blockquote>Return value
<p>
Type: int</p><p>If the function succeeds, the return value is the length, in characters, of 
the text. Under certain conditions, this value may actually be greater than the 
length of the text. For more information, see the following Remarks section.</p></blockquote>这里提到的“返回值可能比实际文本的长度要大”，是考虑到了多字节字符系统（MBCS）中某些字符可能会占用两个或更多字节数。也就是说，如果你是用的是 ANSI 版本的函数（即 GetWindowTextLengthA），那么你可以把返回值作为分配内存的字节数（别忘了 +1）来使用，绝对可以放得下。<br />而且，就算你在调用 GetWindowTextLength 和 GetWindowText 两个步骤之间，目标窗口的文本发生变化了，例如，变长了，那么也不会有问题。GetWindowText 会根据你提供的缓冲区大小，将多出去的部分截断。因此起码不会造成崩溃。<br /><br />在有些情况下，字符串的最大长度是已知的，例如 GetComputerName：<br /><div class="highlight"><pre><code class="language-text">BOOL WINAPI GetComputerName(
  _Out_    LPTSTR lpBuffer,
  _Inout_  LPDWORD lpnSize
); </code></pre></div>这里是这么说的：<br /><blockquote>lpBuffer [out] 

<p>A pointer to a buffer that receives the computer name or the cluster virtual 
server name. <u>The buffer size should be large enough to contain 
MAX_COMPUTERNAME_LENGTH + 1 characters.</u></p>
lpnSize [in, out] 

<p>On input, specifies the size of the buffer, in TCHARs. On output, the number of TCHARs copied to the destination buffer, not 
including the terminating null character.</p><p><u>If the buffer is too small, the function fails and </u><a href="ms-xhelp:///?method=page&amp;id=d852e148-985c-416f-a5a7-27b6914b45d4&amp;vendor=Microsoft&amp;topicVersion=85&amp;topicLocale=EN-US"><u>GetLastError</u></a><u> returns ERROR_BUFFER_OVERFLOW. 
The lpnSize parameter specifies the size 
of the buffer required, including the terminating null character.</u></p></blockquote>也就是说，只要你的缓冲区足以包含 MAX_COMPUTERNAME_LENGTH + 1 个字符，那么调用就是绝对没有问题的。如果你稍微吝啬一点，缓冲区分配少了，也可以，只不过每次调用完毕后都要检查一下 GetLastError 以确定你的缓冲区够不够用。<br /><br />实际上，不仅仅是字符串。还有结构体也是如此处理的。在有些情况下，调用方不知道需要多大的用于填充结构体的来容纳信息，例如 GDI 中的 GetObject 函数：<br /><div class="highlight"><pre><code class="language-cpp"><span class="kt">int</span> <span class="nf">GetObject</span><span class="p">(</span>
  <span class="n">_In_</span>   <span class="n">HGDIOBJ</span> <span class="n">hgdiobj</span><span class="p">,</span>
  <span class="n">_In_</span>   <span class="kt">int</span> <span class="n">cbBuffer</span><span class="p">,</span>
  <span class="n">_Out_</span>  <span class="n">LPVOID</span> <span class="n">lpvObject</span>
<span class="p">);</span> 
</code></pre></div><br />其中，hgdiobj 是你使用 GDI 中的相关函数创建的句柄，这个句柄可以是 位图、画笔、画刷、调板和字体 句柄，对于不同类型的句柄，GetObject 填入 lpvObject 的字节数也不一样。就如你可以在定义中看到的 LPVOID 一样。就 GetObject 调用本身而言，如果调用方并不知道 hgdiobj 是一个什么句柄（感觉这种情况其实很少见，但理论上来说确实有这个可能），那么调用方也就不知道自己在调用此函数前，应该给 lpvObject 分配 BITMAP、DIBSECTION、EXTLOGPEN、LOGPEN、LOGBRUSH、LOGFONT，还是WORD（对于调板）。<br />那么，怎么办？我们来看看这个函数的返回值<br /><blockquote>Return value
<p>If the function succeeds, and lpvObject is a valid pointer, the return value 
is the number of bytes stored 
into the buffer.</p><p>If the function succeeds, and lpvObject is NULL, the return value is the number of bytes required to hold the information 
the function would store into the buffer.</p><p>If the function fails, the return value is zero.</p></blockquote>也就是说，只要先令 lpvObject 为 NULL，调用一次 GetObject，那么我们就知道需要多大的缓冲区了，那么接下来只要备足缓冲区，再调用一次 GetObject 就可以了。就算你不知道应该使用哪种结构体，你甚至都可以直接使用 new char[...] 来分配内存……总之，就函数调用本身而言，这个流程是没错的。<br />好吧，如果你真的不知道你手握的 hgdiobj 是什么，其实也可以先去问问 GetObjectType 的。</span></div><div><div class="ContentItem-time"><a target="_blank" href="//www.zhihu.com/question/33058061/answer/55951154"><span data-tooltip="发布于 2015-07-22 08:30">编辑于 2015-07-22</span></a></div></div><div><div class="ContentItem-actions Sticky RichContent-actions is-fixed is-bottom" style="width: 694px; bottom: 0px; left: 16px;"><span><button aria-label="赞同 1 " type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"/></svg></span>赞同 1</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"/></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"/></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover36-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover36-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"/></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"/></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"/></svg></span>喜欢</button><div class="Popover ContentItem-action"><button aria-label="更多" id="Popover37-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover37-content" type="button" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"/></svg></span></button></div><button data-zop-retract-question="true" type="button" class="Button ContentItem-action ContentItem-rightButton Button--plain"><span class="RichContent-collapsedText">收起</span><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--ArrowDown ContentItem-arrowIcon is-active" fill="currentColor" viewBox="0 0 24 24" width="24" height="24"><path d="M12 13L8.285 9.218a.758.758 0 0 0-1.064 0 .738.738 0 0 0 0 1.052l4.249 4.512a.758.758 0 0 0 1.064 0l4.246-4.512a.738.738 0 0 0 0-1.052.757.757 0 0 0-1.063 0L12.002 13z" fill-rule="evenodd"/></svg></span></button></div><div class="Sticky--holder" style="position: static; inset: auto; display: flex; float: none; margin: 0px -20px -10px; height: 54px; width: 694px;"></div></div></div><div></div><div class="ModalWrap"><div><div class=""></div><div class="ModalExp-content"><div class="ModalWrap-content"><div class="ModalWrap-title">继续浏览内容</div><div class="ModalWrap-item"><div class="ModalWrap-itemImg"><img src="https://pic4.zhimg.com/80/v2-88158afcff1e7f4b8b00a1ba81171b61_720w.png" /></div><div class="ModalWrap-itemContent"><div class="ModalWrap-itemTitle">知乎</div><div class="ModalWrap-itemDesc">发现更大的世界</div></div><div class="ModalWrap-itemBtn">打开</div></div><div class="ModalWrap-item"><div class="ModalWrap-itemImg"><img src="https://picb.zhimg.com/80/v2-a448b133c0201b59631ccfa93cb650f3_1440w.png" /></div><div class="ModalWrap-itemContent"><div class="ModalWrap-itemTitle">Chrome</div></div><div class="ModalWrap-itemBtn">继续</div></div></div></div></div></div><div><div><div class=""></div><div class="ModalLoading-content"><svg width="30" height="30" viewBox="0 0 66 66" xmlns="http://www.w3.org/2000/svg" class="CircleLoadingBar" aria-hidden="true"><g><circle class="path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"/></g></svg></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="2" data-zop="{&quot;authorName&quot;:&quot;PaintDream&quot;,&quot;itemId&quot;:55909208,&quot;title&quot;:&quot;windows api设计的如何？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="55909208" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="2" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;55909208&quot;,&quot;upvote_num&quot;:1,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;33058061&quot;,&quot;author_member_hash_id&quot;:&quot;264ef4765d10a40dbfe3b5bb6480fa7f&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="PaintDream" /><meta itemprop="image" content="https://pic1.zhimg.com/a03716f2414f19546be7d28592e3c4f3_l.jpg?source=1940ef5c" /><meta itemprop="url" content="https://www.zhihu.com/people/paintsnow" /><meta itemprop="zhihu:followerCount" content="4599" /><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover28-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover28-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="//www.zhihu.com/people/paintsnow"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="https://pic1.zhimg.com/a03716f2414f19546be7d28592e3c4f3_xs.jpg?source=1940ef5c" srcset="https://pic1.zhimg.com/a03716f2414f19546be7d28592e3c4f3_l.jpg?source=1940ef5c 2x" alt="PaintDream" /></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover29-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover29-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="//www.zhihu.com/people/paintsnow">PaintDream</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">竹烟错月影，清辉误卷帘</div></div></div></div></div><div class="LabelContainer-wrapper"></div><div class="css-h5al4j"><span><span class="Voters"><button type="button" class="Button Button--plain">1 人赞同了该回答</button></span></span></div></div><meta itemprop="image" /><meta itemprop="upvoteCount" content="1" /><meta itemprop="url" content="https://www.zhihu.com/question/33058061/answer/55909208" /><meta itemprop="dateCreated" content="2015-07-21T12:33:35.000Z" /><meta itemprop="dateModified" content="2015-07-21T12:33:35.000Z" /><meta itemprop="commentCount" content="0" /><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text">BSTR是Windows COM中标准的做法。被调用方分配内存，然后调用方释放。使用统一的分配API：SysAllocString/SysFreeString.</span></div><div><div class="ContentItem-time"><a target="_blank" href="//www.zhihu.com/question/33058061/answer/55909208"><span data-tooltip="发布于 2015-07-21 20:33">发布于 2015-07-21</span></a></div></div><div class="ContentItem-actions RichContent-actions"><span><button aria-label="赞同 1 " type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"/></svg></span>赞同 1</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"/></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"/></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover14-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover14-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"/></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"/></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"/></svg></span>喜欢</button><div class="Popover ContentItem-action"><button aria-label="更多" id="Popover15-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover15-content" type="button" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"/></svg></span></button></div><button data-zop-retract-question="true" type="button" class="Button ContentItem-action ContentItem-rightButton Button--plain"><span class="RichContent-collapsedText">收起</span><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--ArrowDown ContentItem-arrowIcon is-active" fill="currentColor" viewBox="0 0 24 24" width="24" height="24"><path d="M12 13L8.285 9.218a.758.758 0 0 0-1.064 0 .738.738 0 0 0 0 1.052l4.249 4.512a.758.758 0 0 0 1.064 0l4.246-4.512a.738.738 0 0 0 0-1.052.757.757 0 0 0-1.063 0L12.002 13z" fill-rule="evenodd"/></svg></span></button></div></div><div></div><div class="ModalWrap"><div><div class=""></div><div class="ModalExp-content"><div class="ModalWrap-content"><div class="ModalWrap-title">继续浏览内容</div><div class="ModalWrap-item"><div class="ModalWrap-itemImg"><img src="https://pic4.zhimg.com/80/v2-88158afcff1e7f4b8b00a1ba81171b61_720w.png" /></div><div class="ModalWrap-itemContent"><div class="ModalWrap-itemTitle">知乎</div><div class="ModalWrap-itemDesc">发现更大的世界</div></div><div class="ModalWrap-itemBtn">打开</div></div><div class="ModalWrap-item"><div class="ModalWrap-itemImg"><img src="https://picb.zhimg.com/80/v2-a448b133c0201b59631ccfa93cb650f3_1440w.png" /></div><div class="ModalWrap-itemContent"><div class="ModalWrap-itemTitle">Chrome</div></div><div class="ModalWrap-itemBtn">继续</div></div></div></div></div></div><div><div><div class=""></div><div class="ModalLoading-content"><svg width="30" height="30" viewBox="0 0 66 66" xmlns="http://www.w3.org/2000/svg" class="CircleLoadingBar" aria-hidden="true"><g><circle class="path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"/></g></svg></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="3" data-zop="{&quot;authorName&quot;:&quot;熊起&quot;,&quot;itemId&quot;:126551593,&quot;title&quot;:&quot;windows api设计的如何？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="126551593" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="3" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;126551593&quot;,&quot;upvote_num&quot;:0,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;33058061&quot;,&quot;author_member_hash_id&quot;:&quot;5512b2dde2e8ecefbba31b37283d53ad&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="熊起" /><meta itemprop="image" content="https://pic1.zhimg.com/v2-8f7da4cd0bf848d3d438cdd37f401ebc_l.jpg?source=1940ef5c" /><meta itemprop="url" content="https://www.zhihu.com/people/xiong-qi-1-54" /><meta itemprop="zhihu:followerCount" content="661" /><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover30-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover30-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="//www.zhihu.com/people/xiong-qi-1-54"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="https://pic1.zhimg.com/v2-8f7da4cd0bf848d3d438cdd37f401ebc_xs.jpg?source=1940ef5c" srcset="https://pic1.zhimg.com/v2-8f7da4cd0bf848d3d438cdd37f401ebc_l.jpg?source=1940ef5c 2x" alt="熊起" /></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover31-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover31-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="//www.zhihu.com/people/xiong-qi-1-54">熊起</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">克莱登大学农业学院品药丸专业</div></div></div></div></div><div class="LabelContainer-wrapper"></div></div><meta itemprop="image" /><meta itemprop="upvoteCount" content="0" /><meta itemprop="url" content="https://www.zhihu.com/question/33058061/answer/126551593" /><meta itemprop="dateCreated" content="2016-10-14T07:40:48.000Z" /><meta itemprop="dateModified" content="2016-10-14T07:40:48.000Z" /><meta itemprop="commentCount" content="0" /><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text"><p>用回调：<br />C++处理这种接口最漂亮，硬要用的C方案大概这样：<br />协议部分：<br />struct writer<br />{<br />void* data;<br />void(*proc)(void*, const char*, size_t);<br />};</p><p>void write_string(writer w, const char* s, size_t len)<br />{<br />w.proc(w.data,s,len);<br />}</p><p>//ABI这边<br />mystring s;<br />get_string(make_writer(s));<br />//make_writer函数你自己提供</p><p>//另一边</p>void get_string(struct writer w)<br />{<br />  write_string(w,“hello”,6);<br />}</span></div><div><div class="ContentItem-time"><a target="_blank" href="//www.zhihu.com/question/33058061/answer/126551593"><span data-tooltip="发布于 2016-10-14 15:40">发布于 2016-10-14</span></a></div></div><div class="ContentItem-actions RichContent-actions"><span><button aria-label="赞同 0 " type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"/></svg></span>赞同</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"/></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"/></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover16-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover16-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"/></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"/></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"/></svg></span>喜欢</button><div class="Popover ContentItem-action"><button aria-label="更多" id="Popover17-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover17-content" type="button" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"/></svg></span></button></div><button data-zop-retract-question="true" type="button" class="Button ContentItem-action ContentItem-rightButton Button--plain"><span class="RichContent-collapsedText">收起</span><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--ArrowDown ContentItem-arrowIcon is-active" fill="currentColor" viewBox="0 0 24 24" width="24" height="24"><path d="M12 13L8.285 9.218a.758.758 0 0 0-1.064 0 .738.738 0 0 0 0 1.052l4.249 4.512a.758.758 0 0 0 1.064 0l4.246-4.512a.738.738 0 0 0 0-1.052.757.757 0 0 0-1.063 0L12.002 13z" fill-rule="evenodd"/></svg></span></button></div></div><div></div><div class="ModalWrap"><div><div class=""></div><div class="ModalExp-content"><div class="ModalWrap-content"><div class="ModalWrap-title">继续浏览内容</div><div class="ModalWrap-item"><div class="ModalWrap-itemImg"><img src="https://pic4.zhimg.com/80/v2-88158afcff1e7f4b8b00a1ba81171b61_720w.png" /></div><div class="ModalWrap-itemContent"><div class="ModalWrap-itemTitle">知乎</div><div class="ModalWrap-itemDesc">发现更大的世界</div></div><div class="ModalWrap-itemBtn">打开</div></div><div class="ModalWrap-item"><div class="ModalWrap-itemImg"><img src="https://picb.zhimg.com/80/v2-a448b133c0201b59631ccfa93cb650f3_1440w.png" /></div><div class="ModalWrap-itemContent"><div class="ModalWrap-itemTitle">Chrome</div></div><div class="ModalWrap-itemBtn">继续</div></div></div></div></div></div><div><div><div class=""></div><div class="ModalLoading-content"><svg width="30" height="30" viewBox="0 0 66 66" xmlns="http://www.w3.org/2000/svg" class="CircleLoadingBar" aria-hidden="true"><g><circle class="path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"/></g></svg></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="4" data-zop="{&quot;authorName&quot;:&quot;陈厚来&quot;,&quot;itemId&quot;:55916269,&quot;title&quot;:&quot;windows api设计的如何？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="55916269" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="4" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;55916269&quot;,&quot;upvote_num&quot;:0,&quot;comment_num&quot;:2,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;33058061&quot;,&quot;author_member_hash_id&quot;:&quot;4b51af9687a689782d915a2e704f1835&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="陈厚来" /><meta itemprop="image" content="https://pic2.zhimg.com/dd19f97c49a060f5197186514bc500c2_l.jpg?source=1940ef5c" /><meta itemprop="url" content="https://www.zhihu.com/people/xhawk18" /><meta itemprop="zhihu:followerCount" content="1083" /><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover32-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover32-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="//www.zhihu.com/people/xhawk18"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="https://pic2.zhimg.com/dd19f97c49a060f5197186514bc500c2_xs.jpg?source=1940ef5c" srcset="https://pic2.zhimg.com/dd19f97c49a060f5197186514bc500c2_l.jpg?source=1940ef5c 2x" alt="陈厚来" /></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover33-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover33-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="//www.zhihu.com/people/xhawk18">陈厚来</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">码农。。</div></div></div></div></div><div class="LabelContainer-wrapper"></div></div><meta itemprop="image" /><meta itemprop="upvoteCount" content="0" /><meta itemprop="url" content="https://www.zhihu.com/question/33058061/answer/55916269" /><meta itemprop="dateCreated" content="2015-07-21T13:46:16.000Z" /><meta itemprop="dateModified" content="2015-07-21T13:46:16.000Z" /><meta itemprop="commentCount" content="2" /><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text">win api很多参数是结构体，大大增加了编程的心智负担，减少了编程的乐趣。</span></div><div><div class="ContentItem-time"><a target="_blank" href="//www.zhihu.com/question/33058061/answer/55916269"><span data-tooltip="发布于 2015-07-21 21:46">发布于 2015-07-21</span></a></div></div><div class="ContentItem-actions RichContent-actions"><span><button aria-label="赞同 0 " type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"/></svg></span>赞同</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"/></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"/></svg></span>2 条评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover18-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover18-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"/></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"/></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"/></svg></span>喜欢</button><div class="Popover ContentItem-action"><button aria-label="更多" id="Popover19-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover19-content" type="button" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"/></svg></span></button></div><button data-zop-retract-question="true" type="button" class="Button ContentItem-action ContentItem-rightButton Button--plain"><span class="RichContent-collapsedText">收起</span><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--ArrowDown ContentItem-arrowIcon is-active" fill="currentColor" viewBox="0 0 24 24" width="24" height="24"><path d="M12 13L8.285 9.218a.758.758 0 0 0-1.064 0 .738.738 0 0 0 0 1.052l4.249 4.512a.758.758 0 0 0 1.064 0l4.246-4.512a.738.738 0 0 0 0-1.052.757.757 0 0 0-1.063 0L12.002 13z" fill-rule="evenodd"/></svg></span></button></div></div><div></div><div class="ModalWrap"><div><div class=""></div><div class="ModalExp-content"><div class="ModalWrap-content"><div class="ModalWrap-title">继续浏览内容</div><div class="ModalWrap-item"><div class="ModalWrap-itemImg"><img src="https://pic4.zhimg.com/80/v2-88158afcff1e7f4b8b00a1ba81171b61_720w.png" /></div><div class="ModalWrap-itemContent"><div class="ModalWrap-itemTitle">知乎</div><div class="ModalWrap-itemDesc">发现更大的世界</div></div><div class="ModalWrap-itemBtn">打开</div></div><div class="ModalWrap-item"><div class="ModalWrap-itemImg"><img src="https://picb.zhimg.com/80/v2-a448b133c0201b59631ccfa93cb650f3_1440w.png" /></div><div class="ModalWrap-itemContent"><div class="ModalWrap-itemTitle">Chrome</div></div><div class="ModalWrap-itemBtn">继续</div></div></div></div></div></div><div><div><div class=""></div><div class="ModalLoading-content"><svg width="30" height="30" viewBox="0 0 66 66" xmlns="http://www.w3.org/2000/svg" class="CircleLoadingBar" aria-hidden="true"><g><circle class="path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"/></g></svg></div></div></div></div></div><div></div></div></div></div></div></div></div><div class="Card" data-za-detail-view-path-module="BottomBar" data-za-extra-module="{}"><button type="button" class="Button QuestionAnswers-answerButton Button--blue Button--spread"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Edit QuestionButton-icon" fill="currentColor" viewBox="0 0 24 24" width="16" height="16"><path d="M4.076 16.966a4.19 4.19 0 0 1 1.05-1.76l8.568-8.569a.524.524 0 0 1 .741 0l2.928 2.927a.524.524 0 0 1 0 .74l-8.568 8.57c-.49.49-1.096.852-1.761 1.051l-3.528 1.058a.394.394 0 0 1-.49-.488l1.06-3.53zM20.558 4.83c.59.59.59 1.546 0 2.136l-1.693 1.692a.503.503 0 0 1-.712 0l-2.812-2.812a.504.504 0 0 1 0-.712l1.693-1.693a1.51 1.51 0 0 1 2.135 0l1.389 1.389z"/></svg></span>写回答</button></div><div class="CollapsedAnswers-bar"><button type="button" class="Button Button--plain">2 个回答被折叠</button>（<a target="_blank" type="button" class="Button Button--plain" href="/question/20120168">为什么？</a>）</div></div></div><div class="Question-sideColumn Question-sideColumn--sticky" data-za-detail-view-path-module="RightSideBar" data-za-extra-module="{}"><div><div class="Sticky"><div class="Card"><div class="Pc-card Card"><a class="Banner-link" href="https://www.zhihu.com/xen/market/ecom-page/1352355771074629632" target="_blank"><div class="Banner-adTag">广告</div><img class="Banner-image" src="https://pic2.zhimg.com/v2-2256b6427d487e5e322886922f96928d_540x450.jpeg" alt="广告" /></a><div class="Pc-card-button-close " data-tooltip="不再显示" data-tooltip-position="bottom"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 12" class="Icon Icon--close Pc-card-button-close-svg "><path fill-rule="evenodd" d="M3 2L2 3l3 3-3 3 1 1 3-3 3 3 1-1-3-3 3-3-1-1-3 3"/></svg></div></div></div><div class="QuestionSidebarTopicMeta"></div><div class="Card" data-za-detail-view-path-module="RelatedQuestions" data-za-extra-module="{}"><div class="Card-header SimilarQuestions-title"><div class="Card-headerText">相关问题</div></div><div class="Card-section SimilarQuestions-list"><div class="SimilarQuestions-item" itemprop="zhihu:similarQuestion" itemtype="http://schema.org/Question" itemscope="" data-za-detail-view-path-module="QuestionItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Question&quot;,&quot;token&quot;:&quot;275400371&quot;}}}"><meta itemprop="name" content="什么才算是盗版的Windows？" /><meta itemprop="url" content="https://www.zhihu.com/question/275400371" /><meta itemprop="answerCount" content="24" /><meta itemprop="zhihu:followerCount" content="74" /><a target="_blank" type="button" class="Button Button--plain" href="/question/275400371">什么才算是盗版的Windows？</a> 24 个回答</div><div class="SimilarQuestions-item" itemprop="zhihu:similarQuestion" itemtype="http://schema.org/Question" itemscope="" data-za-detail-view-path-module="QuestionItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Question&quot;,&quot;token&quot;:&quot;63674658&quot;}}}"><meta itemprop="name" content="系统缓存可以清理吗？" /><meta itemprop="url" content="https://www.zhihu.com/question/63674658" /><meta itemprop="answerCount" content="6" /><meta itemprop="zhihu:followerCount" content="8" /><a target="_blank" type="button" class="Button Button--plain" href="/question/63674658">系统缓存可以清理吗？</a> 6 个回答</div><div class="SimilarQuestions-item" itemprop="zhihu:similarQuestion" itemtype="http://schema.org/Question" itemscope="" data-za-detail-view-path-module="QuestionItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Question&quot;,&quot;token&quot;:&quot;30940532&quot;}}}"><meta itemprop="name" content="怎样关闭windows的自动更新？" /><meta itemprop="url" content="https://www.zhihu.com/question/30940532" /><meta itemprop="answerCount" content="2" /><meta itemprop="zhihu:followerCount" content="18" /><a target="_blank" type="button" class="Button Button--plain" href="/question/30940532">怎样关闭windows的自动更新？</a> 2 个回答</div><div class="SimilarQuestions-item" itemprop="zhihu:similarQuestion" itemtype="http://schema.org/Question" itemscope="" data-za-detail-view-path-module="QuestionItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Question&quot;,&quot;token&quot;:&quot;27411731&quot;}}}"><meta itemprop="name" content="Windows有哪些一般用户不会用到的功能？" /><meta itemprop="url" content="https://www.zhihu.com/question/27411731" /><meta itemprop="answerCount" content="12" /><meta itemprop="zhihu:followerCount" content="106" /><a target="_blank" type="button" class="Button Button--plain" href="/question/27411731">Windows有哪些一般用户不会用到的功能？</a> 12 个回答</div><div class="SimilarQuestions-item" itemprop="zhihu:similarQuestion" itemtype="http://schema.org/Question" itemscope="" data-za-detail-view-path-module="QuestionItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Question&quot;,&quot;token&quot;:&quot;23537624&quot;}}}"><meta itemprop="name" content="windows 下如何让一个窗口置顶？" /><meta itemprop="url" content="https://www.zhihu.com/question/23537624" /><meta itemprop="answerCount" content="19" /><meta itemprop="zhihu:followerCount" content="160" /><a target="_blank" type="button" class="Button Button--plain" href="/question/23537624">windows 下如何让一个窗口置顶？</a> 19 个回答</div></div></div><div class="Card" data-za-detail-view-path-module="ContentList" data-za-detail-view-path-module_name="相关推荐" data-za-extra-module="{}"><div class="Card-header RelatedCommodities-title"><div class="Card-headerText">相关推荐</div></div><div class="Card-section RelatedCommodities-list"><a target="_blank" href="/lives/909740192015998976" type="button" class="Button RelatedCommodities-item Button--plain" data-za-detail-view-path-module="LiveItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Live&quot;,&quot;id&quot;:&quot;909740192015998976&quot;,&quot;author_member_hash_id&quot;:&quot;11275cdedcdc7011d17004765b515b0f&quot;}}}"><img class="RelatedCommodities-image" src="https://pic1.zhimg.com/90/v2-d6452a5b642544c720801e7ee4ac33d7_250x0.jpg?source=31184dd1" alt="live" /><div class="RelatedCommodities-content"><div class="RelatedCommodities-subject RelatedCommodities-subject-two" data-tooltip="画龙点睛——从Windows程序到商业产品">画龙点睛——从Windows程序到商业产品</div><div class="RelatedCommodities-meta"><div class="RelatedCommodities-scoreWrapper"><div class="Rating"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15" fill="currentColor"><g fill="#ffab2e" fill-rule="evenodd"><path d="M10.925 14.302c.173.13.408.13.58-.002a.514.514 0 00.175-.572l-1.323-4.296 3.435-2.456c.175-.13.25-.36.185-.572a.5.5 0 00-.468-.36H9.275L7.96 1.754c-.064-.21-.21-.354-.46-.354-.14 0-1.027 3.53-.988 6.32.04 2.788.98 3.85.98 3.85l3.433 2.732z"/><path d="M7.5 1.4a.47.47 0 00-.474.354l-1.318 4.29H1.49a.499.499 0 00-.467.36.523.523 0 00.185.572l3.42 2.463-1.307 4.286c-.066.21.004.44.176.572.172.13.407.132.58.003l3.42-2.734L7.5 1.4z"/></g></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15" fill="currentColor"><g fill="#ffab2e" fill-rule="evenodd"><path d="M10.925 14.302c.173.13.408.13.58-.002a.514.514 0 00.175-.572l-1.323-4.296 3.435-2.456c.175-.13.25-.36.185-.572a.5.5 0 00-.468-.36H9.275L7.96 1.754c-.064-.21-.21-.354-.46-.354-.14 0-1.027 3.53-.988 6.32.04 2.788.98 3.85.98 3.85l3.433 2.732z"/><path d="M7.5 1.4a.47.47 0 00-.474.354l-1.318 4.29H1.49a.499.499 0 00-.467.36.523.523 0 00.185.572l3.42 2.463-1.307 4.286c-.066.21.004.44.176.572.172.13.407.132.58.003l3.42-2.734L7.5 1.4z"/></g></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15" fill="currentColor"><g fill="#ffab2e" fill-rule="evenodd"><path d="M10.925 14.302c.173.13.408.13.58-.002a.514.514 0 00.175-.572l-1.323-4.296 3.435-2.456c.175-.13.25-.36.185-.572a.5.5 0 00-.468-.36H9.275L7.96 1.754c-.064-.21-.21-.354-.46-.354-.14 0-1.027 3.53-.988 6.32.04 2.788.98 3.85.98 3.85l3.433 2.732z"/><path d="M7.5 1.4a.47.47 0 00-.474.354l-1.318 4.29H1.49a.499.499 0 00-.467.36.523.523 0 00.185.572l3.42 2.463-1.307 4.286c-.066.21.004.44.176.572.172.13.407.132.58.003l3.42-2.734L7.5 1.4z"/></g></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15" fill="currentColor"><g fill="#ffab2e" fill-rule="evenodd"><path d="M10.925 14.302c.173.13.408.13.58-.002a.514.514 0 00.175-.572l-1.323-4.296 3.435-2.456c.175-.13.25-.36.185-.572a.5.5 0 00-.468-.36H9.275L7.96 1.754c-.064-.21-.21-.354-.46-.354-.14 0-1.027 3.53-.988 6.32.04 2.788.98 3.85.98 3.85l3.433 2.732z"/><path d="M7.5 1.4a.47.47 0 00-.474.354l-1.318 4.29H1.49a.499.499 0 00-.467.36.523.523 0 00.185.572l3.42 2.463-1.307 4.286c-.066.21.004.44.176.572.172.13.407.132.58.003l3.42-2.734L7.5 1.4z"/></g></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15" fill="currentColor"><g fill="#ffab2e" fill-rule="evenodd"><path d="M10.925 14.302c.173.13.408.13.58-.002a.514.514 0 00.175-.572l-1.323-4.296 3.435-2.456c.175-.13.25-.36.185-.572a.5.5 0 00-.468-.36H9.275L7.96 1.754c-.064-.21-.21-.354-.46-.354-.14 0-1.027 3.53-.988 6.32.04 2.788.98 3.85.98 3.85l3.433 2.732z"/><path d="M7.5 1.4a.47.47 0 00-.474.354l-1.318 4.29H1.49a.499.499 0 00-.467.36.523.523 0 00.185.572l3.42 2.463-1.307 4.286c-.066.21.004.44.176.572.172.13.407.132.58.003l3.42-2.734L7.5 1.4z"/></g></svg></div></div></div></div></a><a target="_blank" href="/pub/book/120129892" type="button" class="Button RelatedCommodities-item Button--plain" data-za-detail-view-path-module="EBookItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;EBook&quot;,&quot;token&quot;:&quot;120129892&quot;}}}"><img class="RelatedCommodities-image" src="https://pic1.zhimg.com/90/v2-6c00776be7a3adf785396de37e57e7cd_250x0.jpg?source=31184dd1" alt="live" /><div class="RelatedCommodities-content"><div class="RelatedCommodities-subject RelatedCommodities-subject-two" data-tooltip="Windows 10 使用方法与技巧从入门到精通">Windows 10 使用方法与技巧从入门到精通</div><div class="RelatedCommodities-meta"><div class="RelatedCommodities-bookMeta">6 人读过<span class="RelatedCommodities-bookRead"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Ebook" width="13" height="14" fill="currentColor" viewBox="0 0 24 24"><path d="M16 17.649V2.931a.921.921 0 0 0-.045-.283.943.943 0 0 0-1.182-.604L4.655 5.235A.932.932 0 0 0 4 6.122v14.947c0 .514.421.931.941.931H19.06c.52 0 .941-.417.941-.93V7.292a.936.936 0 0 0-.941-.931h-.773v12.834a.934.934 0 0 1-.83.924L6.464 21.416c-.02.002 2.94-.958 8.883-2.881a.932.932 0 0 0 .653-.886z" fill-rule="evenodd"/></svg></span>阅读</span></div></div></div></a><a target="_blank" href="/pub/book/119583236" type="button" class="Button RelatedCommodities-item Button--plain" data-za-detail-view-path-module="EBookItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;EBook&quot;,&quot;token&quot;:&quot;119583236&quot;}}}"><img class="RelatedCommodities-image" src="https://pic2.zhimg.com/90/v2-5551588c3762164b12c9ceeae660620b_250x0.jpg?source=31184dd1" alt="live" /><div class="RelatedCommodities-content"><div class="RelatedCommodities-subject RelatedCommodities-subject-two" data-tooltip="Windows 10 技术与应用大全">Windows 10 技术与应用大全</div><div class="RelatedCommodities-meta"><div class="RelatedCommodities-bookMeta">319 人读过<span class="RelatedCommodities-bookRead"><span style="display: inline-flex; align-items: center;">​<svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--Ebook" width="13" height="14" fill="currentColor" viewBox="0 0 24 24"><path d="M16 17.649V2.931a.921.921 0 0 0-.045-.283.943.943 0 0 0-1.182-.604L4.655 5.235A.932.932 0 0 0 4 6.122v14.947c0 .514.421.931.941.931H19.06c.52 0 .941-.417.941-.93V7.292a.936.936 0 0 0-.941-.931h-.773v12.834a.934.934 0 0 1-.83.924L6.464 21.416c-.02.002 2.94-.958 8.883-2.881a.932.932 0 0 0 .653-.886z" fill-rule="evenodd"/></svg></span>阅读</span></div></div></div></a></div></div><div class="Card"><div class="Pc-card Card"><a class="Banner-link" href="https://www.aliyun.com/product/yunxiao/codeup?channel=yy_zhihu0" target="_blank"><div class="Banner-adTag">广告</div><img class="Banner-image" src="https://pic1.zhimg.com/v2-555e96082145c90f565683a2165a3ce4_540x450.jpeg" alt="广告" /></a><div class="Pc-card-button-close " data-tooltip="不再显示" data-tooltip-position="bottom"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 12" class="Icon Icon--close Pc-card-button-close-svg "><path fill-rule="evenodd" d="M3 2L2 3l3 3-3 3 1 1 3-3 3 3 1-1-3-3 3-3-1-1-3 3"/></svg></div></div></div><footer class="Footer"><a class="Footer-item" target="_blank" rel="noopener noreferrer" href="//liukanshan.zhihu.com/">刘看山</a><span class="Footer-dot"></span><a class="Footer-item" target="_blank" rel="noopener noreferrer" href="/question/19581624">知乎指南</a><span class="Footer-dot"></span><a class="Footer-item" target="_blank" rel="noopener noreferrer" href="/term/zhihu-terms">知乎协议</a><span class="Footer-dot"></span><a class="Footer-item" target="_blank" rel="noopener noreferrer" href="/term/privacy">知乎隐私保护指引</a><br /><a class="Footer-item" target="_blank" href="/app">应用</a><span class="Footer-dot"></span><a class="Footer-item" target="_blank" rel="noopener noreferrer" href="https://app.mokahr.com/apply/zhihu">工作</a><span class="Footer-dot"></span><button type="button" class="Button OrgCreateButton">申请开通知乎机构号</button><br /><a class="Footer-item" target="_blank" rel="noopener noreferrer" href="https://zhuanlan.zhihu.com/p/28852607">侵权举报</a><span class="Footer-dot"></span><a class="Footer-item" target="_blank" rel="noopener noreferrer" href="http://www.12377.cn">网上有害信息举报专区</a><br /><a class="Footer-item" target="_blank" rel="noopener noreferrer" href="https://tsm.miit.gov.cn/dxxzsp/">京 ICP 证 110745 号</a><br /><a class="Footer-item" target="_blank" rel="noopener noreferrer" href="https://beian.miit.gov.cn/">京 ICP 备 13052560 号 - 1</a><br /><a class="Footer-item" target="_blank" rel="noopener noreferrer" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010802020088"><img src="https://pic3.zhimg.com/80/v2-d0289dc0a46fc5b15b3363ffa78cf6c7.png" />京公网安备 11010802020088 号</a><br /><span class="Footer-item">互联网药品信息服务资格证书<br />（京）- 非经营性 - 2017 - 0067</span><span class="Footer-item">违法和不良信息举报：010-82716601</span><br /><a class="Footer-item" target="_blank" href="/term/child-jubao">儿童色情信息举报专区</a><br /><a class="Footer-item" target="_blank" href="/certificates">证照中心</a><span class="Footer-dot"></span><a class="Footer-item" target="_blank" rel="noopener noreferrer" href="//ir.zhihu.com">Investor Relations</a><br /><a class="Footer-item" target="_blank" href="/contact">联系我们</a><span> © 2021 知乎</span></footer></div></div></div></div></div></main><div data-zop-usertoken="{&quot;urlToken&quot;:&quot;yangquanhai&quot;}"></div><div class="CornerButtons"><div class="CornerAnimayedFlex CornerAnimayedFlex--hidden"><button data-tooltip="回到顶部" data-tooltip-position="left" data-tooltip-will-hide-on-click="true" aria-label="回到顶部" type="button" class="Button CornerButton Button--plain"><svg xmlns="http://www.w3.org/2000/svg" class="Zi Zi--BackToTop" aria-label="回到顶部" fill="currentColor" viewBox="0 0 24 24" width="24" height="24"><path d="M16.036 19.59a1 1 0 0 1-.997.995H9.032a.996.996 0 0 1-.997-.996v-7.005H5.03c-1.1 0-1.36-.633-.578-1.416L11.33 4.29a1.003 1.003 0 0 1 1.412 0l6.878 6.88c.782.78.523 1.415-.58 1.415h-3.004v7.005z"/></svg></button></div></div></div></div><script id="js-clientConfig" type="text/json">{"host":"zhihu.com","protocol":"https:","wwwHost":"www.zhihu.com","fetchRoot":{"www":"https:\u002F\u002Fwww.zhihu.com","api":"https:\u002F\u002Fapi.zhihu.com","lens":"https:\u002F\u002Flens.zhihu.com","zhuanlan":"https:\u002F\u002Fzhuanlan.zhihu.com","walletpay":"https:\u002F\u002Fwalletpay.zhihu.com","captcha":"https:\u002F\u002Fcaptcha.zhihu.com"}}</script><script id="js-initialData" type="text/json">{"initialState":{"common":{"ask":{}},"loading":{"global":{"count":0},"local":{"question\u002Fget\u002F":false,"question\u002FgetAnswers\u002F33058061":false}},"club":{"tags":{},"admins":{"data":[]},"members":{"data":[]},"explore":{"candidateSyncClubs":{}},"profile":{},"checkin":{},"comments":{"paging":{},"loading":{},"meta":{},"ids":{}},"postList":{"paging":{},"loading":{},"ids":{}},"recommend":{"data":[]},"silences":{"data":[]},"application":{"profile":null}},"entities":{"users":{"5b6cbee5d01bbbae90228c8baf07c3aa":{"uid":615253332370133000,"userType":"people","id":"5b6cbee5d01bbbae90228c8baf07c3aa"}},"questions":{"33058061":{"type":"question","id":33058061,"title":"windows api设计的如何？","questionType":"normal","created":1437469084,"updatedTime":1437469084,"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fquestions\u002F33058061","isMuted":false,"isVisible":true,"isNormal":true,"isEditable":true,"adminClosedComment":false,"hasPublishingDraft":false,"answerCount":5,"visitCount":7477,"commentCount":0,"followerCount":67,"collapsedAnswerCount":2,"excerpt":"C语言怎么从函数中返回未知长度的字符串，可以让它的调用者优雅地接收？","commentPermission":"all","detail":"C语言怎么从函数中返回未知长度的字符串，可以让它的调用者优雅地接收？","editableDetail":"C语言怎么从函数中返回未知长度的字符串，可以让它的调用者优雅地接收？","status":{"isLocked":false,"isClose":false,"isEvaluate":false,"isSuggest":false},"relationship":{"isAuthor":false,"isFollowing":false,"isAnonymous":false,"canLock":false,"canStickAnswers":false,"canCollapseAnswers":false,"voting":0},"topics":[{"id":"19552612","type":"topic","url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19552612","name":"Microsoft Windows","avatarUrl":"https:\u002F\u002Fpic4.zhimg.com\u002F50\u002Fv2-ff6c969503eedfe9a279532f7aaf301c_720w.jpg?source=54b3c3a5","topicType":"NORMAL"}],"author":{"id":"0","urlToken":"","name":"匿名用户","avatarUrl":"https:\u002F\u002Fpic1.zhimg.com\u002Faadd7b895_l.jpg?source=1940ef5c","avatarUrlTemplate":"https:\u002F\u002Fpic3.zhimg.com\u002Faadd7b895.jpg?source=1940ef5c","isOrg":false,"type":"people","url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fpeople\u002F0","userType":"people","headline":"","badge":[],"badgeV2":{"title":"","mergedBadges":[],"detailBadges":[],"icon":"","nightIcon":""},"gender":1,"isAdvertiser":false,"followerCount":0,"isFollowing":false,"isFollowed":false,"isCelebrity":false,"isBlocking":false,"isBlocked":false,"isPrivacy":false},"canComment":{"status":true,"reason":""},"thumbnailInfo":{"count":0,"type":"thumbnail_info","thumbnails":[]},"reviewInfo":{"type":"","tips":"","editTips":"","isReviewing":false,"editIsReviewing":false},"relatedCards":[],"muteInfo":{"type":""},"showAuthor":false,"isLabeled":false,"showEncourageAuthor":false,"voteupCount":0,"canVote":true,"visibleOnlyToAuthor":false}},"answers":{"55896568":{"id":55896568,"type":"answer","answerType":"normal","question":{"type":"question","id":33058061,"title":"windows api设计的如何？","questionType":"normal","created":1437469084,"updatedTime":1437469084,"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fquestions\u002F33058061","relationship":{}},"author":{"id":"5f8dec5f4fec496de6e11c3886951d4f","urlToken":"tim-chen-21","name":"Tim Chen","avatarUrl":"https:\u002F\u002Fpic4.zhimg.com\u002F88c444be01bc6eb8cbfdc360ccc60651_l.jpg?source=1940ef5c","avatarUrlTemplate":"https:\u002F\u002Fpic2.zhimg.com\u002F88c444be01bc6eb8cbfdc360ccc60651.jpg?source=1940ef5c","isOrg":false,"type":"people","url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fpeople\u002F5f8dec5f4fec496de6e11c3886951d4f","userType":"people","headline":"","badge":[{"type":"best_answerer","description":"优秀答主","topics":[{"id":"19554298","type":"topic","url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19554298","name":"编程","avatarUrl":"https:\u002F\u002Fpic2.zhimg.com\u002F50\u002Fv2-27b8ba1e647956fa6f1a2a8ad90138ef_720w.jpg?source=54b3c3a5","topicType":"CHANNEL"},{"id":"19552330","type":"topic","url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19552330","name":"程序员","avatarUrl":"https:\u002F\u002Fpic2.zhimg.com\u002F50\u002Fv2-3d917fb11613b7b13ecd7bbeb1c554e6_720w.jpg?source=54b3c3a5","topicType":"CHANNEL"}]}],"badgeV2":{"title":"编程话题下的优秀答主","mergedBadges":[{"type":"best","detailType":"best","title":"优秀答主","description":"编程话题下的优秀答主","url":"https:\u002F\u002Fwww.zhihu.com\u002Ftopic\u002F20054793","sources":[{"id":"19554298","token":"19554298","type":"topic","url":"https:\u002F\u002Fwww.zhihu.com\u002Ftopic\u002F19554298","name":"编程","avatarPath":"v2-27b8ba1e647956fa6f1a2a8ad90138ef","avatarUrl":"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-27b8ba1e647956fa6f1a2a8ad90138ef_hd.jpg","description":"","priority":0},{"id":"19552330","token":"19552330","type":"topic","url":"https:\u002F\u002Fwww.zhihu.com\u002Ftopic\u002F19552330","name":"程序员","avatarPath":"v2-3d917fb11613b7b13ecd7bbeb1c554e6","avatarUrl":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-3d917fb11613b7b13ecd7bbeb1c554e6_hd.jpg","description":"","priority":0}],"icon":"","nightIcon":""}],"detailBadges":[{"type":"best","detailType":"best_answerer","title":"优秀答主","description":"编程话题下的优秀答主","url":"https:\u002F\u002Fwww.zhihu.com\u002Ftopic\u002F20054793","sources":[{"id":"19554298","token":"19554298","type":"topic","url":"https:\u002F\u002Fwww.zhihu.com\u002Ftopic\u002F19554298","name":"编程","avatarPath":"v2-27b8ba1e647956fa6f1a2a8ad90138ef","avatarUrl":"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-27b8ba1e647956fa6f1a2a8ad90138ef_hd.jpg","description":"","priority":0},{"id":"19552330","token":"19552330","type":"topic","url":"https:\u002F\u002Fwww.zhihu.com\u002Ftopic\u002F19552330","name":"程序员","avatarPath":"v2-3d917fb11613b7b13ecd7bbeb1c554e6","avatarUrl":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-3d917fb11613b7b13ecd7bbeb1c554e6_hd.jpg","description":"","priority":0}],"icon":"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-bf0eec3c31c8e866c468f60eb296696c_l.png","nightIcon":"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-c724649168d8f9d36d7c3d13140a2594_l.png"}],"icon":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-bf0eec3c31c8e866c468f60eb296696c_l.png","nightIcon":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-c724649168d8f9d36d7c3d13140a2594_l.png"},"gender":1,"isAdvertiser":false,"followerCount":38295,"isFollowed":false,"isPrivacy":false},"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fanswers\u002F55896568","isCollapsed":false,"createdTime":1437474008,"updatedTime":1437474008,"extras":"","isCopyable":true,"isNormal":true,"voteupCount":6,"commentCount":0,"isSticky":false,"adminClosedComment":false,"commentPermission":"all","canComment":{"reason":"","status":true},"reshipmentSettings":"allowed","content":"因为牵涉到如何分配并释放内存，这并不是件简单的事。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E一种做法是让调用方分配内存，这种一般要先调用一次返回给你需要分配的大小然后分配内存后再调用一次。这样当然释放内存也是调用方来做。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E还有一种是被调用的函数内部负责分配内存，这种就需要规定好由谁来释放内存。因为不同组件的allocator实现不一样，如果由调用者来释放是件挺麻烦的事情，除非说好了使用某种特定的allocator。而由被调用方来释放的问题是需要有个机制使被调用方知道何时可以释放，比如通过调用另一个函数来释放。","editableContent":"","excerpt":"因为牵涉到如何分配并释放内存，这并不是件简单的事。 一种做法是让调用方分配内存，这种一般要先调用一次返回给你需要分配的大小然后分配内存后再调用一次。这样当然释放内存也是调用方来做。 还有一种是被调用的函数内部负责分配内存，这种就需要规定好由谁来释放内存。因为不同组件的allocator实现不一样，如果由调用者来释放是件挺麻烦的事情，除非说好了使用某种特定的allocator。而由被调用方来释放的问题是需要有个机制使…","collapsedBy":"nobody","collapseReason":"","annotationAction":null,"markInfos":[],"relevantInfo":{"isRelevant":false,"relevantType":"","relevantText":""},"suggestEdit":{"reason":"","status":false,"tip":"","title":"","unnormalDetails":{"status":"","description":"","reason":"","reasonId":0,"note":""},"url":""},"isLabeled":false,"rewardInfo":{"canOpenReward":false,"isRewardable":false,"rewardMemberCount":0,"rewardTotalMoney":0,"tagline":""},"relationship":{"isAuthor":false,"isAuthorized":false,"isNothelp":false,"isThanked":false,"isRecognized":false,"voting":0,"upvotedFollowees":[]},"adAnswer":null},"55909208":{"id":55909208,"type":"answer","answerType":"normal","question":{"type":"question","id":33058061,"title":"windows api设计的如何？","questionType":"normal","created":1437469084,"updatedTime":1437469084,"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fquestions\u002F33058061","relationship":{}},"author":{"id":"264ef4765d10a40dbfe3b5bb6480fa7f","urlToken":"paintsnow","name":"PaintDream","avatarUrl":"https:\u002F\u002Fpic1.zhimg.com\u002Fa03716f2414f19546be7d28592e3c4f3_l.jpg?source=1940ef5c","avatarUrlTemplate":"https:\u002F\u002Fpic2.zhimg.com\u002Fa03716f2414f19546be7d28592e3c4f3.jpg?source=1940ef5c","isOrg":false,"type":"people","url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fpeople\u002F264ef4765d10a40dbfe3b5bb6480fa7f","userType":"people","headline":"竹烟错月影，清辉误卷帘","badge":[],"badgeV2":{"title":"","mergedBadges":[],"detailBadges":[],"icon":"","nightIcon":""},"gender":1,"isAdvertiser":false,"followerCount":4599,"isFollowed":false,"isPrivacy":true},"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fanswers\u002F55909208","isCollapsed":false,"createdTime":1437482015,"updatedTime":1437482015,"extras":"","isCopyable":true,"isNormal":true,"voteupCount":1,"commentCount":0,"isSticky":false,"adminClosedComment":false,"commentPermission":"all","canComment":{"reason":"","status":true},"reshipmentSettings":"allowed","content":"BSTR是Windows COM中标准的做法。被调用方分配内存，然后调用方释放。使用统一的分配API：SysAllocString\u002FSysFreeString.","editableContent":"","excerpt":"BSTR是Windows COM中标准的做法。被调用方分配内存，然后调用方释放。使用统一的分配API：SysAllocString\u002FSysFreeString.","collapsedBy":"nobody","collapseReason":"","annotationAction":null,"markInfos":[],"relevantInfo":{"isRelevant":false,"relevantType":"","relevantText":""},"suggestEdit":{"reason":"","status":false,"tip":"","title":"","unnormalDetails":{"status":"","description":"","reason":"","reasonId":0,"note":""},"url":""},"isLabeled":false,"rewardInfo":{"canOpenReward":false,"isRewardable":false,"rewardMemberCount":0,"rewardTotalMoney":0,"tagline":""},"relationship":{"isAuthor":false,"isAuthorized":false,"isNothelp":false,"isThanked":false,"isRecognized":false,"voting":0,"upvotedFollowees":[]},"adAnswer":null},"55916269":{"id":55916269,"type":"answer","answerType":"normal","question":{"type":"question","id":33058061,"title":"windows api设计的如何？","questionType":"normal","created":1437469084,"updatedTime":1437469084,"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fquestions\u002F33058061","relationship":{}},"author":{"id":"4b51af9687a689782d915a2e704f1835","urlToken":"xhawk18","name":"陈厚来","avatarUrl":"https:\u002F\u002Fpic2.zhimg.com\u002Fdd19f97c49a060f5197186514bc500c2_l.jpg?source=1940ef5c","avatarUrlTemplate":"https:\u002F\u002Fpic2.zhimg.com\u002Fdd19f97c49a060f5197186514bc500c2.jpg?source=1940ef5c","isOrg":false,"type":"people","url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fpeople\u002F4b51af9687a689782d915a2e704f1835","userType":"people","headline":"码农。。","badge":[],"badgeV2":{"title":"","mergedBadges":[],"detailBadges":[],"icon":"","nightIcon":""},"gender":1,"isAdvertiser":false,"followerCount":1083,"isFollowed":false,"isPrivacy":false},"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fanswers\u002F55916269","isCollapsed":false,"createdTime":1437486376,"updatedTime":1437486376,"extras":"","isCopyable":true,"isNormal":true,"voteupCount":0,"commentCount":2,"isSticky":false,"adminClosedComment":false,"commentPermission":"all","canComment":{"reason":"","status":true},"reshipmentSettings":"allowed","content":"win api很多参数是结构体，大大增加了编程的心智负担，减少了编程的乐趣。","editableContent":"","excerpt":"win api很多参数是结构体，大大增加了编程的心智负担，减少了编程的乐趣。","collapsedBy":"nobody","collapseReason":"","annotationAction":null,"markInfos":[],"relevantInfo":{"isRelevant":false,"relevantType":"","relevantText":""},"suggestEdit":{"reason":"","status":false,"tip":"","title":"","unnormalDetails":{"status":"","description":"","reason":"","reasonId":0,"note":""},"url":""},"isLabeled":false,"rewardInfo":{"canOpenReward":false,"isRewardable":false,"rewardMemberCount":0,"rewardTotalMoney":0,"tagline":""},"relationship":{"isAuthor":false,"isAuthorized":false,"isNothelp":false,"isThanked":false,"isRecognized":false,"voting":0,"upvotedFollowees":[]},"adAnswer":null},"55951154":{"id":55951154,"type":"answer","answerType":"normal","question":{"type":"question","id":33058061,"title":"windows api设计的如何？","questionType":"normal","created":1437469084,"updatedTime":1437469084,"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fquestions\u002F33058061","relationship":{}},"author":{"id":"28e02f4158cb57e164c6d82de83b3511","urlToken":"CXuesong","name":"Siam Chen","avatarUrl":"https:\u002F\u002Fpic1.zhimg.com\u002F26db889e2b2923d3fd026c60b05e65c2_l.jpg?source=1940ef5c","avatarUrlTemplate":"https:\u002F\u002Fpic4.zhimg.com\u002F26db889e2b2923d3fd026c60b05e65c2.jpg?source=1940ef5c","isOrg":false,"type":"people","url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fpeople\u002F28e02f4158cb57e164c6d82de83b3511","userType":"people","headline":"L&amp;#34;沉迷SPARQL难以自拔的猫武士中文维基行政员&amp;#34;","badge":[],"badgeV2":{"title":"","mergedBadges":[],"detailBadges":[],"icon":"","nightIcon":""},"gender":1,"isAdvertiser":false,"followerCount":5092,"isFollowed":false,"isPrivacy":true},"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fanswers\u002F55951154","isCollapsed":false,"createdTime":1437525050,"updatedTime":1437534427,"extras":"","isCopyable":true,"isNormal":true,"voteupCount":1,"commentCount":0,"isSticky":false,"adminClosedComment":false,"commentPermission":"all","canComment":{"reason":"","status":true},"reshipmentSettings":"allowed","content":"一般来说，为了避免由于跨模块调用（尤其是使用动态链接库）的时候，内存分配方和释放方不同而可能引发的问题（一般是由于分配方与释放方使用了不同的堆），肯定是要坚持“谁分配，谁释放”的原则的。\u003Cbr\u002F\u003E因此大部分的API一般是由调用方提供一个字符串缓冲区以及缓冲区可以接受字符的最大长度，然后由被调用方将自己的字符串复制到调用方指定的位置去的。\u003Cbr\u002F\u003E不过，作为函数的被调用方，你也可以使用 char** 或者返回 char*，但是需要暴露一个专门的函数，用于回收你分配的内存。例如：\u003Cbr\u002F\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"c1\"\u003E\u002F\u002F 假设你已经根据实际情况定义好了 _DLLEXPORT 用于导出函数。\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003E_DLLEXPORT\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Echar\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003ECreateString\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E();\u003C\u002Fspan\u003E\n\u003Cspan class=\"n\"\u003E_DLLEXPORT\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EDeleteString\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"kt\"\u003Echar\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EpString\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"kt\"\u003Echar\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003ECreateString\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E()\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"kt\"\u003Echar\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emystr\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Echar\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"mi\"\u003E100\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E];\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"n\"\u003Estrcpy\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emystr\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"s\"\u003E&amp;#34;这是一个测试。\u003C\u002Fspan\u003E\u003Cspan class=\"se\"\u003E\\n\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E稍后你可以用其他内容填充这片内存。&amp;#34;\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"k\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emystr\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EDeleteString\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"kt\"\u003Echar\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EpString\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E{\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"k\"\u003Edelete\u003C\u002Fspan\u003E \u003Cspan class=\"p\"\u003E[]\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EpString\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E}\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E然后另一个模块内想要使用 CreateString ，那么就需要这样\u003Cbr\u002F\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E \t\u003Cspan class=\"kt\"\u003Echar\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E*\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eclient\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ECreateString\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E();\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"c1\"\u003E\u002F\u002F 对 client 做你想做的事情。\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E\t\u003Cspan class=\"n\"\u003EDeleteString\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Eclient\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E然而在 Windows API 中，字符串的处理方法以第一种情况居多，就是由调用方来分配缓冲区。这一点与 sprintf 类似。\u003Cbr\u002F\u003E例如，如果我们拿到了一个窗口的句柄，想要获取窗口的标题，可以使用 GetWindowText 函数：\u003Cbr\u002F\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003Eint WINAPI GetWindowText(\n  _In_   HWND hWnd,\n  _Out_  LPTSTR lpString,\n  _In_   int nMaxCount\n); \u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E其中，\u003Cbr\u002F\u003E\u003Cblockquote\u003E lpString [out] \u003Cbr\u002F\u003EType: LPTSTR\u003Cbr\u002F\u003EThe buffer that will receive the text. If the string is as long or longer than the buffer, the string is truncated and terminated with a null character.\u003Cbr\u002F\u003E\u003Cbr\u002F\u003EnMaxCount [in] \u003Cbr\u002F\u003EType: int\u003Cbr\u002F\u003EThe maximum number of characters to copy to the buffer, including the null character. If the text exceeds this limit, it is truncated.\u003C\u002Fblockquote\u003E也就是说，首先，lpString的内存是由调用方提供的，GetWindowText 仅负责把字符填入指定的内存中去；其次如果发现窗口标题文本的实际长度大于 nMaxCount - 1，那么文本会被截断。\u003Cbr\u002F\u003E可能你会有一个问题，我们能否在获取文本之前，确定窗口标题究竟有多长？ 这样，我们就可以分配最合适的内存长度。Windows API 当然已经考虑到这一点了，于是就有了 GetWindowTextLength 函数：\u003Cbr\u002F\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003Eint WINAPI GetWindowTextLength(\n  _In_  HWND hWnd\n); \u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E我们来看看它的描述\u003Cbr\u002F\u003E\u003Cblockquote\u003EReturn value\n\u003Cp\u003E\nType: int\u003C\u002Fp\u003E\u003Cp\u003EIf the function succeeds, the return value is the length, in characters, of \nthe text. Under certain conditions, this value may actually be greater than the \nlength of the text. For more information, see the following Remarks section.\u003C\u002Fp\u003E\u003C\u002Fblockquote\u003E这里提到的“返回值可能比实际文本的长度要大”，是考虑到了多字节字符系统（MBCS）中某些字符可能会占用两个或更多字节数。也就是说，如果你是用的是 ANSI 版本的函数（即 GetWindowTextLengthA），那么你可以把返回值作为分配内存的字节数（别忘了 +1）来使用，绝对可以放得下。\u003Cbr\u002F\u003E而且，就算你在调用 GetWindowTextLength 和 GetWindowText 两个步骤之间，目标窗口的文本发生变化了，例如，变长了，那么也不会有问题。GetWindowText 会根据你提供的缓冲区大小，将多出去的部分截断。因此起码不会造成崩溃。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E在有些情况下，字符串的最大长度是已知的，例如 GetComputerName：\u003Cbr\u002F\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003EBOOL WINAPI GetComputerName(\n  _Out_    LPTSTR lpBuffer,\n  _Inout_  LPDWORD lpnSize\n); \u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E这里是这么说的：\u003Cbr\u002F\u003E\u003Cblockquote\u003ElpBuffer [out] \n\n\u003Cp\u003EA pointer to a buffer that receives the computer name or the cluster virtual \nserver name. \u003Cu\u003EThe buffer size should be large enough to contain \nMAX_COMPUTERNAME_LENGTH + 1 characters.\u003C\u002Fu\u003E\u003C\u002Fp\u003E\nlpnSize [in, out] \n\n\u003Cp\u003EOn input, specifies the size of the buffer, in TCHARs. On output, the number of TCHARs copied to the destination buffer, not \nincluding the terminating null character.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cu\u003EIf the buffer is too small, the function fails and \u003C\u002Fu\u003E\u003Ca href=\"ms-xhelp:\u002F\u002F\u002F?method=page&amp;amp;id=d852e148-985c-416f-a5a7-27b6914b45d4&amp;amp;vendor=Microsoft&amp;amp;topicVersion=85&amp;amp;topicLocale=EN-US\"\u003E\u003Cu\u003EGetLastError\u003C\u002Fu\u003E\u003C\u002Fa\u003E\u003Cu\u003E returns ERROR_BUFFER_OVERFLOW. \nThe lpnSize parameter specifies the size \nof the buffer required, including the terminating null character.\u003C\u002Fu\u003E\u003C\u002Fp\u003E\u003C\u002Fblockquote\u003E也就是说，只要你的缓冲区足以包含 MAX_COMPUTERNAME_LENGTH + 1 个字符，那么调用就是绝对没有问题的。如果你稍微吝啬一点，缓冲区分配少了，也可以，只不过每次调用完毕后都要检查一下 GetLastError 以确定你的缓冲区够不够用。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E实际上，不仅仅是字符串。还有结构体也是如此处理的。在有些情况下，调用方不知道需要多大的用于填充结构体的来容纳信息，例如 GDI 中的 GetObject 函数：\u003Cbr\u002F\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-cpp\"\u003E\u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EGetObject\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E(\u003C\u002Fspan\u003E\n  \u003Cspan class=\"n\"\u003E_In_\u003C\u002Fspan\u003E   \u003Cspan class=\"n\"\u003EHGDIOBJ\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ehgdiobj\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E\n  \u003Cspan class=\"n\"\u003E_In_\u003C\u002Fspan\u003E   \u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EcbBuffer\u003C\u002Fspan\u003E\u003Cspan class=\"p\"\u003E,\u003C\u002Fspan\u003E\n  \u003Cspan class=\"n\"\u003E_Out_\u003C\u002Fspan\u003E  \u003Cspan class=\"n\"\u003ELPVOID\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ElpvObject\u003C\u002Fspan\u003E\n\u003Cspan class=\"p\"\u003E);\u003C\u002Fspan\u003E \n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E其中，hgdiobj 是你使用 GDI 中的相关函数创建的句柄，这个句柄可以是 位图、画笔、画刷、调板和字体 句柄，对于不同类型的句柄，GetObject 填入 lpvObject 的字节数也不一样。就如你可以在定义中看到的 LPVOID 一样。就 GetObject 调用本身而言，如果调用方并不知道 hgdiobj 是一个什么句柄（感觉这种情况其实很少见，但理论上来说确实有这个可能），那么调用方也就不知道自己在调用此函数前，应该给 lpvObject 分配 BITMAP、DIBSECTION、EXTLOGPEN、LOGPEN、LOGBRUSH、LOGFONT，还是WORD（对于调板）。\u003Cbr\u002F\u003E那么，怎么办？我们来看看这个函数的返回值\u003Cbr\u002F\u003E\u003Cblockquote\u003EReturn value\n\u003Cp\u003EIf the function succeeds, and lpvObject is a valid pointer, the return value \nis the number of bytes stored \ninto the buffer.\u003C\u002Fp\u003E\u003Cp\u003EIf the function succeeds, and lpvObject is NULL, the return value is the number of bytes required to hold the information \nthe function would store into the buffer.\u003C\u002Fp\u003E\u003Cp\u003EIf the function fails, the return value is zero.\u003C\u002Fp\u003E\u003C\u002Fblockquote\u003E也就是说，只要先令 lpvObject 为 NULL，调用一次 GetObject，那么我们就知道需要多大的缓冲区了，那么接下来只要备足缓冲区，再调用一次 GetObject 就可以了。就算你不知道应该使用哪种结构体，你甚至都可以直接使用 new char[...] 来分配内存……总之，就函数调用本身而言，这个流程是没错的。\u003Cbr\u002F\u003E好吧，如果你真的不知道你手握的 hgdiobj 是什么，其实也可以先去问问 GetObjectType 的。","editableContent":"","excerpt":"一般来说，为了避免由于跨模块调用（尤其是使用动态链接库）的时候，内存分配方和释放方不同而可能引发的问题（一般是由于分配方与释放方使用了不同的堆），肯定是要坚持“谁分配，谁释放”的原则的。 因此大部分的API一般是由调用方提供一个字符串缓冲区以及缓冲区可以接受字符的最大长度，然后由被调用方将自己的字符串复制到调用方指定的位置去的。 不过，作为函数的被调用方，你也可以使用 char** 或者返回 char*，但是需要…","collapsedBy":"nobody","collapseReason":"","annotationAction":null,"markInfos":[],"relevantInfo":{"isRelevant":false,"relevantType":"","relevantText":""},"suggestEdit":{"reason":"","status":false,"tip":"","title":"","unnormalDetails":{"status":"","description":"","reason":"","reasonId":0,"note":""},"url":""},"isLabeled":false,"rewardInfo":{"canOpenReward":false,"isRewardable":false,"rewardMemberCount":0,"rewardTotalMoney":0,"tagline":""},"relationship":{"isAuthor":false,"isAuthorized":false,"isNothelp":false,"isThanked":false,"isRecognized":false,"voting":0,"upvotedFollowees":[]},"adAnswer":null},"126551593":{"id":126551593,"type":"answer","answerType":"normal","question":{"type":"question","id":33058061,"title":"windows api设计的如何？","questionType":"normal","created":1437469084,"updatedTime":1437469084,"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fquestions\u002F33058061","relationship":{}},"author":{"id":"5512b2dde2e8ecefbba31b37283d53ad","urlToken":"xiong-qi-1-54","name":"熊起","avatarUrl":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-8f7da4cd0bf848d3d438cdd37f401ebc_l.jpg?source=1940ef5c","avatarUrlTemplate":"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-8f7da4cd0bf848d3d438cdd37f401ebc.jpg?source=1940ef5c","isOrg":false,"type":"people","url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fpeople\u002F5512b2dde2e8ecefbba31b37283d53ad","userType":"people","headline":"克莱登大学农业学院品药丸专业","badge":[],"badgeV2":{"title":"","mergedBadges":[],"detailBadges":[],"icon":"","nightIcon":""},"gender":1,"isAdvertiser":false,"followerCount":661,"isFollowed":false,"isPrivacy":false},"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fanswers\u002F126551593","isCollapsed":false,"createdTime":1476430848,"updatedTime":1476430848,"extras":"","isCopyable":true,"isNormal":true,"voteupCount":0,"commentCount":0,"isSticky":false,"adminClosedComment":false,"commentPermission":"all","canComment":{"reason":"","status":true},"reshipmentSettings":"allowed","content":"用回调：\u003Cbr\u002F\u003EC++处理这种接口最漂亮，硬要用的C方案大概这样：\u003Cbr\u002F\u003E协议部分：\u003Cbr\u002F\u003Estruct writer\u003Cbr\u002F\u003E{\u003Cbr\u002F\u003Evoid* data;\u003Cbr\u002F\u003Evoid(*proc)(void*, const char*, size_t);\u003Cbr\u002F\u003E};\u003Cbr\u002F\u003E\u003Cbr\u002F\u003Evoid write_string(writer w, const char* s, size_t len)\u003Cbr\u002F\u003E{\u003Cbr\u002F\u003Ew.proc(w.data,s,len);\u003Cbr\u002F\u003E}\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u002F\u002FABI这边\u003Cbr\u002F\u003Emystring s;\u003Cbr\u002F\u003Eget_string(make_writer(s));\u003Cbr\u002F\u003E\u002F\u002Fmake_writer函数你自己提供\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u002F\u002F另一边\u003Cbr\u002F\u003E\u003Cbr\u002F\u003Evoid get_string(struct writer w)\u003Cbr\u002F\u003E{\u003Cbr\u002F\u003E  write_string(w,“hello”,6);\u003Cbr\u002F\u003E}","editableContent":"","excerpt":"用回调： C++处理这种接口最漂亮，硬要用的C方案大概这样： 协议部分： struct writer { void* data; void(*proc)(void*, const char*, size_t); }; void write_string(writer w, const char* s, size_t len) { w.proc(w.data,s,len); } \u002F\u002FABI这边 mystring s; get_string(make_writer(s)); \u002F\u002Fmake_writer函数你自己提供 \u002F\u002F另一边 void get_string(struct writer w) { write_string(w,“hello”,6); }","collapsedBy":"nobody","collapseReason":"","annotationAction":null,"markInfos":[],"relevantInfo":{"isRelevant":false,"relevantType":"","relevantText":""},"suggestEdit":{"reason":"","status":false,"tip":"","title":"","unnormalDetails":{"status":"","description":"","reason":"","reasonId":0,"note":""},"url":""},"isLabeled":false,"rewardInfo":{"canOpenReward":false,"isRewardable":false,"rewardMemberCount":0,"rewardTotalMoney":0,"tagline":""},"relationship":{"isAuthor":false,"isAuthorized":false,"isNothelp":false,"isThanked":false,"isRecognized":false,"voting":0,"upvotedFollowees":[]},"adAnswer":null}},"articles":{},"columns":{},"topics":{},"roundtables":{},"favlists":{},"comments":{},"notifications":{},"ebooks":{},"activities":{},"feeds":{},"pins":{},"promotions":{},"drafts":{},"chats":{},"posts":{},"clubs":{},"clubTags":{},"zvideos":{}},"currentUser":"5b6cbee5d01bbbae90228c8baf07c3aa","account":{"lockLevel":{},"unlockTicketStatus":false,"unlockTicket":null,"challenge":[],"errorStatus":false,"message":"","isFetching":false,"accountInfo":{},"urlToken":{"loading":false}},"settings":{"socialBind":null,"inboxMsg":null,"notification":{},"email":{},"privacyFlag":null,"blockedUsers":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"blockedFollowees":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"ignoredTopics":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"restrictedTopics":null,"laboratory":{}},"notification":{},"people":{"profileStatus":{},"activitiesByUser":{},"answersByUser":{},"answersSortByVotesByUser":{},"answersIncludedByUser":{},"votedAnswersByUser":{},"thankedAnswersByUser":{},"voteAnswersByUser":{},"thankAnswersByUser":{},"topicAnswersByUser":{},"zvideosByUser":{},"articlesByUser":{},"articlesSortByVotesByUser":{},"articlesIncludedByUser":{},"pinsByUser":{},"questionsByUser":{},"commercialQuestionsByUser":{},"favlistsByUser":{},"followingByUser":{},"followersByUser":{},"mutualsByUser":{},"followingColumnsByUser":{},"followingQuestionsByUser":{},"followingFavlistsByUser":{},"followingTopicsByUser":{},"publicationsByUser":{},"columnsByUser":{},"allFavlistsByUser":{},"brands":null,"creationsByUser":{},"creationsSortByVotesByUser":{},"creationsFeed":{},"infinity":{},"batchUsers":{}},"env":{"ab":{"config":{"experiments":[{"expId":"launch-li_video-3","expPrefix":"li_video","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-qa_art2qa_new-3","expPrefix":"qa_art2qa_new","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-qa_cl_guest-2","expPrefix":"qa_cl_guest","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-qa_repost-2","expPrefix":"qa_repost","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-tp_zrec-8","expPrefix":"tp_zrec","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-us_adjust_new-11","expPrefix":"us_adjust_new","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-us_noti_count-8","expPrefix":"us_noti_count","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-vd_andplay_d-2","expPrefix":"vd_andplay_d","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-vd_hookupplay_an-2","expPrefix":"vd_hookupplay_an","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-vd_ios_play-10","expPrefix":"vd_ios_play","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-vd_timeguide-2","expPrefix":"vd_timeguide","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-vd_video_replay-3","expPrefix":"vd_video_replay","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-vd_zvideo_link-10","expPrefix":"vd_zvideo_link","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-zanswer-2","expPrefix":"zanswer","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-recnew_2th-3","expPrefix":"recnew_2th","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"se_infinity6-4","expPrefix":"se_infinity6","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"se_meta_ss-4","expPrefix":"se_meta_ss","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"qa_cdzixun-1","expPrefix":"qa_cdzixun","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"vd_video_tab-9","expPrefix":"vd_video_tab","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"li_tp_paidanswer-9","expPrefix":"li_tp_paidanswer","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"tp_content-1","expPrefix":"tp_content","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"gw_qrlogin-1","expPrefix":"gw_qrlogin","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"rec_expslotpaid-1","expPrefix":"rec_expslotpaid","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"captcha_v2-2_v11","expPrefix":"captcha_v2","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"xuanpinceshi-5_v3","expPrefix":"xuanpinceshi","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"office_xp-2_v2","expPrefix":"office_xp","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"xuanpinab-1_v4","expPrefix":"xuanpinab","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"Test_Punk-3_v2","expPrefix":"Test_Punk","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"meta_ebook-2_v2","expPrefix":"meta_ebook","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"webpImg-2_v3","expPrefix":"webpImg","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"vdox_cmt-1_v1","expPrefix":"vdox_cmt","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"ffzix_xgdzwz-3_v1","expPrefix":"ffzix_xgdzwz","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"hwtj_bottom_btn-1_v1","expPrefix":"hwtj_bottom_btn","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"general_1-2_v1","expPrefix":"general_1","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"ge_rec_sup-3_v3","expPrefix":"ge_rec_sup","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"rec_new2th-2_v4","expPrefix":"rec_new2th","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"se_zp_five-4_v1","expPrefix":"se_zp_five","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"hw_aa_30-3_v2","expPrefix":"hw_aa_30","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"hw_aa_50-2_v1","expPrefix":"hw_aa_50","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"se_filter-4_v4","expPrefix":"se_filter","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"se_cp_post2-1_v2","expPrefix":"se_cp_post2","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"se_sug_exp-4_v2","expPrefix":"se_sug_exp","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false}],"params":[{"id":"ge_v_rank_v3","type":"Int","value":"0","chainId":"_gene_","layerId":"FPcB","key":581},{"id":"gue_cdzixun","type":"String","value":"0","layerId":"gueqa_layer_3"},{"id":"gue_art2qa","type":"String","value":"0","layerId":"gueqa_layer_579"},{"id":"gue_repost","type":"String","value":"1","layerId":"gueqa_layer_671"},{"id":"gue_messrec","type":"String","value":"0","layerId":"gueqa_layer_769"},{"id":"ge_sxzx","type":"String","value":"0","chainId":"_gene_","layerId":"gere_layer_990","key":3060},{"id":"ge_rec_sup","type":"Int","value":"2","chainId":"_gene_","layerId":"ge_rec_sup","key":197},{"id":"gue_andplayd","type":"String","value":"1","layerId":"guevd_layer_686"},{"id":"ge_prf_rec","type":"String","value":"0","chainId":"_gene_","layerId":"getop_layer_991","key":3040},{"id":"xuanpinceshi","type":"Int","value":"3399","layerId":"xuanpinceshi"},{"id":"web_heifetz_grow_ad","type":"String","value":"1","layerId":"webgw_layer_3"},{"id":"ge_video","type":"String","value":"1","chainId":"_gene_","layerId":"geli_layer_856","key":2831},{"id":"webpImg","type":"Int","value":"2","layerId":"JnVt"},{"id":"gue_visit_n_artcard","type":"String","value":"1","layerId":"gueqa_layer_579"},{"id":"zanswer","type":"Int","value":"1","layerId":"l-zanswer"},{"id":"edu_cd1","type":"Int","value":"0","layerId":"edu_cd1"},{"id":"web_scl_rec","type":"String","value":"0","layerId":"webgw_layer_759"},{"id":"gue_zvideo_link","type":"String","value":"1","layerId":"guevd_layer_2"},{"id":"web_sem_ab","type":"String","value":"1","layerId":"webgw_layer_3"},{"id":"li_sp_mqbk","type":"String","value":"0","chainId":"_all_","layerId":"lili_layer_748"},{"id":"rec_new2th","type":"Int","value":"1","chainId":"_gene_","layerId":"Hump","key":320},{"id":"web_answerlist_ad","type":"String","value":"0","layerId":"webqa_layer_1"},{"id":"gue_bulletmb","type":"String","value":"0","layerId":"guevd_layer_812"},{"id":"hwtj_bottom_btn","type":"Int","value":"1","layerId":"04nd"},{"id":"se_zp_five","type":"Int","value":"1","chainId":"_gene_","layerId":"se_zp_five","key":344},{"id":"gue_video_guide","type":"String","value":"1","layerId":"guevd_layer_625"},{"id":"Full_ans_fav","type":"Int","value":"0","chainId":"_gene_","layerId":"Pnd6","key":372},{"id":"ge_hard_s_ma","type":"String","value":"0","chainId":"_gene_","layerId":"geli_layer_856","key":3031},{"id":"ffzix_xgdzwz","type":"Int","value":"1","layerId":"ffzix_xgdzwz"},{"id":"pfd_newbie2","type":"Int","value":"0","chainId":"_gene_","layerId":"pfd_newbie2","key":71},{"id":"gue_playh_an","type":"String","value":"1","layerId":"guevd_layer_622"},{"id":"general_1","type":"Int","value":"2","chainId":"_gene_","layerId":"general_1","key":8},{"id":"ge_search_ui","type":"String","value":"1","chainId":"_gene_","layerId":"gese_layer_838","key":2898},{"id":"gue_goods_card","type":"String","value":"0","layerId":"gueqa_layer_1"},{"id":"gue_recmess","type":"String","value":"0","layerId":"gueqa_layer_795"},{"id":"ge_yuzhi_v1","type":"String","value":"1","chainId":"_gene_","layerId":"gese_layer_1029","key":3127},{"id":"ge_relation2","type":"String","value":"1","chainId":"_gene_","layerId":"gese_layer_815","key":2796},{"id":"ge_newbie3","type":"Int","value":"0","chainId":"_gene_","layerId":"ge_newbie3","key":180},{"id":"se_filter","type":"Int","value":"2","chainId":"_gene_","layerId":"a8D1","key":363},{"id":"li_panswer_topic","type":"String","value":"0","chainId":"_all_","layerId":"lili_layer_602"},{"id":"web_answer_list_ad","type":"String","value":"1","layerId":"webqa_layer_4"},{"id":"ge_guess","type":"String","value":"0","chainId":"_gene_","layerId":"gese_layer_938","key":2912},{"id":"se_ffzx_jushen1","type":"String","value":"0","chainId":"_all_","layerId":"sese_layer_4"},{"id":"Test_Punk","type":"Int","value":"1","layerId":"Test_Punk"},{"id":"ge_rec_2th","type":"String","value":"11","chainId":"_gene_","layerId":"geli_layer_965","key":3023},{"id":"se_fix_ebook","type":"Int","value":"0","chainId":"_gene_","layerId":"se_fix_ebook","key":103},{"id":"li_paid_answer_exp","type":"String","value":"0","chainId":"_all_","layerId":"lili_layer_3"},{"id":"hw_aa_30","type":"Int","value":"2","chainId":"_gene_","layerId":"hw_aa_30","key":361},{"id":"se_cp_post2","type":"Int","value":"0","chainId":"_gene_","layerId":"se_cp_post2","key":466},{"id":"web_login","type":"String","value":"0","layerId":"webgw_layer_759"},{"id":"zr_slotpaidexp","type":"String","value":"1","chainId":"_all_","layerId":"zrrec_layer_5"},{"id":"ge_infinity6","type":"String","value":"2","chainId":"_gene_","layerId":"gese_layer_815","key":2817},{"id":"captcha_v2","type":"Int","value":"1","layerId":"captcha_v2"},{"id":"se_dssm","type":"Int","value":"0","chainId":"_gene_","layerId":"se_dssm","key":392},{"id":"gue_bullet_guide","type":"String","value":"发个弹幕聊聊…","layerId":"guevd_layer_0"},{"id":"show_ad","type":"Int","value":"0","chainId":"_gene_","layerId":"show_ad","key":27},{"id":"gue_profile_video","type":"String","value":"1","layerId":"guevd_layer_5"},{"id":"xuanpinab","type":"Int","value":"0","layerId":"xuanpinab"},{"id":"pf_adjust","type":"String","value":"1","chainId":"_all_","layerId":"pfus_layer_9"},{"id":"ge_sug_rep","type":"String","value":"1","chainId":"_gene_","layerId":"gese_layer_1034","key":3158},{"id":"tp_topic_style","type":"String","value":"0","chainId":"_all_","layerId":"tptp_layer_4"},{"id":"correct_cnn","type":"Int","value":"0","chainId":"_gene_","layerId":"correct_cnn","key":397},{"id":"gue_fo_recom","type":"String","value":"0","layerId":"gueqa_layer_780"},{"id":"ge_item","type":"String","value":"0","chainId":"_gene_","layerId":"gese_layer_945","key":2971},{"id":"meta_ebook","type":"Int","value":"1","layerId":"meta_ebook"},{"id":"se_personal_ab","type":"Int","value":"0","chainId":"_gene_","layerId":"niPJ","key":554},{"id":"gue_q_share","type":"String","value":"0","layerId":"gueqa_layer_647"},{"id":"zr_expslotpaid","type":"String","value":"1","chainId":"_all_","layerId":"zrrec_layer_11"},{"id":"top_test_4_liguangyi","type":"String","value":"1","chainId":"_all_","layerId":"iosus_layer_1"},{"id":"gue_v_serial","type":"String","value":"1","layerId":"guevd_layer_695"},{"id":"web_collection_guest","type":"String","value":"1","layerId":"webqa_layer_4"},{"id":"ge_newyanzhi","type":"String","value":"0","chainId":"_gene_","layerId":"geus_layer_1019","key":2788},{"id":"gue_art_ui","type":"String","value":"2","layerId":"gueqa_layer_647"},{"id":"gue_video_replay","type":"String","value":"2","layerId":"guevd_layer_3"},{"id":"se_sug_exp","type":"Int","value":"3","chainId":"_gene_","layerId":"9ZDG","key":522},{"id":"gue_iosplay","type":"String","value":"1","layerId":"guevd_layer_810"},{"id":"test_rec","type":"Int","value":"10","layerId":"test_rec"},{"id":"tp_contents","type":"String","value":"2","chainId":"_all_","layerId":"tptp_layer_627"},{"id":"ge_emoji","type":"String","value":"0","chainId":"_gene_","layerId":"getp_layer_827","key":3209},{"id":"tp_zrec","type":"String","value":"1","chainId":"_all_","layerId":"tptp_layer_619"},{"id":"gue_sharp","type":"String","value":"1","layerId":"guevd_layer_686"},{"id":"ge_usercard1","type":"String","value":"0","chainId":"_gene_","layerId":"gese_layer_742","key":2740},{"id":"li_edu_page","type":"String","value":"old","chainId":"_all_","layerId":"lili_layer_580"},{"id":"web_column_auto_invite","type":"String","value":"0","layerId":"webqa_layer_1"},{"id":"li_vip_verti_search","type":"String","value":"0","chainId":"_all_","layerId":"lili_layer_2"},{"id":"gue_card_test","type":"String","value":"1","layerId":"gueqa_layer_2"},{"id":"qap_question_visitor","type":"String","value":" 0","chainId":"_all_","layerId":"qapqa_layer_2"},{"id":"ge_newcard","type":"String","value":"3","chainId":"_gene_","layerId":"geus_layer_839","key":2997},{"id":"vdox_cmt","type":"Int","value":"0","layerId":"vdox_cmt"},{"id":"pfd_newbie","type":"Int","value":"0","chainId":"_gene_","layerId":"pfd_newbie","key":63},{"id":"web_audit_01","type":"String","value":"case1","layerId":"webre_layer_1"},{"id":"pf_noti_entry_num","type":"String","value":"2","chainId":"_all_","layerId":"pfus_layer_718"},{"id":"gue_vid_tab","type":"String","value":"7","layerId":"guevd_layer_900"},{"id":"club_fn","type":"Int","value":"1","layerId":"club_fn"},{"id":"recnew_2th","type":"Int","value":"21","chainId":"_gene_","layerId":"l-recnew_2th","key":67},{"id":"se_cvr_boost","type":"Int","value":"0","chainId":"_gene_","layerId":"se_cvr_boost","key":183},{"id":"ge_dipin_pre","type":"String","value":"0","chainId":"_gene_","layerId":"gese_layer_1000","key":3124},{"id":"office_xp","type":"Int","value":"6666","layerId":"office_xp"},{"id":"tp_dingyue_video","type":"String","value":"0","chainId":"_all_","layerId":"tptp_layer_4"},{"id":"ge_upload","type":"String","value":"0","chainId":"_gene_","layerId":"geus_layer_839","key":2892},{"id":"ge_meta_ss","type":"String","value":"1","chainId":"_gene_","layerId":"gese_layer_834","key":3079},{"id":"ge_entity","type":"String","value":"0","chainId":"_gene_","layerId":"gese_layer_946","key":3036},{"id":"hw_aa_50","type":"Int","value":"1","chainId":"_gene_","layerId":"hw_aa_50","key":362},{"id":"se_time","type":"Int","value":"0","chainId":"_gene_","layerId":"se_time","key":491},{"id":"ad_com_zhi","type":"Int","value":"0","chainId":"_gene_","layerId":"ad_com_zhi","key":571},{"id":"qap_question_author","type":"String","value":"0","chainId":"_all_","layerId":"qapqa_layer_2"},{"id":"se_4a","type":"Int","value":"0","chainId":"_gene_","layerId":"rtiq","key":335},{"id":"gue_bullet_second","type":"String","value":"1","layerId":"guevd_layer_1"}],"chains":[{"chainId":"_all_"}],"encodedParams":"ClhFAvQLxQDgCw8LQAFYAXQB1wtHAAgAUgs3DOwKtABrAWALzwtnAGkB0gEBC4gBGwBWDI0BmwsqAuQKCgKJDLQKtQs\u002FAEMAtwA0DEwLBwzcC2oB6wE7Ak8BEiwAAAIAAQEBAAAAAgEBAQACAAsAAgACAAABAAAAAAMAAAMAFQAAAAEAAQAAAA=="},"triggers":{}},"userAgent":{"Edge":false,"IE":false,"Wechat":false,"Weibo":false,"QQ":false,"MQQBrowser":false,"Qzone":false,"Mobile":false,"Android":false,"iOS":false,"isAppleDevice":false,"Zhihu":false,"ZhihuHybrid":false,"isBot":false,"Tablet":false,"UC":false,"Sogou":false,"Qihoo":false,"Baidu":false,"BaiduApp":false,"Safari":false,"GoogleBot":false,"AndroidDaily":false,"iOSDaily":false,"WxMiniProgram":false,"BaiduMiniProgram":false,"QQMiniProgram":false,"JDMiniProgram":false,"isWebView":false,"isMiniProgram":false,"origin":"Mozilla\u002F5.0 (Windows NT 10.0; Win64; x64) AppleWebKit\u002F537.36 (KHTML, like Gecko) Chrome\u002F89.0.4389.114 Safari\u002F537.36"},"appViewConfig":{},"ctx":{"path":"\u002Fquestion\u002F33058061","query":{},"href":"http:\u002F\u002Fwww.zhihu.com\u002Fquestion\u002F33058061","host":"www.zhihu.com"},"trafficSource":"production","edition":{"beijing":false,"baidu":false,"sogou":false,"baiduBeijing":false,"sogouBeijing":false,"sogouInput":false,"baiduSearch":false,"googleSearch":false,"miniProgram":false,"xiaomi":false},"theme":"light","enableShortcut":true,"referer":"https:\u002F\u002Fwww.zhihu.com\u002Fquestion\u002F33058061","xUDId":"AFDb8Tc0yRKPTjhlczFeFEN9vmUruaPySuc=","mode":"ssr","conf":{},"xTrafficFreeOrigin":"","ipInfo":{},"logged":true,"vars":{"passThroughHeaders":{}}},"me":{"columnContributions":[]},"label":{"recognizerLists":{}},"ecommerce":{},"comments":{"pagination":{},"collapsed":{},"reverse":{},"reviewing":{},"conversation":{},"parent":{}},"commentsV2":{"stickers":[],"commentWithPicPermission":{},"notificationsComments":{},"pagination":{},"collapsed":{},"reverse":{},"reviewing":{},"conversation":{},"conversationMore":{},"parent":{}},"pushNotifications":{"default":{"isFetching":false,"isDrained":false,"ids":[]},"follow":{"isFetching":false,"isDrained":false,"ids":[]},"vote_thank":{"isFetching":false,"isDrained":false,"ids":[]},"currentTab":"default","notificationsCount":{"default":0,"follow":0,"vote_thank":0}},"messages":{"data":{},"currentTab":"common","messageCount":0},"register":{"registerValidateSucceeded":null,"registerValidateErrors":{},"registerConfirmError":null,"sendDigitsError":null,"registerConfirmSucceeded":null},"login":{"loginUnregisteredError":false,"loginBindWechatError":false,"loginConfirmError":null,"sendDigitsError":null,"needSMSIdentify":false,"validateDigitsError":false,"loginConfirmSucceeded":null,"qrcodeLoginToken":"","qrcodeLoginScanStatus":0,"qrcodeLoginError":null,"qrcodeLoginReturnNewToken":false},"switches":{},"captcha":{"captchaNeeded":false,"captchaValidated":false,"captchaBase64String":null,"captchaValidationMessage":null,"loginCaptchaExpires":false},"sms":{"supportedCountries":[]},"chat":{"chats":{},"inbox":{"recents":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"strangers":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"friends":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"search":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"config":{"newCount":0,"strangerMessageSwitch":false,"strangerMessageUnread":false,"friendCount":0}},"global":{"isChatMqttExisted":false}},"emoticons":{"emoticonGroupList":[],"emoticonGroupDetail":{}},"creator":{"currentCreatorUrlToken":null,"homeData":{"recommendQuestions":[]},"tools":{"question":{"invitationCount":{"questionFolloweeCount":0,"questionTotalCount":0},"goodatTopics":[]},"customPromotion":{"itemLists":{}},"recommend":{"recommendTimes":{}}},"explore":{"academy":{"tabs":[],"article":{}}},"rights":[],"rightsStatus":{},"levelUpperLimit":10,"account":{"growthLevel":{}},"mcn":{},"applyStatus":{},"videoSupport":{},"mcnManage":{},"tasks":{},"recentlyCreated":[],"analysis":{"all":{},"answer":{},"zvideo":{},"article":{},"pin":{},"singleContent":{}},"announcement":{},"school":{"tabs":[],"contents":[],"banner":null,"entities":{}}},"question":{"followers":{},"concernedFollowers":{},"answers":{"33058061":{"isFetching":false,"isDrained":true,"ids":[55896568,55951154,55909208,126551593,55916269],"newIds":[55896568,55951154,55909208,126551593,55916269],"totals":5,"error":false,"isPrevDrained":true,"previous":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fquestions\u002F33058061\u002Fanswers?include=data%5B%2A%5D.is_normal%2Cadmin_closed_comment%2Creward_info%2Cis_collapsed%2Cannotation_action%2Cannotation_detail%2Ccollapse_reason%2Cis_sticky%2Ccollapsed_by%2Csuggest_edit%2Ccomment_count%2Ccan_comment%2Ccontent%2Ceditable_content%2Cattachment%2Cvoteup_count%2Creshipment_settings%2Ccomment_permission%2Ccreated_time%2Cupdated_time%2Creview_info%2Crelevant_info%2Cquestion%2Cexcerpt%2Cis_labeled%2Cpaid_info%2Cpaid_info_content%2Crelationship.is_authorized%2Cis_author%2Cvoting%2Cis_thanked%2Cis_nothelp%2Cis_recognized%3Bdata%5B%2A%5D.mark_infos%5B%2A%5D.url%3Bdata%5B%2A%5D.author.follower_count%2Cbadge%5B%2A%5D.topics%3Bdata%5B%2A%5D.settings.table_of_content.enabled&amp;limit=5&amp;offset=0&amp;platform=desktop&amp;sort_by=default","next":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fquestions\u002F33058061\u002Fanswers?include=data%5B%2A%5D.is_normal%2Cadmin_closed_comment%2Creward_info%2Cis_collapsed%2Cannotation_action%2Cannotation_detail%2Ccollapse_reason%2Cis_sticky%2Ccollapsed_by%2Csuggest_edit%2Ccomment_count%2Ccan_comment%2Ccontent%2Ceditable_content%2Cattachment%2Cvoteup_count%2Creshipment_settings%2Ccomment_permission%2Ccreated_time%2Cupdated_time%2Creview_info%2Crelevant_info%2Cquestion%2Cexcerpt%2Cis_labeled%2Cpaid_info%2Cpaid_info_content%2Crelationship.is_authorized%2Cis_author%2Cvoting%2Cis_thanked%2Cis_nothelp%2Cis_recognized%3Bdata%5B%2A%5D.mark_infos%5B%2A%5D.url%3Bdata%5B%2A%5D.author.follower_count%2Cbadge%5B%2A%5D.topics%3Bdata%5B%2A%5D.settings.table_of_content.enabled&amp;limit=5&amp;offset=5&amp;platform=desktop&amp;sort_by=default"}},"hiddenAnswers":{},"updatedAnswers":{},"collapsedAnswers":{},"notificationAnswers":{},"invitedQuestions":{"total":{"count":null,"isEnd":false,"isLoading":false,"questions":[]},"followees":{"count":null,"isEnd":false,"isLoading":false,"questions":[]}},"laterQuestions":{"count":null,"globalWriteAnimate":false,"isEnd":false,"isLoading":false,"questions":[]},"waitingQuestions":{"recommend":{"isEnd":false,"isLoading":false,"questions":[]},"hot":{"isEnd":false,"isLoading":false,"questions":[]},"newest":{"isEnd":false,"isLoading":false,"questions":[]},"invite":{"isEnd":false,"isLoading":false,"questions":[]}},"invitationCandidates":{},"inviters":{},"invitees":{},"similarQuestions":{},"relatedCommodities":{},"bio":{},"brand":{},"permission":{},"adverts":{},"advancedStyle":{},"commonAnswerCount":0,"hiddenAnswerCount":0,"meta":{},"bluestarRanklist":{},"relatedSearch":{},"autoInvitation":{},"simpleConcernedFollowers":{},"draftStatus":{},"disclaimers":{}},"shareTexts":{},"answers":{"voters":{},"copyrightApplicants":{},"favlists":{},"newAnswer":{},"concernedUpvoters":{},"simpleConcernedUpvoters":{},"paidContent":{},"settings":{}},"banner":{},"topic":{"bios":{},"hot":{},"newest":{},"top":{},"unanswered":{},"questions":{},"followers":{},"contributors":{},"parent":{},"children":{},"bestAnswerers":{},"wikiMeta":{},"index":{},"intro":{},"meta":{},"schema":{},"creatorWall":{},"wikiEditInfo":{},"committedWiki":{},"landingBasicData":{},"landingExcellentItems":[],"landingExcellentEditors":[],"landingCatalog":[],"landingEntries":{}},"explore":{"recommendations":{},"specials":{"entities":{},"order":[]},"roundtables":{"entities":{},"order":[]},"collections":{},"columns":{}},"articles":{"voters":{}},"favlists":{"relations":{}},"pins":{"reviewing":{}},"topstory":{"recommend":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"follow":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"room":{"meta":{},"isFetching":false,"afterId":0,"items":[],"next":null},"followWonderful":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"sidebar":null,"announcement":{},"hotListCategories":[],"hotList":[],"guestFeeds":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"followExtra":{"isNewUser":null,"isFetched":false,"followCount":0,"followers":[]},"hotDaily":{"data":[],"paging":{}},"hotHighlight":{"isFetching":false,"isDrained":false,"data":[],"paging":{}},"banner":{}},"upload":{},"video":{"data":{},"shareVideoDetail":{},"last":{}},"zvideos":{"campaigns":{},"tagoreCategory":[],"recommendations":{},"insertable":{},"recruit":{"form":{"platform":"","nickname":"","followerCount":"","domain":"","contact":""},"submited":false,"ranking":[]},"club":{},"qyActivityData":{},"batchVideos":{}},"guide":{"guide":{"isFetching":false,"isShowGuide":false}},"reward":{"answer":{},"article":{},"question":{}},"search":{"recommendSearch":[],"topSearch":{},"searchValue":{},"suggestSearch":{},"attachedInfo":{},"nextOffset":{},"topicReview":{},"generalByQuery":{},"generalByQueryInADay":{},"generalByQueryInAWeek":{},"generalByQueryInThreeMonths":{},"peopleByQuery":{},"clubentityByQuery":{},"clubPostByQuery":{},"topicByQuery":{},"zvideoByQuery":{},"columnByQuery":{},"liveByQuery":{},"albumByQuery":{},"eBookByQuery":{},"kmGeneralByQuery":{}},"publicEditPermission":{},"vessay":{"common":{"draftId":null,"source":{"type":null,"id":null},"autoSave":true,"blockUnload":true,"isCalibratingEditing":false,"editingTrackData":{"editingOutlines":[],"editingVideos":[]},"newAddMaterialData":{},"audioCache":{}},"loading":{"isLoading":false,"text":"正在加载中"},"player":{"currentTime":0,"totalTime":0,"playing":false},"library":{"material":{},"materialSearchResult":{},"music":{},"musicLibraryCategories":[],"musicUrls":{}},"track":{"trackData":{"dataVersion":1,"videoTrack":[],"audioTrack":[],"musicTrack":[],"voiceOverData":{}},"previewEditingTrackData":{"editingSubtitleItem":{},"editingVideoItem":{}},"selectedTrackItems":[],"outlineRemoveMaterial":{}}},"readStatus":{},"draftHistory":{"history":{},"drafts":{}},"notifications":{"recent":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"history":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"notificationActors":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"recentNotificationEntry":"all"},"specials":{"entities":{},"all":{"data":[],"paging":{},"isLoading":false}},"collections":{"hot":{"data":[],"paging":{},"isLoading":false},"collectionFeeds":{}},"userProfit":{"permission":{"permissionStatus":{"zhiZixuan":0,"recommend":-1,"task":0,"plugin":0,"infinity":0},"visible":false}},"mcn":{"bindInfo":{},"memberCategoryList":[],"producerList":[],"categoryList":[],"lists":{},"banners":{},"protocolStatus":{"isAgreedNew":true,"isAgreedOld":true},"probationCountdownDays":0},"mcnActivity":{"household":{"products":{},"rankList":{"total":{},"yesterday":{}}}},"brand":{"contentPlugin":{}},"host":{"roundtable":{"subjects":{},"applications":{"total":0},"online":{"total":0},"applies":{},"details":{},"includedResource":{},"hotQuestions":{},"warmupContents":{},"batchInclude":{}},"special":{"applications":{"total":0,"pages":{},"entities":{}},"censorHistory":{},"drafts":{}}},"campaign":{"single":{},"list":{},"videoMakerAcq":{},"vote":{},"cardCollecting":{"message":null,"profile":{"balance":"0","chance":0,"coinNum":0,"gatherClose":false,"isGotMagicCard":false,"isPay":false,"partitionStart":false,"totalDone":0,"withdrawStart":false},"sharePoster":{"share":"","sendCard":"","invite":""},"shareLink":null,"shareIntention":"share","shareKey":null,"shareCardId":null,"inviterInfo":null,"giverInfo":null,"prize":null,"receivedCard":null,"newCoinCount":null,"newCardList":[],"newUserCardCount":1,"taskList":[],"prizeList":null,"cardList":null,"panel":{"showTaskPanel":false,"showRewardPanel":false},"modal":{"showWelcomeModal":false,"showFusionModal":false,"showFusionPromptModal":false,"showShareModal":false,"showBackModal":false}},"zhiboPandian2020":null,"boarding":{}},"knowledgePlan":{"lists":{},"allCreationRankList":{},"featuredQuestions":{}},"wallE":{"protectHistory":{"total":0,"pages":{},"entities":{}}},"roundtables":{"hotQuestions":{},"warmupContents":{},"hotDiscussions":{},"selectedContents":{},"roundtables":{}},"helpCenter":{"entities":{"question":{},"category":{}},"categories":[],"commonQuestions":[],"relatedQuestions":{}},"republish":{},"commercialReport":{"commercialTypes":[]},"creatorMCN":{"mcn":{},"mcnStatistics":{},"isNoAuth":false,"creatorManageData":[],"creatorManageDataTotal":1,"mcnDomains":[]},"commentManage":{"commentList":{"ids":[],"entities":{},"nextOffset":0,"urlToken":""},"subCommentList":{"ids":[],"entities":{},"paging":{"next":"","isEnd":false}}}},"subAppName":"main"}</script><script crossorigin="" src="https://static.zhihu.com/heifetz/vendor.bfefaa5cfee5584ea98c.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/main.app.9c0b01692aa725eeada0.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/main.question-routes.b3e7b62cc1c15ebb2e13.js"></script><script crossorigin="" src="https://hm.baidu.com/hm.js?98beee57fd2ef70ccdd5ca52b9740c49" async=""></script><script crossorigin="" src="https://unpkg.zhimg.com/za-js-sdk@2.28.0/dist/zap.js"></script><script crossorigin="" src="https://zz.bdstatic.com/linksubmit/push.js"></script><div><div style="display: none;">想来知乎工作？请发送邮件到 jobs@zhihu.com</div></div><div><div><div class="css-8pdeid"></div></div></div></body></html>