<!DOCTYPE HTML>


<html lang="en">
<head>

	

	
	<link rel="preconnect" href="https://apps.developermedia.com">
	<link rel="preconnect" href="https://cdn1.developermedia.com">
	<link rel="preconnect" href="https://cdn.ampproject.org">
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://ajax.googleapis.com">
	<link rel="preconnect" href="https://adservice.google.com">
	<link rel="preconnect" href="https://www.googletagservices.com">
	<link rel="preconnect" href="https://www.googletagmanager.com">
	<link rel="preconnect" href="https://www.google.com">
	<link rel="preconnect" href="https://www.google-analytics.com">
	<link rel="preconnect" href="https://pagead2.googlesyndication.com">

	<link rel="preconnect" href="https://www.codeproject.com">

	<title>Listing Used Files - CodeProject</title> 
    
	<link type="text/css" rel="stylesheet" href="https://www.codeproject.com/App_Themes/CodeProject/Css/Main.min.css?dt=2.8.20201130.1">


    <script type="text/javascript" src="https://www.codeproject.com/script/JS/jquery-2.2.4.min.js" defer ></script>
<script type="text/javascript" src="https://www.codeproject.com/script/Articles/JS/article.min.js?dt=2.8.20201130.1" defer ></script>
<script type="text/javascript" src="/script/Membership/JS/MemberProfilePopup.min.js?v=1.4" defer ></script>
<script type="text/javascript" src="/a.min.js?v=1.3" defer ></script>

	
<meta http-equiv="content-language" content="en-US">
<meta charset="UTF-8">
<meta name="Description" content="A ShellExtension that lists all the used files in a folder.">
<meta name="Keywords" content="VC6, C++, Windows, Dev, Intermediate,Shell and IE programming,Desktop Development,Free source code, tutorials">
<meta name="Author" content="&lt;font color=&quot;0xFF000000&quot;&gt;N&lt;/font&gt;aveen">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">

<link rel="dns-prefetch" href="//ajax.googleapis.com"> 
<link rel="canonical" href="/Articles/18975/Listing-Used-Files" />
<meta name="twitter: card" content="summary" />
<meta name="twitter: site" content="@CodeProject" />
<meta property="og:url" content="https://www.codeproject.com/Articles/18975/Listing-Used-Files" />
<meta property="og:title" content="Listing Used Files" />
<meta property="og:description" content="A ShellExtension that lists all the used files in a folder." />
<meta property="og:image" content="https://www.codeproject.com/KB/shell/OpenedFileFinder/Thumb-18975.jpg" />

<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All Topics" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=1" />
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Artificial Intelligence" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=31" />
<link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="https://www.codeproject.com/webservices/LoungeRSS.aspx" />
<meta name="robots" content="index, follow" />
<link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="https://www.codeproject.com/info/OpenSearch.xml">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="144x144" href="/favicon/apple-touch-icon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"> 
<link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"> 
<link rel="manifest" href="/favicon/manifest.json"> 
<link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#ff9900">
	<script type='application/ld+json'>{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codeproject.com/Articles/18975/Listing-Used-Files"
   },
  "name": "Listing Used Files",
  "headline": "Listing Used Files",
  "url": "https://www.codeproject.com/Articles/18975/Listing-Used-Files",
  "discussionUrl": "https://www.codeproject.com/Articles/18975/Listing-Used-Files#_comments",
  "isFamilyFriendly": "true",
  "image": "https://www.codeproject.com/KB/shell/OpenedFileFinder/Thumb-18975.jpg",
  "keywords": "VC6,C++,Windows,Dev,Intermediate",
  "commentCount": "218",
  "editor" : {
    "@type" : "Person",
    "name" : "Smitha Nishant",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=28970"
  },
  "license": "http://www.codeproject.com/info/cpol10.aspx",
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  },
  "description": "A ShellExtension that lists all the used files in a folder.",
  "articleSection": "Shell and IE programming",
  "author" : [{
      "@type" : "Person",
      "name" : "Naveen",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=1599046"
    }],
  "datePublished": "2007-05-28",
  "dateCreated": "2007-05-28",
  "dateModified": "2010-09-29"
,
  "aggregateRating" : {
    "@type" : "AggregateRating",
    "ratingValue" : 4.81,
    "ratingCount" : 94,
    "bestRating" : 5,
    "worstRating" : 1
  }
}</script>

<script type='application/ld+json'>{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/Chapters/1/Desktop-Development",
      "name" : "Desktop Development"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/KB/shell/",
      "name" : "Shell and IE programming"
    }
  }]
}</script>


	<base target="_top" />
	
    


<script type='text/javascript'>
function defrm () { /* thanks twitter */
    document.write = '';
    window.top.location = window.self.location;
    setTimeout(function() { document.body.innerHTML = ''; }, 0);
    window.self.onload = function(evt) { document.body.innerHTML = ''; };
}

if (window.top !== window.self) {
    try {
        if (window.top.location.host) { /* will throw for all except chrome */ }
        else { defrm(); /* chrome */ }
    } catch (ex) { defrm(); /* everyone else */ }
}

// Specific case where a site is screwing with us.
if (typeof(DemoUrl) !== 'undefined') {
    document.write(unescape('%3Cme') + 'ta http' + '-equiv="re' + 'fresh con' +
                           'tent="1;url=' + DemoUrl + unescape('"%3CE'));
}
</script>
	





<!-- Global site tag (gtag.js) - Google Analytics -->
    <script async type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=UA-1735123-1"></script>
    <script type="text/javascript">
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-1735123-1' );
    </script>


</head>	

<body class="python-urllib python-urllib3">

<a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="https://www.codeproject.com/images/t.gif" /></a>




<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed">
        <div class="main-content">
            

<div class="container memberbar clearfix flex-container flex-extend">

	<div id="ctl00_MemberBar_GenInfo" class="flex-item align-left">14,701,138 members</div>

	<div class="flex-item">
		
	</div>

	<div class="flex-item align-right">

		

		

		

			<script type="text/javascript">//<!--
			function doSubmit(secure)
			{
				if (secure)
					document.signinForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f18975%2fListing-Used-Files"
				else
					document.signinForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f18975%2fListing-Used-Files"
				document.signinForm.submit();
				return true;
			}//-->
			</script>

			<a name="SignUp"></a>
			<span class="member-signin tooltip openable">
				<span><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f18975%2fListing-Used-Files">Sign in</a>
                    <img src="https://www.codeproject.com/App_Themes/CodeProject/Img/login32.png"
                        width="16px" height="16px" style="vertical-align:middle;"/>
				</span>

				<div class="tooltip-flyout">
					<form name="signinForm" id="signinForm" action="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f18975%2fListing-Used-Files" method="post"
						class="tight">

						
						<input id="FormName" name="FormName" value="MenuBarForm" type="hidden" />

						<div>Email</div>
						<div><input class="small-text" type="email" name="Email" id="Email" autocomplete="email" /></div>
						<div>Password</div>
						<div><input class="small-text" type="password" name="Password" id="Password" 
							autocomplete="current-password" /></div>
						<div class="action">
                            <input id='joinBtn' type='button' class='create hidden' onclick='return Join();' value='Join' />
                            <input type='hidden' name='fld_quicksign' value='true' />
							<input type="submit" value="Sign in" class="signin" onclick="return doSubmit(false);" />
						</div>

						<div class="container">
							
							&nbsp;
							<a id="ctl00_MemberBar_SendPassword" class="forgot float-right" href="/script/Membership/SendPassword.aspx?rp=/Articles/18975/Listing-Used-Files">Forgot your password?</a>
						</div>
					</form>

					<hr class="divider-dark" />

					Sign in with <a class="oauth" alt="Sign in using Github" title="Sign in using Github" href="/script/Membership/OAuthLogOn.aspx?auth=GitHub"><img src="/script/Membership/Images/octicons_github.png" style="vertical-align:middle;padding-right:3px;border:0;" /></a>
<a class="oauth" alt="Sign in using Facebook" title="Sign in using Facebook" href="/script/Membership/OAuthLogOn.aspx?auth=Facebook"><img src="/script/Membership/Images/facebook.png" style="vertical-align:middle;padding-right:3px;border:0;" /></a>
<a class="oauth" alt="Sign in using Google" title="Sign in using Google" href="/script/Membership/OAuthLogOn.aspx?auth=Google"><img src="/script/Membership/Images/google-plus.png" style="vertical-align:middle;padding-right:3px;border:0;" /></a>
<a class="oauth" alt="Sign in using Microsoft" title="Sign in using Microsoft" href="/script/Membership/OAuthLogOn.aspx?auth=Microsoft"><img src="/script/Membership/Images/microsoft.png" style="vertical-align:middle;padding-right:3px;border:0;" /></a>

				</div>
            </span>
		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed">
        <div class="main-content">
            <div class="logo"><a href="/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="https://www.codeproject.com/App_Themes/CodeProject/Img/logo250x135.gif" alt="Home" height="135" width="250" border="0" /></a></div>
            <div class="promo"><div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Desktop-Development/Shell-and-IE-programming/General"  data-country='US' data-tags='VC6, C++, Windows, Dev, Intermediate,rating4.5'><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Desktop-Development/Shell-and-IE-programming/General&sz=728x90&c=112028"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Desktop-Development/Shell-and-IE-programming/General&sz=728x90&c=112028"  width="728px" height="90px" target="_blank"/></a></noscript></div></div>
        </div>
    </div>

	
	<div id="ctl00_TPR" class="sub-headerbar clearfix fixed">
    <div class="float-right">
		

<div class="searchbar">

<form method="get" action="/search.aspx?sbo=kw" name="Search" class="tight">


<table border="0" cellspacing="0" cellpadding="0" class="search"><tr><td><input TabIndex="2" class="search " id="sb_tb" autocomplete="off" value="" name="q" /></td><td><input type="image" src="https://www.codeproject.com/images/search.gif" /></td></tr></table>

<div class="hover-container">
	<div id="SearchFilter" class="search-advanced popup small-text align-left">
	<b>Search within:<br /></b>
		
		<input type="radio" id="sb_kw" name="sbo" value="kw" checked="checked"><label for="sb_kw">Articles</label><br>
<input type="radio" id="sb_qa" name="sbo" value="qa"><label for="sb_qa">Quick Answers</label><br>
<input type="radio" id="sb_fm" name="sbo" value="fm"><label for="sb_fm">Messages</label><br>


		
		

		
		
	</div>
</div>
</form>

</div>
    </div>
    <div class="float-left">
		

<div class="navbar clearfix">
<ul class="navmenu openable">

<li class="desktop-only"><a id="ctl00_TopNavBar_Home" href="https://www.codeproject.com">home</a>


<li class="openable"><a id="ctl00_TopNavBar_Art" class="down selected" href="/script/Articles/Latest.aspx">articles</a>

	<ul>
		<li class="openable"><a id="ctl00_TopNavBar_ArtTopicList" class="fly" onmouseover="navBarMenu.ShowMap(this, &#39;ctl00_TopNavBar_MapFlyout&#39;);" href="/script/Content/SiteMap.aspx">Chapters and Sections<span class="has-submenu">&gt;</span></a><ul id="ctl00_TopNavBar_MapFlyout" class="taxonomy">
			<li>
				<div id="siteMap"></div>
			</li>
			</ul>
		</li>
		<li><a id="ctl00_TopNavBar_ArtLatestArts" class="fly" href="/script/Articles/Latest.aspx">Latest Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtTop" class="fly" href="/script/Articles/TopArticles.aspx?ta_so=5">Top Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtGuide" class="fly" href="/info/Submit.aspx">Posting/Update Guidelines</a></li>
		<li><a id="ctl00_TopNavBar_ArtHelpForum" class="fly" href="/Forums/1641/Article-Writing">Article Help Forum</a></li>
		<li><a id="ctl00_TopNavBar_ArtPostArticle" class="fly highlight1" href="/script/Articles/Submit.aspx">
			<img src="https://www.codeproject.com/images/write13.png" width="13" height="13" /> Submit an article or tip
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtImportGitHub" class="fly highlight3" href="/script/Articles/ImportArticle.aspx">
			<img src="https://www.codeproject.com/images/write13.png" width="13" height="13" /> Import GitHub Project
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtPostBlog" class="fly highlight2" href="/script/Articles/BlogFeed.aspx">
			<img src="https://www.codeproject.com/images/write13.png" width="13" height="13" /> Import your Blog
			</a></li>		
        
        <li class="last"></li>
	</ul>

</li>



<li class="openable">
<a id="ctl00_TopNavBar_Answers" href="/script/Answers/List.aspx?tab=active">
    <span class="desktop-only tablet-only">quick answers</span><span class="mobile-only">Q&amp;A</span>
</a>
	<ul>
		<li id="ctl00_TopNavBar_AQL"><a id="ctl00_TopNavBar_ArticleQuestion" class="fly highlight1" href="#_comments">
			<img src="https://www.codeproject.com/images/write13.png" width="13" height="13" /> Ask a Question about this 
			article</a>
		</li>

		<li><a id="ctl00_TopNavBar_QAAsk" class="fly highlight2" href="/Questions/ask.aspx"><img 
			src="https://www.codeproject.com/images/write13.png" width="13" height="13" /> Ask a Question</a></li>

		<li><a id="ctl00_TopNavBar_QAUnanswered" class="fly" href="/script/Answers/List.aspx?tab=unanswered">View Unanswered Questions</a></li>
		<li><a id="ctl00_TopNavBar_QALatest" class="fly" href="/script/Answers/List.aspx?tab=active">View All Questions</a></li>
        
				<li><a id="ctl00_TopNavBar_QATR_ctl00_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=81" style="padding-left:30px">View C# questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl01_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=842" style="padding-left:30px">View VB.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl02_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=93" style="padding-left:30px">View SQL questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl03_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=78" style="padding-left:30px">View C++ questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl04_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=87" style="padding-left:30px">View Javascript questions</a></li>
			
    
		<li class="last"></li>
	</ul>

</li>



<li class="openable"><a id="ctl00_TopNavBar_Forums" href="/script/Forums/List.aspx">
        <span class="desktop-only tablet-only">discussions</span><span class="mobile-only">forums</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_MessageBoardsAll" class="fly" href="/script/Forums/List.aspx">All Message Boards...</a></li>
		<li class="openable"><a class="fly" style="padding-left:30px" href="/Forums/1580997/Application-Lifecycle">Application Lifecycle<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="/Forums/1533717/Running-a-Business">Running a Business</a></li>
<li><a class="fly" href="/Forums/1533716/Sales-Marketing">Sales / Marketing</a></li>
<li><a class="fly" href="/Forums/1651/Collaboration-Beta-Testing">Collaboration / Beta Testing</a></li>
<li><a class="fly" href="/Forums/3304/Work-Issues">Work  Issues</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="/Forums/369270/Design-and-Architecture">Design and Architecture</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/12076/ASP-NET">ASP.NET</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1580226/JavaScript">JavaScript</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="/Forums/1647/C-Cplusplus-MFC">C / C++ / MFC<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="/Forums/4486/ATL-WTL-STL">ATL /  WTL / STL</a></li>
<li><a class="fly" href="/Forums/3785/Managed-Cplusplus-CLI">Managed C++/CLI</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1649/Csharp">C#</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1627782/Free-Tools">Free Tools</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1827460/Objective-C-and-Swift">Objective-C and Swift</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1725/Database">Database</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="/Forums/186301/Hardware-Devices">Hardware &amp; Devices<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="/Forums/1644/System-Admin">System Admin</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1606152/Hosting-and-Servers">Hosting and Servers</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1643/Java">Java</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1942421/Linux-Programming">Linux Programming</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1650/NET-Core-and-Framework">.NET (Core and Framework)</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1848626/Android">Android</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1876716/iOS">iOS</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/13695/Mobile">Mobile</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1540733/SharePoint">SharePoint</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1004257/Silverlight-WPF">Silverlight / WPF</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1646/Visual-Basic">Visual Basic</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1640/Web-Development">Web Development</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/suggestions.aspx">Site Bugs / Suggestions</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1652005/Spam-and-Abuse-Watch">Spam and Abuse Watch</a>
</li>

		<li class="last"></li>
	</ul>

</li>

<li class="openable"><a id="ctl00_TopNavBar_Features" href="/Feature/">
      <span class="desktop-only tablet-only">features</span><span class="mobile-only">stuff</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_Comps" class="fly" href="/script/Contests/CurrentCompetitions.aspx?cmpTpId=3&amp;amp;awsac=true">Competitions</a></li>
        
		<li><a id="ctl00_TopNavBar_Conferences" class="fly" href="/script/Conferences/List.aspx">Conferences</a></li>
		
		<li><a id="ctl00_TopNavBar_News" class="fly" href="/script/News/List.aspx">News</a></li>
		<li><a id="ctl00_TopNavBar_Insider" class="fly" href="/Feature/Insider/">The Insider Newsletter</a></li>
    	<li><a id="ctl00_TopNavBar_DailyBuild" class="fly" href="/Feature/DailyBuild">The Daily Build Newsletter</a></li>
		<li><a id="ctl00_TopNavBar_Newsletters" class="fly" href="/script/Mailouts/Archive.aspx?mtpid=1">Newsletter archive</a></li>
		<li><a id="ctl00_TopNavBar_Surveys" class="fly" href="/script/Surveys/List.aspx">Surveys</a></li>
		<li><a id="ctl00_TopNavBar_Showcase" class="fly" href="/KB/showcase/">Product Showcase</a></li>
        
		<li><a id="ctl00_TopNavBar_Stuff" class="fly" href="/Info/Stuff.aspx">CodeProject Stuff</a></li>
		<li class="last"></li>
	</ul>

</li>


<li  class="openable"><a id="ctl00_TopNavBar_Lounge" href="/Lounge.aspx">
            <span class="desktop-only tablet-only">community</span><span class="mobile-only">lounge</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_WhosWho" class="fly" href="/script/Membership/Profiles.aspx">Who's Who</a></li>
		<li><a id="ctl00_TopNavBar_MVPs" class="fly break" href="/script/Contests/Winners.aspx?obtid=1&amp;amp;cmpTpId=2&amp;amp;cid=0">Most Valuable Professionals</a></li>

		<li><a id="ctl00_TopNavBar_LoungeLnk" class="fly highlight2" href="/Lounge.aspx">The Lounge  </a></li>
		<li><a id="ctl00_TopNavBar_WhereAmILink" class="fly" href="/Forums/1939564/Where-I-am-Member-Photos">Where I Am: Member Photos</a></li>
		<li><a id="ctl00_TopNavBar_InsiderLnk" class="fly" href="/Insider.aspx">The Insider News</a></li>
		<li><a id="ctl00_TopNavBar_WeirdWonderful" class="fly" href="/Feature/WeirdAndWonderful.aspx">The Weird & The Wonderful</a></li>

		<li class="last"></li>
	</ul>

</li>


<li class="openable" style="margin-left:20px"><a id="ctl00_TopNavBar_Help" href="/KB/FAQs/">
    <span class="desktop-only tablet-only">help</span><span class="mobile-only">?</span>
</a>


	<ul>
		<li><a id="ctl00_TopNavBar_HelpWhatIs" class="fly" href="/info/guide.aspx">What is 'CodeProject'?</a></li>
		<li><a id="ctl00_TopNavBar_HelpGeneral" class="fly break" href="/KB/FAQs/">General FAQ</a></li>
		<li><a id="ctl00_TopNavBar_HelpPostQuestion" class="fly break highlight2" href="/Questions/ask.aspx">Ask a Question</a></li>
		<li><a id="ctl00_TopNavBar_HelpBugs" class="fly" href="/suggestions.aspx">Bugs and Suggestions</a></li>
		<li><a id="ctl00_TopNavBar_HelpArticles" class="fly" href="/Forums/1641/Article-Writing">Article Help Forum</a></li>
		
		
		
		
		<li><a id="ctl00_TopNavBar_HelpAboutUs" class="fly" href="/info/about.aspx">About Us</a></li>
		<li class="last"></li>
	</ul>

</li>

</ul>

</div>
    </div>
	<div class="sub-headerbar-divider"></div>
	</div>		
	

	<div id="A" class="container-content-wrap fixed"> 

	<div class="container-content">

        
		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div>Articles &#187; Desktop Development &#187; Shell and IE programming &#187; General</div>
			</div>

            <div class="float-left">
				
			</div>

			<div class="edit-links float-right">
				



 
&nbsp;










			</div>

			<div class="article-nav float-right">
				


<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    
</div>



 

<a id="ctl00_ActionLinks_PrintMd" data-tooltip="Print" data-enabletooltip="true" data-width="auto" href="/Articles/18975/Listing-Used-Files?display=Print">
   <img src="/App_Themes/CodeProject/Img/print48.png" 
	    width="24px" height="24px" style="border:0">
</a>



<span id="ctl00_ActionLinks_R">
    
    
</span>
			</div>
		</div>

        
		<div class="extended article-container-parts">

			
		    <div id="ctl00_LeftSideBar" class="article-left-sidebar">

                <div id="ctl00_StickyBlock" class="article-left-sidebar-inner">
                    
    		        

<div class="tabs">
	<div class=" selected">Article</div>
<div><a href="/script/Articles/Statistics.aspx?aid=18975">View Stats</a></div>
<div><a href="/script/Articles/ListVersions.aspx?aid=18975">Revisions (2)</a></div>
<div><a href="#_comments">Comments (218)</a></div>
<div>Posted 28 May 2007</div>


    
</div>



			        

			        <div>
                        <h4 id="ctl00_TaggedAsWrapper">Tagged as</h4>
			            <span id="ctl00_TagList_TagWrp" class="tags vertical">

	
	

	
	<span id="ctl00_TagList_VisibleTags"><div class="t"><a rel="tag" href="/Tags/VC6" data-id="4">VC6</a></div><div class="t"><a rel="tag" href="/Tags/Cplusplus" data-id="78">C++</a></div><div class="t"><a rel="tag" href="/Tags/Windows" data-id="94">Windows</a></div></span> 

	
	
</span>


			        </div>

                    <div id="ctl00_VerticalStatsWrapper" class="stats">
                    <h4>Stats</h4>
                    <div id="ctl00_VerticalStats"><div class="stats"><div>531.4K views</div><div>21.1K downloads</div><div>222 bookmarked</div></div></div>
                    </div>

                    
                </div>
		    </div>
            

			
			<div id="AT" class="article-container  fixed"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="./View.aspx" id="aspnetForm" style="margin:0;padding:0">
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="g+NcQZooP/p3gIs9puOVmrQXThU268RMJHDtD2o8JknXJwfIjMj1MSt8XOGeO3340GLv3ShdAK9JUVKOra74Z5ERTd9pt7zki9lUt1xtxZoTxCkuSyJc3PHL+gypg0SzwB8s1EeghdDOPDS8j7gzCFI0TAQ4Jq9r2uEFJr2Nio30F17F5OYE6gsxripZolF6TgXjBXFGV33IYMTmc4KpqsN0o33CuJux7f8SdM4jWFiSGvWdo6I7dGYNCbFGPnPwFA/Yb9O023Jp6Ti9ksHeqnZayY9mqdX0uQ82VQiKbry2/c//yagC1ir6p7T63oCdm68ltqDfoky+HOVwzT185KqgvooTTCmjTjh7rMJQ76iFhPI0nWWLW/PKQDH32jXpFQlo+LZl/0mvwuQD81Z266HmpBydwLMt6aYtHUmLtqrnbWX+whs1XGyykcU6cWUzjfY2Gb8vQKxQem7pIq0AADkuiyuk9rV7E/WnpkT8r+jStkKZDdX+pycU885Jk6SSDEIXi8NcEYdvwKDrolV/qvzLZ4aJXrf6FsCigdMPnedoaQgxjBSriRVxD1aAvMvVUyclNkGlnO/TmHc9jSyTWNlM6W2xihiC+5W/6p8dV5E6KNhzYrW3WX1GufW62lyCguVNOwrFXTyQvYK7v1ED/5SG/SfQkC6XfvAqpBoLnNmIOjmdAw9NUWv5MCSokYwZeF5Xax23mV9BzXR+4wl0MwsM+WvHTaHyeR6vSe9XftDj6NzIcRp1wlR/FPa+CwocyJBcsWEmYHrWJXwkF9szYS49juKJ7VIYiKPs5SeELSiPvvRg5pFkKXXpeV3eYRP0YtgB8h6EiPsy+L4g0Ww8jOYZOQmlSUQfC9u2Gwmk1alhzGK3X9zxdhrY/oigRVNhQ59niA/60swk0nSz20ahrNnZAPfKLXJQOinsxIgDAKZjgMtfM8coky/P0iGfdd7wCmIfM5zj7cKVWYDFtEr8MN9tcFQRiqE5IlBTduyOeIeOsIu6hoc4S23u6kOAJwfEyIRvY1/+IkZYr0nEhad57LJmfbHIVEtpqk57McrMSenSZ5kQKqVusGn3TBhF//cE9KrUBc+6VoapVLadaKoWv8iGUKHxLqgrd89hOZ7Vhj7MnZCXOZ/YnTpqeluXg36TK3M0FL64t+m7GicJLibuO6yYrNnE9SFwFYW6UID9a5JOGy7ZR2g0EtQ0hHaToD8U1Jagh60hVAm+AtJh02BWimaL4BdrWBwyqPxVE2O/eLCBKC3YkByTsqBdDBf+sg2K22uyF23sfPMJKHw9JCPdpY5Y9lt3Ol+4BWI9m4Em71Fc6sy4i9oLOmdTU2TAmM7qvPEMYjXHA1QPhl0P3IfMvF8uCardbGwtdQ2eoZAD9LaGXautnulQxIK2D6JhQPp9LiFAdVayvu1tkqRwHB+K/FZ5/eYGAlPc5Ivgb+eM+xcgU9BS89wBOfsPDHlHNVKm7nhrvRS8WIumNphq9Sh8HguADFTSm94Nj8WtD8FBId7pHszDg7sTsNpFs5+yH1By9+sTZEZ2d7Ccni5fYyeOVhFitqdzsl94IrheKoC195Ya1/MnYEFzV2Edn/VZzPo4UZmSVBuwlMDO86zFBQWXmyHo9taUuW68QKcdMvTgnZRmQ2vkB8x1O4be405NxTwsIezSQ+26/moGckRetjonInavMx0=" />

<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69" />

					
					 
					<div class="header">
					    <a name="Main"></a>

					    
					    <a name="_articleTop" id="_articleTop"></a>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">Listing Used Files</h1>
					    </div>

                        <div>
					        
					        <div class="entry flex-container">

                                <img src="https://www.codeproject.com/script/Membership/ProfileImages/{D5771DE2-6D71-4D51-8ECC-532B2EA5068D}.jpg" id="ctl00_avatar" class="avatar" />

                                <div class="flex-item" style="flex:1 1 auto">
                                    <div class="flex-container" style="justify-content:space-between;flex-wrap:wrap-reverse">
                                       <span id="ctl00_Authors" class="author flex-item"><a href="/script/Membership/View.aspx?mid=1599046" rel="author"><font color="0xFF000000">N</font>aveen</a></span> 

                                        <div class="flex-item" style="margin-top:-4px;">
                                            <div id="ctl00_RateArticle_RatingTable" class="small-text" data-objectref="2_18975_2">

	<meta itemprop="upvoteCount" content="93">


	<div id="ctl00_RateArticle_RatingRow" class="flex-container rating-container large-stars">

					
		<div id="ctl00_RateArticle_Prompt" class="rating-prompt nowrap">Rate me:</a></div>

		
		<div class="nowrap tooltip">

			
			
			

			
			<div id="ctl00_RateArticle_RatingHistWrap" class="tooltip">

				
				<div id="ctl00_RateArticle_ResultWithHist" class="rating-result"><div class="flex-container rating-stars large-stars"><div><img src='https://codeproject.freetls.fastly.net/script/Ratings/Images/star-fill-lg.png' style='width:24px;height:24px'></div><div><img src='https://codeproject.freetls.fastly.net/script/Ratings/Images/star-fill-lg.png' style='width:24px;height:24px'></div><div><img src='https://codeproject.freetls.fastly.net/script/Ratings/Images/star-fill-lg.png' style='width:24px;height:24px'></div><div><img src='https://codeproject.freetls.fastly.net/script/Ratings/Images/star-fill-lg.png' style='width:24px;height:24px'></div><div style='width:19px;' class='clipped'><img src='https://codeproject.freetls.fastly.net/script/Ratings/Images/star-fill-lg.png' style='width:24px;height:24px'></div><div style='width:5px;position:relative' class='clipped'><img src='https://codeproject.freetls.fastly.net/script/Ratings/Images/star-empty-lg.png' style='width:24px;height:24px;position:absolute;top:0px;right:0'></div></div></div>
				

				<div class="speech-bubble-container-up-right" style="width:170px">
					<div class="speech-bubble-up-right">
						<div class="histogram"></div>
					</div>
					<div class="speech-bubble-pointer-up-right">
						<div class="speech-bubble-pointer-up-right-inner"></div>
					</div>
				</div>
			</div>

			
            

			
            <span id="ctl00_RateArticle_RatingSignin" class="speech-bubble-container-down">
		        <div class="speech-bubble-down">
                    Please <a id="ctl00_RateArticle_SignUp" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f18975%2fListing-Used-Files">Sign up or sign in</a> 
                    to vote.
		        </div>
		        <div class="speech-bubble-pointer-down">
			        <div class="speech-bubble-pointer-down-inner"></div>
		        </div>
	        </span>    

		</div>
		
	
		
		<div id="ctl00_RateArticle_VoteCountNoHist" class="rating-votes nowrap">4.81/5  (94 votes)</div>	

		

		
		<div class="rating-undo" title="Undo vote" style="margin-left:5px;display:none"></div>

		
		
	</div>

	
	

</div>

                                        </div>
                                    </div>

                                    <div  class="flex-container">
                                        <span id="ctl00_LastUpdated" class="date flex-item-tight" title="Date last updated">29 Sep 2010</span><a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license flex-item-tight" title="Licence" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a>
                                    </div>
                                </div>
					        </div>

                            

                        </div>

                        <div id="ctl00_DescriptionSpot" class="summary">A ShellExtension that lists all the used files in a folder.</div><span id="ctl00_ThumbnailUrl" class="date" content="https://www.codeproject.com/KB/shell/OpenedFileFinder/Thumb-18975.jpg"></span>			

                    </div>
                    
					
					

					

					
					

					
					
					
					

						
					

					

						
						<div id="contentdiv" class="text">
						



<html><head></head><body><ul class="download">
<li><a href="/KB/shell/OpenedFileFinder/OpenedFileFinder_Binary32.zip">Download 32 bit project demo - 305 KB</a></li><li><a href="/KB/shell/OpenedFileFinder/OpenedFileFinder_Binary64.zip">Download 64 bit project demo - 342 KB</a></li><li><a href="/KB/shell/OpenedFileFinder/OpenedFileFinder_src_vc6.zip">Download VC 6 source - 141 KB</a></li><li><a href="/KB/shell/OpenedFileFinder/OpenFileFinder_src_vc8.zip">Download VC 8 source - 306 KB</a></li></ul>

<p class="small-text">[The VC6 version of source code is kept just for reference in case if any one is still using VC6. Also, it does not include any modifications done after <strong>June-06-2008</strong> mentioned in the Revision History section.]</p>

<p><img width="606" height="269" alt="Screenshot - Application.jpg" src="/KB/shell/OpenedFileFinder/Application.jpg" class="lazyload" data-sizes="auto" data-srcset="/KB/shell/OpenedFileFinder/Application-r-400.jpg 400w, /KB/shell/OpenedFileFinder/Application.jpg 606w"></p>

<h2>Introduction</h2>

<p>This is a utility to display all the files that are opened under a specific folder.</p>

<h2>Background</h2>

<p>It often happens to me that when I try to rename or delete my current working folder of a project, it gives an error message like "Cannot rename BlaBlaBla: It is being used by another person or program". Almost at all times, I fail to find this other program/person, and end up restarting the machine. Since then, I have been searching for a method to find the list of files that an application uses. Even though the <code>ProcessExplorer</code> of <a href="http://www.microsoft.com/technet/sysinternals/ProcessesAndThreads/ProcessExplorer.mspx">SysInternals</a> lists the files opened by each process, it is hard to find opened files in a particular folder. So I created one that does this, purely because of my necessity.</p>

<h2>Using the Code</h2>

<p>Download the application and register it using RegSvr32 (<em>RegSvr32 OpenedFiles.dll)</em>. This application basically contains two components: an extension DLL and a driver. The extension DLL is responsible for showing the context menu in the shell and the GUI you see. I will explain the role of the driver later in this article.</p>

<p>This application will install a menu on folders, the background of a folder, and on a drive. I suggest you read <a href="/KB/shell/shellextguide1.aspx">The Complete Idiot's Guide to Writing Shell Extensions - Part I</a>, article by Michael Dunn, if you are new to shell extensions. In fact, it was from there that I learned to write shell extensions.</p>

<p><img width="365" height="305" alt="Screenshot - context_menu.jpg" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="/KB/shell/OpenedFileFinder/context_menu.jpg" class="lazyload"></p>

<h3>Enumerating Opened Files</h3>

<p>When you click on the "List Opened Files" menu, it will first enumerate all of the opened files in the system. This is implemented in the following function:</p>

<pre lang="C++" data-lang-orig="C++"><span class="code-keyword">void</span> EnumerateOpenedFiles( CString&amp; csPath, OF_CALLBACL CallBackProc, UINT_PTR pUserContext, 
                           HANDLE hDriver, 
                           GetFinalPathNameByHandleDef pGetFinalPathNameByHandle ) 

{
    ...............
    <span class="code-comment">//</span><span class="code-comment"> Get the list of all handles in the system</span>
    PSYSTEM_HANDLE_INFORMATION pSysHandleInformation = <span class="code-keyword">new</span> SYSTEM_HANDLE_INFORMATION;
    DWORD size = <span class="code-keyword">sizeof</span>(SYSTEM_HANDLE_INFORMATION);
    DWORD needed = <span class="code-digit">0</span>;
    NTSTATUS status = NtQuerySystemInformation( SystemHandleInformation, 
                      pSysHandleInformation, size, &amp;needed );
    <span class="code-keyword">if</span>( !NT_SUCCESS(status))
    {
        <span class="code-keyword">if</span>( <span class="code-digit">0</span> == needed )
        {
            <span class="code-keyword">return</span>;<span class="code-comment">//</span><span class="code-comment"> some other error</span>
        }
        <span class="code-comment">//</span><span class="code-comment"> The previously supplied buffer wasn't enough.</span>
        <span class="code-keyword">delete</span> pSysHandleInformation;
        size = needed + <span class="code-digit">1024</span>;
        pSysHandleInformation = (PSYSTEM_HANDLE_INFORMATION)<span class="code-keyword">new</span> BYTE[size];
        status = NtQuerySystemInformation( SystemHandleInformation, 
                                           pSysHandleInformation, size, &amp;needed );
        <span class="code-keyword">if</span>( !NT_SUCCESS(status))
        {
            <span class="code-comment">//</span><span class="code-comment"> some other error so quit.</span>
            <span class="code-keyword">delete</span> pSysHandleInformation;
            <span class="code-keyword">return</span>;
        }
    }
    .....................
    .....................
    .....................
        <span class="code-keyword">for</span> ( DWORD i = <span class="code-digit">0</span>; i &lt; pSysHandleInformation-&gt;dwCount; i++ )
    {
        SYSTEM_HANDLE&amp; sh = pSysHandleInformation-&gt;Handles[i];
        <span class="code-keyword">if</span>( sh.bObjectType != nFileType )<span class="code-comment">//</span><span class="code-comment"> Under windows XP file handle is of type 28</span>
        {
            <span class="code-keyword">continue</span>;
        }

        CString csFileName;
        CString csDir;
        <span class="code-keyword">if</span>( hDriver )
        {
            HANDLE_INFO stHandle = {<span class="code-digit">0</span>};
            ADDRESS_INFO stAddress;
            stAddress.pAddress = sh.pAddress;
            DWORD dwReturn = <span class="code-digit">0</span>;
            BOOL bSuccess = DeviceIoControl( hDriver, IOCTL_LISTDRV_BUFFERED_IO, 
                                             &amp;stAddress, <span class="code-keyword">sizeof</span>(ADDRESS_INFO), 
                                             &amp;stHandle, 
                                             <span class="code-keyword">sizeof</span>(HANDLE_INFO), &amp;dwReturn, NULL );

            
            <span class="code-keyword">if</span>( bSuccess &amp;&amp; stHandle.tcFileName[<span class="code-digit">0</span>] != <span class="code-digit">0</span> &amp;&amp; 
                stHandle.uType != FILE_DEVICE_SOUND &amp;&amp; 
                stHandle.uType != FILE_DEVICE_NAMED_PIPE )
            {

                <span class="code-keyword">if</span>( stHandle.uType != FILE_DEVICE_NETWORK_FILE_SYSTEM  )
                {
                    <span class="code-comment">//</span><span class="code-comment"> Get the drive name from the dos device name</span>
                    <span class="code-keyword">if</span>( !GetDrive( (LPCTSTR)stHandle.tcDeviceName, csFileName, <span class="code-keyword">true</span> ))
                    {
                        OutputDebugString( L<span class="code-string">"</span><span class="code-string">GetDrive failed"</span> );
                    }
                    csFileName += (LPCTSTR)stHandle.tcFileName;
                }
                <span class="code-keyword">else</span>
                {
                    csFileName = _T(<span class="code-string">"</span><span class="code-string">\\"</span>);
                    csFileName += (LPCTSTR)stHandle.tcFileName;
                }
            }
        }    
        ...</pre>

<p>For every file opened in the system, there will be a handle associated with it. With the <code>NtQuerySystemInformation</code> API, we can retrieve all the handles in the system. This includes file handles, Mutex handles, Event handles, etc. Actually, the <code>NtQuerySystemInformation</code> function returns an array of the structure <code>SYSTEM_HANDLE</code>.</p>

<pre lang="C++" data-lang-orig="C++"><span class="code-keyword">typedef</span> <span class="code-keyword">struct</span> _SYSTEM_HANDLE
{
    DWORD    dwProcessId;
    BYTE     bObjectType;
    BYTE     bFlags;
    WORD     wValue;
    PVOID    pAddress;
    DWORD    GrantedAccess;
}
SYSTEM_HANDLE;</pre>

<p>For an object of type file, the value <code>bObjectType</code> in <code>SYSTEM_HANDLE</code> is 28 in Windows XP, Windows 2000, and Window 7; 25 in Windows Vista; and 26 in Windows 2000. Since this application supports only XP/Windows 7, Windows 2000, and Vista, we can ignore all the items with values other than 28/25. In <code>SYSTEM_HANDLE</code>, there is another important member for us, the <code>pAddress</code>. For each file handle, there is a <code>FILE_OBJECT</code> associated with it, and the <code>pAddress</code> is a pointer to that structure. Unfortunately, this address points to kernel memory space, and a user mode application cannot access this memory. Here comes the driver part. This application accesses this memory using the driver "<em>ListOpenedFileDrv_XX.sys</em>". The only thing the driver does is copy the file name in the kernel memory and pass it to the user mode. Using the function <code>DeviceIoControl</code>, the <code>pAddress</code> is passed to the driver. The driver accepts this address and copies the file name from <code>FILE_OBJECT</code>, setting it in the <code>out</code> parameter of the <code>DeviceIoControl</code> function.</p>

<p>As I mentioned earlier, the Process Explorer shows the information about all the handles used by the application. However, the Process Explorer is a stand-alone application. So where is the driver? Or is it doing all this without the driver? This question puzzled me for many days until someone told me that the driver is added in the resource of the Process Explorer. Nice trick, isn't it? So I thought of implementing the same feature in my application too. The function given below performs this task. [Note: The new version of the application is not keeping the driver in the resource, but it directly uses the driver from the application folder. The below code is kept only for those who refer to the VC6 version of the source code.]</p>

<pre lang="C++" data-lang-orig="C++">HANDLE ExtractAndInstallDrv()
{
    SC_HANDLE hSCManager =
        OpenSCManager( NULL, NULL, SC_MANAGER_ALL_ACCESS );
    SC_HANDLE hService = OpenService
        ( hSCManager , DRV_NAME, SERVICE_ALL_ACCESS);
    CString csPath;
    <span class="code-keyword">if</span>( <span class="code-digit">0</span> == hService )
    {
        <span class="code-comment">//</span><span class="code-comment"> Service not installed. So install the service.</span>
        <span class="code-comment">//</span><span class="code-comment"> First extract the resource</span>
        HINSTANCE hModule= AfxGetInstanceHandle();
        HRSRC hRsrc = FindResource
            (hModule, MAKEINTRESOURCE(IDR_XPDRIVER),_T(<span class="code-string">"</span><span class="code-string">BINARY"</span>));
        HGLOBAL hDrvRsrc = LoadResource(hModule, hRsrc);
        DWORD dwDriverSize = SizeofResource(hModule, hRsrc);
        LPVOID lpvDriver = LockResource(hDrvRsrc);
        CFile File;
        <span class="code-keyword">if</span>( !File.Open( DRV_FILE_NAME, CFile::modeCreate|CFile::modeWrite ))
        {
            <span class="code-keyword">return</span> <span class="code-digit">0</span>;
        }
        File.Write( lpvDriver, dwDriverSize );
        csPath = File.GetFilePath();
        File.Close();
        ...
    }</pre>

<p>I made an application that does the above things and started using it. Some days later, again that rename problem occurred, and my application listed nothing. When I looked in the Task Manager, I found out that this time it was because of the applications that were running from my folder. So my next step was to enumerate the EXEs and any DLLs that have been loaded from my folder.</p>

<h3>Enumerating Loaded Modules</h3>

<p>Enumerating the modules loaded by applications was somewhat easy compared to the above task. It just made use of the following APIs. The <code>EnumerateLoadedModules</code> function handles this task in the application.</p>

<pre lang="C++" data-lang-orig="C++">EnumProcesses()
CreateToolhelp32Snapshot()
Module32First()
Module32Next()</pre>

<h3>Compatibility with UAC</h3>

<p>As you have seen, this application makes use of many API calls that need Administrative privilege. But the <em>Explorer.exe</em> in Vista and later runs with restricted privilege so that the shell extension loaded by the explorer also cannot make any API calls that need Administrative privilege. Which means my current implementation, which had only one DLL that does all the job, is no longer going to work. So the only way is to spool another EXE from the shell extension in Administrative mode. So now, when you click on "List Opened Files", it launches <em>OpenFileFinder.exe</em> using <code>ShellExecute</code>, and the rest of the things are taken care by this process. But I was so lazy to move all the existing feature of in the shell extension DLL to the exe or another DLL. So what I did is I kept the functionality in the DLL itself and exported the function <code>ShowOpenedFiles</code> from the DLL, which when called, shows the opened files dialog. The diagram below show this architecture:</p>

<p><img width="521" height="200" alt="Screenshot - Application.jpg" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="/KB/shell/OpenedFileFinder/Architecture.JPG" class="lazyload" data-sizes="auto" data-srcset="/KB/shell/OpenedFileFinder/Architecture-r-400.JPG 400w, /KB/shell/OpenedFileFinder/Architecture.JPG 521w"></p>

<h3>The Problem with Vista 64 Bit and Windows-7 64 Bit</h3>

<p>In 64 bit versions of Windows, starting from Vista, Microsoft has enforced that any program that is supposed to be loaded into the kernel space should be digitally signed by Microsoft. This enforcement affect lots of free software and unfortunately to this software also. The core thing in this application is done by our tiny driver which I no longer will be able to load in those versions of Windows. So my initial plan was to discontinue this application in 64 bit Vista and later. However, because of the new APIs which are introduced from Windows Vista, there is still an option to make this work without the driver also. So this application still works in 64 bit Vista and Windows with limited results. The new API that I was talking about is <a href="http://msdn.microsoft.com/en-us/library/aa364962(VS.85).aspx"><code>GetFinalPathNameByHandle</code></a>. However, using the API instead of our driver has some problems like:</p>

<ul>
<li>This function accepts <code>HANDLE</code>, but the handles are not unique among all processes.</li><li>To solve the above problem, we have to duplicate the handle. To duplicate the handle, I have to get the process handle using <code>OpenProcess</code>. But <code>OpenProcess</code> fails for some processes like SYSTEM because of lack of access. Even if we successfully duplicate some other handles, the API still fails saying Access Denied.</li><li>Last and the worst, it hangs for certain kinds of handles. You can read mode about this problem in here: <a href="http://0memory.blogspot.com/2008/08/getfinalpathnamebyhandle-api-hungs.html">GetFinalPathNameByHandle API Hungs</a>. At the time when I was checking this problem in Windows Vista, I remember atleast the <a href="http://msdn.microsoft.com/en-us/library/aa364953(VS.85).aspx"><code>GetFileInformationByHandleEx</code></a> worked in all cases. But now I experience the same problem in Windows 7.</li></ul>

<p>The only workaround to prevent the entire application from hanging is to call the API from a separate thread. So what I did in this application is, if the driver installation fails, it will switch to Plan B, which is actually to use the <code>GetFinalPathNameByHandle</code> in a separate thread. Meanwhile, the main thread will keep on checking whether the worker thread has hung or not using some events. After a time out period, if the main thread does not receive the event, it will terminate the worked thread and spool another worker thread. This is continued until all the the handles have been enumerated.</p>

<p>The following code shows how the API is called from the thread:</p>

<pre lang="C++" data-lang-orig="C++">DWORD WINAPI ThreadProc( LPVOID lParam )
{
    THREAD_PARAMS* pThreadParam = (THREAD_PARAMS*)lParam;    
    GetFinalPathNameByHandleDef pGetFinalPathNameByHandle = 
                       pThreadParam-&gt;pGetFinalPathNameByHandle;
    <span class="code-keyword">for</span>( g_CurrentIndex; g_CurrentIndex &lt; pThreadParam-&gt;pSysHandleInformation-&gt;dwCount;  )
    {
        WaitForSingleObject( pThreadParam-&gt;hStartEvent, INFINITE );
        ResetEvent( pThreadParam-&gt;hStartEvent ). 
        pThreadParam-&gt;bStatus = <span class="code-keyword">false</span>;
        SYSTEM_HANDLE&amp; sh = pThreadParam-&gt;pSysHandleInformation-&gt;Handles[g_CurrentIndex];
        g_CurrentIndex++;
        <span class="code-comment">//</span><span class="code-comment"> First try to duplicate the handle,</span>
        <span class="code-comment">//</span><span class="code-comment"> if the duplicate handle failed, we will coninue with the</span>
        <span class="code-comment">//</span><span class="code-comment"> original handle. But calling the API</span>
        <span class="code-comment">//</span><span class="code-comment"> with the orginal handle is least likly to success</span>
        HANDLE hDup = (HANDLE)sh.wValue;
        HANDLE hProcess = OpenProcess( PROCESS_DUP_HANDLE , FALSE, sh.dwProcessId );
        <span class="code-keyword">if</span>( hProcess )
        {
            BOOL b = DuplicateHandle( hProcess, (HANDLE)sh.wValue, 
                       GetCurrentProcess(), &amp;hDup, <span class="code-digit">0</span>, FALSE, DUPLICATE_SAME_ACCESS );
            <span class="code-keyword">if</span>( !b )
            {
                hDup = (HANDLE)sh.wValue;
            }
            CloseHandle( hProcess );
        }
        DWORD dwRet = pGetFinalPathNameByHandle( hDup, pThreadParam-&gt;lpPath, MAX_PATH, <span class="code-digit">0</span> );
        <span class="code-keyword">if</span>( hDup &amp;&amp; (hDup != (HANDLE)sh.wValue))
        {
            CloseHandle( hDup );
        }
        <span class="code-keyword">if</span>(dwRet)
        {
            pThreadParam-&gt;bStatus = <span class="code-keyword">true</span>;
        }
        SetEvent( pThreadParam-&gt;hFinishedEvent );
        
    }
    <span class="code-keyword">return</span> <span class="code-digit">0</span>;
}</pre>

<p>And this is how the main thread delegates its work to the thread procedure:</p>

<pre lang="C++" data-lang-orig="C++"><span class="code-keyword">void</span> EnumerateOpenedFiles( CString&amp; csPath, OF_CALLBACL CallBackProc, 
                           UINT_PTR pUserContext, HANDLE hDriver,
                           GetFinalPathNameByHandleDef pGetFinalPathNameByHandle ) 
{
    ................
    ................
    <span class="code-keyword">if</span>( pGetFinalPathNameByHandle )<span class="code-comment">//</span><span class="code-comment"> there is no driver, we have do it ugly way</span>
    {
        g_CurrentIndex = <span class="code-digit">0</span>;
        TCHAR tcFileName[MAX_PATH+1];
        THREAD_PARAMS ThreadParams;
        ThreadParams.lpPath = tcFileName;
        ThreadParams.nFileType = nFileType;
        ThreadParams.pGetFinalPathNameByHandle = pGetFinalPathNameByHandle;
        ThreadParams.pSysHandleInformation = pSysHandleInformation;
        ThreadParams.hStartEvent = ::CreateEvent( <span class="code-digit">0</span>, TRUE, FALSE, <span class="code-digit">0</span> );
        ThreadParams.hFinishedEvent = ::CreateEvent( <span class="code-digit">0</span>, TRUE, FALSE, <span class="code-digit">0</span> );
        HANDLE ThreadHandle = <span class="code-digit">0</span>;
        <span class="code-keyword">while</span>( g_CurrentIndex &lt; pSysHandleInformation-&gt;dwCount )
        {
            <span class="code-keyword">if</span>( !ThreadHandle )
            {
                ThreadHandle = CreateThread( <span class="code-digit">0</span>, <span class="code-digit">0</span>, ThreadProc, &amp;ThreadParams, <span class="code-digit">0</span>, <span class="code-digit">0</span> );    
            }
            ResetEvent( ThreadParams.hFinishedEvent );
            SetEvent( ThreadParams.hStartEvent );
            <span class="code-keyword">if</span>( WAIT_TIMEOUT == WaitForSingleObject( ThreadParams.hFinishedEvent, <span class="code-digit">100</span> ))
            {
                CString csError;
                csError.Format(L<span class="code-string">"</span><span class="code-string">Query hang for handle %d"</span>, 
                   (<span class="code-keyword">int</span>)pSysHandleInformation-&gt;Handles[g_CurrentIndex - <span class="code-digit">1</span>].wValue);
                OutputDebugString(csError );
                TerminateThread( ThreadHandle, <span class="code-digit">0</span> );
                CloseHandle( ThreadHandle );
                ThreadHandle = <span class="code-digit">0</span>;
                <span class="code-keyword">continue</span>;
            }
            <span class="code-keyword">if</span>( !ThreadParams.bStatus )
            {
                <span class="code-keyword">continue</span>;
            }
    ................
    ................
}</pre>

<p>Compared to the driver method, this one is much slower and returns less results. You have to switch off the diver signature enforcement in 64 bit Vista if you still want this application to work using the driver.</p>

<h3>How Third Party Applications Can Make Use of This Application</h3>

<p>After the initial version of this application, I received many requests from people to export some functions so that other applications can also make use of this functionality. Starting from this release, <em>OpenFileFinder.dll</em> exports two C functions, which can be called from other binaries:</p>

<ul>
<li><code>void ShowOpenedFiles( LPCWSTR lpPath )</code></li><p>You can call this function if you want to show the dialog and display the opened files in it.</p>

<li><code>void GetOpenedFiles( LPCWSTR lpPath, OF_TYPE Filter,OF_CALLBACK CallBackProc,UINT_PTR pUserContext );</code></li><p>If you call this function and pass a callback pointer, for each file handle that matches the input path, the callback function will be called.</p>
</ul>

<p>The above functions plus the <code>OF_TYPE</code> enum and the <code>OF_CALLBACK</code> function pointer is defined in <em>OpenedFiles.h</em>.</p>

<h3>Close Handle Option</h3>

<p>During the initial development of this utility, I purposefully ignored the option for closing any file handles opened by another process. I though it was unsafe if it provides such an option because closing the handle may lead to unexpected results in that application. However, I later got into some situations like the folder I wanted to rename was used by <em>service.exe</em>. And if I wanted to rename the folder, the only option was to terminate the process. But terminating <em>service.exe</em> will make the entire system unstable. And so I was forced to include a Close Handle option too.</p>

<p>So how this option basically works is, it duplicates the handle using the <code>DuplicateHandle()</code> function with the <code>DUPLICATE_CLOSE_SOURCE</code> flag specified. After that, it closes the duplicate handle also using the <code>CloseHandle()</code> function. This option will work only for loaded files; i.e., using this option on a DLL used by another process is just ignored.</p>

<pre lang="C++" data-lang-orig="C++">HANDLE hDup = <span class="code-digit">0</span>;
BOOL b = DuplicateHandle( hProcess, hFile, GetCurrentProcess(), 
    &amp;hDup, DUPLICATE_SAME_ACCESS , FALSE, DUPLICATE_CLOSE_SOURCE );
<span class="code-keyword">if</span>( hDup )
{
    CloseHandle( hDup );
}
CloseHandle( hProcess );</pre>

<p>Basically, with the above code, we can close the handles created by another process. After closing the handle, we can rename or delete that file or directory. But there are cases where after closing the handle, we can rename the folder but deleting is not possible. For example, consider the file <em>C:\WINDOWS\system32\config\CstEvent.Evt</em>. Normally, this file is used by <em>Service.exe</em> for event logging purposes. So if we try to close this file handle using the above option, the handle will be closed and we can rename too, but cannot delete!! I tried many ways to solve this, but couldn't come up with a working solution. If anybody knows any options to solve this, please let me know.</p>

<h3>Miscellaneous Features</h3>

<h4>Auto Complete in Combobox</h4>

<p><img width="604" height="270" alt="Screenshot - AutoComplete.jpg" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="/KB/shell/OpenedFileFinder/AutoComplete.jpg" class="lazyload" data-sizes="auto" data-srcset="/KB/shell/OpenedFileFinder/AutoComplete-r-400.jpg 400w, /KB/shell/OpenedFileFinder/AutoComplete.jpg 604w"></p>

<p>You have probably noticed that when we type some paths in the Run dialog of Windows, it will list the files and folders under that path. Similarly, when you type a path in the combobox of this application, it will list the files and folders under that path. <code>SHAutoComplete</code> takes care of this feature. This function needs a handle of the edit control. But I only have a combobox - how do I take the edit control inside it? Well, the edit control inside the combobox has a control ID 1001. Use the <code>GetDlgItem()</code> function with this ID to get the handle of the edit control. You can also specify a filename in that combobox.</p>

<pre lang="C++" data-lang-orig="C++">BOOL MainDlg::OnInitDialog()
{
    .....
    CWnd* pEdit =  m_combobox.GetDlgItem( <span class="code-digit">1001</span> );
    <span class="code-keyword">if</span>( pEdit )
    {
        SHAutoComplete( pEdit-&gt;m_hWnd, SHACF_FILESYSTEM );
    }
}</pre>

<h4>Find Target Option</h4>

<p>When you right click on one item in the list control of this application, you will find a menu called "Find Target". This option is something like the Find Target option in Windows Explorer. It opens a Windows Explorer window with a specified file selected in its folder. <code>SHOpenFolderAndSelectItems()</code> is used for implementing this feature.</p>

<pre lang="C++" data-lang-orig="C++"><span class="code-keyword">void</span> MainDlg::OnMainFindtarget()
{
    ....
    CString csPath;
    csPath = m_list.GetItemText( nItem,<span class="code-digit">2</span> );
    LPITEMIDLIST stId = <span class="code-digit">0</span>;
    SFGAOF stSFGAOFIn = <span class="code-digit">0</span>;
    SFGAOF stSFGAOFOut = <span class="code-digit">0</span>;
    <span class="code-keyword">if</span>( !FAILED(SHParseDisplayName( csPath, <span class="code-digit">0</span>, &amp;stId,stSFGAOFIn, &amp;stSFGAOFOut )))
    {
        SHOpenFolderAndSelectItems( stId, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span> );
    }
}</pre>

<h4>Show Loaded Modules and Show Loaded Files - Options</h4>

<p>As mentioned above, the list control in the application list includes two types of items - loaded files and loaded modules (DLLs, OCX, EXE etc.). This option is to Show/Hide one type of item from the list.</p>

<h3>Note </h3>

<p>This application uses a driver built for Windows XP/Win2003/Vista/Window 7, and so it will run only on those versions. If you want, you can add support for other OS versions as well by building the driver and making the necessary changes to the application.</p>

<h2>Revision History</h2>

<h4>September-29-2010</h4>

<ul>
<li>Added 64 bit support</li><li>Added modifications mentioned in the section "Compatibility with UAC"</li><li>Added modifications mentioned in the section "The problem with Vista 64 bit and Windows-7 64 bit"</li></ul>

<h4>June-06-2008</h4>

<ul>
<li>The bug described in the below <a href="/KB/shell/OpenedFileFinder/aspx?msg=2547364#xx2547364xx">post</a>[<a title="New Window" href="/KB/shell/OpenedFileFinder/aspx?msg=2547364#xx2547364xx" target="_blank">^</a>] has been fixed</li><li>Close Handle and Close All Handle options added</li><li>"Show Loaded Modules" and "Show Loaded Files" options added</li></ul>

<h4>October-12-2007</h4>

<ul>
<li>Application icon is displayed along with process</li><li>Miscellaneous Features section added</li></ul>

<h4>September-27-2007</h4>

<ul>
<li>"Find Target" menu added</li><li>Added driver for Windows Vista</li><li>Added VC8 solution</li></ul>

<h4>June-30-2007</h4>

<ul>
<li>Article moved</li></ul>

<h4>June-4-2007</h4>

<ul>
<li>Article updated</li></ul>

<h4>May-28-2007</h4>

<ul>
<li>Original version posted</li></ul></body></html>


						</div>
						

						

						<div class="float-right" style="margin:20px 0 0 10px;border:1px solid #ccc">
						<div class="msg-300x250" data-format="300x250" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Desktop-Development/Shell-and-IE-programming/General"  data-country='US' data-loadOnView='true'  data-tags='VC6, C++, Windows, Dev, Intermediate,rating4.5'><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Desktop-Development/Shell-and-IE-programming/General&sz=300x250&c=112028"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Desktop-Development/Shell-and-IE-programming/General&sz=300x250&c=112028"  width="300px" height="250px" target="_blank"/></a></noscript></div>
						</div>
                        
                        
						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p></div>
						<h2>Share</h2>
				        <div class="share-list">
					        

    <ul class="rrssb-buttons clearfix">
        <li id="ctl00_SocialLike_Email" class="email compact">
            <a href="mailto:?subject=Listing%20Used%20Files%20-%20CodeProject&amp;body=Here%27s%20an%20interesting%20article%20on%20for%20you%20on%20codeproject.com%0a%0aA%20ShellExtension%20that%20lists%20all%20the%20used%20files%20in%20a%20folder.%0a%0ahttps%3a%2f%2fwww.codeproject.com%2fArticles%2f18975%2fListing-Used-Files%0a">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                        version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" 
                        enable-background="new 0 0 28 28" xml:space="preserve">
                        <g>
                            <path d="M20.111 26.147c-2.336 1.051-4.361 1.401-7.125 1.401c-6.462 0-12.146-4.633-12.146-12.265 
                                c0-7.94 5.762-14.833 14.561-14.833c6.853 0 11.8 4.7 11.8 11.252c0 5.684-3.194 9.265-7.399 
                                9.3 c-1.829 0-3.153-0.934-3.347-2.997h-0.077c-1.208 1.986-2.96 2.997-5.023 2.997c-2.532 
                                0-4.361-1.868-4.361-5.062 c0-4.749 3.504-9.071 9.111-9.071c1.713 0 3.7 0.4 4.6 0.973l-1.169 
                                7.203c-0.388 2.298-0.116 3.3 1 3.4 c1.673 0 3.773-2.102 3.773-6.58c0-5.061-3.27-8.994-9.303-8.994c-5.957 
                                0-11.175 4.673-11.175 12.1 c0 6.5 4.2 10.2 10 10.201c1.986 0 4.089-0.43 5.646-1.245L20.111 
                                26.147z M16.646 10.1 c-0.311-0.078-0.701-0.155-1.207-0.155c-2.571 0-4.595 2.53-4.595 5.529c0 
                                1.5 0.7 2.4 1.9 2.4 c1.441 0 2.959-1.828 3.311-4.087L16.646 10.068z"></path>
                        </g>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Twitter" class="twitter compact">
            <a href="http://twitter.com/home?status=Listing+Used+Files+-+CodeProject+-+https%3a%2f%2fwww.codeproject.com%2fArticles%2f18975%2fListing-Used-Files" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                        x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M24.253,8.756C24.689,17.08,18.297,24.182,9.97,24.62c-3.122,0.162-6.219-0.646-8.861-2.32
                        c2.703,0.179,5.376-0.648,7.508-2.321c-2.072-0.247-3.818-1.661-4.489-3.638c0.801,0.128,1.62,0.076,2.399-0.155
                        C4.045,15.72,2.215,13.6,2.115,11.077c0.688,0.275,1.426,0.407,2.168,0.386c-2.135-1.65-2.729-4.621-1.394-6.965
                        C5.575,7.816,9.54,9.84,13.803,10.071c-0.842-2.739,0.694-5.64,3.434-6.482c2.018-0.623,4.212,0.044,5.546,1.683
                        c1.186-0.213,2.318-0.662,3.329-1.317c-0.385,1.256-1.247,2.312-2.399,2.942c1.048-0.106,2.069-0.394,3.019-0.851
                        C26.275,7.229,25.39,8.196,24.253,8.756z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Facebook" class="facebook compact">
            
            <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.codeproject.com%2fArticles%2f18975%2fListing-Used-Files" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                        x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M27.825,4.783c0-2.427-2.182-4.608-4.608-4.608H4.783c-2.422,0-4.608,2.182-4.608,4.608v18.434
                            c0,2.427,2.181,4.608,4.608,4.608H14V17.379h-3.379v-4.608H14v-1.795c0-3.089,2.335-5.885,5.192-5.885h3.718v4.608h-3.726
                            c-0.408,0-0.884,0.492-0.884,1.236v1.836h4.609v4.608h-4.609v10.446h4.916c2.422,0,4.608-2.188,4.608-4.608V4.783z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_LinkedIn" class="linkedin compact">
            <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f18975%2fListing-Used-Files&amp;title=Listing+Used+Files+-+CodeProject&amp;summary=A+ShellExtension+that+lists+all+the+used+files+in+a+folder.&amp;source=codeproject.com" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                        x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M25.424,15.887v8.447h-4.896v-7.882c0-1.979-0.709-3.331-2.48-3.331c-1.354,0-2.158,0.911-2.514,1.803
                            c-0.129,0.315-0.162,0.753-0.162,1.194v8.216h-4.899c0,0,0.066-13.349,0-14.731h4.899v2.088c-0.01,0.016-0.023,0.032-0.033,0.048
                            h0.033V11.69c0.65-1.002,1.812-2.435,4.414-2.435C23.008,9.254,25.424,11.361,25.424,15.887z M5.348,2.501
                            c-1.676,0-2.772,1.092-2.772,2.539c0,1.421,1.066,2.538,2.717,2.546h0.032c1.709,0,2.771-1.132,2.771-2.546
                            C8.054,3.593,7.019,2.501,5.343,2.501H5.348z M2.867,24.334h4.897V9.603H2.867V24.334z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Reddit" class="reddit compact">
            <a href="http://www.reddit.com/submit?url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f18975%2fListing-Used-Files&amp;title=Listing+Used+Files+-+CodeProject">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" 
                        x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" 
                        enable-background="new 0 0 28 28" xml:space="preserve"><g>
                    <path d="M11.794 15.316c0-1.029-0.835-1.895-1.866-1.895c-1.03 0-1.893 0.865-1.893 1.895s0.863 1.9 1.9 1.9 C10.958 17.2 11.8 16.3 11.8 15.316z"></path>
                    <path d="M18.1 13.422c-1.029 0-1.895 0.864-1.895 1.895c0 1 0.9 1.9 1.9 1.865c1.031 0 1.869-0.836 1.869-1.865 C19.969 14.3 19.1 13.4 18.1 13.422z"></path>
                    <path d="M17.527 19.791c-0.678 0.678-1.826 1.006-3.514 1.006c-0.004 0-0.009 0-0.014 0c-0.004 0-0.01 0-0.015 0 
                    c-1.686 0-2.834-0.328-3.51-1.005c-0.264-0.265-0.693-0.265-0.958 0c-0.264 0.265-0.264 0.7 0 1 c0.943 0.9 2.4 1.4 
                    4.5 1.402c0.005 0 0 0 0 0c0.005 0 0 0 0 0c2.066 0 3.527-0.459 4.47-1.402 c0.265-0.264 0.265-0.693 0.002-0.958C18.221 
                    19.5 17.8 19.5 17.5 19.791z"></path><path d="M27.707 13.267c0-1.785-1.453-3.237-3.236-3.237c-0.793 0-1.518 0.287-2.082 
                    0.761c-2.039-1.295-4.646-2.069-7.438-2.219 l1.483-4.691l4.062 0.956c0.071 1.4 1.3 2.6 2.7 2.555c1.488 0 2.695-1.208 
                    2.695-2.695C25.881 3.2 24.7 2 23.2 2 c-1.059 0-1.979 0.616-2.42 1.508l-4.633-1.091c-0.344-0.081-0.693 0.118-0.803 
                    0.455l-1.793 5.7 C10.548 8.6 7.7 9.4 5.6 10.75C5.006 10.3 4.3 10 3.5 10.029c-1.785 0-3.237 1.452-3.237 3.2 c0 1.1 0.6 
                    2.1 1.4 2.69c-0.04 0.272-0.061 0.551-0.061 0.831c0 2.3 1.3 4.4 3.7 5.9 c2.299 1.5 5.3 2.3 8.6 2.325c3.228 0 6.271-0.825 
                    8.571-2.325c2.387-1.56 3.7-3.66 3.7-5.917 c0-0.26-0.016-0.514-0.051-0.768C27.088 15.5 27.7 14.4 27.7 13.267z M23.186 
                    3.355c0.74 0 1.3 0.6 1.3 1.3 c0 0.738-0.6 1.34-1.34 1.34s-1.342-0.602-1.342-1.34C21.844 4 22.4 3.4 23.2 3.355z M1.648 
                    13.3 c0-1.038 0.844-1.882 1.882-1.882c0.31 0 0.6 0.1 0.9 0.209c-1.049 0.868-1.813 1.861-2.26 2.9 C1.832 14.2 1.6 13.8 1.6 
                    13.267z M21.773 21.57c-2.082 1.357-4.863 2.105-7.831 2.105c-2.967 0-5.747-0.748-7.828-2.105 
                    c-1.991-1.301-3.088-3-3.088-4.782c0-1.784 1.097-3.484 3.088-4.784c2.081-1.358 4.861-2.106 7.828-2.106 c2.967 0 5.7 
                    0.7 7.8 2.106c1.99 1.3 3.1 3 3.1 4.784C24.859 18.6 23.8 20.3 21.8 21.57z M25.787 14.6 
                    c-0.432-1.084-1.191-2.095-2.244-2.977c0.273-0.156 0.59-0.245 0.928-0.245c1.035 0 1.9 0.8 1.9 1.9 
                    C26.354 13.8 26.1 14.3 25.8 14.605z"></path></g></svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Pinterest" class="pinterest compact">
            <a href="http://pinterest.com/pin/create/bookmarklet/?is_video=false&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f18975%2fListing-Used-Files&amp;description=Listing+Used+Files+-+CodeProject">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                        x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M14.021,1.57C6.96,1.57,1.236,7.293,1.236,14.355c0,7.062,5.724,12.785,12.785,12.785c7.061,0,12.785-5.725,12.785-12.785
                        C26.807,7.294,21.082,1.57,14.021,1.57z M15.261,18.655c-1.161-0.09-1.649-0.666-2.559-1.219c-0.501,2.626-1.113,5.145-2.925,6.458
                        c-0.559-3.971,0.822-6.951,1.462-10.116c-1.093-1.84,0.132-5.545,2.438-4.632c2.837,1.123-2.458,6.842,1.099,7.557
                        c3.711,0.744,5.227-6.439,2.925-8.775c-3.325-3.374-9.678-0.077-8.897,4.754c0.19,1.178,1.408,1.538,0.489,3.168
                        C7.165,15.378,6.53,13.7,6.611,11.462c0.131-3.662,3.291-6.227,6.46-6.582c4.007-0.448,7.771,1.474,8.29,5.239
                        c0.579,4.255-1.816,8.865-6.102,8.533L15.261,18.655z"></path>
                    </svg>
                </span>
                
            </a>
        </li>

    </ul>



				        </div> 
    			        
                        <h2 id="ctl00_AboutHeading">About the Author</h2>
						    

<div class="author-wrapper">

    <div class="pic-wrapper"> 
        <img id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto" class="profile-pic" src="https://www.codeproject.com/script/Membership/ProfileImages/{D5771DE2-6D71-4D51-8ECC-532B2EA5068D}.jpg" border="0" style="transform:rotate(2deg);" />
    </div>

    <div class="container-member">  
        <b><a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink" class="author" href="/Members/User-1597544"><font color="0xFF000000">N</font>aveen</a></b>

        <table>
        <tr>
            <td rowspan="2" nowrap valign="middle">
            
            </td>
            <td nowrap="nowrap">
                <div class="company">
                    <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle">Software Developer (Senior)</span>
	                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberCompany"></span>
                </div>
            </td>
            <td rowspan="2" style="padding-left:15px">
                
            </td>
        </tr>
        <tr>
            <td>
                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation">Singapore <img src="/script/Geo/Images/SG.gif" alt="Singapore" width="16px" height="11px" /></span>
            </td>
        </tr>
        </table>
    </div>

    <div class="description">
        No Biography provided

        
    </div>

</div><br />
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    <div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Desktop-Development/Shell-and-IE-programming/General"  data-country='US' data-loadOnView='true'  data-tags='VC6, C++, Windows, Dev, Intermediate,rating4.5,pos_bottom'><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Desktop-Development/Shell-and-IE-programming/General&sz=728x90&c=112028"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Desktop-Development/Shell-and-IE-programming/General&sz=728x90&c=112028"  width="728px" height="90px" target="_blank"/></a></noscript></div>
				</div>
				
                
                

				
				

					<h2>Comments and Discussions</h2>
					<a class="float-left" name="_comments" id="_comments">&nbsp;</a><div id="_MessageBoardctl00_MessageBoard" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(event, null)">
<table id="ForumTable" class="forum relaxed" cellpadding="0" cellspacing="0">
<tr>
<td><a name="xx0xx"></a><table border="0" cellpadding="2px" cellspacing="0" width="100%">
<tr class="navbar">
<td></td><td align="right" width="50%"></td><td align="right" nowrap="nowrap"><span class="nav-link disabled">First</span> <span class="nav-link disabled">Prev</span><a class="nav-link" name="Frm_HoverNL" href="/Articles/18975/Listing-Used-Files?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;fr=26#xx0xx">Next</a></td>
</tr>
</table></td>
</tr><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%" class="fixed-layout blank-background">
<tr id="F5731399_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx5731399xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="5731399" parent="0" thread="5731399" href="/Messages/5731399/Build-drive">Build drive</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">hunguyen.abs</span><span class="date">23-Jun-20  15:45</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=14871548">hunguyen.abs</a></span></td><td class="date"><span>23-Jun-20  15:45&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F5731399_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="14871548" data-objectref="3_5731399" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2"><pre>Thank you for sharing. Could you please tell me, what program did you use to build the drive?</pre><br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F5571213_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx5571213xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="5571213" parent="0" thread="5571213" href="/Messages/5571213/Question-about-app">Question about app</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Member 14056281</span><span class="date">15-Nov-18  16:45</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=14056281">Member 14056281</a></span></td><td class="date"><span>15-Nov-18  16:45&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F5571213_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="14056281" data-objectref="3_5571213" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">This is a great app. A few things that would improve the Quality Of Life of the app. Keep up the great work.<br />
<br />
1. Can you make the window adjust to my current desktop or make it resize friendly or easier instead of manually resizing the window?<br />
2. Typing a file name and it lists all paths associated with the file name or Wild card the filename so it gives you any file name with the wildcard search results along with all paths associated with it. For example. *Cache_32.db it will list all files that have iconcache_32.db along with the paths etc. helps ton if i don't know the exact path of where the handle resides.<br />
3. Filter options to disclude or hide processes. If i had to search for handles by processes by process of elimination, filter would work wonders.<br />
4. Ability to open file location, once i identify a particular handle and i find the path, i'd like to see a right click option to open file location and it would open the folder to that exact folder.<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F5429084_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx5429084xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="5429084" parent="0" thread="5429084" href="/Messages/5429084/Simplifications-found">Simplifications found</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">HooNose_JJP</span><span class="date">24-Aug-17  22:06</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=1324485">HooNose_JJP</a></span></td><td class="date"><span>24-Aug-17  22:06&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F5429084_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="1324485" data-objectref="3_5429084" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">Thank you so much Naveen! I learned from this article how to do it.<br />
And I have found some new input for improvement/simplification (while doing a re-implementation in C# with pinvoke): You may use the API function <pre>GetFileType(handle)</pre> ... to query the handle type / object type. On the duplicated handle, right before calling GetFinalPathNameByHandle(...). And then proceed only for those Handles that are <pre>FileTypeDisk = 0x0001</pre> (it simply returns FileTypeUnknown = 0x0000 for any non-File or even invalid handle. And it returns different values for named pipes, COM ports etc.).<br />
<br />
 - GetFinalPathNameByHandle(...) does <u><b>not</b></u> hang for these handles, of FileTypeDisk <br />
 - you can drop the hack with running the extra thread<br />
 - the driver can be dropped (won't work anymore with newer Windows version)<br />
 - you may even drop the check for the object type (25, 28, 35 on Windows 10, ...) and thus become compatible with (almost) any version of Windows.<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F5164674_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx5164674xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_idea.gif" alt="Suggestion" title="Suggestion" /></td><td class="subject hover-container"><a class="message-link" name="5164674" parent="0" thread="5164674" href="/Messages/5164674/This-tool-is-not-required-ProcessExlorer-has-this">This tool is not required. ProcessExlorer has this functionality built in.</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Elmue</span><span class="date">23-Nov-15  5:17</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=480064">Elmue</a></span></td><td class="date"><span>23-Nov-15  5:17&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F5164674_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="480064" data-objectref="3_5164674" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">In SysInternals ProcessExplorer you click the menu "Find" and enter the name of the DLL.<br />
It will show you all processes that have this DLL loaded.<br />
<br />
There is no need to write an own tool.<br />
<br />
If you want to remove an entire folder, delete all files in it.<br />
The ones that remain because they are currently loaded into a process, you can then search in ProcessExplorer to see who uses them.<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F5429104_h0" class="header hover-row">
<td class="subject-line normal vote-hi " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="38px" class="indent"><a name="xx5429104xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer" /></td><td class="subject hover-container"><a class="message-link" name="5429104" parent="5164674" thread="5164674" href="/Messages/5429104/Re-This-tool-is-not-required-ProcessExlorer-has-th">Re: This tool is not required. ProcessExlorer has this functionality built in.</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">HooNose_JJP</span><span class="date">24-Aug-17  23:18</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=1324485">HooNose_JJP</a></span></td><td class="date"><span>24-Aug-17  23:18&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F5429104_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="38"><span class="rating-vote vertical" data-ownerid="1324485" data-objectref="3_5429104" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5164674);" href="/Messages/5164674/This-tool-is-not-required-ProcessExlorer-has-this"><img src="https://www.codeproject.com/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent"  style="width:16px;height:16px;border:0" /></a></div><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/smiley_snore.gif" align="top" alt="Sleepy | :zzz:" />  Elmu, your comment was silly and not helpful. I cannot use ProcessExplorer from my code, in my projects. There are also lots of license/legal issues when you need a solution in commercial projects/environments. And - besides all practical concerns - I, as a software developer, wanted to learn how to solve this kind of task in code. I'm not here searching for a magic black-box tool that accomplishes some task for me. This article was the perfect tutorial for me.<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F5139129_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx5139129xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="5139129" parent="0" thread="5139129" href="/Messages/5139129/How-to-build-the-ListOpenedFileDrv-64-sys-driver">How to build the ListOpenedFileDrv_64.sys driver</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Member 12009323</span><span class="date">6-Oct-15  11:33</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=12009323">Member 12009323</a></span></td><td class="date"><span>6-Oct-15  11:33&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F5139129_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="12009323" data-objectref="3_5139129" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">I downloaded the source code and I see the the following files in the ListFileDrv folder:<br />
ListFileDrv.c<br />
makefile<br />
sources<br />
<br />
However, I am not sure how to build the .sys file. The makefile refers to a makefile.def but I don't have that.<br />
<br />
I might be missing something obvious here, so I am open to anyone who wants to correct the error in my ways. <br />
<br />
I am try to build this using Visual Studio 2005 running nmake makefile.<br />
<br />
Thanks<br />
<br />
Tom<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F5223379_h0" class="header hover-row">
<td class="subject-line normal vote-hi " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="38px" class="indent"><a name="xx5223379xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer" /></td><td class="subject hover-container"><a class="message-link" name="5223379" parent="5139129" thread="5139129" href="/Messages/5223379/Re-How-to-build-the-ListOpenedFileDrv-64-sys-drive">Re: How to build the ListOpenedFileDrv_64.sys driver</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">cat'seye</span><span class="date">30-Mar-16  6:03</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=2148916">cat'seye</a></span></td><td class="date"><span>30-Mar-16  6:03&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F5223379_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="38"><span class="rating-vote vertical" data-ownerid="2148916" data-objectref="3_5223379" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5139129);" href="/Messages/5139129/How-to-build-the-ListOpenedFileDrv-64-sys-driver"><img src="https://www.codeproject.com/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent"  style="width:16px;height:16px;border:0" /></a></div>Same problem :<br />
<br />
nmake<br />
<br />
<pre lang="C#" data-lang-orig="C#">Microsoft (R) Program Maintenance Utility Version <span class="code-digit">10</span>.<span class="code-digit">00</span>.<span class="code-digit">30319</span>.<span class="code-digit">01</span>
Copyright (C) Microsoft Corporation.  All rights reserved.

makefile(<span class="code-digit">1</span>) : fatal error U1052: file <span class="code-string">&#39;</span><span class="code-string">\makefile.def&#39;</span> not found
Stop.</pre><br />
<br />
<br />
 <img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/smiley_sigh.gif" align="top" alt="Sigh | :sigh:" /><br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F5045196_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx5045196xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="5045196" parent="0" thread="5045196" href="/Messages/5045196/HELP-About-Retrieving-all-System-Processes-Handles">[HELP]About Retrieving all System/Processes Handles and its name</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">uRLuVRJoNNeL</span><span class="date">21-Apr-15  2:53</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=10583967">uRLuVRJoNNeL</a></span></td><td class="date"><span>21-Apr-15  2:53&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F5045196_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="10583967" data-objectref="3_5045196" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">I am making an application that copy files , that was used to backup files.<br />
but I need to implement a Feature that can copy a File even it was used by another processed [file is not accessible even in Read Only Mode].<br />
<br />
The only thing that was better than closing a Process is to Close all the Handles from the Specified Target file to be copied.<br />
<br />
I already know how to Retrieve the List of Handles in the System using NtQuerySystemInformation and NtQueryObject to obtain its name , with used of OpenProcess Function to obtain the handle and DuplicateHandle to Obtain the Real Handle from the Target Process that contains a File Handle.<br />
<br />
But OpenProcess Failed to return a Valid Handle , also DuplicateHandle because of the Security from windows. I read some Blogs/Article that the best way to do is to make a Driver that can Retrieve the Names of the Handle then Return it to the User Mode Process, and Close the Handle from the Kernel mode , But I don't know how to do that. Please help me How i can Implement your Driver to my Application. Please. Thanks.<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4907826_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx4907826xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="4907826" parent="0" thread="4907826" href="/Messages/4907826/My-vote-of-5">My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">raiserle</span><span class="date">20-Sep-14  11:52</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=5752276">raiserle</a></span></td><td class="date"><span>20-Sep-14  11:52&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F4907826_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="5752276" data-objectref="3_4907826" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">excelent<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4887139_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx4887139xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="4887139" parent="0" thread="4887139" href="/Messages/4887139/Freeing-OF-INFO-t-lpFile-member">Freeing OF_INFO_t lpFile member</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Felix Dombek</span><span class="date">21-Aug-14  4:51</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=9169261">Felix Dombek</a></span></td><td class="date"><span>21-Aug-14  4:51&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F4887139_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="9169261" data-objectref="3_4887139" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">Hi, great work.<br />
Question: When using the GetOpenedFiles function in the DLL, do I have to free the string lpFile in the OF_INFO_t parameter in my callback function? If so, what function must I use (free or delete or LocalFree)? Thanks<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4798934_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx4798934xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="4798934" parent="0" thread="4798934" href="/Messages/4798934/How-does-ProcessExplorer-not-hang">How does ProcessExplorer not hang ?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Elmue</span><span class="date">11-Apr-14  15:49</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=480064">Elmue</a></span></td><td class="date"><span>11-Apr-14  15:49&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F4798934_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="480064" data-objectref="3_4798934" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">Hello<br />
<br />
Very interesting article.<br />
<br />
How does ProcessExplorer from SysInternals.com not hang when listing the handles? <br />
Wouldn't it be a good idea to use the driver of ProcessExplorer instead in your application? <br />
Does this driver have a certificate for Windows 64 Bit ?<br />
This would eliminate all problems at once!<br />
<br />
Elmü<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4781649_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx4781649xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="4781649" parent="0" thread="4781649" href="/Messages/4781649/DuplicateHandle-returns-access-denied">DuplicateHandle returns access denied</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Valdeci Monteiro</span><span class="date">18-Mar-14  21:47</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=6665751">Valdeci Monteiro</a></span></td><td class="date"><span>18-Mar-14  21:47&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F4781649_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="6665751" data-objectref="3_4781649" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">I am doing a program that list open files using DuplicateHandle like in your code, but for some process all calls to DuplicateHandle return access denied.<br />
<br />
I am using Windows 7 32bits. My program is running as administrator with SE_DEBUG_NAME privilege enabled. I can open all processes, but can´t get the handle.<br />
<br />
Can you help me?<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4798936_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="38px" class="indent"><a name="xx4798936xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer" /></td><td class="subject hover-container"><a class="message-link" name="4798936" parent="4781649" thread="4781649" href="/Messages/4798936/Re-DuplicateHandle-returns-access-denied">Re: DuplicateHandle returns access denied</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Elmue</span><span class="date">11-Apr-14  15:50</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=480064">Elmue</a></span></td><td class="date"><span>11-Apr-14  15:50&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F4798936_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="38"><span class="rating-vote vertical" data-ownerid="480064" data-objectref="3_4798936" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4781649);" href="/Messages/4781649/DuplicateHandle-returns-access-denied"><img src="https://www.codeproject.com/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent"  style="width:16px;height:16px;border:0" /></a></div>Try to run your code in a Service!<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4530979_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx4530979xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="4530979" parent="0" thread="4530979" href="/Messages/4530979/Build-Note">Build Note</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Roger65</span><span class="date">2-Apr-13  3:29</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=156576">Roger65</a></span></td><td class="date"><span>2-Apr-13  3:29&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F4530979_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="156576" data-objectref="3_4530979" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">Env: VS2010. Windows 7<br />
<br />
can only do 1 build.  the next time the dll can't be accessed because windows explorer has a lock on it.  I guess it's when the dll is registered?<br />
<div class="signature">Old dog learning new tricks!</div><br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4496720_h0" class="header hover-row root">
<td class="subject-line normal vote-hi " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx4496720xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="4496720" parent="0" thread="4496720" href="/Messages/4496720/My-vote-of-5">My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Franc Morales</span><span class="date">15-Feb-13  2:19</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=649740">Franc Morales</a></span></td><td class="date"><span>15-Feb-13  2:19&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F4496720_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="649740" data-objectref="3_4496720" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">Thank you for sharing.<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4463484_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx4463484xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="4463484" parent="0" thread="4463484" href="/Messages/4463484/My-vote-of-5">My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">WebMaster</span><span class="date">2-Jan-13  15:20</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=6731395">WebMaster</a></span></td><td class="date"><span>2-Jan-13  15:20&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F4463484_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="6731395" data-objectref="3_4463484" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">Well done.<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4475765_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="38px" class="indent"><a name="xx4475765xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="4475765" parent="4463484" thread="4463484" href="/Messages/4475765/Re-My-vote-of-5">Re: My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author"><font color="0xFF000000">N</font>aveen</span><span class="date">18-Jan-13  23:39</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=1599046"><font color="0xFF000000">N</font>aveen</a></span></td><td class="date"><span>18-Jan-13  23:39&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F4475765_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="38"><span class="rating-vote vertical" data-ownerid="1599046" data-objectref="3_4475765" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4463484);" href="/Messages/4463484/My-vote-of-5"><img src="https://www.codeproject.com/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent"  style="width:16px;height:16px;border:0" /></a></div>Thanks Phat..<br />
<div class="signature">nave<br />
<br />
<small><a href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=1599046">[My Articles]</a>  <a href="http://0memory.blogspot.com/">[My Blog]</a></small></div><br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4461387_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx4461387xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="4461387" parent="0" thread="4461387" href="/Messages/4461387/Command-Line-Arguments-for-Application">Command Line Arguments for Application</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">yashvi_rsy</span><span class="date">29-Dec-12  3:58</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=5571688">yashvi_rsy</a></span></td><td class="date"><span>29-Dec-12  3:58&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F4461387_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="5571688" data-objectref="3_4461387" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">Dear Naveen,<br />
<br />
Can you please modify project so that we can send command prompt arguments for "Path"?<br />
It will be also very usefull if filtered application list get save in csv,txt format.<br />
<br />
Thanks<br />
Yashvi<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4462098_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="38px" class="indent"><a name="xx4462098xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer" /></td><td class="subject hover-container"><a class="message-link" name="4462098" parent="4461387" thread="4461387" href="/Messages/4462098/Re-Command-Line-Arguments-for-Application">Re: Command Line Arguments for Application</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author"><font color="0xFF000000">N</font>aveen</span><span class="date">30-Dec-12  17:20</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=1599046"><font color="0xFF000000">N</font>aveen</a></span></td><td class="date"><span>30-Dec-12  17:20&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F4462098_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="38"><span class="rating-vote vertical" data-ownerid="1599046" data-objectref="3_4462098" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4461387);" href="/Messages/4461387/Command-Line-Arguments-for-Application"><img src="https://www.codeproject.com/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent"  style="width:16px;height:16px;border:0" /></a></div><blockquote class="FQ"><div class="FQA">yashvi_rsy wrote:</div>Can you please modify project so that we can send command prompt arguments for <br />
"Path"?<br></blockquote><br />
the application already accepts path as command line, but that it shows the output in the list control only.<br />
<br />
I will try to implement your suggestion. may be on next version..<br />
<br />
Thanks<br />
<div class="signature">nave<br />
<br />
<small><a href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=1599046">[My Articles]</a>  <a href="http://0memory.blogspot.com/">[My Blog]</a></small></div><br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4459245_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx4459245xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="4459245" parent="0" thread="4459245" href="/Messages/4459245/Great-work">Great work</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">Sajeesh Payolam</span><span class="date">24-Dec-12  23:10</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=8119174">Sajeesh Payolam</a></span></td><td class="date"><span>24-Dec-12  23:10&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F4459245_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="8119174" data-objectref="3_4459245" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">Good article naveen <img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/smiley_smile.gif" align="top" alt="Smile | :)" /><br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4459566_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="38px" class="indent"><a name="xx4459566xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer" /></td><td class="subject hover-container"><a class="message-link" name="4459566" parent="4459245" thread="4459245" href="/Messages/4459566/Re-Great-work">Re: Great work</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author"><font color="0xFF000000">N</font>aveen</span><span class="date">25-Dec-12  17:25</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=1599046"><font color="0xFF000000">N</font>aveen</a></span></td><td class="date"><span>25-Dec-12  17:25&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F4459566_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="38"><span class="rating-vote vertical" data-ownerid="1599046" data-objectref="3_4459566" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4459245);" href="/Messages/4459245/Great-work"><img src="https://www.codeproject.com/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent"  style="width:16px;height:16px;border:0" /></a></div>Thanks <img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/smiley_smile.gif" align="top" alt="Smile | :)" /> <br />
<div class="signature">nave<br />
<br />
<small><a href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=1599046">[My Articles]</a>  <a href="http://0memory.blogspot.com/">[My Blog]</a></small></div><br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4453095_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="20px" class="indent"><a name="xx4453095xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question" /></td><td class="subject hover-container"><a class="message-link" name="4453095" parent="0" thread="4453095" href="/Messages/4453095/vb-net-support">vb.net support</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">yashvi_rsy</span><span class="date">15-Dec-12  6:35</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=5571688">yashvi_rsy</a></span></td><td class="date"><span>15-Dec-12  6:35&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F4453095_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="20"><span class="rating-vote vertical" data-ownerid="5571688" data-objectref="3_4453095" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2">hi,<br />
we need to use this function in vb.net , but we are not able to create refrence od dlls.<br />
please helpme urgently.<br />
thanks<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4453643_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="38px" class="indent"><a name="xx4453643xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer" /></td><td class="subject hover-container"><a class="message-link" name="4453643" parent="4453095" thread="4453095" href="/Messages/4453643/Re-vb-net-support">Re: vb.net support</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author"><font color="0xFF000000">N</font>aveen</span><span class="date">16-Dec-12  16:24</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=1599046"><font color="0xFF000000">N</font>aveen</a></span></td><td class="date"><span>16-Dec-12  16:24&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F4453643_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="38"><span class="rating-vote vertical" data-ownerid="1599046" data-objectref="3_4453643" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4453095);" href="/Messages/4453095/vb-net-support"><img src="https://www.codeproject.com/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent"  style="width:16px;height:16px;border:0" /></a></div>Check this comment at bottom <a href="http://www.codeproject.com/Articles/18975/Listing-Used-Files?msg=4230225#xx4230225xx">Use in VB6</a>[<a href="http://www.codeproject.com/Articles/18975/Listing-Used-Files?msg=4230225#xx4230225xx" target="_blank" title="New Window">^</a>]<br />
<div class="signature">nave<br />
<br />
<small><a href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=1599046">[My Articles]</a>  <a href="http://0memory.blogspot.com/">[My Blog]</a></small></div><br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4461389_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="56px" class="indent"><a name="xx4461389xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="4461389" parent="4453643" thread="4453095" href="/Messages/4461389/Re-vb-net-support">Re: vb.net support</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">yashvi_rsy</span><span class="date">29-Dec-12  4:01</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=5571688">yashvi_rsy</a></span></td><td class="date"><span>29-Dec-12  4:01&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F4461389_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="56"><span class="rating-vote vertical" data-ownerid="5571688" data-objectref="3_4461389" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4453643);" href="/Messages/4453643/Re-vb-net-support"><img src="https://www.codeproject.com/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent"  style="width:16px;height:16px;border:0" /></a></div>Dear Naveen,<br />
<br />
Please Describe this<br />
<br />
"Recompile the code and change the calling convention to __stdcall<br />
2) create another c/c++ dll in which there should be a function that call GetOpenedFiles internally. Also you need to export this function in the new with __stdcall calling convention.<br />
<br />
I hope you know how to call a C function from vb6."<br />
<br />
I am not good in c/C++ and need to implement in VB.Net<br />
<br />
Thank you in Advance<br />
Yashvi<br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr id="F4462095_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td width="74px" class="indent"><a name="xx4462095xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="4462095" parent="4461389" thread="4453095" href="/Messages/4462095/Re-vb-net-support">Re: vb.net support</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://www.codeproject.com/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author"><font color="0xFF000000">N</font>aveen</span><span class="date">30-Dec-12  17:12</span>
</div></td><td class="icon"><img border="0" src="https://www.codeproject.com/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=1599046"><font color="0xFF000000">N</font>aveen</a></span></td><td class="date"><span>30-Dec-12  17:12&nbsp;</span></td>
</tr>
</table></td>
</tr><tr id="F4462095_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr valign="top">
<td class="indent align-right voteform" width="74"><span class="rating-vote vertical" data-ownerid="1599046" data-objectref="3_4462095" data-votingtype="GoodOrBad"></span></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4461389);" href="/Messages/4461389/Re-vb-net-support"><img src="https://www.codeproject.com/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent"  style="width:16px;height:16px;border:0" /></a></div>Sorry, I miss read you are using VB6, in vb.net it is easy,<br />
<br />
check this commment <a href="http://www.codeproject.com/Articles/18975/Listing-Used-Files?msg=3631245#xx3631245xx">Re: Use the dll in a visual studio project</a>[<a href="http://www.codeproject.com/Articles/18975/Listing-Used-Files?msg=3631245#xx3631245xx" target="_blank" title="New Window">^</a>]<br />
<div class="signature">nave<br />
<br />
<small><a href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=1599046">[My Articles]</a>  <a href="http://0memory.blogspot.com/">[My Blog]</a></small></div><br /></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr>
</table></td>
</tr><tr>
<td><table width="100%" cellpadding="2px" cellspacing="0">
<tr class="footer">
<td><span class="last-visit desktop-only tablet-only">Last Visit: 6-Dec-20  22:46 &nbsp; &nbsp; Last Update: 6-Dec-20  22:46</span></td><td><a rel="nofollow" href="/Articles/18975/Listing-Used-Files?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True">Refresh</a></td><td align="right" nowrap="nowrap"><input id="_mbnUrl" type="hidden" value="/Articles/18975/Listing-Used-Files?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;fr=26" /><span class="nav-link selected">1</span><a class="nav-link" name="Frm_HoverNL" href="/Articles/18975/Listing-Used-Files?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;fr=26#xx0xx">2</a><a class="nav-link" name="Frm_HoverNL" href="/Articles/18975/Listing-Used-Files?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;fr=51#xx0xx">3</a><a class="nav-link" name="Frm_HoverNL" href="/Articles/18975/Listing-Used-Files?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;fr=76#xx0xx">4</a><a class="nav-link" name="Frm_HoverNL" href="/Articles/18975/Listing-Used-Files?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;fr=101#xx0xx">5</a><a class="nav-link" name="Frm_HoverNL" href="/Articles/18975/Listing-Used-Files?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;fr=126#xx0xx">6</a><a class="nav-link" name="Frm_HoverNL" href="/Articles/18975/Listing-Used-Files?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;fr=151#xx0xx">7</a><a class="nav-link" name="Frm_HoverNL" href="/Articles/18975/Listing-Used-Files?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;fr=176#xx0xx">8</a><a class="nav-link" name="Frm_HoverNL" href="/Articles/18975/Listing-Used-Files?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;fr=201#xx0xx">9</a> <a class="nav-link" name="Frm_HoverNL" href="/Articles/18975/Listing-Used-Files?fid=422864&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;fr=26#xx0xx">Next ᐅ</a></td>
</tr>
</table></td>
</tr>
</table>
</div><p class="small-text"><img align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_general.gif" width="16px" height="16px" alt="General" /> General &nbsp;&nbsp; <img align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_news.gif" width="16px" height="16px" alt="News" /> News &nbsp;&nbsp; <img align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_idea.gif" width="16px" height="16px" alt="Suggestion" /> Suggestion &nbsp;&nbsp; <img align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_question.gif" width="16px" height="16px" alt="Question" /> Question &nbsp;&nbsp; <img align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_bug.gif" width="16px" height="16px" alt="Bug" /> Bug &nbsp;&nbsp; <img align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_answer.gif" width="16px" height="16px" alt="Answer" /> Answer &nbsp;&nbsp; <img align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_joke.gif" width="16px" height="16px" alt="Joke" /> Joke &nbsp;&nbsp; <img align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_kudos.gif" width="16px" height="16px" alt="Praise" /> Praise &nbsp;&nbsp; <img align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_rant.gif" width="16px" height="16px" alt="Rant" /> Rant &nbsp;&nbsp; <img align="top" src="https://codeproject.freetls.fastly.net/script/Forums/Images/msg_admin.gif" width="16px" height="16px" alt="Admin" /> Admin &nbsp;&nbsp; </p><p class="small-text">Use Ctrl+Left/Right to switch messages, Ctrl+Up/Down to switch threads, Ctrl+Shift+Left/Right to switch pages.</p>
				

			</div>
			

            
            <div id="ctl00_RightSideBar" class="article-right-sidebar">

				

                <div id="RHSticky" class="container-article-info-sticky">

        		    

<div class="article-summary">

    
    

</div>

				    <div id="ctl00_SectionSponsor" class="padded-top" style="width:160px;margin:10px auto">
					    <div class="msg-160x200" data-format="160x200" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Desktop-Development/Shell-and-IE-programming/General"  data-country='US' data-showindicator="true"  data-tags='VC6, C++, Windows, Dev, Intermediate,rating4.5'><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Desktop-Development/Shell-and-IE-programming/General&sz=160x200&c=268289"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Desktop-Development/Shell-and-IE-programming/General&sz=160x200&c=268289"  width="160px" height="200px" target="_blank"/></a></noscript></div>
				    </div>

				    <div style="width:160px;margin: 10px auto;">
					    <div class="msg-160x600" data-format="160x600" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Desktop-Development/Shell-and-IE-programming/General"  data-country='US' data-tags='VC6, C++, Windows, Dev, Intermediate,rating4.5'><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Desktop-Development/Shell-and-IE-programming/General&sz=160x600&c=268289"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Desktop-Development/Shell-and-IE-programming/General&sz=160x600&c=268289"  width="160px" height="600px" target="_blank"/></a></noscript></div>
				    </div>

                    

				    

				    

                    <div class="anchorLink gototop" id="gototop">
                        <a id="ctl00_GoToTop" href="/Articles/18975/Listing-Used-Files#_articleTop">Go to top</a>
                    </div>

			    </div>
            </div>
            

        </div>
        

		
		<div class="theme1-background" style="height:2px;margin:5px 0" id="stickyStop"></div>

		<div class="site-footer">
			<div class="align-left">
				<a id="ctl00_PermaLink" href="/Articles/18975/Listing-Used-Files">Permalink</a><br>
				<a id="ctl00_AdvertiseLink" href="http://developermedia.com/">Advertise </a><br>
				<a id="ctl00_PrivacyLink" href="/info/privacy.aspx">Privacy</a><br>
    			<a id="ctl00_CookiePolicyLink" href="/info/cookie.aspx">Cookies</a><br>
                <a id="ctl00_TermsOfUseLink" href="/info/TermsOfUse.aspx">Terms of Use</a><br>
			</div>

            <div class="align-center">
				


<div class="page-width">
    Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="/Articles/18975/Listing-Used-Files?PageFlow=FixedWidth">fixed</a>
    |
    <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="/Articles/18975/Listing-Used-Files?PageFlow=Fluid">fluid</a>
</div>


				

				

	            

                <br>
			</div>
                
			<div class="align-right">
				Article Copyright 2007 by <font color="0xFF000000">N</font>aveen<br />Everything else
				Copyright &copy; <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2020 <br />
                <br>
				Web06 
				2.8.20201130.1<br>
			</div>
		</div>
		

		<br clear="all" />
		
			

	</div> 
	</div> 
</div>



<img id="ctl00_Audience" src="https://pubads.g.doubleclick.net/activity;dc_iu=/6839/DFPAudiencePixel;ord=&#39;637429095752955738&#39;;dc_seg=33705250?" border="0" height="1" width="1" />



<script type="text/javascript"> // IMMEDIATE script

function Join() {
                                     document.location.href = 'https://www.codeproject.com/script/Membership/Modify.aspx';
                                     return false;
                                  }

var jucmpyxbiy = function(n){var t=!1;n=n||{};var r=n.RetrievalServiceUrl||"/script/content/webservices/RetrieveContent.aspx/GetContent",u=n.RetrievalServiceRetries||3,f=n.RetrievalServiceTimeout||5e3,e=function(){t||(t=!0,$(window).on("resize scroll",i),i())},i=function(){if(typeof DMAds=="undefined"){var n=$('[data-type="ad"]');n.each(function(){var n=$(this),u=n.attr("data-format")||"",f=n.attr("data-publisher")||"",e=n.attr("data-zone")||"",t=n.attr("data-loadonview"),i=n.attr("data-noadx"),h=n.attr("data-tags")||"",c=n.find("iframe").length!==0||n.find("img").length!==0,r=n.attr("data-processed");t=typeof t=="string"&&t.toLowerCase()==="true";i=typeof i=="string"&&i.toLowerCase()==="true";r=typeof r=="string"&&r.toLowerCase()==="true";r||c||t&&!s(this)||(o(n,u,f,e,i,h),n.attr("data-processed","true"))})}},o=function(n,t,i,e,o,s){var h=new $.Deferred,c=JSON.stringify({format:t,publisherCode:i,zone:e,noAdX:o,keywords:s});$.ajax({url:r,cache:!1,type:"POST",data:c,contentType:"application/json; charset=utf-8",dataType:"json",tryCount:0,retryLimit:u,timeout:f}).done(function(t){var i=t?t.d:null;h.resolve(i); i && i.html && n.html(i.html)}).fail(function(n,t){h.reject(t)})},s=function(n){var t,f,e,o;if(!h(n))return!1;var u=!1,i=0,r=0;try{t=n.getBoundingClientRect();typeof innerWidth=="number"?(i=window.innerWidth,r=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(i=document.documentElement.clientWidth,r=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(i=document.body.clientWidth,r=document.body.clientHeight);f=-200;t.top===t.bottom&&(f+=n.height*-1);e=t.top>=0&&t.top-200<=r||t.top<=0&&t.top>=f;o=i>t.left&&t.right>=0;u=e&&o}catch(s){u=!0}return u},h=function(n){var t=!1,i;return n&&n.style.position!=="fixed"&&n.offsetParent?t=!0:n&&n.style.position==="fixed"&&(i=window.getComputedStyle(n),t=i&&i.display!=="none"),t&&c()},c=function(){var t=!0,n="";return typeof document.hidden!="undefined"?n="hidden":typeof document.mozHidden!="undefined"?n="mozHidden":typeof document.msHidden!="undefined"?n="msHidden":typeof document.webkitHidden!="undefined"&&(n="webkitHidden"),n!==null&&document[n]&&(t=!1),t};return{init:e}};
document.addEventListener('DOMContentLoaded', function() {
var n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP"),t;n.onreadystatechange=function(){try{if(n.readyState==4)if(n.status==200){var t=document.createElement("script");t.type="text/javascript";t.innerHTML=n.responseText;document.getElementsByTagName("body")[0].appendChild(t)}else(new jucmpyxbiy).init()}catch(i){(new jucmpyxbiy).init()}};try{t='/a.min.js?v=1.3';n.open("GET",t,!0);n.send()}catch(i){(new jucmpyxbiy).init()}

  $('div[data-type="ad"][data-showindicator="true"]').before('<div class="small-text muted hidden">Advertisement</div>');
  setTimeout(function(){ 
    $('div[data-type="ad"][data-showindicator="true"]').each(function( index ) {
      if ($(this).height() > 0) {
       $(this).prev().removeClass('hidden');
      }
    });
  }, 2000);

});

var ratingCtrl_ctl00_RateArticle;

var forumConfig_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard_forumMsgFlag;
var forumCtrl_ctl00_MessageBoard_rating;
var forumCtrl_ctl00_MessageBoard_ratingConfig;

var subscriptionConfig_ctl00_MessageBoard = {
 ParentId      : 'ctl00_MessageBoard_SubscribeDiv',
 NewId         : 'ctl00_MessageBoard_SubscribeNew',
 ReplyId       : 'ctl00_MessageBoard_SubscribeReplies',
 InstantId     : 'ctl00_MessageBoard_SubscribeInstant',
 DailyId       : 'ctl00_MessageBoard_SubscribeDaily',
 MessageTypeId : 'ctl00_MessageBoard_MessageType',
 GetInfoUrl    : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/GetSubscriptions',
 UpdateInfoUrl : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/UpdateSubscription',
 ForumId       : 422864,
};
var subscriptions_ctl00_MessageBoard;
</script>

<script type="text/javascript"> // DEFERRED script

document.addEventListener('DOMContentLoaded', function() {

	ProcessCodeBlocks.Initialise('#contentdiv');
	
	$('.author-wrapper .description').shorten({showChars: 400});
	
	anchorAnimate();
	$('#RHSticky').sticky($('#stickyStop'));
	$('#ctl00_StickyBlock').sticky($('#stickyStop'));
	
	$('#__EVENTVALIDATION').attr('autocomplete', 'off');
	
	$('#joinBtn').css('visibility', 'visible');
	
	$('.oauth').click(function () {
	    $this = $(this);
	    href = $this.attr('href');
	    var myWindow = window.open(href, 'popup',
	                              'width=800,height=600,location=0,menubar=0,resizeable=0,scrollbars=0,toolbar=0');
	    myWindow.focus();
	    var timer = setInterval(function () {
	        if (myWindow.closed) {
	            clearInterval(timer);
	            // window.location.reload(); // May do a POST reload, shows a warning
	            window.location = window.location; // force a GET reload
	        }
	    }, 200);
	    return false;
	});
	
	var oSrchFlt = false, oSrchBox=false, srchBoxFoc=false;
	var sbar     = $('#sb_tb');
	var sfilter  = $('#SearchFilter');
	
	if (typeof(InitWatermark) !== 'undefined')
	  InitWatermark('sb_tb', 'Search for articles, questions, tips');
	if (sbar && sfilter) {
	  sfilter.removeClass('popup'); sfilter.hide(); sfilter.removeClass('open');
	  sbar.blur(function() {
	    if (!oSrchFlt) { sfilter.hide(); sfilter.removeClass('open'); }
	    srchBoxFoc = false;
	  });
	  sbar.focus(function() {
	    oSrchFlt   = false;
	    srchBoxFoc = true;
	    sfilter.show();
	    sfilter.addClass('open');
	  });
	  sbar.mouseleave(function()    { oSrchBox = false; });
	  sbar.mouseover(function()     { oSrchBox = true; });
	  sfilter.mouseleave(function() {
	    oSrchFlt=false;
	    if (!srchBoxFoc && !oSrchBox) { sfilter.hide(); sfilter.removeClass('open'); }
	  });
	  sfilter.mouseover(function()  { oSrchFlt = true; });
	}
	
	var ratingConfig_ctl00_RateArticle = {
	  objectRef:          '2_18975_2',
	  objectSubtypeId:    1,
	  objectTypeName:     'article',
	  ownerId:            1599046,
	  votingType:         'None',
	  ratingDisplayMode:  'LargeStars',
	  resultDisplayMode:  'LargeStars',
	  ratingCallback:     null,
	  staticServer:       'https://www.codeproject.com',
	  baseDir:            '/script/Ratings/',
	  ratingUrl:          'ajax/RateItem.aspx',
	  histogramUrl:       'ajax/Histogram.aspx',
	  getRatingUrl:       'ajax/GetRatings.aspx',
	  width:              130,
	  forceComment:       false,
	  lowVoteThreshold:   0,
	  minRating:          1,
	  maxRating:          5
	};
	ratingCtrl_ctl00_RateArticle = new RatingControl('#ctl00_RateArticle_RatingTable',ratingConfig_ctl00_RateArticle);
	
	forumConfig_ctl00_MessageBoard_ratingConfig = {
	  objectTypeId:       3,
	  objectTypeName:     'message',
	  bulkResultSelector: '#_MessageBoardctl00_MessageBoard',
	  votingType:         'GoodOrBad',
	  staticServer:       'https://www.codeproject.com',
	  forceComment:       false,
	  ratingDisplayMode:  'TextOnly',
	  resultDisplayMode:  'TextOnly'
	};
	forumCtrl_ctl00_MessageBoard_rating = new RatingControl('#_MessageBoardctl00_MessageBoard .content', forumConfig_ctl00_MessageBoard_ratingConfig);
	forumConfig_ctl00_MessageBoard = {
	    objectName          : 'forumCtrl_ctl00_MessageBoard',
	    messageTypeId       : 3,
	    searchPrompt        : 'Search Comments',
	    smoothScroll        : true,
	    allowReporting      : false,
	    allowRating         : false,
	    allowRatingDisplay  : true,
	    forumDir            : '/script/Forums/',
	    staticServer        : 'https://www.codeproject.com',
	    switchMsgCallback   : null,
	    ratingControl       : forumCtrl_ctl00_MessageBoard_rating,
	    getReportFormMethod : getReportFormHtml,
	    voteHiThreshold     : 5 - 0.5,
	    reportOptions       : [
	       { reportTypeId : 19, name : 'Abusive / Trolling'},
	       { reportTypeId : 20, name : 'Inappropriate'},
	       { reportTypeId : 5, name : 'Spam'},
	    ],
	};
	forumCtrl_ctl00_MessageBoard = new ForumControl('#ForumTable',forumConfig_ctl00_MessageBoard, -1);
	forumCtrl_ctl00_MessageBoard_rating.setConfig('ratingCallback', forumCtrl_ctl00_MessageBoard.showMessageRating);
	forumCtrl_ctl00_MessageBoard.Initialise();
	
	subscriptions_ctl00_MessageBoard = new Subscriptions(subscriptionConfig_ctl00_MessageBoard);
	subscriptions_ctl00_MessageBoard.initialise();
	
	cookieconsent.initialise({
	                                    enabled : true,
	                                    cookie  : { domain: 'codeproject.com' },
	                                    palette : {
	                                        popup: { background: '#ff9900' },
	                                        button: { background: '#f5d948' }
	                                    },
	                                    law :  {
	                                        showForAllRegions : true, 
	                                        countryCode : 'US' 
	                                    },
	                                    theme: 'edgeless',
	                                    type : 'opt-in',
	                                    content: {
	                                        message: 'Like every other website we use cookies. By using our site you acknowledge that you have read and understand our <a href=\'/info/cookie.aspx\'>Cookie Policy</a>, <a href=\'/info/privacy.aspx\'>Privacy Policy</a>, and our <a href=\'/info/TermsOfUse.aspx\'>Terms of Service</a>.',
	                                        href:    'https://www.codeproject.com/info/privacy.aspx',
	                                        dismiss: 'Ask me later'
	                                    },
	                                    revokable:true,
	                                    onStatusChange: function(status) {
	                                        $.ajax({
	                                		    dataType  : 'json',
	                                            data: JSON.stringify({ allowCookies : this.hasConsented() }),
	                                            url: '/script/membership/webservices/LoggedOnMemberservices.aspx/SetCookieConsent',
	                                            cache: false,
	                                            type: 'POST',
	                                            contentType: 'application/json'
	                                        })
	                                        console.log(this.hasConsented() ? 'enable cookies' : 'disable cookies');
	                                        console.log(this.hasAnswered() ? 'has answered' : 'did not answer');
	                                    },
	                                });

})
</script>








</body>

</html>