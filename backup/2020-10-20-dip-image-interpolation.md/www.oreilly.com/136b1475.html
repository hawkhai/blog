<!DOCTYPE html>
<!--[if lt IE 10]><html class="no-js ie8 oldie" lang="en" prefix="og: http://ogp.me/ns/# og:book: http://ogp.me/ns/book# og:video: http://ogp.me/ns/video#"

  
    itemscope itemtype="http://schema.org/Book http://schema.org/ItemPage" data-offline-url="/"
data-url="/library/view/python-data-science/9781491912126/ch04.html"

data-archive="9781491912126"
data-publishers="O&#x27;Reilly Media, Inc."


  data-htmlfile-name="ch04.html"
  data-epub-title="Python Data Science Handbook"
  


data-federated-auth-enabled="true"

data-env="production"
data-debug="0" ><![endif]-->
<!--[if gt IE 9]><!--><html class="no-js" lang="en" prefix="og: http://ogp.me/ns/# og:book: http://ogp.me/ns/book# og:video: http://ogp.me/ns/video#"

  
    itemscope itemtype="http://schema.org/Book http://schema.org/ItemPage" data-offline-url="/"
data-url="/library/view/python-data-science/9781491912126/ch04.html"

data-archive="9781491912126"
data-publishers="O&#x27;Reilly Media, Inc."


  data-htmlfile-name="ch04.html"
  data-epub-title="Python Data Science Handbook"
  


data-federated-auth-enabled="true"

data-env="production"
data-debug="0" ><!--<![endif]-->
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>4. Visualization with Matplotlib - Python Data Science Handbook [Book]</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="/library/view/static/CACHE/css/output.a33a000c6aec.css" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro' rel='stylesheet' type='text/css' />
    <link rel="stylesheet" type="text/css" href="https://cdn.oreillystatic.com/assets/css/2018_font_face.css" />
    

    <meta property="og:title" content="Python Data Science Handbook" />
    <meta itemprop="isPartOf" content="/library/view/python-data-science/9781491912126/" />
    <meta itemprop="name" content="4. Visualization with Matplotlib" />
    
    <meta property="og:url" itemprop="url" content="https://www.oreilly.com/library/view/python-data-science/9781491912126/ch04.html" />
    <meta property="og:site_name" content="O’Reilly Online Learning" />
    <meta property="og:image" itemprop="thumbnailUrl" content="https://www.oreilly.com/library/cover/9781491912126/" />
    
    <meta property="og:image:secure_url" itemprop="thumbnailUrl" content="https://learning.oreilly.com/library/cover/9781491912126/360h/">
    <meta property="og:description" itemprop="description" name="description" content=" Chapter 4. Visualization with Matplotlib We’ll now take an in-depth look at the Matplotlib tool for visualization in Python. Matplotlib is a multiplatform data visualization library built on NumPy arrays, …  - Selection from Python Data Science Handbook [Book]">
    
    <meta itemprop="inLanguage" content="en" />
    
    <meta itemprop="publisher" content="O&#x27;Reilly Media, Inc." />
    
    <meta property="og:type" content="article" />
    <meta property="og:book:isbn" itemprop="isbn" content="9781491912058" />
    
    <meta property="og:book:author" itemprop="author" content="Jake VanderPlas" />
    
    
    
    
    <meta property="og:image:width" content="400">
    <meta property="og:image:height" content="400">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@OReillyMedia">

<!-- Start Visual Website Optimizer Asynchronous Code -->
<script type='text/javascript'>
var _vwo_code=(function(){
var account_id=291788,
settings_tolerance=2000,
library_tolerance=2500,
use_existing_jquery=false,
/* DO NOT EDIT BELOW THIS LINE */
f=false,d=document;return{use_existing_jquery:function(){return use_existing_jquery;},library_tolerance:function(){return library_tolerance;},finish:function(){if(!f){f=true;var a=d.getElementById('_vis_opt_path_hides');if(a)a.parentNode.removeChild(a);}},finished:function(){return f;},load:function(a){var b=d.createElement('script');b.src=a;b.type='text/javascript';b.innerText;b.onerror=function(){_vwo_code.finish();};d.getElementsByTagName('head')[0].appendChild(b);},init:function(){settings_timer=setTimeout('_vwo_code.finish()',settings_tolerance);var a=d.createElement('style'),b='body{opacity:0 !important;filter:alpha(opacity=0) !important;background:none !important;}',h=d.getElementsByTagName('head')[0];a.setAttribute('id','_vis_opt_path_hides');a.setAttribute('type','text/css');if(a.styleSheet)a.styleSheet.cssText=b;else a.appendChild(d.createTextNode(b));h.appendChild(a);this.load('//dev.visualwebsiteoptimizer.com/j.php?a='+account_id+'&u='+encodeURIComponent(d.URL)+'&r='+Math.random());return settings_timer;}};}());_vwo_settings_timer=_vwo_code.init();
</script>
<!-- End Visual Website Optimizer Asynchronous Code -->

    <link class="t-canonical-link" rel="canonical" href="https://www.oreilly.com/library/view/python-data-science/9781491912126/ch04.html" />

    <link rel="shortcut icon" href="//www.oreilly.com/favicon.ico" type="image/vnd.microsoft.icon" />
    <link rel="apple-touch-icon" href="/library/view/static/images/apple-touch-icon.png" />
    

  
    <style type="text/css" title="ibis-book">
    @charset "utf-8";#sbo-rt-content html,#sbo-rt-content div,#sbo-rt-content div,#sbo-rt-content span,#sbo-rt-content applet,#sbo-rt-content object,#sbo-rt-content iframe,#sbo-rt-content h1,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5,#sbo-rt-content h6,#sbo-rt-content p,#sbo-rt-content blockquote,#sbo-rt-content pre,#sbo-rt-content a,#sbo-rt-content abbr,#sbo-rt-content acronym,#sbo-rt-content address,#sbo-rt-content big,#sbo-rt-content cite,#sbo-rt-content code,#sbo-rt-content del,#sbo-rt-content dfn,#sbo-rt-content em,#sbo-rt-content img,#sbo-rt-content ins,#sbo-rt-content kbd,#sbo-rt-content q,#sbo-rt-content s,#sbo-rt-content samp,#sbo-rt-content small,#sbo-rt-content strike,#sbo-rt-content strong,#sbo-rt-content sub,#sbo-rt-content sup,#sbo-rt-content tt,#sbo-rt-content var,#sbo-rt-content b,#sbo-rt-content u,#sbo-rt-content i,#sbo-rt-content center,#sbo-rt-content dl,#sbo-rt-content dt,#sbo-rt-content dd,#sbo-rt-content ol,#sbo-rt-content ul,#sbo-rt-content li,#sbo-rt-content fieldset,#sbo-rt-content form,#sbo-rt-content label,#sbo-rt-content legend,#sbo-rt-content table,#sbo-rt-content caption,#sbo-rt-content tdiv,#sbo-rt-content tfoot,#sbo-rt-content thead,#sbo-rt-content tr,#sbo-rt-content th,#sbo-rt-content td,#sbo-rt-content article,#sbo-rt-content aside,#sbo-rt-content canvas,#sbo-rt-content details,#sbo-rt-content embed,#sbo-rt-content figure,#sbo-rt-content figcaption,#sbo-rt-content footer,#sbo-rt-content header,#sbo-rt-content hgroup,#sbo-rt-content menu,#sbo-rt-content nav,#sbo-rt-content output,#sbo-rt-content ruby,#sbo-rt-content section,#sbo-rt-content summary,#sbo-rt-content time,#sbo-rt-content mark,#sbo-rt-content audio,#sbo-rt-content video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}#sbo-rt-content article,#sbo-rt-content aside,#sbo-rt-content details,#sbo-rt-content figcaption,#sbo-rt-content figure,#sbo-rt-content footer,#sbo-rt-content header,#sbo-rt-content hgroup,#sbo-rt-content menu,#sbo-rt-content nav,#sbo-rt-content section{display:block}#sbo-rt-content div{line-height:1}#sbo-rt-content ol,#sbo-rt-content ul{list-style:none}#sbo-rt-content blockquote,#sbo-rt-content q{quotes:none}#sbo-rt-content blockquote:before,#sbo-rt-content blockquote:after,#sbo-rt-content q:before,#sbo-rt-content q:after{content:none}#sbo-rt-content table{border-collapse:collapse;border-spacing:0}@page{margin:5px !important}#sbo-rt-content p{margin:10px 0 0;line-height:125%;text-align:left}#sbo-rt-content p.byline{text-align:left;margin:-33px auto 35px;font-style:italic;font-weight:bold}#sbo-rt-content div.preface p+p.byline{margin:1em 0 0 !important}#sbo-rt-content div.preface p.byline+p.byline{margin:0 !important}#sbo-rt-content div.sect1>p.byline{margin:-.25em 0 1em}#sbo-rt-content div.sect1>p.byline+p.byline{margin-top:-1em}#sbo-rt-content em{font-style:italic;font-family:inherit}#sbo-rt-content em strong,#sbo-rt-content strong em{font-weight:bold;font-style:italic;font-family:inherit}#sbo-rt-content strong,#sbo-rt-content span.bold{font-weight:bold}#sbo-rt-content em.replaceable{font-style:italic}#sbo-rt-content strong.userinput{font-weight:bold;font-style:normal}#sbo-rt-content span.bolditalic{font-weight:bold;font-style:italic}#sbo-rt-content a.ulink,#sbo-rt-content a.xref,#sbo-rt-content a.email,#sbo-rt-content a.link,#sbo-rt-content a{text-decoration:none;color:#8e0012}#sbo-rt-content span.lineannotation{font-style:italic;color:#a62a2a;font-family:serif}#sbo-rt-content span.underline{text-decoration:underline}#sbo-rt-content span.strikethrough{text-decoration:line-through}#sbo-rt-content span.smallcaps{font-variant:small-caps}#sbo-rt-content span.cursor{background:#000;color:#fff}#sbo-rt-content span.smaller{font-size:75%}#sbo-rt-content .boxedtext,#sbo-rt-content .keycap{border-style:solid;border-width:1px;border-color:#000;padding:1px}#sbo-rt-content span.gray50{color:#7F7F7F;}#sbo-rt-content h1,#sbo-rt-content div.toc-title,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5{-webkit-hyphens:none;hyphens:none;adobe-hyphenate:none;font-weight:bold;text-align:left;page-break-after:avoid !important;font-family:sans-serif,"DejaVuSans"}#sbo-rt-content div.toc-title{font-size:1.5em;margin-top:20px !important;margin-bottom:30px !important}#sbo-rt-content section[data-type="sect1"] h1{font-size:1.3em;color:#8e0012;margin:40px 0 8px 0}#sbo-rt-content section[data-type="sect2"] h2{font-size:1.1em;margin:30px 0 8px 0 !important}#sbo-rt-content section[data-type="sect3"] h3{font-size:1em;color:#555;margin:20px 0 8px 0 !important}#sbo-rt-content section[data-type="sect4"] h4{font-size:1em;font-weight:normal;font-style:italic;margin:15px 0 6px 0 !important}#sbo-rt-content section[data-type="chapter"]>div>h1,#sbo-rt-content section[data-type="preface"]>div>h1,#sbo-rt-content section[data-type="appendix"]>div>h1,#sbo-rt-content section[data-type="glossary"]>div>h1,#sbo-rt-content section[data-type="bibliography"]>div>h1,#sbo-rt-content section[data-type="index"]>div>h1{font-size:2em;line-height:1;margin-bottom:50px;color:#000;padding-bottom:10px;border-bottom:1px solid #000}#sbo-rt-content span.label,#sbo-rt-content span.keep-together{font-size:inherit;font-weight:inherit}#sbo-rt-content div[data-type="part"] h1{font-size:2em;text-align:center;margin-top:0 !important;margin-bottom:50px;padding:50px 0 10px 0;border-bottom:1px solid #000}#sbo-rt-content img.width-ninety{width:90%}#sbo-rt-content img{max-width:95%;margin:0 auto;padding:0}#sbo-rt-content div.figure{background-color:transparent;text-align:center !important;margin:15px 0 15px 0 !important;page-break-inside:avoid}#sbo-rt-content figure{margin:15px 0 15px 0 !important;page-break-inside:avoid}#sbo-rt-content div.figure h6,#sbo-rt-content figure h6,#sbo-rt-content figure figcaption{font-size:.9rem !important;text-align:center;font-weight:normal !important;font-style:italic;font-family:serif !important;text-transform:none !important;letter-spacing:normal !important;color:#000 !important;padding-top:10px !important;page-break-before:avoid}#sbo-rt-content div.informalfigure{text-align:center !important;padding:5px 0 !important}#sbo-rt-content div.sidebar{margin:15px 0 10px 0 !important;border:1px solid #DCDCDC;background-color:#F7F7F7;padding:15px !important;page-break-inside:avoid}#sbo-rt-content aside[data-type="sidebar"]{margin:15px 0 10px 0 !important;page-break-inside:avoid}#sbo-rt-content div.sidebar-title,#sbo-rt-content aside[data-type="sidebar"] h5{font-weight:bold;font-size:1em;font-family:sans-serif;text-transform:uppercase;letter-spacing:1px;text-align:center;margin:4px 0 6px 0 !important;page-break-inside:avoid}#sbo-rt-content div.sidebar ol,#sbo-rt-content div.sidebar ul,#sbo-rt-content aside[data-type="sidebar"] ol,#sbo-rt-content aside[data-type="sidebar"] ul{margin-left:1.25em !important}#sbo-rt-content div.sidebar div.figure p.title,#sbo-rt-content aside[data-type="sidebar"] figcaption,#sbo-rt-content div.sidebar div.informalfigure div.caption{font-size:90%;text-align:center;font-weight:normal;font-style:italic;font-family:serif !important;color:#000;padding:5px !important;page-break-before:avoid;page-break-after:avoid}#sbo-rt-content div.sidebar div.tip,#sbo-rt-content div.sidebar div[data-type="tip"],#sbo-rt-content div.sidebar div.note,#sbo-rt-content div.sidebar div[data-type="note"],#sbo-rt-content div.sidebar div.warning,#sbo-rt-content div.sidebar div[data-type="warning"],#sbo-rt-content div.sidebar div[data-type="caution"],#sbo-rt-content div.sidebar div[data-type="important"]{margin:20px auto 20px auto !important;font-size:90%;width:85%}#sbo-rt-content aside[data-type="sidebar"] p.byline{font-size:90%;font-weight:bold;font-style:italic;text-align:center;text-indent:0;margin:5px auto 6px;page-break-after:avoid}#sbo-rt-content pre{white-space:pre-wrap;font-family:"Ubuntu Mono",monospace;margin:25px 0 25px 20px;font-size:85%;display:block;-webkit-hyphens:none;hyphens:none;adobe-hyphenate:none;overflow-wrap:break-word}#sbo-rt-content div.note pre.programlisting,#sbo-rt-content div.tip pre.programlisting,#sbo-rt-content div.warning pre.programlisting,#sbo-rt-content div.caution pre.programlisting,#sbo-rt-content div.important pre.programlisting{margin-bottom:0}#sbo-rt-content code{font-family:"Ubuntu Mono",monospace;-webkit-hyphens:none;hyphens:none;adobe-hyphenate:none;overflow-wrap:break-word}#sbo-rt-content code strong em,#sbo-rt-content code em strong,#sbo-rt-content pre em strong,#sbo-rt-content pre strong em,#sbo-rt-content strong code em code,#sbo-rt-content em code strong code,#sbo-rt-content span.bolditalic code{font-weight:bold;font-style:italic;font-family:"Ubuntu Mono BoldItal",monospace}#sbo-rt-content code em,#sbo-rt-content em code,#sbo-rt-content pre em,#sbo-rt-content em.replaceable{font-family:"Ubuntu Mono Ital",monospace;font-style:italic}#sbo-rt-content code strong,#sbo-rt-content strong code,#sbo-rt-content pre strong,#sbo-rt-content strong.userinput{font-family:"Ubuntu Mono Bold",monospace;font-weight:bold}#sbo-rt-content div[data-type="example"]{margin:10px 0 15px 0 !important}#sbo-rt-content div[data-type="example"] h1,#sbo-rt-content div[data-type="example"] h2,#sbo-rt-content div[data-type="example"] h3,#sbo-rt-content div[data-type="example"] h4,#sbo-rt-content div[data-type="example"] h5,#sbo-rt-content div[data-type="example"] h6{font-style:italic;font-weight:normal;text-align:left !important;text-transform:none !important;font-family:serif !important;margin:10px 0 5px 0 !important;border-bottom:1px solid #000}#sbo-rt-content li pre.example{padding:10px 0 !important}#sbo-rt-content div[data-type="example"] pre[data-type="programlisting"],#sbo-rt-content div[data-type="example"] pre[data-type="screen"]{margin:0}#sbo-rt-content section[data-type="titlepage"]>div>h1{font-size:2em;margin:50px 0 10px 0 !important;line-height:1;text-align:center}#sbo-rt-content section[data-type="titlepage"] h2,#sbo-rt-content section[data-type="titlepage"] p.subtitle,#sbo-rt-content section[data-type="titlepage"] p[data-type="subtitle"]{font-size:1.3em;font-weight:normal;text-align:center;margin-top:.5em;color:#555}#sbo-rt-content section[data-type="titlepage"]>div>h2[data-type="author"],#sbo-rt-content section[data-type="titlepage"] p.author{font-size:1.3em;font-family:serif !important;font-weight:bold;margin:50px 0 !important;text-align:center}#sbo-rt-content section[data-type="titlepage"] p.edition{text-align:center;text-transform:uppercase;margin-top:2em}#sbo-rt-content section[data-type="titlepage"]{text-align:center}#sbo-rt-content section[data-type="titlepage"]:after{content:url(css_assets/titlepage_footer_ebook.png);margin:0 auto;max-width:80%}#sbo-rt-content div.book div.titlepage div.publishername{margin-top:60%;margin-bottom:20px;text-align:center;font-size:1.25em}#sbo-rt-content div.book div.titlepage div.locations p{margin:0;text-align:center}#sbo-rt-content div.book div.titlepage div.locations p.cities{font-size:80%;text-align:center;margin-top:5px}#sbo-rt-content section.preface[title="Dedication"]>div.titlepage h2.title{text-align:center;text-transform:uppercase;font-size:1.5em;margin-top:50px;margin-bottom:50px}#sbo-rt-content ul.stafflist{margin:15px 0 15px 20px !important}#sbo-rt-content ul.stafflist li{list-style-type:none;padding:5px 0}#sbo-rt-content ul.printings li{list-style-type:none}#sbo-rt-content section.preface[title="Dedication"] p{font-style:italic;text-align:center}#sbo-rt-content div.colophon h1.title{font-size:1.3em;margin:0 !important;font-family:serif !important;font-weight:normal}#sbo-rt-content div.colophon h2.subtitle{margin:0 !important;color:#000;font-family:serif !important;font-size:1em;font-weight:normal}#sbo-rt-content div.colophon div.author h3.author{font-size:1.1em;font-family:serif !important;margin:10px 0 0 !important;font-weight:normal}#sbo-rt-content div.colophon div.editor h4,#sbo-rt-content div.colophon div.editor h3.editor{color:#000;font-size:.8em;margin:15px 0 0 !important;font-family:serif !important;font-weight:normal}#sbo-rt-content div.colophon div.editor h3.editor{font-size:.8em;margin:0 !important;font-family:serif !important;font-weight:normal}#sbo-rt-content div.colophon div.publisher{margin-top:10px}#sbo-rt-content div.colophon div.publisher p,#sbo-rt-content div.colophon div.publisher span.publishername{margin:0;font-size:.8em}#sbo-rt-content div.legalnotice p,#sbo-rt-content div.timestamp p{font-size:.8em}#sbo-rt-content div.timestamp p{margin-top:10px}#sbo-rt-content div.colophon[title="About the Author"] h1.title,#sbo-rt-content div.colophon[title="Colophon"] h1.title{font-size:1.5em;margin:0 !important;font-family:sans-serif !important}#sbo-rt-content section.chapter div.titlepage div.author{margin:10px 0 10px 0}#sbo-rt-content section.chapter div.titlepage div.author div.affiliation{font-style:italic}#sbo-rt-content div.attribution{margin:5px 0 0 50px !important}#sbo-rt-content h3.author span.orgname{display:none}#sbo-rt-content div.epigraph{margin:10px 0 10px 20px !important;page-break-inside:avoid;font-size:90%}#sbo-rt-content div.epigraph p{font-style:italic}#sbo-rt-content blockquote,#sbo-rt-content div.blockquote{margin:10px !important;page-break-inside:avoid;font-size:95%}#sbo-rt-content blockquote p,#sbo-rt-content div.blockquote p{font-style:italic;margin:.75em 0 0 !important}#sbo-rt-content blockquote div.attribution,#sbo-rt-content blockquote p[data-type="attribution"]{margin:5px 0 10px 30px !important;text-align:right;width:80%}#sbo-rt-content blockquote div.attribution p,#sbo-rt-content blockquote p[data-type="attribution"]{font-style:normal;margin-top:5px}#sbo-rt-content blockquote div.attribution p:before,#sbo-rt-content blockquote p[data-type="attribution"]:before{font-style:normal;content:"—";-webkit-hyphens:none;hyphens:none;adobe-hyphenate:none}#sbo-rt-content p.right{text-align:right;margin:0}#sbo-rt-content div[data-type="footnotes"]{border-top:1px solid black;margin-top:2em}#sbo-rt-content sub,#sbo-rt-content sup{font-size:75%;line-height:0;position:relative}#sbo-rt-content sup{top:-.5em}#sbo-rt-content sub{bottom:-.25em}#sbo-rt-content p[data-type="footnote"]{font-size:90% !important;line-height:1.2em !important;margin-left:2.5em !important;text-indent:-2.3em !important}#sbo-rt-content p[data-type="footnote"] sup{display:inline-block !important;position:static !important;width:2em !important;text-align:right !important;font-size:100% !important;padding-right:.5em !important}#sbo-rt-content p[data-type="footnote"] a[href$="-marker"]{font-family:sans-serif !important;font-size:90% !important;color:#8e0012 !important}#sbo-rt-content p[data-type="footnote"] a[data-type="xref"]{margin:0 !important;padding:0 !important;text-indent:0 !important}#sbo-rt-content a[data-type="noteref"]{font-family:sans-serif !important;color:#8e0012;margin-left:0;padding-left:0}#sbo-rt-content div.refentry p.refname{font-size:1em;font-family:sans-serif,"DejaVuSans";font-weight:bold;margin-bottom:5px;overflow:auto;width:100%}#sbo-rt-content div.refentry{width:100%;display:block;margin-top:2em}#sbo-rt-content div.refsynopsisdiv{display:block;clear:both}#sbo-rt-content div.refentry header{page-break-inside:avoid !important;display:block;break-inside:avoid !important;padding-top:0;border-bottom:1px solid #000}#sbo-rt-content div.refsect1 h6{font-size:.9em;font-family:sans-serif,"DejaVuSans";font-weight:bold}#sbo-rt-content div.refsect1{margin-top:3em}#sbo-rt-content dt{padding-top:10px !important;padding-bottom:0 !important}#sbo-rt-content dd{margin-left:1.5em !important;margin-bottom:.25em}#sbo-rt-content dd ol,#sbo-rt-content dd ul{padding-left:1em}#sbo-rt-content dd li{margin-top:0;margin-bottom:0}#sbo-rt-content dd,#sbo-rt-content li{text-align:left}#sbo-rt-content ul,#sbo-rt-content ul>li,#sbo-rt-content ol ul,#sbo-rt-content ol ul>li,#sbo-rt-content ul ol ul,#sbo-rt-content ul ol ul>li{list-style-type:disc}#sbo-rt-content ul ul,#sbo-rt-content ul ul>li{list-style-type:square}#sbo-rt-content ul ul ul,#sbo-rt-content ul ul ul>li{list-style-type:circle}#sbo-rt-content ol,#sbo-rt-content ol>li,#sbo-rt-content ol ul ol,#sbo-rt-content ol ul ol>li,#sbo-rt-content ul ol,#sbo-rt-content ul ol>li{list-style-type:decimal}#sbo-rt-content ol ol,#sbo-rt-content ol ol>li{list-style-type:lower-alpha}#sbo-rt-content ol ol ol,#sbo-rt-content ol ol ol>li{list-style-type:lower-roman}#sbo-rt-content ol,#sbo-rt-content ul{list-style-position:outside;margin:15px 0 15px 1.25em;padding-left:2.25em}#sbo-rt-content ol li,#sbo-rt-content ul li{margin:.5em 0 .65em;line-height:125%}#sbo-rt-content div.orderedlistalpha{list-style-type:upper-alpha}#sbo-rt-content table.simplelist,#sbo-rt-content ul.simplelist{margin:15px 0 15px 20px !important}#sbo-rt-content ul.simplelist li{list-style-type:none;padding:5px 0}#sbo-rt-content table.simplelist td{border:none}#sbo-rt-content table.simplelist tr{border-bottom:none}#sbo-rt-content table.simplelist tr:nth-of-type(even){background-color:transparent}#sbo-rt-content dl.calloutlist p:first-child{margin-top:-25px !important}#sbo-rt-content dl.calloutlist dd{padding-left:0;margin-top:-25px}#sbo-rt-content dl.calloutlist img,#sbo-rt-content a.co img{padding:0}#sbo-rt-content div.toc ol{margin-top:8px !important;margin-bottom:8px !important;margin-left:0 !important;padding-left:0 !important}#sbo-rt-content div.toc ol ol{margin-left:30px !important;padding-left:0 !important}#sbo-rt-content div.toc ol li{list-style-type:none}#sbo-rt-content div.toc a{color:#8e0012}#sbo-rt-content div.toc ol a{font-size:1em;font-weight:bold}#sbo-rt-content div.toc ol>li>ol a{font-weight:bold;font-size:1em}#sbo-rt-content div.toc ol>li>ol>li>ol a{text-decoration:none;font-weight:normal;font-size:1em}#sbo-rt-content div.tip,#sbo-rt-content div[data-type="tip"],#sbo-rt-content div.note,#sbo-rt-content div[data-type="note"],#sbo-rt-content div.warning,#sbo-rt-content div[data-type="warning"],#sbo-rt-content div[data-type="caution"],#sbo-rt-content div[data-type="important"]{margin:30px !important;font-size:90%;padding:10px 8px 20px 8px !important;page-break-inside:avoid}#sbo-rt-content div.tip ol,#sbo-rt-content div.tip ul,#sbo-rt-content div[data-type="tip"] ol,#sbo-rt-content div[data-type="tip"] ul,#sbo-rt-content div.note ol,#sbo-rt-content div.note ul,#sbo-rt-content div[data-type="note"] ol,#sbo-rt-content div[data-type="note"] ul,#sbo-rt-content div.warning ol,#sbo-rt-content div.warning ul,#sbo-rt-content div[data-type="warning"] ol,#sbo-rt-content div[data-type="warning"] ul,#sbo-rt-content div[data-type="caution"] ol,#sbo-rt-content div[data-type="caution"] ul,#sbo-rt-content div[data-type="important"] ol,#sbo-rt-content div[data-type="important"] ul{margin-left:1.5em !important}#sbo-rt-content div.tip,#sbo-rt-content div[data-type="tip"],#sbo-rt-content div.note,#sbo-rt-content div[data-type="note"]{border:1px solid #BEBEBE;background-color:transparent}#sbo-rt-content div.warning,#sbo-rt-content div[data-type="warning"],#sbo-rt-content div[data-type="caution"],#sbo-rt-content div[data-type="important"]{border:1px solid #BC8F8F}#sbo-rt-content div.tip h3,#sbo-rt-content div[data-type="tip"] h6,#sbo-rt-content div[data-type="tip"] h1,#sbo-rt-content div.note h3,#sbo-rt-content div[data-type="note"] h6,#sbo-rt-content div[data-type="note"] h1,#sbo-rt-content div.warning h3,#sbo-rt-content div[data-type="warning"] h6,#sbo-rt-content div[data-type="warning"] h1,#sbo-rt-content div[data-type="caution"] h6,#sbo-rt-content div[data-type="caution"] h1,#sbo-rt-content div[data-type="important"] h1,#sbo-rt-content div[data-type="important"] h6{font-weight:bold;font-size:110%;font-family:sans-serif !important;text-transform:uppercase;letter-spacing:1px;text-align:center;margin:4px 0 6px !important}#sbo-rt-content div[data-type="tip"] figure h6,#sbo-rt-content div[data-type="note"] figure h6,#sbo-rt-content div[data-type="warning"] figure h6,#sbo-rt-content div[data-type="caution"] figure h6,#sbo-rt-content div[data-type="important"] figure h6{font-family:serif !important}#sbo-rt-content div.tip h3,#sbo-rt-content div[data-type="tip"] h6,#sbo-rt-content div.note h3,#sbo-rt-content div[data-type="note"] h6,#sbo-rt-content div[data-type="tip"] h1,#sbo-rt-content div[data-type="note"] h1{color:#737373}#sbo-rt-content div.warning h3,#sbo-rt-content div[data-type="warning"] h6,#sbo-rt-content div[data-type="caution"] h6,#sbo-rt-content div[data-type="important"] h6,#sbo-rt-content div[data-type="warning"] h1,#sbo-rt-content div[data-type="caution"] h1,#sbo-rt-content div[data-type="important"] h1{color:#C67171}#sbo-rt-content div.sect1[title="Safari® Books Online"] div.note,#sbo-rt-content div.safarienabled{background-color:transparent;margin:8px 0 0 !important;border:0 solid #BEBEBE;font-size:100%;padding:0 !important;page-break-inside:avoid}#sbo-rt-content div.sect1[title="Safari® Books Online"] div.note h3,#sbo-rt-content div.safarienabled h6{display:none}#sbo-rt-content div.table,#sbo-rt-content table{margin:15px 0 30px 0 !important;max-width:95%;border:none !important;background:none;display:table !important}#sbo-rt-content div.table,#sbo-rt-content div.informaltable,#sbo-rt-content table{page-break-inside:avoid}#sbo-rt-content tr,#sbo-rt-content tr td{border-bottom:1px solid #c3c3c3}#sbo-rt-content thead td,#sbo-rt-content thead th{border-bottom:#9d9d9d 1px solid !important;border-top:#9d9d9d 1px solid !important}#sbo-rt-content tr:nth-of-type(even){background-color:#f1f6fc}#sbo-rt-content thead{font-family:sans-serif;font-weight:bold}#sbo-rt-content td,#sbo-rt-content th{display:table-cell;padding:.3em;text-align:left;vertical-align:middle;font-size:80%}#sbo-rt-content div.informaltable table{margin:10px auto !important}#sbo-rt-content div.informaltable table tr{border-bottom:none}#sbo-rt-content div.informaltable table tr:nth-of-type(even){background-color:transparent}#sbo-rt-content div.informaltable td,#sbo-rt-content div.informaltable th{border:#9d9d9d 1px solid}#sbo-rt-content div.table-title,#sbo-rt-content table caption{font-weight:normal;font-style:italic;font-family:serif;font-size:1em;margin:10px 0 10px 0 !important;padding:0;page-break-after:avoid;text-align:left !important}#sbo-rt-content table code{font-size:smaller}#sbo-rt-content table.border tbody>tr:last-child>td{border-bottom:transparent}#sbo-rt-content div.equation,#sbo-rt-content div[data-type="equation"]{margin:10px 0 15px 0 !important}#sbo-rt-content div.equation-title,#sbo-rt-content div[data-type="equation"] h5{font-style:italic;font-weight:normal;font-family:serif !important;font-size:90%;margin:20px 0 10px 0 !important;page-break-after:avoid}#sbo-rt-content div.equation-contents{margin-left:20px}#sbo-rt-content div[data-type="equation"] math{font-size:calc(.35em + 1vw)}#sbo-rt-content span.inlinemediaobject{height:.85em;display:inline-block;margin-bottom:.2em}#sbo-rt-content span.inlinemediaobject img{margin:0;height:.85em}#sbo-rt-content div.informalequation{margin:20px 0 20px 20px;width:75%}#sbo-rt-content div.informalequation img{width:75%}#sbo-rt-content div.index{text-indent:0}#sbo-rt-content div.index h3{padding:.25em;margin-top:1em !important;background-color:#F0F0F0}#sbo-rt-content div.index li{line-height:130%;list-style-type:none}#sbo-rt-content div.index a.indexterm{color:#8e0012 !important}#sbo-rt-content div.index ul{margin-left:0 !important;padding-left:0 !important}#sbo-rt-content div.index ul ul{margin-left:1em !important;margin-top:0 !important}#sbo-rt-content code.boolean,#sbo-rt-content .navy{color:rgb(0,0,128);}#sbo-rt-content code.character,#sbo-rt-content .olive{color:rgb(128,128,0);}#sbo-rt-content code.comment,#sbo-rt-content .blue{color:rgb(0,0,255);}#sbo-rt-content code.conditional,#sbo-rt-content .limegreen{color:rgb(50,205,50);}#sbo-rt-content code.constant,#sbo-rt-content .darkorange{color:rgb(255,140,0);}#sbo-rt-content code.debug,#sbo-rt-content .darkred{color:rgb(139,0,0);}#sbo-rt-content code.define,#sbo-rt-content .darkgoldenrod,#sbo-rt-content .gold{color:rgb(184,134,11);}#sbo-rt-content code.delimiter,#sbo-rt-content .dimgray{color:rgb(105,105,105);}#sbo-rt-content code.error,#sbo-rt-content .red{color:rgb(255,0,0);}#sbo-rt-content code.exception,#sbo-rt-content .salmon{color:rgb(250,128,11);}#sbo-rt-content code.float,#sbo-rt-content .steelblue{color:rgb(70,130,180);}#sbo-rt-content pre code.function,#sbo-rt-content .green{color:rgb(0,128,0);}#sbo-rt-content code.identifier,#sbo-rt-content .royalblue{color:rgb(65,105,225);}#sbo-rt-content code.ignore,#sbo-rt-content .gray{color:rgb(128,128,128);}#sbo-rt-content code.include,#sbo-rt-content .purple{color:rgb(128,0,128);}#sbo-rt-content code.keyword,#sbo-rt-content .sienna{color:rgb(160,82,45);}#sbo-rt-content code.label,#sbo-rt-content .deeppink{color:rgb(255,20,147);}#sbo-rt-content code.macro,#sbo-rt-content .orangered{color:rgb(255,69,0);}#sbo-rt-content code.number,#sbo-rt-content .brown{color:rgb(165,42,42);}#sbo-rt-content code.operator,#sbo-rt-content .black{color:#000;}#sbo-rt-content code.preCondit,#sbo-rt-content .teal{color:rgb(0,128,128);}#sbo-rt-content code.preProc,#sbo-rt-content .fuschia{color:rgb(255,0,255);}#sbo-rt-content code.repeat,#sbo-rt-content .indigo{color:rgb(75,0,130);}#sbo-rt-content code.special,#sbo-rt-content .saddlebrown{color:rgb(139,69,19);}#sbo-rt-content code.specialchar,#sbo-rt-content .magenta{color:rgb(255,0,255);}#sbo-rt-content code.specialcomment,#sbo-rt-content .seagreen{color:rgb(46,139,87);}#sbo-rt-content code.statement,#sbo-rt-content .forestgreen{color:rgb(34,139,34);}#sbo-rt-content code.storageclass,#sbo-rt-content .plum{color:rgb(221,160,221);}#sbo-rt-content code.string,#sbo-rt-content .darkred{color:rgb(139,0,0);}#sbo-rt-content code.structure,#sbo-rt-content .chocolate{color:rgb(210,106,30);}#sbo-rt-content code.tag,#sbo-rt-content .darkcyan{color:rgb(0,139,139);}#sbo-rt-content code.todo,#sbo-rt-content .black{color:#000;}#sbo-rt-content code.type,#sbo-rt-content .mediumslateblue{color:rgb(123,104,238);}#sbo-rt-content code.typedef,#sbo-rt-content .darkgreen{color:rgb(0,100,0);}#sbo-rt-content code.underlined{text-decoration:underline;}#sbo-rt-content pre code.hll{background-color:#ffc}#sbo-rt-content pre code.c{color:#09F;font-style:italic}#sbo-rt-content pre code.err{color:#A00}#sbo-rt-content pre code.k{color:#069;font-weight:bold}#sbo-rt-content pre code.o{color:#555}#sbo-rt-content pre code.cm{color:#35586C;font-style:italic}#sbo-rt-content pre code.cp{color:#099}#sbo-rt-content pre code.c1{color:#35586C;font-style:italic}#sbo-rt-content pre code.cs{color:#35586C;font-weight:bold;font-style:italic}#sbo-rt-content pre code.gd{background-color:#FCC}#sbo-rt-content pre code.ge{font-style:italic}#sbo-rt-content pre code.gr{color:#F00}#sbo-rt-content pre code.gh{color:#030;font-weight:bold}#sbo-rt-content pre code.gi{background-color:#CFC}#sbo-rt-content pre code.go{color:#000}#sbo-rt-content pre code.gp{color:#009;font-weight:bold}#sbo-rt-content pre code.gs{font-weight:bold}#sbo-rt-content pre code.gu{color:#030;font-weight:bold}#sbo-rt-content pre code.gt{color:#9C6}#sbo-rt-content pre code.kc{color:#069;font-weight:bold}#sbo-rt-content pre code.kd{color:#069;font-weight:bold}#sbo-rt-content pre code.kn{color:#069;font-weight:bold}#sbo-rt-content pre code.kp{color:#069}#sbo-rt-content pre code.kr{color:#069;font-weight:bold}#sbo-rt-content pre code.kt{color:#078;font-weight:bold}#sbo-rt-content pre code.m{color:#F60}#sbo-rt-content pre code.s{color:#C30}#sbo-rt-content pre code.na{color:#309}#sbo-rt-content pre code.nb{color:#366}#sbo-rt-content pre code.nc{color:#0A8;font-weight:bold}#sbo-rt-content pre code.no{color:#360}#sbo-rt-content pre code.nd{color:#99F}#sbo-rt-content pre code.ni{color:#999;font-weight:bold}#sbo-rt-content pre code.ne{color:#C00;font-weight:bold}#sbo-rt-content pre code.nf{color:#C0F}#sbo-rt-content pre code.nl{color:#99F}#sbo-rt-content pre code.nn{color:#0CF;font-weight:bold}#sbo-rt-content pre code.nt{color:#309;font-weight:bold}#sbo-rt-content pre code.nv{color:#033}#sbo-rt-content pre code.ow{color:#000;font-weight:bold}#sbo-rt-content pre code.w{color:#bbb}#sbo-rt-content pre code.mf{color:#F60}#sbo-rt-content pre code.mh{color:#F60}#sbo-rt-content pre code.mi{color:#F60}#sbo-rt-content pre code.mo{color:#F60}#sbo-rt-content pre code.sb{color:#C30}#sbo-rt-content pre code.sc{color:#C30}#sbo-rt-content pre code.sd{color:#C30;font-style:italic}#sbo-rt-content pre code.s2{color:#C30}#sbo-rt-content pre code.se{color:#C30;font-weight:bold}#sbo-rt-content pre code.sh{color:#C30}#sbo-rt-content pre code.si{color:#A00}#sbo-rt-content pre code.sx{color:#C30}#sbo-rt-content pre code.sr{color:#3AA}#sbo-rt-content pre code.s1{color:#C30}#sbo-rt-content pre code.ss{color:#A60}#sbo-rt-content pre code.bp{color:#366}#sbo-rt-content pre code.vc{color:#033}#sbo-rt-content pre code.vg{color:#033}#sbo-rt-content pre code.vi{color:#033}#sbo-rt-content pre code.il{color:#F60}#sbo-rt-content pre code.g{color:#050}#sbo-rt-content pre code.l{color:#C60}#sbo-rt-content pre code.l{color:#F90}#sbo-rt-content pre code.n{color:#008}#sbo-rt-content pre code.nx{color:#008}#sbo-rt-content pre code.py{color:#96F}#sbo-rt-content pre code.p{color:#000}#sbo-rt-content pre code.x{color:#F06}#sbo-rt-content div.blockquote_sampler_toc{width:95%;margin:5px 5px 5px 10px !important}#sbo-rt-content div{font-family:serif;text-align:left}#sbo-rt-content .gray-background,#sbo-rt-content .reverse-video{background:#2E2E2E;color:#FFF}#sbo-rt-content .light-gray-background{background:#A0A0A0}#sbo-rt-content .preserve-whitespace{white-space:pre-wrap}#sbo-rt-content span.gray{color:#4C4C4C}#sbo-rt-content .width-10{width:10vw !important}#sbo-rt-content .width-20{width:20vw !important}#sbo-rt-content .width-30{width:30vw !important}#sbo-rt-content .width-40{width:40vw !important}#sbo-rt-content .width-50{width:50vw !important}#sbo-rt-content .width-60{width:60vw !important}#sbo-rt-content .width-70{width:70vw !important}#sbo-rt-content .width-80{width:80vw !important}#sbo-rt-content .width-90{width:90vw !important}#sbo-rt-content .width-full,#sbo-rt-content .width-100{width:100vw !important}
    </style>
  




</head>
<body class="js-preview-content  ">


<div class="skipToMain" id="skipToMain"><a href="#maincontent"><span class="skipToMain-text">Skip to main content</span></a></div>
<header role="banner" class="global">
  <div class="global-nav">
    <div class="content">
      <nav role="navigation" aria-label="site sections">
        <a href="https://www.oreilly.com" class="logo" title="home page" aria-current="page"><img src="https://cdn.oreillystatic.com/images/sitewide-headers/oreilly_logo_mark_red.svg" onerror="this.src='https://cdn.oreillystatic.com/images/sitewide-headers/oreilly_logo_mark_red_@2x.png'; this.onerror=null;" alt="O'Reilly home"></a>

        <button id="mobileNavButton" class="mobileNavButton mobileNavButton--collapse mobileNavButton--3dx" type="button" aria-expanded="false" aria-controls="menuList">
          <span class="mobileNavButton-box">
            <span class="mobileNavButton-inner"></span>
          </span>
        </button>


        <ul id="menuList" class="menuList mobileHidden ">
          <li class="menuList-itemsP1">
            <ul>
              
  <li class="menuList-item menuList-signIn"><a class="t-sign-in" href="https://learning.oreilly.com/accounts/login/?next=/library/view/python-data-science/9781491912126/ch04.html">Sign In</a></li>


              <li class="menuList-item menuList-tryNow"><a class="menuList-cta" href="https://learning.oreilly.com/p/register/">Try Now</a></li>
            </ul>
          </li>
          <li class="menuList-itemsP2">
            <ul>
              <li class="menuList-item"><a href="https://www.oreilly.com/online-learning/teams.html">Teams</a></li>
              <li class="menuList-item"><a href="https://www.oreilly.com/online-learning/individuals.html">Individuals</a></li>
              <li class="menuList-item menuList-itemWithSub"><a href="https://www.oreilly.com/online-learning/features.html">Features</a>
                <ul class="menuList-subList">
                  <li class="menuList-subItem"><a href="https://www.oreilly.com/online-learning/feature-certification.html">Certifications</a></li>
                  <li class="menuList-subItem"><a href="https://www.oreilly.com/online-learning/intro-interactive-learning.html">Interactive learning</a></li>
                  <li class="menuList-subItem"><a href="https://www.oreilly.com/online-learning/live-online-sessions.html">Live online sessions</a></li>
                </ul>
              </li>
              <li class="menuList-item"><a href="https://www.oreilly.com/whats-new.html">What’s New</a></li>
              <li class="menuList-item menuList-forMarketers"><a href="https://www.oreilly.com/content-marketing-solutions.html">O’Reilly for marketers</a></li>
            </ul>
          </li>
        </ul>
      </nav>
    </div>
  </div>


  <div class="global-search">
    <div id="globalSearchContent" class="content">
      <form id="js-search-form" class="t-navigation-form" action="https://learning.oreilly.com/search/">
        
        <script type="application/ld+json">
        {
          "@context": "http://schema.org",
          "@type": "WebSite",
          "url": "https://learning.oreilly.com",
          "potentialAction": {
            "@type": "SearchAction",
            "target": "https://learning.oreilly.com/search/?q={search_term_string}",
            "query-input": "required name=search_term_string"
          }
        }
        </script>
        <input data-search-text-focus= "See everything available through O’Reilly online learning and start a free trial. Explore now." data-search-text-idle = "See everything available through O’Reilly online learning and start a free trial. Explore now." id="search" type="search" name="query" placeholder="See everything available through O’Reilly online learning and start a free trial. Explore now." autocomplete="off" required />
        <input type="submit" value="Search" class="search-submit" />
      </form>
    </div>
  </div>
</header>

    
    
        <div class="sbo-menu-top">
           
            <section class="sbo-toc-container">
                <a href="https://learning.oreilly.com/library/view/python-data-science/9781491912126/" class="sbo-toc-thumb">
                    <span class="sbo-title ss-list">
                        
                            <h1 class="t-title">Python Data Science Handbook by Jake VanderPlas</h1>
                        
                    </span>
                </a>
            </section>
             
        </div>
    


</header>


<section id="trial-overlay">
  <div class="trial-overlay-content">
    <p>Get <em>Python Data Science Handbook</em> now with O’Reilly <span class="nowrap">online learning.</span></p>

    <p>O’Reilly members experience live online training, plus books, videos, and digital content from <span class="nowrap">200+ publishers.</span></p>

    <div class="controls">
      <a href="https://learning.oreilly.com/p/register/" class="button-primary" data-ga-label="Bottom CTA">Start your free trial</a>
    </div>
    <a class="modal-dismiss" aria-label="modal dismiss"></a>
  </div>
</section>

<main role="main" id="maincontent">
  <div role="document" class="document">
  	
<section id="sbo-reader">
    
    

<div class="sbo-reader-content sbo-sample-reader ">
    
    <div id="sbo-rt-content" class="sbo-rt-content">
    <div id="test-content-id"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 4. Visualization with Matplotlib"><div class="chapter" id="introduction-to-matplotlib">
<h1><span class="label">Chapter 4. </span>Visualization with Matplotlib</h1>


<p><a data-type="indexterm" data-primary="Matplotlib" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc0"></a><a data-type="indexterm" data-primary="plotting" data-secondary="Matplotlib" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc1"></a>We’ll now take an in-depth look at the Matplotlib tool for visualization in Python. Matplotlib is a multiplatform data visualization library built on NumPy arrays, and designed to work with the broader SciPy stack. It was conceived by <a data-type="indexterm" data-primary="Hunter, John" id="idm45026307559528"></a>John Hunter in 2002, originally as a patch to IPython for enabling interactive MATLAB-style plotting via gnuplot from the IPython command line. IPython’s creator, <a data-type="indexterm" data-primary="Perez, Fernando" id="idm45026307558616"></a>Fernando Perez, was at the time scrambling to finish his PhD, and let John know he wouldn’t have time to review the patch for several months. John took this as a cue to set out on his own, and the Matplotlib package was born, with version 0.1 released in 2003. It received an early boost when it was adopted as the plotting package of choice of the Space Telescope Science Institute (the folks behind the Hubble Telescope), which financially supported Matplotlib’s development and greatly expanded its capabilities.</p>

<p>One of Matplotlib’s most important features is its ability to play well
with many operating systems and graphics backends. Matplotlib supports
dozens of backends and output types, which means you can count on it to
work regardless of which operating system you are using or which output
format you wish. This cross-platform, everything-to-everyone approach
has been one of the great strengths of Matplotlib. It has led to a large
userbase, which in turn has led to an active developer base and
Matplotlib’s powerful tools and ubiquity within the scientific Python
world.</p>

<p>In recent years, however, the interface and style of Matplotlib have
begun to show their age. Newer tools like ggplot and ggvis in the R
language, along with web visualization toolkits based on D3js and HTML5
canvas, often make Matplotlib feel clunky and old-fashioned. Still, I’m
of the opinion that we cannot ignore Matplotlib’s strength as a
well-tested, cross-platform graphics engine. Recent Matplotlib versions
make it relatively easy to set new global plotting styles (see
<a data-type="xref" href="#customizing-matplotlib-configurations-and-style-sheets">“Customizing Matplotlib: Configurations and Stylesheets”</a>), and people have been developing new
packages that build on its powerful internals to drive
Matplotlib via cleaner, more modern APIs—for example, Seaborn
(discussed in <a data-type="xref" href="#visualization-with-seaborn">“Visualization with Seaborn”</a>), <a href="http://yhat.github.io/ggplot">ggplot</a>,
<a href="http://holoviews.org">HoloViews</a>,
<a href="http://altair-viz.github.io">Altair</a>, and even Pandas itself can
be used as wrappers around Matplotlib’s API. Even with wrappers like
these, it is still often useful to dive into Matplotlib’s syntax to
adjust the final plot output. For this reason, I believe that Matplotlib
itself will remain a vital piece of the data visualization stack, even
if new tools mean the community gradually moves away from using the
Matplotlib API directly.</p>






<section data-type="sect1" data-pdf-bookmark="General Matplotlib Tips"><div class="sect1" id="general-matplotlib-tips">
<h1>General Matplotlib Tips</h1>

<p><a data-type="indexterm" data-primary="Matplotlib" data-secondary="general tips" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc2"></a>Before we dive into the details of creating visualizations with
Matplotlib, there are a few useful things you should know about using
the package.</p>








<section data-type="sect2" data-pdf-bookmark="Importing matplotlib"><div class="sect2" id="importing-matplotlib">
<h2>Importing matplotlib</h2>

<p><a data-type="indexterm" data-primary="Matplotlib" data-secondary="importing" id="idm45026307545960"></a>Just as we use the <code>np</code> shorthand for NumPy and the <code>pd</code> shorthand for
Pandas, we will use some standard shorthands for Matplotlib imports:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">1</code><code class="p">]:</code> <code class="kn">import</code> <code class="nn">matplotlib</code> <code class="kn">as</code> <code class="nn">mpl</code>
       <code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="kn">as</code> <code class="nn">plt</code></pre>

<p>The <code>plt</code> interface is what we will use most often, as we’ll see
throughout this chapter.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Setting Styles"><div class="sect2" id="setting-styles">
<h2>Setting Styles</h2>

<p><a data-type="indexterm" data-primary="Matplotlib" data-secondary="setting styles" id="idm45026307532760"></a>We will use the <code>plt.style</code> directive to choose
appropriate aesthetic styles for our figures. Here we will set the
<code>classic</code> style, which ensures that the plots we create use the classic
Matplotlib style:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">2</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">use</code><code class="p">(</code><code class="s1">'classic'</code><code class="p">)</code></pre>

<p>Throughout this section, we will adjust this style as needed. Note that
the stylesheets used here are supported as of Matplotlib version 1.5; if
you are using an earlier version of Matplotlib, only the default style is
available. For more information on stylesheets, see
<a data-type="xref" href="#customizing-matplotlib-configurations-and-style-sheets">“Customizing Matplotlib: Configurations and Stylesheets”</a>.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="show() or No show()? How to Display Your Plots"><div class="sect2" id="show-or-no-show-how-to-display-your-plots">
<h2>show() or No show()? How to Display Your Plots</h2>

<p><a data-type="indexterm" data-primary="Matplotlib" data-secondary="plot display contexts" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc3"></a><a data-type="indexterm" data-primary="plotting" data-secondary="display contexts" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc4"></a>A visualization you can’t see won’t be of much use, but just how you
view your Matplotlib plots depends on the context. The best use of
Matplotlib differs depending on how you are using it; roughly, the three
applicable contexts are using Matplotlib in a script, in an IPython
terminal, or in an IPython notebook.</p>










<section data-type="sect3" data-pdf-bookmark="Plotting from a script"><div class="sect3" id="plotting-from-a-script">
<h3>Plotting from a script</h3>

<p><a data-type="indexterm" data-primary="Matplotlib" data-secondary="plotting from a script" id="idm45026307512424"></a><a data-type="indexterm" data-primary="plotting" data-secondary="from script" id="idm45026307482360"></a><a data-type="indexterm" data-primary="script" data-secondary="plotting from" id="idm45026307481416"></a>If you are using Matplotlib from within a script, the function
<code>plt.show()</code> is your friend. <code>plt.show()</code> starts an event loop, looks
for all currently active figure objects, and opens one or more
interactive windows that display your figure or figures.</p>

<p>So, for example, you may have a file called <em>myplot.py</em> containing
the following:</p>

<pre data-type="programlisting" data-code-language="python"><code class="c1"># ------- file: myplot.py ------</code>
<code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="kn">as</code> <code class="nn">plt</code>
<code class="kn">import</code> <code class="nn">numpy</code> <code class="kn">as</code> <code class="nn">np</code>

<code class="n">x</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">10</code><code class="p">,</code> <code class="mi">100</code><code class="p">)</code>

<code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">))</code>
<code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">cos</code><code class="p">(</code><code class="n">x</code><code class="p">))</code>

<code class="n">plt</code><code class="o">.</code><code class="n">show</code><code class="p">()</code></pre>

<p>You can then run this script from the command-line prompt, which will result in a window opening with your figure displayed:</p>

<pre data-type="programlisting">$ python myplot.py</pre>

<p>The <code>plt.show()</code> command does a lot under the hood, as it must interact with
your system’s interactive graphical backend. The details of this
operation can vary greatly from system to system and even installation
to installation, but Matplotlib does its best to hide all these details
from you.</p>

<p>One thing to be aware of: the <code>plt.show()</code> command should be used <em>only
once</em> per Python session, and is most often seen at the very end of the
script. Multiple <code>show()</code> commands can lead to unpredictable
backend-dependent behavior, and should mostly be avoided.</p>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Plotting from an IPython shell"><div class="sect3" id="plotting-from-an-ipython-shell">
<h3>Plotting from an IPython shell</h3>

<p><a data-type="indexterm" data-primary="IPython" data-secondary="plotting from shell" id="idm45026307407080"></a><a data-type="indexterm" data-primary="Matplotlib" data-secondary="plotting from IPython shell" id="idm45026307405880"></a><a data-type="indexterm" data-primary="plotting" data-secondary="from an IPython shell" id="idm45026307404968"></a>It can be very convenient to use Matplotlib interactively within an
IPython shell (see
<a data-type="xref" href="ch01.html#ipython-beyond-normal-python">Chapter 1</a>). IPython is built to work well with Matplotlib if you specify
Matplotlib mode. <a data-type="indexterm" data-primary="%matplotlib" id="idm45026307403080"></a>To enable this mode, you can use the <code>%matplotlib</code>
magic command after starting <code>ipython</code>:</p>

<pre data-type="programlisting" data-code-language="ipython"><code class="n">In</code> <code class="p">[</code><code class="mi">1</code><code class="p">]:</code> <code class="o">%</code><code class="k">matplotlib</code>
<code class="n">Using</code> <code class="n">matplotlib</code> <code class="n">backend</code><code class="p">:</code> <code class="n">TkAgg</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">2</code><code class="p">]:</code> <code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="kn">as</code> <code class="nn">plt</code></pre>

<p>At this point, any <code>plt</code> plot command will cause a figure window to
open, and further commands can be run to update the plot. Some changes
(such as modifying properties of lines that are already drawn) will not
draw automatically; to force an update, use <code>plt.draw()</code>. Using
<code>plt.show()</code> in Matplotlib mode is not required.</p>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Plotting from an IPython notebook"><div class="sect3" id="plotting-from-an-ipython-notebook">
<h3>Plotting from an IPython notebook</h3>

<p><a data-type="indexterm" data-primary="Jupyter notebook" data-secondary="plotting from" id="idm45026307377912"></a><a data-type="indexterm" data-primary="Matplotlib" data-secondary="plotting from IPython notebook" id="idm45026307376936"></a><a data-type="indexterm" data-primary="plotting" data-secondary="IPython notebook" id="idm45026307376024"></a>The IPython notebook is a browser-based interactive data analysis tool
that can combine narrative, code, graphics, HTML elements, and much
more into a single executable document (see
<a data-type="xref" href="ch01.html#ipython-beyond-normal-python">Chapter 1</a>).</p>

<p>Plotting interactively within an IPython notebook can be done with the
<code>%matplotlib</code> command, and works in a similar way to the IPython shell.
In the IPython notebook, you also have the option of embedding graphics
directly in the notebook, with two possible options:</p>

<ul>
<li>
<p><code>%matplotlib notebook</code> will lead to <em>interactive</em> plots embedded
within the <span class="keep-together">notebook</span></p>
</li>
<li>
<p><code>%matplotlib inline</code> will lead to <em>static</em> images of your plot
embedded in the notebook</p>
</li>
</ul>

<p>For this book, we will generally opt for <code>%matplotlib inline</code>:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">3</code><code class="p">]:</code> <code class="o">%</code><code class="n">matplotlib</code> <code class="n">inline</code></pre>

<p>After you run this command (it needs to be done only once per
kernel/session), any cell within the notebook that creates a plot will
embed a PNG image of the resulting graphic (<a data-type="xref" href="#fig0401">Figure 4-1</a>):<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc4" id="idm45026307324568"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc3" id="idm45026307323896"></a></p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">4</code><code class="p">]:</code> <code class="kn">import</code> <code class="nn">numpy</code> <code class="kn">as</code> <code class="nn">np</code>
       <code class="n">x</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">10</code><code class="p">,</code> <code class="mi">100</code><code class="p">)</code>

       <code class="n">fig</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">()</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">),</code> <code class="s1">'-'</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">cos</code><code class="p">(</code><code class="n">x</code><code class="p">),</code> <code class="s1">'--'</code><code class="p">);</code></pre>

<figure><div id="fig0401" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in01.png" alt="png" width="383" height="256">
<h6><span class="label">Figure 4-1. </span>Basic plotting example</h6>
</div></figure>
</div></section>



</div></section>













<section data-type="sect2" data-pdf-bookmark="Saving Figures to File"><div class="sect2" id="saving-figures-to-file">
<h2>Saving Figures to File</h2>

<p><a data-type="indexterm" data-primary="Matplotlib" data-secondary="saving figures to file" id="idm45026307210376"></a>One nice feature of Matplotlib is the ability to save figures in a wide
variety of formats. You can save a figure using the <code>savefig()</code>
command. For example, to save the previous figure as a PNG file, you can
run this:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">5</code><code class="p">]:</code> <code class="n">fig</code><code class="o">.</code><code class="n">savefig</code><code class="p">(</code><code class="s1">'my_figure.png'</code><code class="p">)</code></pre>

<p>We now have a file called <em>my_figure.png</em> in the current working
directory:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">6</code><code class="p">]:</code> <code class="err">!</code><code class="n">ls</code> <code class="o">-</code><code class="n">lh</code> <code class="n">my_figure</code><code class="o">.</code><code class="n">png</code></pre>

<pre data-type="programlisting">-rw-r--r--  1 jakevdp  staff    16K Aug 11 10:59 my_figure.png</pre>

<p>To confirm that it contains what we think it contains, let’s use the
IPython <code>Image</code> object to display the contents of this file (<a data-type="xref" href="#fig0402">Figure 4-2</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">7</code><code class="p">]:</code> <code class="kn">from</code> <code class="nn">IPython.display</code> <code class="kn">import</code> <code class="n">Image</code>
       <code class="n">Image</code><code class="p">(</code><code class="s1">'my_figure.png'</code><code class="p">)</code></pre>

<figure><div id="fig0402" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in02.png" alt="png" width="432" height="288">
<h6><span class="label">Figure 4-2. </span>PNG rendering of the basic plot</h6>
</div></figure>

<p>In <code>savefig()</code>, the file format is inferred from the extension of the
given filename. Depending on what backends you have installed, many
different file formats are available. You can find the list of supported file types for your system by using the following method of the figure
<code>canvas</code> object:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">8</code><code class="p">]:</code> <code class="n">fig</code><code class="o">.</code><code class="n">canvas</code><code class="o">.</code><code class="n">get_supported_filetypes</code><code class="p">()</code></pre>

<pre data-type="programlisting">Out[8]: {'eps': 'Encapsulated Postscript',
         'jpeg': 'Joint Photographic Experts Group',
         'jpg': 'Joint Photographic Experts Group',
         'pdf': 'Portable Document Format',
         'pgf': 'PGF code for LaTeX',
         'png': 'Portable Network Graphics',
         'ps': 'Postscript',
         'raw': 'Raw RGBA bitmap',
         'rgba': 'Raw RGBA bitmap',
         'svg': 'Scalable Vector Graphics',
         'svgz': 'Scalable Vector Graphics',
         'tif': 'Tagged Image File Format',
         'tiff': 'Tagged Image File Format'}</pre>

<p>Note that when saving your figure, it’s not necessary to use <code>plt.show()</code> or
related commands discussed earlier.<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc2" id="idm45026307095416"></a></p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Two Interfaces for the Price of One"><div class="sect1" id="two-interfaces-for-the-price-of-one">
<h1>Two Interfaces for the Price of One</h1>

<p><a data-type="indexterm" data-primary="Matplotlib" data-secondary="interfaces" id="idm45026307093304"></a>A potentially confusing feature of Matplotlib is its dual interfaces: a
convenient MATLAB-style state-based interface, and a more powerful
object-oriented interface. We’ll quickly highlight the differences
between the two here.</p>










<section data-type="sect3" data-pdf-bookmark="MATLAB-style interface"><div class="sect3" id="matlab-style-interface">
<h3>MATLAB-style interface</h3>

<p><a data-type="indexterm" data-primary="MATLAB-style interface" id="idm45026307090152"></a><a data-type="indexterm" data-primary="Matplotlib" data-secondary="MATLAB-style interfaces" id="idm45026307062824"></a>Matplotlib was originally written as a Python alternative for MATLAB
users, and much of its syntax reflects that fact. The MATLAB-style tools
are contained in the pyplot (<code>plt</code>) interface. For example, the
following code will probably look quite familiar to MATLAB users (<a data-type="xref" href="#fig0403">Figure 4-3</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">9</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">()</code>  <code class="c1"># create a plot figure</code>

       <code class="c1"># create the first of two panels and set current axis</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">subplot</code><code class="p">(</code><code class="mi">2</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">)</code> <code class="c1"># (rows, columns, panel number)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">))</code>

       <code class="c1"># create the second panel and set current axis</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">subplot</code><code class="p">(</code><code class="mi">2</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">cos</code><code class="p">(</code><code class="n">x</code><code class="p">));</code></pre>

<figure><div id="fig0403" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in03.png" alt="png" width="383" height="256">
<h6><span class="label">Figure 4-3. </span>Subplots using the MATLAB-style interface</h6>
</div></figure>

<p>It’s important to note that this interface is <em>stateful</em>: it keeps track of the
“current” figure and axes, which are where all <code>plt</code> commands are
applied. You can get a reference to these using the <code>plt.gcf()</code> (get
current figure) and <code>plt.gca()</code> (get current axes) <span class="keep-together">routines</span>.</p>

<p>While this stateful interface is fast and convenient for simple plots,
it is easy to run into problems. For example, once the second panel is
created, how can we go back and add something to the first? This is
possible within the MATLAB-style interface, but a bit clunky.
Fortunately, there is a better way.</p>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Object-oriented interface"><div class="sect3" id="object-oriented-interface">
<h3>Object-oriented interface</h3>

<p><a data-type="indexterm" data-primary="Matplotlib" data-secondary="object-oriented interfaces" id="idm45026306987448"></a><a data-type="indexterm" data-primary="object-oriented interface" id="idm45026306986280"></a>The object-oriented interface is available for these more complicated
situations, and for when you want more control over your figure. Rather
than depending on some notion of an “active” figure or axes, in the
object-oriented interface the plotting functions are <em>methods</em> of
explicit <code>Figure</code> and <code>Axes</code> objects. To re-create the previous plot using
this style of plotting, you might do the following (<a data-type="xref" href="#fig0404">Figure 4-4</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">10</code><code class="p">]:</code> <code class="c1"># First create a grid of plots</code>
        <code class="c1"># ax will be an array of two Axes objects</code>
        <code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">(</code><code class="mi">2</code><code class="p">)</code>

        <code class="c1"># Call plot() method on the appropriate object</code>
        <code class="n">ax</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">))</code>
        <code class="n">ax</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">cos</code><code class="p">(</code><code class="n">x</code><code class="p">));</code></pre>

<figure><div id="fig0404" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in04.png" alt="png" width="383" height="256">
<h6><span class="label">Figure 4-4. </span>Subplots using the object-oriented interface</h6>
</div></figure>

<p>For more simple plots, the choice of which style to use is largely a matter of preference, but the object-oriented approach can become a necessity as plots become
more complicated. Throughout this chapter, we will switch between the
MATLAB-style and object-oriented interfaces, depending on what is most
convenient. In most cases, the difference is as small as switching
<code>plt.plot()</code> to <code>ax.plot()</code>, but there are a few gotchas that we will
highlight as they come up in the following sections.</p>
</div></section>



</div></section>













<section data-type="sect1" data-pdf-bookmark="Simple Line Plots"><div class="sect1" id="simple-line-plots">
<h1>Simple Line Plots</h1>

<p><a data-type="indexterm" data-primary="line plots" data-secondary="Matplotlib" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc5"></a><a data-type="indexterm" data-primary="Matplotlib" data-secondary="simple line plots" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc6"></a><a data-type="indexterm" data-primary="plotting" data-secondary="simple line plots" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc7"></a><a data-type="indexterm" data-primary="simple line plots" data-secondary="Matplotlib" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc8"></a><a data-type="indexterm" data-primary="simple line plots" data-secondary="simple (Matplotlib)" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc9"></a>Perhaps the simplest of all plots is the visualization of a single
function <math xmlns="http://www.w3.org/1998/Math/MathML" alttext="y equals f left-parenthesis x right-parenthesis">
  <mrow>
    <mi>y</mi>
    <mo>=</mo>
    <mi>f</mi>
    <mo>(</mo>
    <mi>x</mi>
    <mo>)</mo>
  </mrow>
</math>. Here we will take a first look at
creating a simple plot of this type. As with all the following sections,
we’ll start by setting up the notebook for plotting and importing the functions we will use:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">1</code><code class="p">]:</code> <code class="o">%</code><code class="n">matplotlib</code> <code class="n">inline</code>
       <code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="kn">as</code> <code class="nn">plt</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">use</code><code class="p">(</code><code class="s1">'seaborn-whitegrid'</code><code class="p">)</code>
       <code class="kn">import</code> <code class="nn">numpy</code> <code class="kn">as</code> <code class="nn">np</code></pre>

<p>For all Matplotlib plots, we start by creating a figure and an axes. In
their simplest form, a figure and axes can be created as follows (<a data-type="xref" href="#fig0405">Figure 4-5</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">2</code><code class="p">]:</code> <code class="n">fig</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">()</code>
       <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">axes</code><code class="p">()</code></pre>

<figure><div id="fig0405" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in05.png" alt="png" width="374" height="255">
<h6><span class="label">Figure 4-5. </span>An empty gridded axes</h6>
</div></figure>

<p>In Matplotlib, the <em>figure</em> (an instance of the class <code>plt.Figure</code>) can
be thought of as a single container that contains all the objects
representing axes, graphics, text, and labels. The <em>axes</em> (an instance
of the class <code>plt.Axes</code>) is what we see above: a bounding box with ticks
and labels, which will eventually contain the plot elements that make up
our visualization. Throughout this book, we’ll commonly use the variable
name <code>fig</code> to refer to a figure instance, and <code>ax</code> to refer to an axes
instance or group of axes instances.</p>

<p>Once we have created an axes, we can use the <code>ax.plot</code> function to plot
some data. Let’s start with a simple sinusoid (<a data-type="xref" href="#fig0406">Figure 4-6</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">3</code><code class="p">]:</code> <code class="n">fig</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">()</code>
       <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">axes</code><code class="p">()</code>

       <code class="n">x</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">10</code><code class="p">,</code> <code class="mi">1000</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">));</code></pre>

<figure><div id="fig0406" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in06.png" alt="png" width="378" height="255">
<h6><span class="label">Figure 4-6. </span>A simple sinusoid</h6>
</div></figure>

<p>Alternatively, we can use the pylab interface and let the figure and
axes be created for us in the background (<a data-type="xref" href="#fig0407">Figure 4-7</a>; see
<a data-type="xref" href="#two-interfaces-for-the-price-of-one">“Two Interfaces for the Price of One”</a>
for a discussion of these two interfaces):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">4</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">));</code></pre>

<figure><div id="fig0407" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in07.png" alt="png" width="378" height="255">
<h6><span class="label">Figure 4-7. </span>A simple sinusoid via the object-oriented interface</h6>
</div></figure>

<p>If we want to create a single figure with multiple lines, we can simply
call the <code>plot</code> function multiple times (<a data-type="xref" href="#fig0408">Figure 4-8</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">5</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">))</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">cos</code><code class="p">(</code><code class="n">x</code><code class="p">));</code></pre>

<figure><div id="fig0408" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in08.png" alt="png" width="378" height="255">
<h6><span class="label">Figure 4-8. </span>Over-plotting multiple lines</h6>
</div></figure>

<p>That’s all there is to plotting simple functions in Matplotlib! We’ll now dive into some more details about how to control the appearance of
the axes and lines.</p>








<section data-type="sect2" data-pdf-bookmark="Adjusting the Plot: Line Colors and Styles"><div class="sect2" id="adjusting-the-plot-line-colors-and-styles">
<h2>Adjusting the Plot: Line Colors and Styles</h2>

<p><a data-type="indexterm" data-primary="line plots" data-secondary="line colors and styles" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc10"></a><a data-type="indexterm" data-primary="Matplotlib" data-secondary="line colors and styles" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc11"></a><a data-type="indexterm" data-primary="plotting" data-secondary="line colors and styles" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc12"></a><a data-type="indexterm" data-primary="simple line plots" data-secondary="line colors and styles" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc13"></a>The first adjustment you might wish to make to a plot is to control the
line colors and styles. <a data-type="indexterm" data-primary="plt.plot() function" data-secondary="color arguments" id="idm45026306605624"></a>The <code>plt.plot()</code> function takes additional
arguments that can be used to specify these. To adjust the color, you
can use the <code>color</code> keyword, which accepts a string argument
representing virtually any imaginable color. The color can be specified
in a variety of ways (<a data-type="xref" href="#fig0409">Figure 4-9</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">6</code><code class="p">]:</code>
<code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code> <code class="o">-</code> <code class="mi">0</code><code class="p">),</code> <code class="n">color</code><code class="o">=</code><code class="s1">'blue'</code><code class="p">)</code>        <code class="c1"># specify color by name</code>
<code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code> <code class="o">-</code> <code class="mi">1</code><code class="p">),</code> <code class="n">color</code><code class="o">=</code><code class="s1">'g'</code><code class="p">)</code>           <code class="c1"># short color code (rgbcmyk)</code>
<code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code> <code class="o">-</code> <code class="mi">2</code><code class="p">),</code> <code class="n">color</code><code class="o">=</code><code class="s1">'0.75'</code><code class="p">)</code>        <code class="c1"># Grayscale between 0 and 1</code>
<code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code> <code class="o">-</code> <code class="mi">3</code><code class="p">),</code> <code class="n">color</code><code class="o">=</code><code class="s1">'#FFDD44'</code><code class="p">)</code>     <code class="c1"># Hex code (RRGGBB from 00 to FF)</code>
<code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code> <code class="o">-</code> <code class="mi">4</code><code class="p">),</code> <code class="n">color</code><code class="o">=</code><code class="p">(</code><code class="mf">1.0</code><code class="p">,</code><code class="mf">0.2</code><code class="p">,</code><code class="mf">0.3</code><code class="p">))</code> <code class="c1"># RGB tuple, values 0 and 1</code>
<code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code> <code class="o">-</code> <code class="mi">5</code><code class="p">),</code> <code class="n">color</code><code class="o">=</code><code class="s1">'chartreuse'</code><code class="p">);</code> <code class="c1"># all HTML color names supported</code></pre>

<figure><div id="fig0409" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in09.png" alt="png" width="378" height="255">
<h6><span class="label">Figure 4-9. </span>Controlling the color of plot elements</h6>
</div></figure>

<p>If no color is specified, Matplotlib will automatically cycle through a
set of default colors for multiple lines.</p>

<p>Similarly, you can adjust the line style using the <code>linestyle</code> keyword (<a data-type="xref" href="#fig0410">Figure 4-10</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">7</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">x</code> <code class="o">+</code> <code class="mi">0</code><code class="p">,</code> <code class="n">linestyle</code><code class="o">=</code><code class="s1">'solid'</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">x</code> <code class="o">+</code> <code class="mi">1</code><code class="p">,</code> <code class="n">linestyle</code><code class="o">=</code><code class="s1">'dashed'</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">x</code> <code class="o">+</code> <code class="mi">2</code><code class="p">,</code> <code class="n">linestyle</code><code class="o">=</code><code class="s1">'dashdot'</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">x</code> <code class="o">+</code> <code class="mi">3</code><code class="p">,</code> <code class="n">linestyle</code><code class="o">=</code><code class="s1">'dotted'</code><code class="p">);</code>

       <code class="c1"># For short, you can use the following codes:</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">x</code> <code class="o">+</code> <code class="mi">4</code><code class="p">,</code> <code class="n">linestyle</code><code class="o">=</code><code class="s1">'-'</code><code class="p">)</code>  <code class="c1"># solid</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">x</code> <code class="o">+</code> <code class="mi">5</code><code class="p">,</code> <code class="n">linestyle</code><code class="o">=</code><code class="s1">'--'</code><code class="p">)</code> <code class="c1"># dashed</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">x</code> <code class="o">+</code> <code class="mi">6</code><code class="p">,</code> <code class="n">linestyle</code><code class="o">=</code><code class="s1">'-.'</code><code class="p">)</code> <code class="c1"># dashdot</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">x</code> <code class="o">+</code> <code class="mi">7</code><code class="p">,</code> <code class="n">linestyle</code><code class="o">=</code><code class="s1">':'</code><code class="p">);</code>  <code class="c1"># dotted</code></pre>

<figure><div id="fig0410" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in10.png" alt="png" width="370" height="255">
<h6><span class="label">Figure 4-10. </span>Example of various line styles</h6>
</div></figure>

<p>If you would like to be extremely terse, these <code>linestyle</code> and <code>color</code>
codes can be combined into a single nonkeyword argument to the
<code>plt.plot()</code> function (<a data-type="xref" href="#fig0411">Figure 4-11</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">8</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">x</code> <code class="o">+</code> <code class="mi">0</code><code class="p">,</code> <code class="s1">'-g'</code><code class="p">)</code>  <code class="c1"># solid green</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">x</code> <code class="o">+</code> <code class="mi">1</code><code class="p">,</code> <code class="s1">'--c'</code><code class="p">)</code> <code class="c1"># dashed cyan</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">x</code> <code class="o">+</code> <code class="mi">2</code><code class="p">,</code> <code class="s1">'-.k'</code><code class="p">)</code> <code class="c1"># dashdot black</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">x</code> <code class="o">+</code> <code class="mi">3</code><code class="p">,</code> <code class="s1">':r'</code><code class="p">);</code>  <code class="c1"># dotted red</code></pre>

<figure><div id="fig0411" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in11.png" alt="png" width="370" height="255">
<h6><span class="label">Figure 4-11. </span>Controlling colors and styles with the shorthand syntax</h6>
</div></figure>

<p>These single-character color codes reflect the standard abbreviations in
the RGB (Red/Green/Blue) and CMYK (Cyan/Magenta/Yellow/blacK) color
systems, commonly used for digital color graphics.</p>

<p>There are many other keyword arguments that can be used to fine-tune the
appearance of the plot; for more details, I’d suggest viewing the
docstring of the <code>plt.plot()</code> function using IPython’s help tools (see
<a data-type="xref" href="ch01.html#help-and-documentation-in-ipython">“Help and Documentation in IPython”</a>).<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc13" id="idm45026306237048"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc12" id="idm45026306236376"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc11" id="idm45026306235736"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc10" id="idm45026306235096"></a></p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Adjusting the Plot: Axes Limits"><div class="sect2" id="adjusting-the-plot-axes-limits">
<h2>Adjusting the Plot: Axes Limits</h2>

<p><a data-type="indexterm" data-primary="axes limits" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc14"></a><a data-type="indexterm" data-primary="line plots" data-secondary="axes limits for" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc15"></a><a data-type="indexterm" data-primary="Matplotlib" data-secondary="axes limits for line plots" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc16"></a><a data-type="indexterm" data-primary="plotting" data-secondary="axes limits for simple line plots" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc17"></a><a data-type="indexterm" data-primary="simple line plots" data-secondary="axes limits for" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc18"></a>Matplotlib does a decent job of choosing default axes limits for your
plot, but sometimes it’s nice to have finer control. The most basic way
to adjust axis limits is to use the <code>plt.xlim()</code> and <code>plt.ylim()</code>
methods (<a data-type="xref" href="#fig0412">Figure 4-12</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">9</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">))</code>

       <code class="n">plt</code><code class="o">.</code><code class="n">xlim</code><code class="p">(</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code> <code class="mi">11</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">ylim</code><code class="p">(</code><code class="o">-</code><code class="mf">1.5</code><code class="p">,</code> <code class="mf">1.5</code><code class="p">);</code></pre>

<figure><div id="fig0412" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in12.png" alt="png" width="373" height="255">
<h6><span class="label">Figure 4-12. </span>Example of setting axis limits</h6>
</div></figure>

<p>If for some reason you’d like either axis to be displayed in reverse,
you can simply reverse the order of the arguments (<a data-type="xref" href="#fig0413">Figure 4-13</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">10</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">))</code>

        <code class="n">plt</code><code class="o">.</code><code class="n">xlim</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code> <code class="mi">0</code><code class="p">)</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">ylim</code><code class="p">(</code><code class="mf">1.2</code><code class="p">,</code> <code class="o">-</code><code class="mf">1.2</code><code class="p">);</code></pre>

<figure><div id="fig0413" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in13.png" alt="png" width="375" height="250">
<h6><span class="label">Figure 4-13. </span>Example of reversing the y-axis</h6>
</div></figure>

<p>A useful related method is <code>plt.axis()</code> (note here the potential
confusion between <em>axes</em> with an <em>e</em>, and <em>axis</em> with an <em>i</em>). The
<code>plt.axis()</code> method allows you to set the <code>x</code> and <code>y</code> limits with a single
call, by passing a list that specifies <code>[xmin, xmax, ymin, ymax]</code> (<a data-type="xref" href="#fig0414">Figure 4-14</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">11</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">))</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">axis</code><code class="p">([</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code> <code class="mi">11</code><code class="p">,</code> <code class="o">-</code><code class="mf">1.5</code><code class="p">,</code> <code class="mf">1.5</code><code class="p">]);</code></pre>

<figure><div id="fig0414" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in14.png" alt="png" width="373" height="255">
<h6><span class="label">Figure 4-14. </span>Setting the axis limits with plt.axis</h6>
</div></figure>

<p>The <code>plt.axis()</code> method goes even beyond this, allowing you to do things
like automatically tighten the bounds around the current plot (<a data-type="xref" href="#fig0415">Figure 4-15</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">12</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">))</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">axis</code><code class="p">(</code><code class="s1">'tight'</code><code class="p">);</code></pre>

<figure><div id="fig0415" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in15.png" alt="png" width="378" height="255">
<h6><span class="label">Figure 4-15. </span>Example of a “tight” layout</h6>
</div></figure>

<p>It allows even higher-level specifications, such as ensuring an equal
aspect ratio so that on your screen, one unit in <code>x</code> is equal to one unit
in <code>y</code> (<a data-type="xref" href="#fig0416">Figure 4-16</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">13</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">))</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">axis</code><code class="p">(</code><code class="s1">'equal'</code><code class="p">);</code></pre>

<figure><div id="fig0416" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in16.png" alt="png" width="370" height="250">
<h6><span class="label">Figure 4-16. </span>Example of an “equal” layout, with units matched to the output resolution</h6>
</div></figure>

<p>For more information on axis limits and the other capabilities of the
<code>plt.axis()</code> method, refer to the <code>plt.axis()</code> docstring.<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc18" id="idm45026305844808"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc17" id="idm45026305844104"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc16" id="idm45026305843464"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc15" id="idm45026305842824"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc14" id="idm45026305842184"></a></p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Labeling Plots"><div class="sect2" id="labeling-plots">
<h2>Labeling Plots</h2>

<p><a data-type="indexterm" data-primary="labels/labeling" data-secondary="simple line plots" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc19"></a><a data-type="indexterm" data-primary="line plots" data-secondary="labeling" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc20"></a><a data-type="indexterm" data-primary="Matplotlib" data-secondary="labeling simple line plots" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc21"></a><a data-type="indexterm" data-primary="plotting" data-secondary="labeling simple line plots" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc22"></a><a data-type="indexterm" data-primary="simple line plots" data-secondary="labeling" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc23"></a>As the last piece of this section, we’ll briefly look at the labeling of
plots: titles, axis labels, and simple legends.</p>

<p>Titles and axis labels are the simplest such labels—there are methods
that can be used to quickly set them (<a data-type="xref" href="#fig0417">Figure 4-17</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">14</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">))</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">title</code><code class="p">(</code><code class="s2">"A Sine Curve"</code><code class="p">)</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">xlabel</code><code class="p">(</code><code class="s2">"x"</code><code class="p">)</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">ylabel</code><code class="p">(</code><code class="s2">"sin(x)"</code><code class="p">);</code></pre>

<figure><div id="fig0417" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in17.png" alt="png" width="392" height="277">
<h6><span class="label">Figure 4-17. </span>Examples of axis labels and title</h6>
</div></figure>

<p>You can adjust the position, size, and style of these labels using
optional arguments to the function. For more information, see the
Matplotlib documentation and the docstrings of each of these functions.</p>

<p>When multiple lines are being shown within a single axes, it can be
useful to create a plot legend that labels each line type. Again,
Matplotlib has a built-in way of quickly creating such a legend. It is
done via the (you guessed it) <code>plt.legend()</code> method. Though there are
several valid ways of using this, I find it easiest to specify the label
of each line using the <code>label</code> keyword of the plot function (<a data-type="xref" href="#fig0418">Figure 4-18</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">15</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">),</code> <code class="s1">'-g'</code><code class="p">,</code> <code class="n">label</code><code class="o">=</code><code class="s1">'sin(x)'</code><code class="p">)</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">cos</code><code class="p">(</code><code class="n">x</code><code class="p">),</code> <code class="s1">':b'</code><code class="p">,</code> <code class="n">label</code><code class="o">=</code><code class="s1">'cos(x)'</code><code class="p">)</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">axis</code><code class="p">(</code><code class="s1">'equal'</code><code class="p">)</code>

        <code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">();</code></pre>

<figure><div id="fig0418" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in18.png" alt="png" width="370" height="250">
<h6><span class="label">Figure 4-18. </span>Plot legend example</h6>
</div></figure>

<p>As you can see, the <code>plt.legend()</code> function keeps track of the line
style and color, and matches these with the correct label. More
information on specifying and formatting plot legends can be found in
the <code>plt.legend()</code> docstring; additionally, we will cover some more
advanced legend options in
<a data-type="xref" href="#customizing-plot-legends">“Customizing Plot Legends”</a>.<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc23" id="idm45026305703768"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc22" id="idm45026305703096"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc21" id="idm45026305702456"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc20" id="idm45026305701816"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc19" id="idm45026305701176"></a></p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="aside-matplotlib-gotchas">
<h5>Matplotlib Gotchas</h5>
<p><a data-type="indexterm" data-primary="Matplotlib" data-secondary="gotchas" id="idm45026305698888"></a>While most <code>plt</code> functions translate directly to <code>ax</code> methods (such as
<code>plt.plot()</code> → <code>ax.plot()</code>, <code>plt.legend()</code> → <code>ax.legend()</code>, etc.), this
is not the case for all commands. In particular, functions to set
limits, labels, and titles are slightly modified. For transitioning
between MATLAB-style functions and object-oriented methods, make the
following changes:</p>

<ul>
<li>
<p><code>plt.xlabel()</code> → <code>ax.set_xlabel()</code></p>
</li>
<li>
<p><code>plt.ylabel()</code> → <code>ax.set_ylabel()</code></p>
</li>
<li>
<p><code>plt.xlim()</code> → <code>ax.set_xlim()</code></p>
</li>
<li>
<p><code>plt.ylim()</code> → <code>ax.set_ylim()</code></p>
</li>
<li>
<p><code>plt.title()</code> → <code>ax.set_title()</code></p>
</li>
</ul>

<p>In the object-oriented interface to plotting, rather than calling these
functions individually, it is often more convenient to use the
<code>ax.set()</code> method to set all these properties at once (<a data-type="xref" href="#fig0419">Figure 4-19</a>):<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc9" id="idm45026305685160"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc8" id="idm45026305684360"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc7" id="idm45026305683656"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc6" id="idm45026305682952"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc5" id="idm45026305682248"></a></p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">16</code><code class="p">]:</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">axes</code><code class="p">()</code>
        <code class="n">ax</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">))</code>
        <code class="n">ax</code><code class="o">.</code><code class="n">set</code><code class="p">(</code><code class="n">xlim</code><code class="o">=</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">10</code><code class="p">),</code> <code class="n">ylim</code><code class="o">=</code><code class="p">(</code><code class="o">-</code><code class="mi">2</code><code class="p">,</code> <code class="mi">2</code><code class="p">),</code>
               <code class="n">xlabel</code><code class="o">=</code><code class="s1">'x'</code><code class="p">,</code> <code class="n">ylabel</code><code class="o">=</code><code class="s1">'sin(x)'</code><code class="p">,</code>
               <code class="n">title</code><code class="o">=</code><code class="s1">'A Simple Plot'</code><code class="p">);</code></pre>

<figure><div id="fig0419" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in19.png" alt="png" width="392" height="277">
<h6><span class="label">Figure 4-19. </span>Example of using ax.set to set multiple properties at once</h6>
</div></figure>
</div></aside>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Simple Scatter Plots"><div class="sect1" id="simple-scatter-plots">
<h1>Simple Scatter Plots</h1>

<p><a data-type="indexterm" data-primary="plotting" data-secondary="simple scatter plots" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc24"></a><a data-type="indexterm" data-primary="simple scatter plots" data-secondary="Matplotlib" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc25"></a>Another commonly used plot type is the simple scatter plot, a close
cousin of the line plot. Instead of points being joined by line
segments, here the points are represented individually with a dot,
circle, or other shape. We’ll start by setting up the notebook for plotting and importing the functions we will use:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">1</code><code class="p">]:</code> <code class="o">%</code><code class="n">matplotlib</code> <code class="n">inline</code>
       <code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="kn">as</code> <code class="nn">plt</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">use</code><code class="p">(</code><code class="s1">'seaborn-whitegrid'</code><code class="p">)</code>
       <code class="kn">import</code> <code class="nn">numpy</code> <code class="kn">as</code> <code class="nn">np</code></pre>








<section data-type="sect2" data-pdf-bookmark="Scatter Plots with plt.plot"><div class="sect2" id="scatter-plots-with-plt.plot">
<h2>Scatter Plots with plt.plot</h2>

<p><a data-type="indexterm" data-primary="plt.plot() function" data-secondary="scatter plots with" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc26"></a><a data-type="indexterm" data-primary="simple scatter plots" data-secondary="plt.plot" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc27"></a>In the previous section, we looked at <code>plt.plot</code>/<code>ax.plot</code> to produce line
plots. It turns out that this same function can produce scatter plots as
well (<a data-type="xref" href="#fig0420">Figure 4-20</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">2</code><code class="p">]:</code> <code class="n">x</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">10</code><code class="p">,</code> <code class="mi">30</code><code class="p">)</code>
       <code class="n">y</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">)</code>

       <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">,</code> <code class="s1">'o'</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s1">'black'</code><code class="p">);</code></pre>

<figure><div id="fig0420" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in20.png" alt="png" width="378" height="255">
<h6><span class="label">Figure 4-20. </span>Scatter plot example</h6>
</div></figure>

<p>The third argument in the function call is a character that represents
the type of symbol used for the plotting. Just as you can specify options such as <code>'-'</code> and <code>'--'</code> to control the line style, the marker style has its own set
of short string codes. The full list of available symbols can be seen in
the documentation of <code>plt.plot</code>, or in Matplotlib’s online
documentation. Most of the possibilities are fairly intuitive, and we’ll
show a number of the more common ones here (<a data-type="xref" href="#fig0421">Figure 4-21</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">3</code><code class="p">]:</code> <code class="n">rng</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">RandomState</code><code class="p">(</code><code class="mi">0</code><code class="p">)</code>
       <code class="k">for</code> <code class="n">marker</code> <code class="ow">in</code> <code class="p">[</code><code class="s1">'o'</code><code class="p">,</code> <code class="s1">'.'</code><code class="p">,</code> <code class="s1">','</code><code class="p">,</code> <code class="s1">'x'</code><code class="p">,</code> <code class="s1">'+'</code><code class="p">,</code> <code class="s1">'v'</code><code class="p">,</code> <code class="s1">'^'</code><code class="p">,</code> <code class="s1">'&lt;'</code><code class="p">,</code> <code class="s1">'&gt;'</code><code class="p">,</code> <code class="s1">'s'</code><code class="p">,</code> <code class="s1">'d'</code><code class="p">]:</code>
           <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">rng</code><code class="o">.</code><code class="n">rand</code><code class="p">(</code><code class="mi">5</code><code class="p">),</code> <code class="n">rng</code><code class="o">.</code><code class="n">rand</code><code class="p">(</code><code class="mi">5</code><code class="p">),</code> <code class="n">marker</code><code class="p">,</code>
                    <code class="n">label</code><code class="o">=</code><code class="s2">"marker='{0}'"</code><code class="o">.</code><code class="n">format</code><code class="p">(</code><code class="n">marker</code><code class="p">))</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="n">numpoints</code><code class="o">=</code><code class="mi">1</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">xlim</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mf">1.8</code><code class="p">);</code></pre>

<figure><div id="fig0421" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in21.png" alt="png" width="374" height="255">
<h6><span class="label">Figure 4-21. </span>Demonstration of point numbers</h6>
</div></figure>

<p>For even more possibilities, these character codes can be used together
with line and color codes to plot points along with a line connecting
them (<a data-type="xref" href="#fig0422">Figure 4-22</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">4</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">,</code> <code class="s1">'-ok'</code><code class="p">);</code>   <code class="c1"># line (-), circle marker (o), black (k)</code></pre>

<figure><div id="fig0422" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in22.png" alt="png" width="378" height="255">
<h6><span class="label">Figure 4-22. </span>Combining line and point markers</h6>
</div></figure>

<p>Additional keyword arguments to <code>plt.plot</code> specify a wide range of
properties of the lines and markers (<a data-type="xref" href="#fig0423">Figure 4-23</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">5</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">,</code> <code class="s1">'-p'</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s1">'gray'</code><code class="p">,</code>
                <code class="n">markersize</code><code class="o">=</code><code class="mi">15</code><code class="p">,</code> <code class="n">linewidth</code><code class="o">=</code><code class="mi">4</code><code class="p">,</code>
                <code class="n">markerfacecolor</code><code class="o">=</code><code class="s1">'white'</code><code class="p">,</code>
                <code class="n">markeredgecolor</code><code class="o">=</code><code class="s1">'gray'</code><code class="p">,</code>
                <code class="n">markeredgewidth</code><code class="o">=</code><code class="mi">2</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">ylim</code><code class="p">(</code><code class="o">-</code><code class="mf">1.2</code><code class="p">,</code> <code class="mf">1.2</code><code class="p">);</code></pre>

<figure><div id="fig0423" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in23.png" alt="png" width="378" height="250">
<h6><span class="label">Figure 4-23. </span>Customizing line and point numbers</h6>
</div></figure>

<p>This type of flexibility in the <code>plt.plot</code> function allows for a wide
variety of possible visualization options. For a full description of the
options available, refer to the <code>plt.plot</code> documentation.<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc27" id="idm45026305209000"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc26" id="idm45026305208296"></a></p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Scatter Plots with plt.scatter"><div class="sect2" id="scatter-plots-with-plt.scatter">
<h2>Scatter Plots with plt.scatter</h2>

<p><a data-type="indexterm" data-primary="plt.scatter() function" data-secondary="simple scatter plots with" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc28"></a><a data-type="indexterm" data-primary="simple scatter plots" data-secondary="plt.scatter" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc29"></a>A second, more powerful method of creating scatter plots is the
<code>plt.scatter</code> function, which can be used very similarly to the
<code>plt.plot</code> function (<a data-type="xref" href="#fig0424">Figure 4-24</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">6</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">scatter</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">,</code> <code class="n">marker</code><code class="o">=</code><code class="s1">'o'</code><code class="p">);</code></pre>

<figure><div id="fig0424" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in24.png" alt="png" width="378" height="255">
<h6><span class="label">Figure 4-24. </span>A simple scatter plot</h6>
</div></figure>

<p>The primary difference of <code>plt.scatter</code> from <code>plt.plot</code> is that it can
be used to create scatter plots where the properties of each individual
point (size, face color, edge color, etc.) can be individually
controlled or mapped to data.</p>

<p>Let’s show this by creating a random scatter plot with points of many
colors and sizes. In order to better see the overlapping results, we’ll
also use the <code>alpha</code> keyword to adjust the transparency level (<a data-type="xref" href="#fig0425">Figure 4-25</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">7</code><code class="p">]:</code> <code class="n">rng</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">RandomState</code><code class="p">(</code><code class="mi">0</code><code class="p">)</code>
       <code class="n">x</code> <code class="o">=</code> <code class="n">rng</code><code class="o">.</code><code class="n">randn</code><code class="p">(</code><code class="mi">100</code><code class="p">)</code>
       <code class="n">y</code> <code class="o">=</code> <code class="n">rng</code><code class="o">.</code><code class="n">randn</code><code class="p">(</code><code class="mi">100</code><code class="p">)</code>
       <code class="n">colors</code> <code class="o">=</code> <code class="n">rng</code><code class="o">.</code><code class="n">rand</code><code class="p">(</code><code class="mi">100</code><code class="p">)</code>
       <code class="n">sizes</code> <code class="o">=</code> <code class="mi">1000</code> <code class="o">*</code> <code class="n">rng</code><code class="o">.</code><code class="n">rand</code><code class="p">(</code><code class="mi">100</code><code class="p">)</code>

       <code class="n">plt</code><code class="o">.</code><code class="n">scatter</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">,</code> <code class="n">c</code><code class="o">=</code><code class="n">colors</code><code class="p">,</code> <code class="n">s</code><code class="o">=</code><code class="n">sizes</code><code class="p">,</code> <code class="n">alpha</code><code class="o">=</code><code class="mf">0.3</code><code class="p">,</code>
                   <code class="n">cmap</code><code class="o">=</code><code class="s1">'viridis'</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">colorbar</code><code class="p">();</code>  <code class="c1"># show color scale</code></pre>

<figure><div id="fig0425" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in25.png" alt="png" width="343" height="255">
<h6><span class="label">Figure 4-25. </span>Changing size, color, and transparency in scatter points</h6>
</div></figure>

<p>Notice that the color argument is
automatically mapped to a color scale (shown here by the <code>colorbar()</code>
command), and the size argument is given in pixels. In this way, the
color and size of points can be used to convey information in the
visualization, in order to illustrate multidimensional data.</p>

<p><a data-type="indexterm" data-primary="Iris dataset" data-secondary="scatter plots" id="idm45026305048696"></a>For example, we might use the Iris data from Scikit-Learn, where each
sample is one of three types of flowers that has had the size of its
petals and sepals carefully measured (<a data-type="xref" href="#fig0426">Figure 4-26</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">8</code><code class="p">]:</code> <code class="kn">from</code> <code class="nn">sklearn.datasets</code> <code class="kn">import</code> <code class="n">load_iris</code>
       <code class="n">iris</code> <code class="o">=</code> <code class="n">load_iris</code><code class="p">()</code>
       <code class="n">features</code> <code class="o">=</code> <code class="n">iris</code><code class="o">.</code><code class="n">data</code><code class="o">.</code><code class="n">T</code>

       <code class="n">plt</code><code class="o">.</code><code class="n">scatter</code><code class="p">(</code><code class="n">features</code><code class="p">[</code><code class="mi">0</code><code class="p">],</code> <code class="n">features</code><code class="p">[</code><code class="mi">1</code><code class="p">],</code> <code class="n">alpha</code><code class="o">=</code><code class="mf">0.2</code><code class="p">,</code>
                   <code class="n">s</code><code class="o">=</code><code class="mi">100</code><code class="o">*</code><code class="n">features</code><code class="p">[</code><code class="mi">3</code><code class="p">],</code> <code class="n">c</code><code class="o">=</code><code class="n">iris</code><code class="o">.</code><code class="n">target</code><code class="p">,</code> <code class="n">cmap</code><code class="o">=</code><code class="s1">'viridis'</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">xlabel</code><code class="p">(</code><code class="n">iris</code><code class="o">.</code><code class="n">feature_names</code><code class="p">[</code><code class="mi">0</code><code class="p">])</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">ylabel</code><code class="p">(</code><code class="n">iris</code><code class="o">.</code><code class="n">feature_names</code><code class="p">[</code><code class="mi">1</code><code class="p">]);</code></pre>

<figure><div id="fig0426" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in26.png" alt="png" width="388" height="269">
<h6><span class="label">Figure 4-26. </span>Using point properties to encode features of the Iris data</h6>
</div></figure>

<p>We can see that this scatter plot has given us the ability to
simultaneously explore four different dimensions of the data: the (x, y)
location of each point corresponds to the sepal length and width, the
size of the point is related to the petal width, and the color is
related to the particular species of flower. Multicolor and
multifeature scatter plots like this can be useful for both exploration
and presentation of data.<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc29" id="idm45026304922216"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc28" id="idm45026304921544"></a></p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="plot Versus scatter: A Note on Efficiency"><div class="sect2" id="plot-vs.-scatter-a-note-on-efficiency">
<h2>plot Versus scatter: A Note on Efficiency</h2>

<p><a data-type="indexterm" data-primary="plt.plot() function" data-secondary="plt.scatter vs." id="idm45026305189800"></a><a data-type="indexterm" data-primary="plt.scatter() function" data-secondary="plt.plot vs." id="idm45026304918280"></a><a data-type="indexterm" data-primary="simple scatter plots" data-secondary="plt.plot vs. plt.scatter" id="idm45026304917336"></a>Aside from the different features available in <code>plt.plot</code> and
<code>plt.scatter</code>, why might you choose to use one over the other? While it
doesn’t matter as much for small amounts of data, as datasets get larger
than a few thousand points, <code>plt.plot</code> can be noticeably more efficient
than <code>plt.scatter</code>. The reason is that <code>plt.scatter</code> has the capability
to render a different size and/or color for each point, so the renderer
must do the extra work of constructing each point individually. In
<code>plt.plot</code>, on the other hand, the points are always essentially clones
of each other, so the work of determining the appearance of the points
is done only once for the entire set of data. For large datasets, the
difference between these two can lead to vastly different performance,
and for this reason, <code>plt.plot</code> should be preferred over <code>plt.scatter</code>
for large <span class="keep-together">datasets</span>.<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc25" id="idm45026304911560"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc24" id="idm45026304910856"></a></p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Visualizing Errors"><div class="sect1" id="visualizing-errors">
<h1>Visualizing Errors</h1>

<p><a data-type="indexterm" data-primary="errors, visualizing" data-secondary="Matplotlib" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc30"></a><a data-type="indexterm" data-primary="Matplotlib" data-secondary="error visualization" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc31"></a><a data-type="indexterm" data-primary="plotting" data-secondary="of errors" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc32"></a>For any scientific measurement, accurate accounting for errors is nearly
as important, if not more important, than accurate reporting of the
number itself. For example, imagine that I am using some astrophysical
observations to estimate the Hubble Constant, the local measurement of
the expansion rate of the universe. I know that the current literature
suggests a value of around 71 (km/s)/Mpc, and I measure a value of 74
(km/s)/Mpc with my method. Are the values consistent? The only correct
answer, given this information, is this: there is no way to know.</p>

<p>Suppose I augment this information with reported uncertainties: the
current literature suggests a value of around 71 <math xmlns="http://www.w3.org/1998/Math/MathML" alttext="plus-or-minus">
  <mo>±</mo>
</math> 2.5
(km/s)/Mpc, and my method has measured a value of 74 <math xmlns="http://www.w3.org/1998/Math/MathML">
  <mo>±</mo>
</math> 5
(km/s)/Mpc. Now are the values consistent? That is a question that can
be quantitatively answered.</p>

<p>In visualization of data and results, showing these errors effectively
can make a plot convey much more complete information.</p>








<section data-type="sect2" data-pdf-bookmark="Basic Errorbars"><div class="sect2" id="basic-errorbars">
<h2>Basic Errorbars</h2>

<p><a data-type="indexterm" data-primary="errors, visualizing" data-secondary="basic errorbars" id="idm45026304898760"></a>A basic errorbar can be created with a single Matplotlib function call (<a data-type="xref" href="#fig0427">Figure 4-27</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">1</code><code class="p">]:</code> <code class="o">%</code><code class="n">matplotlib</code> <code class="n">inline</code>
       <code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="kn">as</code> <code class="nn">plt</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">use</code><code class="p">(</code><code class="s1">'seaborn-whitegrid'</code><code class="p">)</code>
       <code class="kn">import</code> <code class="nn">numpy</code> <code class="kn">as</code> <code class="nn">np</code></pre>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">2</code><code class="p">]:</code> <code class="n">x</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">10</code><code class="p">,</code> <code class="mi">50</code><code class="p">)</code>
       <code class="n">dy</code> <code class="o">=</code> <code class="mf">0.8</code>
       <code class="n">y</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">)</code> <code class="o">+</code> <code class="n">dy</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">randn</code><code class="p">(</code><code class="mi">50</code><code class="p">)</code>

       <code class="n">plt</code><code class="o">.</code><code class="n">errorbar</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">,</code> <code class="n">yerr</code><code class="o">=</code><code class="n">dy</code><code class="p">,</code> <code class="n">fmt</code><code class="o">=</code><code class="s1">'.k'</code><code class="p">);</code></pre>

<figure><div id="fig0427" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in27.png" alt="png" width="370" height="255">
<h6><span class="label">Figure 4-27. </span>An errorbar example</h6>
</div></figure>

<p>Here the <code>fmt</code> is a format code controlling the appearance of lines and
points, and has the same syntax as the shorthand used in <code>plt.plot</code>,
outlined in <a data-type="xref" href="#simple-line-plots">“Simple Line Plots”</a> and
<a data-type="xref" href="#simple-scatter-plots">“Simple Scatter Plots”</a>.</p>

<p>In addition to these basic options, the <code>errorbar</code> function has many
options to fine-tune the outputs. Using these additional options you can
easily customize the aesthetics of your errorbar plot. I often find it
helpful, especially in crowded plots, to make the errorbars lighter than
the points themselves (<a data-type="xref" href="#fig0428">Figure 4-28</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">3</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">errorbar</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">,</code> <code class="n">yerr</code><code class="o">=</code><code class="n">dy</code><code class="p">,</code> <code class="n">fmt</code><code class="o">=</code><code class="s1">'o'</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s1">'black'</code><code class="p">,</code>
                    <code class="n">ecolor</code><code class="o">=</code><code class="s1">'lightgray'</code><code class="p">,</code> <code class="n">elinewidth</code><code class="o">=</code><code class="mi">3</code><code class="p">,</code> <code class="n">capsize</code><code class="o">=</code><code class="mi">0</code><code class="p">);</code></pre>

<figure><div id="fig0428" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in28.png" alt="png" width="370" height="255">
<h6><span class="label">Figure 4-28. </span>Customizing errorbars</h6>
</div></figure>

<p>In addition to these options, you can also specify horizontal errorbars
(<code>xerr</code>), one-sided errorbars, and many other variants. For more
information on the options available, refer to the docstring of
<code>plt.errorbar</code>.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Continuous Errors"><div class="sect2" id="continuous-errors">
<h2>Continuous Errors</h2>

<p><a data-type="indexterm" data-primary="errors, visualizing" data-secondary="continuous quantities" id="idm45026304681064"></a>In some situations it is desirable to show errorbars on continuous
quantities. Though Matplotlib does not have a built-in convenience
routine for this type of application, it’s relatively easy to combine
primitives like <code>plt.plot</code> and <code>plt.fill_between</code> for a useful result.</p>

<p><a data-type="indexterm" data-primary="Gaussian process regression (GPR)" id="idm45026304678568"></a>Here we’ll perform a simple <em>Gaussian process regression</em> (GPR), using
the Scikit-Learn API (see
<a data-type="xref" href="ch05.html#introducing-scikit-learn">“Introducing Scikit-Learn”</a> for
details). This is a method of fitting a very flexible nonparametric
function to data with a continuous measure of the uncertainty. We won’t delve into the details of Gaussian process regression at this point,
but will focus instead on how you might visualize such a continuous
error measurement:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">4</code><code class="p">]:</code> <code class="kn">from</code> <code class="nn">sklearn.gaussian_process</code> <code class="kn">import</code> <code class="n">GaussianProcess</code>

       <code class="c1"># define the model and draw some data</code>
       <code class="n">model</code> <code class="o">=</code> <code class="k">lambda</code> <code class="n">x</code><code class="p">:</code> <code class="n">x</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">)</code>
       <code class="n">xdata</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">,</code> <code class="mi">8</code><code class="p">])</code>
       <code class="n">ydata</code> <code class="o">=</code> <code class="n">model</code><code class="p">(</code><code class="n">xdata</code><code class="p">)</code>

       <code class="c1"># Compute the Gaussian process fit</code>
       <code class="n">gp</code> <code class="o">=</code> <code class="n">GaussianProcess</code><code class="p">(</code><code class="n">corr</code><code class="o">=</code><code class="s1">'cubic'</code><code class="p">,</code> <code class="n">theta0</code><code class="o">=</code><code class="mf">1e-2</code><code class="p">,</code> <code class="n">thetaL</code><code class="o">=</code><code class="mf">1e-4</code><code class="p">,</code> <code class="n">thetaU</code><code class="o">=</code><code class="mf">1E-1</code><code class="p">,</code>
                            <code class="n">random_start</code><code class="o">=</code><code class="mi">100</code><code class="p">)</code>
       <code class="n">gp</code><code class="o">.</code><code class="n">fit</code><code class="p">(</code><code class="n">xdata</code><code class="p">[:,</code> <code class="n">np</code><code class="o">.</code><code class="n">newaxis</code><code class="p">],</code> <code class="n">ydata</code><code class="p">)</code>

       <code class="n">xfit</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">10</code><code class="p">,</code> <code class="mi">1000</code><code class="p">)</code>
       <code class="n">yfit</code><code class="p">,</code> <code class="n">MSE</code> <code class="o">=</code> <code class="n">gp</code><code class="o">.</code><code class="n">predict</code><code class="p">(</code><code class="n">xfit</code><code class="p">[:,</code> <code class="n">np</code><code class="o">.</code><code class="n">newaxis</code><code class="p">],</code> <code class="n">eval_MSE</code><code class="o">=</code><code class="bp">True</code><code class="p">)</code>
       <code class="n">dyfit</code> <code class="o">=</code> <code class="mi">2</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">sqrt</code><code class="p">(</code><code class="n">MSE</code><code class="p">)</code>  <code class="c1"># 2*sigma ~ 95% confidence region</code></pre>

<p>We now have <code>xfit</code>, <code>yfit</code>, and <code>dyfit</code>, which sample the continuous fit
to our data. We could pass these to the <code>plt.errorbar</code> function as
above, but we don’t really want to plot 1,000 points with 1,000 errorbars.
Instead, we can use the <code>plt.fill_between</code> function with a light color
to visualize this continuous error (<a data-type="xref" href="#fig0429">Figure 4-29</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">5</code><code class="p">]:</code> <code class="c1"># Visualize the result</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">xdata</code><code class="p">,</code> <code class="n">ydata</code><code class="p">,</code> <code class="s1">'or'</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">xfit</code><code class="p">,</code> <code class="n">yfit</code><code class="p">,</code> <code class="s1">'-'</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s1">'gray'</code><code class="p">)</code>

       <code class="n">plt</code><code class="o">.</code><code class="n">fill_between</code><code class="p">(</code><code class="n">xfit</code><code class="p">,</code> <code class="n">yfit</code> <code class="o">-</code> <code class="n">dyfit</code><code class="p">,</code> <code class="n">yfit</code> <code class="o">+</code> <code class="n">dyfit</code><code class="p">,</code>
                        <code class="n">color</code><code class="o">=</code><code class="s1">'gray'</code><code class="p">,</code> <code class="n">alpha</code><code class="o">=</code><code class="mf">0.2</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">xlim</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">10</code><code class="p">);</code></pre>

<figure><div id="fig0429" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in29.png" alt="png" width="375" height="255">
<h6><span class="label">Figure 4-29. </span>Representing continuous uncertainty with filled regions</h6>
</div></figure>

<p>Note what we’ve done here with the <code>fill_between</code> function: we pass an x
value, then the lower y-bound, then the upper y-bound, and the result is
that the area between these regions is filled.</p>

<p>The resulting figure gives a very intuitive view into what the Gaussian
process regression algorithm is doing: in regions near a measured data
point, the model is strongly constrained and this is reflected in the
small model errors. In regions far from a measured data point, the model
is not strongly constrained, and the model errors increase.</p>

<p>For more information on the options available in <code>plt.fill_between()</code>
(and the closely related <code>plt.fill()</code> function), see the function
docstring or the Matplotlib documentation.</p>

<p>Finally, if this seems a bit too low level for your taste, refer to
<a data-type="xref" href="#visualization-with-seaborn">“Visualization with Seaborn”</a>, where we discuss the Seaborn package,
which has a more streamlined API
for visualizing this type of continuous errorbar.<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc32" id="idm45026304370248"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc31" id="idm45026304369608"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc30" id="idm45026304368968"></a></p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Density and Contour Plots"><div class="sect1" id="density-and-contour-plots">
<h1>Density and Contour Plots</h1>

<p><a data-type="indexterm" data-primary="contour plots" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc33"></a><a data-type="indexterm" data-primary="contour plots" data-secondary="density and" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc34"></a><a data-type="indexterm" data-primary="Matplotlib" data-secondary="density and contour plots" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc35"></a><a data-type="indexterm" data-primary="plotting" data-secondary="density and contour plots" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc36"></a>Sometimes it is useful to display three-dimensional data in
two dimensions using contours or color-coded regions. There are three
Matplotlib functions that can be helpful for this task: <code>plt.contour</code>
for contour plots, <code>plt.contourf</code> for filled contour plots, and
<code>plt.imshow</code> for showing images. This section looks at several examples of using these. We’ll start by setting up the notebook for plotting and importing the functions we will use:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">1</code><code class="p">]:</code> <code class="o">%</code><code class="n">matplotlib</code> <code class="n">inline</code>
       <code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="kn">as</code> <code class="nn">plt</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">use</code><code class="p">(</code><code class="s1">'seaborn-white'</code><code class="p">)</code>
       <code class="kn">import</code> <code class="nn">numpy</code> <code class="kn">as</code> <code class="nn">np</code></pre>








<section data-type="sect2" data-pdf-bookmark="Visualizing a Three-Dimensional Function"><div class="sect2" id="visualizing-a-3d-function">
<h2>Visualizing a Three-Dimensional Function</h2>

<p><a data-type="indexterm" data-primary="contour plots" data-secondary="three-dimensional function" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc37"></a><a data-type="indexterm" data-primary="Matplotlib" data-secondary="three-dimensional function visualization" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc38"></a><a data-type="indexterm" data-primary="plotting" data-secondary="three-dimensional function" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc39"></a>We’ll start by demonstrating a contour plot using a function
<math xmlns="http://www.w3.org/1998/Math/MathML" alttext="z equals f left-parenthesis x comma y right-parenthesis">
  <mrow>
    <mi>z</mi>
    <mo>=</mo>
    <mi>f</mi>
    <mo>(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo>)</mo>
  </mrow>
</math>, using the following particular choice for
<math xmlns="http://www.w3.org/1998/Math/MathML" alttext="f">
  <mi>f</mi>
</math> (we’ve seen this before in
<a data-type="xref" href="ch02.html#computation-on-arrays-broadcasting">“Computation on Arrays: Broadcasting”</a>, when we used it as a motivating example for array
<span class="keep-together">broadcasting</span>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">2</code><code class="p">]:</code> <code class="k">def</code> <code class="nf">f</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">):</code>
           <code class="k">return</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">)</code> <code class="o">**</code> <code class="mi">10</code> <code class="o">+</code> <code class="n">np</code><code class="o">.</code><code class="n">cos</code><code class="p">(</code><code class="mi">10</code> <code class="o">+</code> <code class="n">y</code> <code class="o">*</code> <code class="n">x</code><code class="p">)</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">cos</code><code class="p">(</code><code class="n">x</code><code class="p">)</code></pre>

<p><a data-type="indexterm" data-primary="plt.contour() function" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc40"></a>A contour plot can be created with the <code>plt.contour</code> function. It takes
three arguments: a grid of <em>x</em> values, a grid of <em>y</em> values, and a grid of <em>z</em>
values. The <em>x</em> and <em>y</em> values represent positions on the plot, and the <em>z</em>
values will be represented by the contour levels. Perhaps the most
straightforward way to prepare such data is to use the <code>np.meshgrid</code>
function, which builds two-dimensional grids from one-dimensional arrays:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">3</code><code class="p">]:</code> <code class="n">x</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">50</code><code class="p">)</code>
       <code class="n">y</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">40</code><code class="p">)</code>

       <code class="n">X</code><code class="p">,</code> <code class="n">Y</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">meshgrid</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">)</code>
       <code class="n">Z</code> <code class="o">=</code> <code class="n">f</code><code class="p">(</code><code class="n">X</code><code class="p">,</code> <code class="n">Y</code><code class="p">)</code></pre>

<p>Now let’s look at this with a standard line-only contour plot (<a data-type="xref" href="#fig0430">Figure 4-30</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">4</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">contour</code><code class="p">(</code><code class="n">X</code><code class="p">,</code> <code class="n">Y</code><code class="p">,</code> <code class="n">Z</code><code class="p">,</code> <code class="n">colors</code><code class="o">=</code><code class="s1">'black'</code><code class="p">);</code></pre>

<figure><div id="fig0430" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in30.png" alt="png" width="361" height="255">
<h6><span class="label">Figure 4-30. </span>Visualizing three-dimensional data with contours</h6>
</div></figure>

<p>Notice that by default when a single color is used, negative values are
represented by dashed lines, and positive values by solid lines.
Alternatively, you can color-code the lines by specifying a colormap
with the <code>cmap</code> argument. Here, we’ll also specify that we want more
lines to be drawn—20 equally spaced intervals within the data range (<a data-type="xref" href="#fig0431">Figure 4-31</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">5</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">contour</code><code class="p">(</code><code class="n">X</code><code class="p">,</code> <code class="n">Y</code><code class="p">,</code> <code class="n">Z</code><code class="p">,</code> <code class="mi">20</code><code class="p">,</code> <code class="n">cmap</code><code class="o">=</code><code class="s1">'RdGy'</code><code class="p">);</code></pre>

<figure><div id="fig0431" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in31.png" alt="png" width="361" height="255">
<h6><span class="label">Figure 4-31. </span>Visualizing three-dimensional data with colored contours</h6>
</div></figure>

<p>Here we chose the <code>RdGy</code> (short for <em>Red-Gray</em>) colormap, which is a good
choice for centered data. Matplotlib has a wide range of colormaps
available, which you can easily browse in IPython by doing a
tab completion on the <code>plt.cm</code> module:</p>

<pre data-type="programlisting">plt.cm.&lt;TAB&gt;</pre>

<p>Our plot is looking nicer, but the spaces between the lines may be
a bit distracting. We can change this by switching to a filled contour
plot using the <code>plt.contourf()</code> function (notice the <code>f</code> at the end),
which uses largely the same syntax as <code>plt.contour()</code>.</p>

<p>Additionally, we’ll add a <code>plt.colorbar()</code> command, which automatically
creates an additional axis with labeled color information for the plot (<a data-type="xref" href="#fig0432">Figure 4-32</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">6</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">contourf</code><code class="p">(</code><code class="n">X</code><code class="p">,</code> <code class="n">Y</code><code class="p">,</code> <code class="n">Z</code><code class="p">,</code> <code class="mi">20</code><code class="p">,</code> <code class="n">cmap</code><code class="o">=</code><code class="s1">'RdGy'</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">colorbar</code><code class="p">();</code></pre>

<figure><div id="fig0432" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in32.png" alt="png" width="343" height="255">
<h6><span class="label">Figure 4-32. </span>Visualizing three-dimensional data with filled contours</h6>
</div></figure>

<p>The colorbar makes it clear that the black regions are “peaks,” while
the red regions are “valleys.”</p>

<p>One potential issue with this plot is that it is a bit “splotchy.” That
is, the color steps are discrete rather than continuous, which is not
always what is desired. You could remedy this by setting the number of
contours to a very high number, but this results in a rather inefficient
plot: Matplotlib must render a new polygon for each step in the level. <a data-type="indexterm" data-primary="plt.imshow() function" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc41"></a>A
better way to handle this is to use the <code>plt.imshow()</code> function, which
interprets a two-dimensional grid of data as an image.</p>

<p><a data-type="xref" href="#fig0433">Figure 4-33</a> shows the result of the following code:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">7</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">imshow</code><code class="p">(</code><code class="n">Z</code><code class="p">,</code> <code class="n">extent</code><code class="o">=</code><code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">5</code><code class="p">],</code> <code class="n">origin</code><code class="o">=</code><code class="s1">'lower'</code><code class="p">,</code>
                  <code class="n">cmap</code><code class="o">=</code><code class="s1">'RdGy'</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">colorbar</code><code class="p">()</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">axis</code><code class="p">(</code><code class="n">aspect</code><code class="o">=</code><code class="s1">'image'</code><code class="p">);</code></pre>

<p>There are a few potential gotchas with <code>imshow()</code>, however:</p>

<ul>
<li>
<p><code>plt.imshow()</code> doesn’t accept an <em>x</em> and <em>y</em> grid, so you must manually
specify the <em>extent</em> <code>[<em>xmin</em>, <em>xmax</em>, <em>ymin</em>, <em>ymax</em>]</code> of the image on the plot.</p>
</li>
<li>
<p><code>plt.imshow()</code> by default follows the standard image array definition
where the origin is in the upper left, not in the lower left as in most
contour plots. This must be changed when showing gridded data.</p>
</li>
<li>
<p><code>plt.imshow()</code> will automatically adjust the axis aspect ratio to
match the input data; you can change this by setting, for example,
<code>plt.axis(aspect='image')</code> to make <em>x</em> and <em>y</em> units match.</p>
</li>
</ul>

<figure><div id="fig0433" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in33.png" alt="png" width="304" height="255">
<h6><span class="label">Figure 4-33. </span>Representing three-dimensional data as an image</h6>
</div></figure>

<p>Finally, it can sometimes be useful to combine contour plots and image
plots. For example, to create the effect shown in <a data-type="xref" href="#fig0434">Figure 4-34</a>, we’ll use a partially
transparent background image (with transparency set via the <code>alpha</code>
parameter) and over-plot contours with labels on the contours themselves
(using the <code>plt.clabel()</code> function):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">8</code><code class="p">]:</code> <code class="n">contours</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">contour</code><code class="p">(</code><code class="n">X</code><code class="p">,</code> <code class="n">Y</code><code class="p">,</code> <code class="n">Z</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="n">colors</code><code class="o">=</code><code class="s1">'black'</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">clabel</code><code class="p">(</code><code class="n">contours</code><code class="p">,</code> <code class="n">inline</code><code class="o">=</code><code class="bp">True</code><code class="p">,</code> <code class="n">fontsize</code><code class="o">=</code><code class="mi">8</code><code class="p">)</code>

       <code class="n">plt</code><code class="o">.</code><code class="n">imshow</code><code class="p">(</code><code class="n">Z</code><code class="p">,</code> <code class="n">extent</code><code class="o">=</code><code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">5</code><code class="p">],</code> <code class="n">origin</code><code class="o">=</code><code class="s1">'lower'</code><code class="p">,</code>
                  <code class="n">cmap</code><code class="o">=</code><code class="s1">'RdGy'</code><code class="p">,</code> <code class="n">alpha</code><code class="o">=</code><code class="mf">0.5</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">colorbar</code><code class="p">();</code></pre>

<figure><div id="fig0434" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in34.png" alt="png" width="304" height="255">
<h6><span class="label">Figure 4-34. </span>Labeled contours on top of an image</h6>
</div></figure>

<p>The combination of these three functions—<code>plt.contour</code>, <code>plt.contourf</code>,
and <code>plt.imshow</code>—gives nearly limitless possibilities for displaying
this sort of three-dimensional data within a two-dimensional plot<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc41" id="idm45026303836568"></a>.<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc40" id="idm45026303835768"></a> For
more information on the options available in these functions, refer to
their docstrings.<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc39" id="idm45026303834856"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc38" id="idm45026303834216"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc37" id="idm45026303833576"></a> If you are interested in three-dimensional
visualizations of this type of data, see
<a data-type="xref" href="#three-dimensional-plotting-in-matplotlib">“Three-Dimensional Plotting in Matplotlib”</a>.<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc36" id="idm45026303831976"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc35" id="idm45026303831224"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc34" id="idm45026303830504"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc33" id="idm45026303829784"></a></p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Histograms, Binnings, and Density"><div class="sect1" id="histograms-binnings-and-density">
<h1>Histograms, Binnings, and Density</h1>

<p><a data-type="indexterm" data-primary="histograms" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc42"></a><a data-type="indexterm" data-primary="Matplotlib" data-secondary="histograms, binnings, and density" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc43"></a><a data-type="indexterm" data-primary="plotting" data-secondary="histograms, binnings, and density" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc44"></a>A <a data-type="indexterm" data-primary="histograms" data-secondary="simple" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc45"></a><a data-type="indexterm" data-primary="simple histograms" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc46"></a>simple histogram can be a great first step in understanding a dataset.
Earlier, we saw a preview of Matplotlib’s histogram function (see <a data-type="xref" href="ch02.html#comparisons-masks-and-boolean-logic">“Comparisons, Masks, and Boolean Logic”</a>), which
creates a basic histogram in one line, once the normal boilerplate
imports are done (<a data-type="xref" href="#fig0435">Figure 4-35</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">1</code><code class="p">]:</code> <code class="o">%</code><code class="n">matplotlib</code> <code class="n">inline</code>
       <code class="kn">import</code> <code class="nn">numpy</code> <code class="kn">as</code> <code class="nn">np</code>
       <code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="kn">as</code> <code class="nn">plt</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">use</code><code class="p">(</code><code class="s1">'seaborn-white'</code><code class="p">)</code>

       <code class="n">data</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">randn</code><code class="p">(</code><code class="mi">1000</code><code class="p">)</code></pre>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">2</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">hist</code><code class="p">(</code><code class="n">data</code><code class="p">);</code></pre>

<figure><div id="fig0435" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in35.png" alt="png" width="372" height="255">
<h6><span class="label">Figure 4-35. </span>A simple histogram</h6>
</div></figure>

<p>The <code>hist()</code> function has many options to tune both the calculation and
the display; here’s an example of a more customized histogram (<a data-type="xref" href="#fig0436">Figure 4-36</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">3</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">hist</code><code class="p">(</code><code class="n">data</code><code class="p">,</code> <code class="n">bins</code><code class="o">=</code><code class="mi">30</code><code class="p">,</code> <code class="n">normed</code><code class="o">=</code><code class="bp">True</code><code class="p">,</code> <code class="n">alpha</code><code class="o">=</code><code class="mf">0.5</code><code class="p">,</code>
                <code class="n">histtype</code><code class="o">=</code><code class="s1">'stepfilled'</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s1">'steelblue'</code><code class="p">,</code>
                <code class="n">edgecolor</code><code class="o">=</code><code class="s1">'none'</code><code class="p">);</code></pre>

<figure><div id="fig0436" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in36.png" alt="png" width="375" height="255">
<h6><span class="label">Figure 4-36. </span>A customized histogram</h6>
</div></figure>

<p>The <code>plt.hist</code> docstring has more information on other customization
options available. I find this combination of
<code>histtype='stepfilled'</code> along with some transparency <code>alpha</code> to be very
useful when comparing histograms of several distributions (<a data-type="xref" href="#fig0437">Figure 4-37</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">4</code><code class="p">]:</code> <code class="n">x1</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">normal</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mf">0.8</code><code class="p">,</code> <code class="mi">1000</code><code class="p">)</code>
       <code class="n">x2</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">normal</code><code class="p">(</code><code class="o">-</code><code class="mi">2</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">1000</code><code class="p">)</code>
       <code class="n">x3</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">normal</code><code class="p">(</code><code class="mi">3</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">1000</code><code class="p">)</code>

       <code class="n">kwargs</code> <code class="o">=</code> <code class="nb">dict</code><code class="p">(</code><code class="n">histtype</code><code class="o">=</code><code class="s1">'stepfilled'</code><code class="p">,</code> <code class="n">alpha</code><code class="o">=</code><code class="mf">0.3</code><code class="p">,</code> <code class="n">normed</code><code class="o">=</code><code class="bp">True</code><code class="p">,</code> <code class="n">bins</code><code class="o">=</code><code class="mi">40</code><code class="p">)</code>

       <code class="n">plt</code><code class="o">.</code><code class="n">hist</code><code class="p">(</code><code class="n">x1</code><code class="p">,</code> <code class="o">**</code><code class="n">kwargs</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">hist</code><code class="p">(</code><code class="n">x2</code><code class="p">,</code> <code class="o">**</code><code class="n">kwargs</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">hist</code><code class="p">(</code><code class="n">x3</code><code class="p">,</code> <code class="o">**</code><code class="n">kwargs</code><code class="p">);</code></pre>

<figure><div id="fig0437" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in37.png" alt="png" width="372" height="255">
<h6><span class="label">Figure 4-37. </span>Over-plotting multiple histograms</h6>
</div></figure>

<p>If you would like to simply compute the histogram (that is, count the
number of points in a given bin) and not display it, the
<code>np.histogram()</code> function is available:<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc46" id="idm45026303540904"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc45" id="idm45026303540200"></a></p>

<pre data-type="programlisting" data-code-language="python" class="pagebreak-before"><code class="n">In</code><code class="p">[</code><code class="mi">5</code><code class="p">]:</code> <code class="n">counts</code><code class="p">,</code> <code class="n">bin_edges</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">histogram</code><code class="p">(</code><code class="n">data</code><code class="p">,</code> <code class="n">bins</code><code class="o">=</code><code class="mi">5</code><code class="p">)</code>
       <code class="k">print</code><code class="p">(</code><code class="n">counts</code><code class="p">)</code></pre>

<pre data-type="programlisting">[ 12 190 468 301  29]</pre>








<section data-type="sect2" data-pdf-bookmark="Two-Dimensional Histograms and Binnings"><div class="sect2" id="two-dimensional-histograms-and-binnings">
<h2>Two-Dimensional Histograms and Binnings</h2>

<p><a data-type="indexterm" data-primary="histograms" data-secondary="two-dimensional" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc47"></a>Just as we create histograms in one dimension by dividing the
number line into bins, we can also create histograms in two dimensions
by dividing points among two-dimensional bins. We’ll take a brief look
at several ways to do this here. We’ll start by defining some data—an
<code>x</code> and <code>y</code> array drawn from a multivariate Gaussian <span class="keep-together">distribution</span>:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">6</code><code class="p">]:</code> <code class="n">mean</code> <code class="o">=</code> <code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">]</code>
       <code class="n">cov</code> <code class="o">=</code> <code class="p">[[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">],</code> <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">]]</code>
       <code class="n">x</code><code class="p">,</code> <code class="n">y</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">multivariate_normal</code><code class="p">(</code><code class="n">mean</code><code class="p">,</code> <code class="n">cov</code><code class="p">,</code> <code class="mi">10000</code><code class="p">)</code><code class="o">.</code><code class="n">T</code></pre>










<section data-type="sect3" data-pdf-bookmark="plt.hist2d: Two-dimensional histogram"><div class="sect3" id="plt.hist2d-two-dimensional-histogram">
<h3>plt.hist2d: Two-dimensional histogram</h3>

<p><a data-type="indexterm" data-primary="histograms" data-secondary="plt.hist2d() function" id="idm45026303401096"></a>One straightforward way to plot a two-dimensional histogram is to use Matplotlib’s
<code>plt.hist2d</code> function (<a data-type="xref" href="#fig0438">Figure 4-38</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">12</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">hist2d</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">,</code> <code class="n">bins</code><code class="o">=</code><code class="mi">30</code><code class="p">,</code> <code class="n">cmap</code><code class="o">=</code><code class="s1">'Blues'</code><code class="p">)</code>
        <code class="n">cb</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">colorbar</code><code class="p">()</code>
        <code class="n">cb</code><code class="o">.</code><code class="n">set_label</code><code class="p">(</code><code class="s1">'counts in bin'</code><code class="p">)</code></pre>

<figure><div id="fig0438" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in38.png" alt="png" width="360" height="250">
<h6><span class="label">Figure 4-38. </span>A two-dimensional histogram with plt.hist2d</h6>
</div></figure>

<p>Just as with <code>plt.hist</code>, <code>plt.hist2d</code> has a number of extra options to
fine-tune the plot and the binning, which are nicely outlined in the function
docstring. Further, just as <code>plt.hist</code> has a counterpart in <code>np.histogram</code>,
<code>plt.hist2d</code> has a counterpart in <code>np.histogram2d</code>, which can be used as
follows:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">8</code><code class="p">]:</code> <code class="n">counts</code><code class="p">,</code> <code class="n">xedges</code><code class="p">,</code> <code class="n">yedges</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">histogram2d</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">,</code> <code class="n">bins</code><code class="o">=</code><code class="mi">30</code><code class="p">)</code></pre>

<p>For the generalization of this histogram binning in dimensions higher
than two, see the <code>np.histogramdd</code> function.</p>
</div></section>













<section data-type="sect3" data-pdf-bookmark="plt.hexbin: Hexagonal binnings"><div class="sect3" id="plt.hexbin-hexagonal-binnings">
<h3>plt.hexbin: Hexagonal binnings</h3>

<p><a data-type="indexterm" data-primary="binnings" id="idm45026303298088"></a><a data-type="indexterm" data-primary="hexagonal binnings" id="idm45026303297384"></a><a data-type="indexterm" data-primary="histograms" data-secondary="plt.hexbin() function" id="idm45026303296712"></a>The two-dimensional histogram creates a tessellation of squares across
the axes. Another natural shape for such a tessellation is the regular
hexagon. For this purpose, Matplotlib provides the <code>plt.hexbin</code> routine,
which represents a two-dimensional dataset binned within a grid of
hexagons (<a data-type="xref" href="#fig0439">Figure 4-39</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">9</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">hexbin</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">,</code> <code class="n">gridsize</code><code class="o">=</code><code class="mi">30</code><code class="p">,</code> <code class="n">cmap</code><code class="o">=</code><code class="s1">'Blues'</code><code class="p">)</code>
       <code class="n">cb</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">colorbar</code><code class="p">(</code><code class="n">label</code><code class="o">=</code><code class="s1">'count in bin'</code><code class="p">)</code></pre>

<figure><div id="fig0439" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in39.png" alt="png" width="360" height="250">
<h6><span class="label">Figure 4-39. </span>A two-dimensional histogram with plt.hexbin</h6>
</div></figure>

<p><code>plt.hexbin</code> has a number of interesting options, including the ability
to specify weights for each point, and to change the output in each bin
to any NumPy aggregate (mean of weights, standard deviation of weights,
etc.).</p>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Kernel density estimation"><div class="sect3" id="kernel-density-estimation">
<h3>Kernel density estimation</h3>

<p><a data-type="indexterm" data-primary="histograms" data-secondary="KDE and" id="idm45026303202776"></a><a data-type="indexterm" data-primary="kernel density estimation (KDE)" data-secondary="Matplotlib" id="idm45026303201576"></a>Another common method of evaluating densities in multiple dimensions is
<em>kernel density estimation</em> (KDE). This will be discussed more fully in
<a data-type="xref" href="ch05.html#in-depth-kernel-density-estimation">“In-Depth: Kernel Density Estimation”</a>, but for now we’ll simply mention that KDE can be thought of
as a way to “smear out” the points in space and add up the result to
obtain a smooth function. One extremely quick and simple KDE
implementation exists in the <code>scipy.stats</code> package. Here is a quick
example of using the KDE on this data (<a data-type="xref" href="#fig0440">Figure 4-40</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">10</code><code class="p">]:</code> <code class="kn">from</code> <code class="nn">scipy.stats</code> <code class="kn">import</code> <code class="n">gaussian_kde</code>

        <code class="c1"># fit an array of size [Ndim, Nsamples]</code>
        <code class="n">data</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">vstack</code><code class="p">([</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">])</code>
        <code class="n">kde</code> <code class="o">=</code> <code class="n">gaussian_kde</code><code class="p">(</code><code class="n">data</code><code class="p">)</code>

        <code class="c1"># evaluate on a regular grid</code>
        <code class="n">xgrid</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="o">-</code><code class="mf">3.5</code><code class="p">,</code> <code class="mf">3.5</code><code class="p">,</code> <code class="mi">40</code><code class="p">)</code>
        <code class="n">ygrid</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="o">-</code><code class="mi">6</code><code class="p">,</code> <code class="mi">6</code><code class="p">,</code> <code class="mi">40</code><code class="p">)</code>
        <code class="n">Xgrid</code><code class="p">,</code> <code class="n">Ygrid</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">meshgrid</code><code class="p">(</code><code class="n">xgrid</code><code class="p">,</code> <code class="n">ygrid</code><code class="p">)</code>
        <code class="n">Z</code> <code class="o">=</code> <code class="n">kde</code><code class="o">.</code><code class="n">evaluate</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">vstack</code><code class="p">([</code><code class="n">Xgrid</code><code class="o">.</code><code class="n">ravel</code><code class="p">(),</code> <code class="n">Ygrid</code><code class="o">.</code><code class="n">ravel</code><code class="p">()]))</code>

        <code class="c1"># Plot the result as an image</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">imshow</code><code class="p">(</code><code class="n">Z</code><code class="o">.</code><code class="n">reshape</code><code class="p">(</code><code class="n">Xgrid</code><code class="o">.</code><code class="n">shape</code><code class="p">),</code>
                   <code class="n">origin</code><code class="o">=</code><code class="s1">'lower'</code><code class="p">,</code> <code class="n">aspect</code><code class="o">=</code><code class="s1">'auto'</code><code class="p">,</code>
                   <code class="n">extent</code><code class="o">=</code><code class="p">[</code><code class="o">-</code><code class="mf">3.5</code><code class="p">,</code> <code class="mf">3.5</code><code class="p">,</code> <code class="o">-</code><code class="mi">6</code><code class="p">,</code> <code class="mi">6</code><code class="p">],</code>
                   <code class="n">cmap</code><code class="o">=</code><code class="s1">'Blues'</code><code class="p">)</code>
        <code class="n">cb</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">colorbar</code><code class="p">()</code>
        <code class="n">cb</code><code class="o">.</code><code class="n">set_label</code><code class="p">(</code><code class="s2">"density"</code><code class="p">)</code></pre>

<figure><div id="fig0440" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in40.png" alt="png" width="368" height="255">
<h6><span class="label">Figure 4-40. </span>A kernel density representation of a distribution</h6>
</div></figure>

<p>KDE has a smoothing length that effectively slides the knob between
detail and smoothness (one example of the ubiquitous bias–variance
trade-off). The literature on choosing an appropriate smoothing length is
vast: <code>gaussian_kde</code> uses a rule of thumb to attempt to find a
nearly optimal smoothing length for the input data.</p>

<p>Other KDE implementations are available within the SciPy ecosystem, each with its own various strengths and weaknesses; see, for example,
<code>sklearn.neighbors.KernelDensity</code> and
<code>statsmodels.nonparametric.kernel_density.KDEMultivariate</code>. For
visualizations based on KDE, using Matplotlib tends to be
overly verbose. The Seaborn library, discussed in
<a data-type="xref" href="#visualization-with-seaborn">“Visualization with Seaborn”</a>,
provides a much more terse API for creating KDE-based visualizations<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc47" id="idm45026303046712"></a>.<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc44" id="idm45026303045944"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc43" id="idm45026303045272"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc42" id="idm45026303044632"></a></p>
</div></section>



</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Customizing Plot Legends"><div class="sect1" id="customizing-plot-legends">
<h1>Customizing Plot Legends</h1>

<p><a data-type="indexterm" data-primary="legends, plot" data-secondary="customizing" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc48"></a><a data-type="indexterm" data-primary="Matplotlib" data-secondary="plot legend customization" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc49"></a><a data-type="indexterm" data-primary="plot legends" data-secondary="customizing" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc50"></a><a data-type="indexterm" data-primary="plotting" data-secondary="plot legends" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc51"></a>Plot legends give meaning to a visualization, assigning labels to the
various plot elements. We previously saw how to create a simple legend;
here we’ll take a look at customizing the placement and aesthetics of
the legend in Matplotlib.</p>

<p><a data-type="indexterm" data-primary="plt.legend() command" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc52"></a><a data-type="indexterm" data-primary="simple scatter plots" data-secondary="California city populations" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc53"></a>The simplest legend can be created with the <code>plt.legend()</code> command,
which automatically creates a legend for any labeled plot elements (<a data-type="xref" href="#fig0441">Figure 4-41</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">1</code><code class="p">]:</code> <code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="kn">as</code> <code class="nn">plt</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">use</code><code class="p">(</code><code class="s1">'classic'</code><code class="p">)</code></pre>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">2</code><code class="p">]:</code> <code class="o">%</code><code class="n">matplotlib</code> <code class="n">inline</code>
       <code class="kn">import</code> <code class="nn">numpy</code> <code class="kn">as</code> <code class="nn">np</code></pre>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">3</code><code class="p">]:</code> <code class="n">x</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">10</code><code class="p">,</code> <code class="mi">1000</code><code class="p">)</code>
       <code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">()</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">),</code> <code class="s1">'-b'</code><code class="p">,</code> <code class="n">label</code><code class="o">=</code><code class="s1">'Sine'</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">cos</code><code class="p">(</code><code class="n">x</code><code class="p">),</code> <code class="s1">'--r'</code><code class="p">,</code> <code class="n">label</code><code class="o">=</code><code class="s1">'Cosine'</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">axis</code><code class="p">(</code><code class="s1">'equal'</code><code class="p">)</code>
       <code class="n">leg</code> <code class="o">=</code> <code class="n">ax</code><code class="o">.</code><code class="n">legend</code><code class="p">();</code></pre>

<figure><div id="fig0441" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in41.png" alt="png" width="374" height="251">
<h6><span class="label">Figure 4-41. </span>A default plot legend</h6>
</div></figure>

<p>But there are many ways we might want to customize such a legend. For
example, we can specify the location and turn off the frame (<a data-type="xref" href="#fig0442">Figure 4-42</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">4</code><code class="p">]:</code> <code class="n">ax</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="n">loc</code><code class="o">=</code><code class="s1">'upper left'</code><code class="p">,</code> <code class="n">frameon</code><code class="o">=</code><code class="bp">False</code><code class="p">)</code>
       <code class="n">fig</code></pre>

<figure><div id="fig0442" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in42.png" alt="png" width="374" height="251">
<h6><span class="label">Figure 4-42. </span>A customized plot legend</h6>
</div></figure>

<p>We can use the <code>ncol</code> command to specify the number of columns in the
legend (<a data-type="xref" href="#fig0443">Figure 4-43</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">5</code><code class="p">]:</code> <code class="n">ax</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="n">frameon</code><code class="o">=</code><code class="bp">False</code><code class="p">,</code> <code class="n">loc</code><code class="o">=</code><code class="s1">'lower center'</code><code class="p">,</code> <code class="n">ncol</code><code class="o">=</code><code class="mi">2</code><code class="p">)</code>
       <code class="n">fig</code></pre>

<figure><div id="fig0443" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in43.png" alt="png" width="374" height="251">
<h6><span class="label">Figure 4-43. </span>A two-column plot legend</h6>
</div></figure>

<p>We can use a rounded box (<code>fancybox</code>) or add a shadow, change the
transparency (alpha value) of the frame, or change the padding around
the text (<a data-type="xref" href="#fig0444">Figure 4-44</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">6</code><code class="p">]:</code> <code class="n">ax</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="n">fancybox</code><code class="o">=</code><code class="bp">True</code><code class="p">,</code> <code class="n">framealpha</code><code class="o">=</code><code class="mi">1</code><code class="p">,</code> <code class="n">shadow</code><code class="o">=</code><code class="bp">True</code><code class="p">,</code> <code class="n">borderpad</code><code class="o">=</code><code class="mi">1</code><code class="p">)</code>
       <code class="n">fig</code></pre>

<figure><div id="fig0444" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in44.png" alt="png" width="374" height="251">
<h6><span class="label">Figure 4-44. </span>A fancybox plot legend</h6>
</div></figure>

<p>For more information on available legend options, see the <code>plt.legend</code>
docstring.</p>








<section data-type="sect2" data-pdf-bookmark="Choosing Elements for the Legend"><div class="sect2" id="choosing-elements-for-the-legend">
<h2>Choosing Elements for the Legend</h2>

<p><a data-type="indexterm" data-primary="legends, plot" data-secondary="choosing elements for" id="idm45026302673624"></a><a data-type="indexterm" data-primary="plot legends" data-secondary="choosing elements for" id="idm45026302672648"></a>As we’ve already seen, the legend includes all labeled elements by default.
If this is not what is desired, we can fine-tune which elements and
labels appear in the legend by using the objects returned by plot
commands. The <code>plt.plot()</code> command is able to create multiple lines at
once, and returns a list of created line instances. Passing any of these
to <code>plt.legend()</code> will tell it which to identify, along with the labels
we’d like to specify (<a data-type="xref" href="#fig0445">Figure 4-45</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">7</code><code class="p">]:</code> <code class="n">y</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">[:,</code> <code class="n">np</code><code class="o">.</code><code class="n">newaxis</code><code class="p">]</code> <code class="o">+</code> <code class="n">np</code><code class="o">.</code><code class="n">pi</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">arange</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mf">0.5</code><code class="p">))</code>
       <code class="n">lines</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">)</code>

       <code class="c1"># lines is a list of plt.Line2D instances</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="n">lines</code><code class="p">[:</code><code class="mi">2</code><code class="p">],</code> <code class="p">[</code><code class="s1">'first'</code><code class="p">,</code> <code class="s1">'second'</code><code class="p">]);</code></pre>

<figure><div id="fig0445" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in45.png" alt="png" width="383" height="256">
<h6><span class="label">Figure 4-45. </span>Customization of legend elements</h6>
</div></figure>

<p>I generally find in practice that it is clearer to use the first
method, applying labels to the plot elements you’d like to show on the
legend (<a data-type="xref" href="#fig0446">Figure 4-46</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">8</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">[:,</code> <code class="mi">0</code><code class="p">],</code> <code class="n">label</code><code class="o">=</code><code class="s1">'first'</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">[:,</code> <code class="mi">1</code><code class="p">],</code> <code class="n">label</code><code class="o">=</code><code class="s1">'second'</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">[:,</code> <code class="mi">2</code><code class="p">:])</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="n">framealpha</code><code class="o">=</code><code class="mi">1</code><code class="p">,</code> <code class="n">frameon</code><code class="o">=</code><code class="bp">True</code><code class="p">);</code></pre>

<figure><div id="fig0446" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in46.png" alt="png" width="383" height="256">
<h6><span class="label">Figure 4-46. </span>Alternative method of customizing legend elements</h6>
</div></figure>

<p>Notice that by default, the legend ignores all elements without a
<code>label</code> attribute set.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Legend for Size of Points"><div class="sect2" id="legend-for-size-of-points">
<h2>Legend for Size of Points</h2>

<p><a data-type="indexterm" data-primary="legends, plot" data-secondary="point size" id="idm45026302498872"></a><a data-type="indexterm" data-primary="plot legends" data-secondary="points size" id="idm45026302497896"></a>Sometimes the legend defaults are not sufficient for the given
visualization. For example, perhaps you’re using the size of points to mark
certain features of the data, and want to create a legend reflecting
this. Here is an example where we’ll use the size of points to indicate
populations of California cities. We’d like a legend that specifies the
scale of the sizes of the points, and we’ll accomplish this by plotting
some labeled data with no entries (<a data-type="xref" href="#fig0447">Figure 4-47</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">9</code><code class="p">]:</code> <code class="kn">import</code> <code class="nn">pandas</code> <code class="kn">as</code> <code class="nn">pd</code>
       <code class="n">cities</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="s1">'data/california_cities.csv'</code><code class="p">)</code>

       <code class="c1"># Extract the data we're interested in</code>
       <code class="n">lat</code><code class="p">,</code> <code class="n">lon</code> <code class="o">=</code> <code class="n">cities</code><code class="p">[</code><code class="s1">'latd'</code><code class="p">],</code> <code class="n">cities</code><code class="p">[</code><code class="s1">'longd'</code><code class="p">]</code>
       <code class="n">population</code><code class="p">,</code> <code class="n">area</code> <code class="o">=</code> <code class="n">cities</code><code class="p">[</code><code class="s1">'population_total'</code><code class="p">],</code> <code class="n">cities</code><code class="p">[</code><code class="s1">'area_total_km2'</code><code class="p">]</code>

       <code class="c1"># Scatter the points, using size and color but no label</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">scatter</code><code class="p">(</code><code class="n">lon</code><code class="p">,</code> <code class="n">lat</code><code class="p">,</code> <code class="n">label</code><code class="o">=</code><code class="bp">None</code><code class="p">,</code>
                   <code class="n">c</code><code class="o">=</code><code class="n">np</code><code class="o">.</code><code class="n">log10</code><code class="p">(</code><code class="n">population</code><code class="p">),</code> <code class="n">cmap</code><code class="o">=</code><code class="s1">'viridis'</code><code class="p">,</code>
                   <code class="n">s</code><code class="o">=</code><code class="n">area</code><code class="p">,</code> <code class="n">linewidth</code><code class="o">=</code><code class="mi">0</code><code class="p">,</code> <code class="n">alpha</code><code class="o">=</code><code class="mf">0.5</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">axis</code><code class="p">(</code><code class="n">aspect</code><code class="o">=</code><code class="s1">'equal'</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">xlabel</code><code class="p">(</code><code class="s1">'longitude'</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">ylabel</code><code class="p">(</code><code class="s1">'latitude'</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">colorbar</code><code class="p">(</code><code class="n">label</code><code class="o">=</code><code class="s1">'log$_{10}$(population)'</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">clim</code><code class="p">(</code><code class="mi">3</code><code class="p">,</code> <code class="mi">7</code><code class="p">)</code>

       <code class="c1"># Here we create a legend:</code>
       <code class="c1"># we'll plot empty lists with the desired size and label</code>
       <code class="k">for</code> <code class="n">area</code> <code class="ow">in</code> <code class="p">[</code><code class="mi">100</code><code class="p">,</code> <code class="mi">300</code><code class="p">,</code> <code class="mi">500</code><code class="p">]:</code>
           <code class="n">plt</code><code class="o">.</code><code class="n">scatter</code><code class="p">([],</code> <code class="p">[],</code> <code class="n">c</code><code class="o">=</code><code class="s1">'k'</code><code class="p">,</code> <code class="n">alpha</code><code class="o">=</code><code class="mf">0.3</code><code class="p">,</code> <code class="n">s</code><code class="o">=</code><code class="n">area</code><code class="p">,</code>
                       <code class="n">label</code><code class="o">=</code><code class="nb">str</code><code class="p">(</code><code class="n">area</code><code class="p">)</code> <code class="o">+</code> <code class="s1">' km$^2$'</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="n">scatterpoints</code><code class="o">=</code><code class="mi">1</code><code class="p">,</code> <code class="n">frameon</code><code class="o">=</code><code class="bp">False</code><code class="p">,</code>
                  <code class="n">labelspacing</code><code class="o">=</code><code class="mi">1</code><code class="p">,</code> <code class="n">title</code><code class="o">=</code><code class="s1">'City Area'</code><code class="p">)</code>

       <code class="n">plt</code><code class="o">.</code><code class="n">title</code><code class="p">(</code><code class="s1">'California Cities: Area and Population'</code><code class="p">);</code></pre>

<figure><div id="fig0447" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in47.png" alt="png" width="380" height="281">
<h6><span class="label">Figure 4-47. </span>Location, geographic size, and population of California cities</h6>
</div></figure>

<p>The legend will always reference some object that is on the plot, so if
we’d like to display a particular shape we need to plot it. In this
case, the objects we want (gray circles) are not on the plot, so we fake
them by plotting empty lists. Notice too that the legend only lists plot
elements that have a label specified.</p>

<p>By plotting empty lists, we create labeled plot objects that are
picked up by the legend, and now our legend tells us some useful
information. This strategy can be useful for creating more sophisticated
visualizations.</p>

<p>Finally, note that for geographic data like this, it would be clearer
if we could show state boundaries or other map-specific elements. For
this, an excellent choice of tool is Matplotlib’s Basemap add-on toolkit,
which we’ll explore in
<a data-type="xref" href="#geographic-data-with-basemap">“Geographic Data with Basemap”</a>.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Multiple Legends"><div class="sect2" id="multiple-legends">
<h2>Multiple Legends</h2>

<p><a data-type="indexterm" data-primary="legends, plot" data-secondary="multiple legends on same axes" id="idm45026302242232"></a><a data-type="indexterm" data-primary="plot legends" data-secondary="multiple legends on same axes" id="idm45026302241064"></a>Sometimes when designing a plot you’d like to add multiple legends to
the same axes. Unfortunately, Matplotlib does not make this easy: via
the standard <code>legend</code> interface, it is only possible to create a single
legend for the entire plot. If you try to create a second legend using
<code>plt.legend()</code> or <code>ax.legend()</code>, it will simply override the first one.
We can work around this by creating a new legend artist from scratch,
and then using the lower-level <code>ax.add_artist()</code> method to manually add
the second artist to the plot (<a data-type="xref" href="#fig0448">Figure 4-48</a>):<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc53" id="idm45026302237048"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc52" id="idm45026302236376"></a></p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">10</code><code class="p">]:</code> <code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">()</code>

       <code class="n">lines</code> <code class="o">=</code> <code class="p">[]</code>
       <code class="n">styles</code> <code class="o">=</code> <code class="p">[</code><code class="s1">'-'</code><code class="p">,</code> <code class="s1">'--'</code><code class="p">,</code> <code class="s1">'-.'</code><code class="p">,</code> <code class="s1">':'</code><code class="p">]</code>
       <code class="n">x</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">10</code><code class="p">,</code> <code class="mi">1000</code><code class="p">)</code>

       <code class="k">for</code> <code class="n">i</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="mi">4</code><code class="p">):</code>
           <code class="n">lines</code> <code class="o">+=</code> <code class="n">ax</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code> <code class="o">-</code> <code class="n">i</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">pi</code> <code class="o">/</code> <code class="mi">2</code><code class="p">),</code>
                            <code class="n">styles</code><code class="p">[</code><code class="n">i</code><code class="p">],</code> <code class="n">color</code><code class="o">=</code><code class="s1">'black'</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">axis</code><code class="p">(</code><code class="s1">'equal'</code><code class="p">)</code>

       <code class="c1"># specify the lines and labels of the first legend</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="n">lines</code><code class="p">[:</code><code class="mi">2</code><code class="p">],</code> <code class="p">[</code><code class="s1">'line A'</code><code class="p">,</code> <code class="s1">'line B'</code><code class="p">],</code>
                 <code class="n">loc</code><code class="o">=</code><code class="s1">'upper right'</code><code class="p">,</code> <code class="n">frameon</code><code class="o">=</code><code class="bp">False</code><code class="p">)</code>

       <code class="c1"># Create the second legend and add the artist manually.</code>
       <code class="kn">from</code> <code class="nn">matplotlib.legend</code> <code class="kn">import</code> <code class="n">Legend</code>
       <code class="n">leg</code> <code class="o">=</code> <code class="n">Legend</code><code class="p">(</code><code class="n">ax</code><code class="p">,</code> <code class="n">lines</code><code class="p">[</code><code class="mi">2</code><code class="p">:],</code> <code class="p">[</code><code class="s1">'line C'</code><code class="p">,</code> <code class="s1">'line D'</code><code class="p">],</code>
                    <code class="n">loc</code><code class="o">=</code><code class="s1">'lower right'</code><code class="p">,</code> <code class="n">frameon</code><code class="o">=</code><code class="bp">False</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">add_artist</code><code class="p">(</code><code class="n">leg</code><code class="p">);</code></pre>

<figure><div id="fig0448" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in48.png" alt="png" width="374" height="251">
<h6><span class="label">Figure 4-48. </span>A split plot legend</h6>
</div></figure>

<p>This is a peek into the low-level artist objects that compose any
Matplotlib plot. If you examine the source code of <code>ax.legend()</code> (recall
that you can do this within the IPython notebook using <code>ax.legend??</code>)
you’ll see that the function simply consists of some logic to create a
suitable <code>Legend</code> artist, which is then saved in the <code>legend_</code> attribute
and added to the figure when the plot is drawn.<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc51" id="idm45026302054392"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc50" id="idm45026302053720"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc49" id="idm45026302053080"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc48" id="idm45026302052440"></a></p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Customizing Colorbars"><div class="sect1" id="customizing-colorbars">
<h1>Customizing Colorbars</h1>

<p><a data-type="indexterm" data-primary="colorbars" data-secondary="customizing" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc54"></a><a data-type="indexterm" data-primary="Matplotlib" data-secondary="colorbar customization" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc55"></a><a data-type="indexterm" data-primary="plotting" data-secondary="colorbars" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc56"></a>Plot legends identify discrete labels of discrete points. For continuous
labels based on the color of points, lines, or regions, a labeled
colorbar can be a great tool. In Matplotlib, a colorbar is a separate
axes that can provide a key for the meaning of colors in a plot.
Because the book is printed in black and white, this section has an
accompanying online appendix where you can view the figures in full
color (<a href="https://github.com/jakevdp/PythonDataScienceHandbook"><em class="hyperlink">https://github.com/jakevdp/PythonDataScienceHandbook</em></a>). We’ll start by setting up the notebook for plotting and importing the functions we will use:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">1</code><code class="p">]:</code> <code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="kn">as</code> <code class="nn">plt</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">use</code><code class="p">(</code><code class="s1">'classic'</code><code class="p">)</code></pre>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">2</code><code class="p">]:</code> <code class="o">%</code><code class="n">matplotlib</code> <code class="n">inline</code>
       <code class="kn">import</code> <code class="nn">numpy</code> <code class="kn">as</code> <code class="nn">np</code></pre>

<p>As we have seen several times throughout this section, the simplest
colorbar can be created with the <code>plt.colorbar</code> function (<a data-type="xref" href="#fig0449">Figure 4-49</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">3</code><code class="p">]:</code> <code class="n">x</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">10</code><code class="p">,</code> <code class="mi">1000</code><code class="p">)</code>
       <code class="n">I</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">)</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">cos</code><code class="p">(</code><code class="n">x</code><code class="p">[:,</code> <code class="n">np</code><code class="o">.</code><code class="n">newaxis</code><code class="p">])</code>

       <code class="n">plt</code><code class="o">.</code><code class="n">imshow</code><code class="p">(</code><code class="n">I</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">colorbar</code><code class="p">();</code></pre>

<figure><div id="fig0449" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in49.png" alt="png" width="323" height="256">
<h6><span class="label">Figure 4-49. </span>A simple colorbar legend</h6>
</div></figure>

<p>We’ll now discuss a few ideas for customizing these colorbars and
using them effectively in various situations.</p>








<section data-type="sect2" data-pdf-bookmark="Customizing Colorbars"><div class="sect2" id="customizing-colorbars-1">
<h2>Customizing Colorbars</h2>

<p><a data-type="indexterm" data-primary="colorbars" data-secondary="colormap selection" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc57"></a><a data-type="indexterm" data-primary="colormap" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc58"></a>We can specify the colormap using the <code>cmap</code> argument to the plotting
function that is creating the visualization (<a data-type="xref" href="#fig0450">Figure 4-50</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">4</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">imshow</code><code class="p">(</code><code class="n">I</code><code class="p">,</code> <code class="n">cmap</code><code class="o">=</code><code class="s1">'gray'</code><code class="p">);</code></pre>

<figure><div id="fig0450" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in50.png" alt="png" width="279" height="256">
<h6><span class="label">Figure 4-50. </span>A grayscale colormap</h6>
</div></figure>

<p>All the available colormaps are in the <code>plt.cm</code> namespace; using
IPython’s tab-completion feature will give you a full list of built-in
possibilities:</p>

<pre data-type="programlisting">plt.cm.&lt;TAB&gt;</pre>

<p>But being <em>able</em> to choose a colormap is just the first step: more
important is how to <em>decide</em> among the possibilities! The choice turns
out to be much more subtle than you might initially expect.</p>










<section data-type="sect3" data-pdf-bookmark="Choosing the colormap"><div class="sect3" id="choosing-the-colormap">
<h3>Choosing the colormap</h3>

<p>A full treatment of color choice within visualization is beyond the
scope of this book, but for entertaining reading on this subject and
others, see the article
<a href="http://bit.ly/2fDJn9J">“Ten
Simple Rules for Better Figures”</a>. Matplotlib’s online documentation also
has an <a href="http://matplotlib.org/1.4.1/users/colormaps.html">interesting
discussion</a> of colormap choice.</p>

<p>Broadly, you should be aware of three different categories of colormaps:</p>
<dl>
<dt><em>Sequential</em> colormaps</dt>
<dd>
<p>These consist of one continuous sequence
of colors (e.g., <code>binary</code> or <code>viridis</code>).</p>
</dd>
<dt><em>Divergent</em> colormaps</dt>
<dd>
<p>These usually contain two distinct colors,
which show positive and negative deviations from a mean (e.g., <code>RdBu</code> or
<code>PuOr</code>).</p>
</dd>
<dt><em>Qualitative</em> colormaps</dt>
<dd>
<p>These mix colors with no particular
sequence (e.g., <code>rainbow</code> or <code>jet</code>).</p>
</dd>
</dl>

<p><a data-type="indexterm" data-primary="jet colormap" id="idm45026301825720"></a>The <code>jet</code> colormap, which was the default in Matplotlib prior to version
2.0, is an example of a qualitative colormap. Its status as the default
was quite unfortunate, because qualitative maps are often a poor choice
for representing quantitative data. Among the problems is the fact that
qualitative maps usually do not display any uniform progression in
brightness as the scale increases.</p>

<p>We can see this by converting the <code>jet</code> colorbar into black and white (<a data-type="xref" href="#fig0451">Figure 4-51</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">5</code><code class="p">]:</code>
<code class="kn">from</code> <code class="nn">matplotlib.colors</code> <code class="kn">import</code> <code class="n">LinearSegmentedColormap</code>

<code class="k">def</code> <code class="nf">grayscale_cmap</code><code class="p">(</code><code class="n">cmap</code><code class="p">):</code>
    <code class="sd">"""Return a grayscale version of the given colormap"""</code>
    <code class="n">cmap</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">cm</code><code class="o">.</code><code class="n">get_cmap</code><code class="p">(</code><code class="n">cmap</code><code class="p">)</code>
    <code class="n">colors</code> <code class="o">=</code> <code class="n">cmap</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">arange</code><code class="p">(</code><code class="n">cmap</code><code class="o">.</code><code class="n">N</code><code class="p">))</code>

    <code class="c1"># convert RGBA to perceived grayscale luminance</code>
    <code class="c1"># cf. http://alienryderflex.com/hsp.html</code>
    <code class="n">RGB_weight</code> <code class="o">=</code> <code class="p">[</code><code class="mf">0.299</code><code class="p">,</code> <code class="mf">0.587</code><code class="p">,</code> <code class="mf">0.114</code><code class="p">]</code>
    <code class="n">luminance</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">sqrt</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">dot</code><code class="p">(</code><code class="n">colors</code><code class="p">[:,</code> <code class="p">:</code><code class="mi">3</code><code class="p">]</code> <code class="o">**</code> <code class="mi">2</code><code class="p">,</code> <code class="n">RGB_weight</code><code class="p">))</code>
    <code class="n">colors</code><code class="p">[:,</code> <code class="p">:</code><code class="mi">3</code><code class="p">]</code> <code class="o">=</code> <code class="n">luminance</code><code class="p">[:,</code> <code class="n">np</code><code class="o">.</code><code class="n">newaxis</code><code class="p">]</code>

    <code class="k">return</code> <code class="n">LinearSegmentedColormap</code><code class="o">.</code><code class="n">from_list</code><code class="p">(</code><code class="n">cmap</code><code class="o">.</code><code class="n">name</code> <code class="o">+</code> <code class="s2">"_gray"</code><code class="p">,</code> <code class="n">colors</code><code class="p">,</code> <code class="n">cmap</code><code class="o">.</code><code class="n">N</code><code class="p">)</code>


<code class="k">def</code> <code class="nf">view_colormap</code><code class="p">(</code><code class="n">cmap</code><code class="p">):</code>
    <code class="sd">"""Plot a colormap with its grayscale equivalent"""</code>
    <code class="n">cmap</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">cm</code><code class="o">.</code><code class="n">get_cmap</code><code class="p">(</code><code class="n">cmap</code><code class="p">)</code>
    <code class="n">colors</code> <code class="o">=</code> <code class="n">cmap</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">arange</code><code class="p">(</code><code class="n">cmap</code><code class="o">.</code><code class="n">N</code><code class="p">))</code>

    <code class="n">cmap</code> <code class="o">=</code> <code class="n">grayscale_cmap</code><code class="p">(</code><code class="n">cmap</code><code class="p">)</code>
    <code class="n">grayscale</code> <code class="o">=</code> <code class="n">cmap</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">arange</code><code class="p">(</code><code class="n">cmap</code><code class="o">.</code><code class="n">N</code><code class="p">))</code>

    <code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">(</code><code class="mi">2</code><code class="p">,</code> <code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">6</code><code class="p">,</code> <code class="mi">2</code><code class="p">),</code>
                           <code class="n">subplot_kw</code><code class="o">=</code><code class="nb">dict</code><code class="p">(</code><code class="n">xticks</code><code class="o">=</code><code class="p">[],</code> <code class="n">yticks</code><code class="o">=</code><code class="p">[]))</code>
    <code class="n">ax</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="o">.</code><code class="n">imshow</code><code class="p">([</code><code class="n">colors</code><code class="p">],</code> <code class="n">extent</code><code class="o">=</code><code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">10</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">1</code><code class="p">])</code>
    <code class="n">ax</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="o">.</code><code class="n">imshow</code><code class="p">([</code><code class="n">grayscale</code><code class="p">],</code> <code class="n">extent</code><code class="o">=</code><code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">10</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">1</code><code class="p">])</code></pre>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">6</code><code class="p">]:</code> <code class="n">view_colormap</code><code class="p">(</code><code class="s1">'jet'</code><code class="p">)</code></pre>

<figure><div id="fig0451" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in51.png" alt="png" width="349" height="108">
<h6><span class="label">Figure 4-51. </span>The jet colormap and its uneven luminance scale</h6>
</div></figure>

<p>Notice the bright stripes in the grayscale image. Even in full color,
this uneven brightness means that the eye will be drawn to certain
portions of the color range, which will potentially emphasize
unimportant parts of the dataset. <a data-type="indexterm" data-primary="viridis colormap" id="idm45026301635944"></a>It’s better to use a colormap such as
<code>viridis</code> (the default as of Matplotlib 2.0), which is specifically
constructed to have an even brightness variation across the range. Thus,
it not only plays well with our color perception, but also will
translate well to grayscale printing (<a data-type="xref" href="#fig0452">Figure 4-52</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">7</code><code class="p">]:</code> <code class="n">view_colormap</code><code class="p">(</code><code class="s1">'viridis'</code><code class="p">)</code></pre>

<figure><div id="fig0452" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in52.png" alt="png" width="349" height="108">
<h6><span class="label">Figure 4-52. </span>The viridis colormap and its even luminance scale</h6>
</div></figure>

<p><a data-type="indexterm" data-primary="cubehelix colormap" id="idm45026301619224"></a>If you favor rainbow schemes, another good option for continuous data is
the <span class="keep-together"><code>cubehelix</code></span> colormap (<a data-type="xref" href="#fig0453">Figure 4-53</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">8</code><code class="p">]:</code> <code class="n">view_colormap</code><code class="p">(</code><code class="s1">'cubehelix'</code><code class="p">)</code></pre>

<figure><div id="fig0453" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in53.png" alt="png" width="349" height="108">
<h6><span class="label">Figure 4-53. </span>The cubehelix colormap and its luminance</h6>
</div></figure>

<p>For other situations, such as showing positive and negative deviations
from some mean, <a data-type="indexterm" data-primary="RdBu colormap" id="idm45026301588232"></a>dual-color colorbars such as <code>RdBu</code> (short for <em>Red-Blue</em>) can be
useful. However, as you can see in <a data-type="xref" href="#fig0454">Figure 4-54</a>, it’s important to note that the positive-negative information will be
lost upon translation to grayscale!</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">9</code><code class="p">]:</code> <code class="n">view_colormap</code><code class="p">(</code><code class="s1">'RdBu'</code><code class="p">)</code></pre>

<figure><div id="fig0454" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in54.png" alt="png" width="349" height="108">
<h6><span class="label">Figure 4-54. </span>The RdBu (Red-Blue) colormap and its luminance</h6>
</div></figure>

<p>We’ll see examples of using some of these color maps as we continue.</p>

<p>There are a large number of colormaps available in Matplotlib; to see a
list of them, you can use IPython to explore the <code>plt.cm</code> submodule. For
a more principled approach to colors in Python, you can refer to the
tools and documentation within the Seaborn library (see
<a data-type="xref" href="#visualization-with-seaborn">“Visualization with Seaborn”</a>).<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc58" id="idm45026301556408"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc57" id="idm45026301555736"></a></p>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Color limits and extensions"><div class="sect3" id="color-limits-and-extensions">
<h3>Color limits and extensions</h3>

<p>Matplotlib allows for a large range of colorbar customization. The
colorbar itself is simply an instance of <code>plt.Axes</code>, so all of the axes
and tick formatting tricks we’ve learned are applicable. The colorbar
has some interesting flexibility; for example, we can narrow the color
limits and indicate the out-of-bounds values with a triangular arrow at
the top and bottom by setting the <code>extend</code> property. This might come in
handy, for example, if you’re displaying an image that is subject to noise (<a data-type="xref" href="#fig0455">Figure 4-55</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">10</code><code class="p">]:</code> <code class="c1"># make noise in 1% of the image pixels</code>
        <code class="n">speckles</code> <code class="o">=</code> <code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">random</code><code class="p">(</code><code class="n">I</code><code class="o">.</code><code class="n">shape</code><code class="p">)</code> <code class="o">&lt;</code> <code class="mf">0.01</code><code class="p">)</code>
        <code class="n">I</code><code class="p">[</code><code class="n">speckles</code><code class="p">]</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">normal</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">count_nonzero</code><code class="p">(</code><code class="n">speckles</code><code class="p">))</code>

        <code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code> <code class="mf">3.5</code><code class="p">))</code>

        <code class="n">plt</code><code class="o">.</code><code class="n">subplot</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">1</code><code class="p">)</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">imshow</code><code class="p">(</code><code class="n">I</code><code class="p">,</code> <code class="n">cmap</code><code class="o">=</code><code class="s1">'RdBu'</code><code class="p">)</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">colorbar</code><code class="p">()</code>

        <code class="n">plt</code><code class="o">.</code><code class="n">subplot</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">2</code><code class="p">)</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">imshow</code><code class="p">(</code><code class="n">I</code><code class="p">,</code> <code class="n">cmap</code><code class="o">=</code><code class="s1">'RdBu'</code><code class="p">)</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">colorbar</code><code class="p">(</code><code class="n">extend</code><code class="o">=</code><code class="s1">'both'</code><code class="p">)</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">clim</code><code class="p">(</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">);</code></pre>

<figure><div id="fig0455" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in55.png" alt="png" width="593" height="228">
<h6><span class="label">Figure 4-55. </span>Specifying colormap extensions</h6>
</div></figure>

<p>Notice that in the left panel, the default color limits respond to the
noisy pixels, and the range of the noise completely washes out the
pattern we are interested in. In the right panel, we manually set the
color limits, and add extensions to indicate values that are above or
below those limits. The result is a much more useful visualization of
our data.</p>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Discrete colorbars"><div class="sect3" id="discrete-color-bars">
<h3>Discrete colorbars</h3>

<p><a data-type="indexterm" data-primary="colorbars" data-secondary="discrete" id="idm45026301223992"></a>Colormaps are by default continuous, but sometimes you’d like to
represent discrete values. The easiest way to do this is to use the
<code>plt.cm.get_cmap()</code> function, and pass the name of a suitable colormap
along with the number of desired bins (<a data-type="xref" href="#fig0456">Figure 4-56</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">11</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">imshow</code><code class="p">(</code><code class="n">I</code><code class="p">,</code> <code class="n">cmap</code><code class="o">=</code><code class="n">plt</code><code class="o">.</code><code class="n">cm</code><code class="o">.</code><code class="n">get_cmap</code><code class="p">(</code><code class="s1">'Blues'</code><code class="p">,</code> <code class="mi">6</code><code class="p">))</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">colorbar</code><code class="p">()</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">clim</code><code class="p">(</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">);</code></pre>

<figure><div id="fig0456" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in56.png" alt="png" width="323" height="256">
<h6><span class="label">Figure 4-56. </span>A discretized colormap</h6>
</div></figure>

<p>The discrete version of a colormap can be used just like any other
colormap.</p>
</div></section>



</div></section>













<section data-type="sect2" data-pdf-bookmark="Example: Handwritten Digits"><div class="sect2" id="example-hand-written-digits">
<h2>Example: Handwritten Digits</h2>

<p><a data-type="indexterm" data-primary="colorbars" data-secondary="handwritten digit example" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc59"></a><a data-type="indexterm" data-primary="optical character recognition" data-secondary="Matplotlib" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc60"></a>For an example of where this might be useful, let’s look at an
interesting visualization of some handwritten digits data. This data is
included in Scikit-Learn, and consists of nearly 2,000 8×8 thumbnails
showing various handwritten digits.</p>

<p>For now, let’s start by downloading the digits data and visualizing
several of the example images with <code>plt.imshow()</code> (<a data-type="xref" href="#fig0457">Figure 4-57</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">12</code><code class="p">]:</code> <code class="c1"># load images of the digits 0 through 5 and visualize several of them</code>
        <code class="kn">from</code> <code class="nn">sklearn.datasets</code> <code class="kn">import</code> <code class="n">load_digits</code>
        <code class="n">digits</code> <code class="o">=</code> <code class="n">load_digits</code><code class="p">(</code><code class="n">n_class</code><code class="o">=</code><code class="mi">6</code><code class="p">)</code>

        <code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">(</code><code class="mi">8</code><code class="p">,</code> <code class="mi">8</code><code class="p">,</code> <code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">6</code><code class="p">,</code> <code class="mi">6</code><code class="p">))</code>
        <code class="k">for</code> <code class="n">i</code><code class="p">,</code> <code class="n">axi</code> <code class="ow">in</code> <code class="nb">enumerate</code><code class="p">(</code><code class="n">ax</code><code class="o">.</code><code class="n">flat</code><code class="p">):</code>
            <code class="n">axi</code><code class="o">.</code><code class="n">imshow</code><code class="p">(</code><code class="n">digits</code><code class="o">.</code><code class="n">images</code><code class="p">[</code><code class="n">i</code><code class="p">],</code> <code class="n">cmap</code><code class="o">=</code><code class="s1">'binary'</code><code class="p">)</code>
            <code class="n">axi</code><code class="o">.</code><code class="n">set</code><code class="p">(</code><code class="n">xticks</code><code class="o">=</code><code class="p">[],</code> <code class="n">yticks</code><code class="o">=</code><code class="p">[])</code></pre>

<figure><div id="fig0457" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in57.png" alt="png" width="349" height="349">
<h6><span class="label">Figure 4-57. </span>Sample of handwritten digit data</h6>
</div></figure>

<p>Because each digit is defined by the hue of its 64 pixels, we can
consider each digit to be a point lying in 64-dimensional space: each
dimension represents the brightness of one pixel. But visualizing
relationships in such high-dimensional spaces can be extremely
difficult. <a data-type="indexterm" data-primary="dimensionality reduction" id="idm45026301052760"></a><a data-type="indexterm" data-primary="unsupervised learning" data-secondary="dimensionality reduction" id="idm45026301052088"></a>One way to approach this is to use a <em>dimensionality
reduction</em> technique such as manifold learning to reduce the
dimensionality of the data while maintaining the relationships of
interest. Dimensionality reduction is an example of unsupervised machine
learning, and we will discuss it in more detail in
<a data-type="xref" href="ch05.html#what-is-machine-learning">“What Is Machine Learning?”</a>.</p>

<p>Deferring the discussion of these details, let’s take a look at a
two-dimensional manifold learning projection of this digits data (see
<a data-type="xref" href="ch05.html#in-depth-manifold-learning">“In-Depth: Manifold Learning”</a> for
details):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">13</code><code class="p">]:</code> <code class="c1"># project the digits into 2 dimensions using IsoMap</code>
        <code class="kn">from</code> <code class="nn">sklearn.manifold</code> <code class="kn">import</code> <code class="n">Isomap</code>
        <code class="n">iso</code> <code class="o">=</code> <code class="n">Isomap</code><code class="p">(</code><code class="n">n_components</code><code class="o">=</code><code class="mi">2</code><code class="p">)</code>
        <code class="n">projection</code> <code class="o">=</code> <code class="n">iso</code><code class="o">.</code><code class="n">fit_transform</code><code class="p">(</code><code class="n">digits</code><code class="o">.</code><code class="n">data</code><code class="p">)</code></pre>

<p>We’ll use our discrete colormap to view the results, setting the <code>ticks</code>
and <code>clim</code> to improve the aesthetics of the resulting colorbar (<a data-type="xref" href="#fig0458">Figure 4-58</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">14</code><code class="p">]:</code> <code class="c1"># plot the results</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">scatter</code><code class="p">(</code><code class="n">projection</code><code class="p">[:,</code> <code class="mi">0</code><code class="p">],</code> <code class="n">projection</code><code class="p">[:,</code> <code class="mi">1</code><code class="p">],</code> <code class="n">lw</code><code class="o">=</code><code class="mf">0.1</code><code class="p">,</code>
                    <code class="n">c</code><code class="o">=</code><code class="n">digits</code><code class="o">.</code><code class="n">target</code><code class="p">,</code> <code class="n">cmap</code><code class="o">=</code><code class="n">plt</code><code class="o">.</code><code class="n">cm</code><code class="o">.</code><code class="n">get_cmap</code><code class="p">(</code><code class="s1">'cubehelix'</code><code class="p">,</code> <code class="mi">6</code><code class="p">))</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">colorbar</code><code class="p">(</code><code class="n">ticks</code><code class="o">=</code><code class="nb">range</code><code class="p">(</code><code class="mi">6</code><code class="p">),</code> <code class="n">label</code><code class="o">=</code><code class="s1">'digit value'</code><code class="p">)</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">clim</code><code class="p">(</code><code class="o">-</code><code class="mf">0.5</code><code class="p">,</code> <code class="mf">5.5</code><code class="p">)</code></pre>

<figure><div id="fig0458" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in58.png" alt="png" width="367" height="256">
<h6><span class="label">Figure 4-58. </span>Manifold embedding of handwritten digit pixels</h6>
</div></figure>

<p>The projection also gives us some interesting insights on the
relationships within the dataset: for example, the ranges of 5 and 3
nearly overlap in this projection, indicating that some handwritten
fives and threes are difficult to distinguish, and therefore more likely
to be confused by an automated classification algorithm. Other values,
like 0 and 1, are more distantly separated, and therefore much less
likely to be confused. This observation agrees with our intuition,
because 5 and 3 look much more similar than do 0 and 1.<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc60" id="idm45026300892168"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc59" id="idm45026300891496"></a></p>

<p>We’ll return to manifold learning and digit classification in
<a data-type="xref" href="ch05.html#machine-learning">Chapter 5</a>.<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc56" id="idm45026300889640"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc55" id="idm45026300888968"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc54" id="idm45026300888328"></a></p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Multiple Subplots"><div class="sect1" id="multiple-subplots">
<h1>Multiple Subplots</h1>

<p><a data-type="indexterm" data-primary="Matplotlib" data-secondary="multiple subplots" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc61"></a><a data-type="indexterm" data-primary="plotting" data-secondary="multiple subplots" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc62"></a><a data-type="indexterm" data-primary="subplots" data-secondary="multiple" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc63"></a>Sometimes it is helpful to compare different views of data side by side.
To this end, Matplotlib has the concept of <em>subplots</em>: groups of
smaller axes that can exist together within a single figure. These
subplots might be insets, grids of plots, or other more complicated
layouts. In this section, we’ll explore four routines for creating subplots in
Matplotlib. We’ll start by setting up the notebook for plotting and importing the functions we will use:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">1</code><code class="p">]:</code> <code class="o">%</code><code class="n">matplotlib</code> <code class="n">inline</code>
       <code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="kn">as</code> <code class="nn">plt</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">use</code><code class="p">(</code><code class="s1">'seaborn-white'</code><code class="p">)</code>
       <code class="kn">import</code> <code class="nn">numpy</code> <code class="kn">as</code> <code class="nn">np</code></pre>








<section data-type="sect2" data-pdf-bookmark="plt.axes: Subplots by Hand"><div class="sect2" id="plt.axes-subplots-by-hand">
<h2>plt.axes: Subplots by Hand</h2>

<p><a data-type="indexterm" data-primary="plt.axes() function" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc64"></a><a data-type="indexterm" data-primary="subplots" data-secondary="manual customization" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc65"></a><a data-type="indexterm" data-primary="subplots" data-secondary="plt.axes() for" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc66"></a>The most basic method of creating an axes is to use the <code>plt.axes</code>
function. As we’ve seen previously, by default this creates a standard
axes object that fills the entire figure. <code>plt.axes</code> also takes an
optional argument that is a list of four numbers in the figure
coordinate system. These numbers represent
<code>[<em>bottom</em>, <em>left</em>, <em>width</em>, <em>height</em>]</code> in the figure coordinate system, which
ranges from 0 at the bottom left of the figure to 1 at the top right of
the figure.</p>

<p>For example, we might create an inset axes at the top-right corner of
another axes by setting the <em>x</em> and <em>y</em> position to 0.65 (that is, starting
at 65% of the width and 65% of the height of the figure) and the <em>x</em> and <em>y</em>
extents to 0.2 (that is, the size of the axes is 20% of the width and
20% of the height of the figure). <a data-type="xref" href="#fig0459">Figure 4-59</a> shows the result of this code:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">2</code><code class="p">]:</code> <code class="n">ax1</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">axes</code><code class="p">()</code>  <code class="c1"># standard axes</code>
       <code class="n">ax2</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">axes</code><code class="p">([</code><code class="mf">0.65</code><code class="p">,</code> <code class="mf">0.65</code><code class="p">,</code> <code class="mf">0.2</code><code class="p">,</code> <code class="mf">0.2</code><code class="p">])</code></pre>

<figure><div id="fig0459" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in59.png" alt="png" width="374" height="255">
<h6><span class="label">Figure 4-59. </span>Example of an inset axes</h6>
</div></figure>

<p>The equivalent of this command within the object-oriented interface is
<code>fig.add_axes()</code>. Let’s use this to create two vertically stacked axes (<a data-type="xref" href="#fig0460">Figure 4-60</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">3</code><code class="p">]:</code> <code class="n">fig</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">()</code>
       <code class="n">ax1</code> <code class="o">=</code> <code class="n">fig</code><code class="o">.</code><code class="n">add_axes</code><code class="p">([</code><code class="mf">0.1</code><code class="p">,</code> <code class="mf">0.5</code><code class="p">,</code> <code class="mf">0.8</code><code class="p">,</code> <code class="mf">0.4</code><code class="p">],</code>
                          <code class="n">xticklabels</code><code class="o">=</code><code class="p">[],</code> <code class="n">ylim</code><code class="o">=</code><code class="p">(</code><code class="o">-</code><code class="mf">1.2</code><code class="p">,</code> <code class="mf">1.2</code><code class="p">))</code>
       <code class="n">ax2</code> <code class="o">=</code> <code class="n">fig</code><code class="o">.</code><code class="n">add_axes</code><code class="p">([</code><code class="mf">0.1</code><code class="p">,</code> <code class="mf">0.1</code><code class="p">,</code> <code class="mf">0.8</code><code class="p">,</code> <code class="mf">0.4</code><code class="p">],</code>
                          <code class="n">ylim</code><code class="o">=</code><code class="p">(</code><code class="o">-</code><code class="mf">1.2</code><code class="p">,</code> <code class="mf">1.2</code><code class="p">))</code>

       <code class="n">x</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">10</code><code class="p">)</code>
       <code class="n">ax1</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">))</code>
       <code class="n">ax2</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">cos</code><code class="p">(</code><code class="n">x</code><code class="p">));</code></pre>

<figure><div id="fig0460" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in60.png" alt="png" width="389" height="257">
<h6><span class="label">Figure 4-60. </span>Vertically stacked axes example</h6>
</div></figure>

<p>We now have two axes (the top with no tick labels) that are
just touching: the bottom of the upper panel (at position 0.5) matches
the top of the lower panel (at position 0.1 + 0.4).<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc66" id="idm45026300621992"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc65" id="idm45026300621320"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc64" id="idm45026300620680"></a></p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="plt.subplot: Simple Grids of Subplots"><div class="sect2" id="plt.subplot-simple-grids-of-subplots">
<h2>plt.subplot: Simple Grids of Subplots</h2>

<p><a data-type="indexterm" data-primary="plt.subplot() function" id="idm45026300618424"></a><a data-type="indexterm" data-primary="subplots" data-secondary="plt.subplot() for" id="idm45026300617720"></a>Aligned columns or rows of subplots are a common enough need that
Matplotlib has several convenience routines that make them easy to
create. The lowest level of these is <code>plt.subplot()</code>, which creates a
single subplot within a grid. As you can see, this command takes three
integer arguments—the number of rows, the number of columns, and the
index of the plot to be created in this scheme, which runs from the
upper left to the bottom right (<a data-type="xref" href="#fig0461">Figure 4-61</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">4</code><code class="p">]:</code> <code class="k">for</code> <code class="n">i</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="mi">7</code><code class="p">):</code>
           <code class="n">plt</code><code class="o">.</code><code class="n">subplot</code><code class="p">(</code><code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="n">i</code><code class="p">)</code>
           <code class="n">plt</code><code class="o">.</code><code class="n">text</code><code class="p">(</code><code class="mf">0.5</code><code class="p">,</code> <code class="mf">0.5</code><code class="p">,</code> <code class="nb">str</code><code class="p">((</code><code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="n">i</code><code class="p">)),</code>
                    <code class="n">fontsize</code><code class="o">=</code><code class="mi">18</code><code class="p">,</code> <code class="n">ha</code><code class="o">=</code><code class="s1">'center'</code><code class="p">)</code></pre>

<figure><div id="fig0461" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in61.png" alt="png" width="374" height="255">
<h6><span class="label">Figure 4-61. </span>A plt.subplot() example</h6>
</div></figure>

<p>The command <code>plt.subplots_adjust</code> can be used to adjust the spacing between these plots. The following code (the result of which is shown in <a data-type="xref" href="#fig0462">Figure 4-62</a>) uses the equivalent object-oriented
command, <code>fig.add_subplot()</code>:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">5</code><code class="p">]:</code> <code class="n">fig</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">()</code>
       <code class="n">fig</code><code class="o">.</code><code class="n">subplots_adjust</code><code class="p">(</code><code class="n">hspace</code><code class="o">=</code><code class="mf">0.4</code><code class="p">,</code> <code class="n">wspace</code><code class="o">=</code><code class="mf">0.4</code><code class="p">)</code>
       <code class="k">for</code> <code class="n">i</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="mi">7</code><code class="p">):</code>
           <code class="n">ax</code> <code class="o">=</code> <code class="n">fig</code><code class="o">.</code><code class="n">add_subplot</code><code class="p">(</code><code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="n">i</code><code class="p">)</code>
           <code class="n">ax</code><code class="o">.</code><code class="n">text</code><code class="p">(</code><code class="mf">0.5</code><code class="p">,</code> <code class="mf">0.5</code><code class="p">,</code> <code class="nb">str</code><code class="p">((</code><code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="n">i</code><code class="p">)),</code>
                  <code class="n">fontsize</code><code class="o">=</code><code class="mi">18</code><code class="p">,</code> <code class="n">ha</code><code class="o">=</code><code class="s1">'center'</code><code class="p">)</code></pre>

<figure><div id="fig0462" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in62.png" alt="png" width="374" height="255">
<h6><span class="label">Figure 4-62. </span>plt.subplot() with adjusted margins</h6>
</div></figure>

<p>We’ve used the <code>hspace</code> and <code>wspace</code> arguments of <code>plt.subplots_adjust</code>,
which specify the spacing along the height and width of the figure, in
units of the subplot size (in this case, the space is 40% of the subplot
width and height).</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="plt.subplots: The Whole Grid in One Go"><div class="sect2" id="plt.subplots-the-whole-grid-in-one-go">
<h2>plt.subplots: The Whole Grid in One Go</h2>

<p><a data-type="indexterm" data-primary="plt.subplots() function" id="idm45026300437112"></a><a data-type="indexterm" data-primary="subplots" data-secondary="plt.subplots() for" id="idm45026300436184"></a>The approach just described can become quite tedious when you’re creating a large grid of
subplots, especially if you’d like to hide the x- and y-axis labels
on the inner plots. For this purpose, <code>plt.subplots()</code> is the easier tool
to use (note the <code>s</code> at the end of <code>subplots</code>). Rather than creating a
single subplot, this function creates a full grid of subplots in a
single line, returning them in a NumPy array. The arguments are the
number of rows and number of columns, along with optional keywords
<code>sharex</code> and <code>sharey</code>, which allow you to specify the relationships
between different axes.</p>

<p>Here we’ll create a 2×3 grid of subplots, where all axes in the same
row share their <span class="keep-together">y-axis</span> scale, and all axes in the same column share
their x-axis scale (<a data-type="xref" href="#fig0463">Figure 4-63</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">6</code><code class="p">]:</code> <code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">(</code><code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="n">sharex</code><code class="o">=</code><code class="s1">'col'</code><code class="p">,</code> <code class="n">sharey</code><code class="o">=</code><code class="s1">'row'</code><code class="p">)</code></pre>

<figure><div id="fig0463" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in63.png" alt="png" width="374" height="255">
<h6><span class="label">Figure 4-63. </span>Shared x and y axis in plt.subplots()</h6>
</div></figure>

<p>Note that by specifying <code>sharex</code> and <code>sharey</code>, we’ve automatically
removed inner labels on the grid to make the plot cleaner. The resulting
grid of axes instances is returned within a NumPy array, allowing for
convenient specification of the desired axes using standard array
indexing notation (<a data-type="xref" href="#fig0464">Figure 4-64</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">7</code><code class="p">]:</code> <code class="c1"># axes are in a two-dimensional array, indexed by [row, col]</code>
       <code class="k">for</code> <code class="n">i</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="mi">2</code><code class="p">):</code>
           <code class="k">for</code> <code class="n">j</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="mi">3</code><code class="p">):</code>
               <code class="n">ax</code><code class="p">[</code><code class="n">i</code><code class="p">,</code> <code class="n">j</code><code class="p">]</code><code class="o">.</code><code class="n">text</code><code class="p">(</code><code class="mf">0.5</code><code class="p">,</code> <code class="mf">0.5</code><code class="p">,</code> <code class="nb">str</code><code class="p">((</code><code class="n">i</code><code class="p">,</code> <code class="n">j</code><code class="p">)),</code>
                             <code class="n">fontsize</code><code class="o">=</code><code class="mi">18</code><code class="p">,</code> <code class="n">ha</code><code class="o">=</code><code class="s1">'center'</code><code class="p">)</code>
       <code class="n">fig</code></pre>

<figure><div id="fig0464" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in64.png" alt="png" width="374" height="255">
<h6><span class="label">Figure 4-64. </span>Identifying plots in a subplot grid</h6>
</div></figure>

<p>In comparison to <code>plt.subplot()</code>, <code>plt.subplots()</code> is more consistent
with Python’s conventional 0-based indexing.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="plt.GridSpec: More Complicated Arrangements"><div class="sect2" id="plt.gridspec-more-complicated-arrangements">
<h2>plt.GridSpec: More Complicated Arrangements</h2>

<p><a data-type="indexterm" data-primary="plt.GridSpec() function" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc67"></a><a data-type="indexterm" data-primary="subplots" data-secondary="plt.GridSpec() for" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc68"></a>To go beyond a regular grid to subplots that span multiple rows and
columns, <code>plt.GridSpec()</code> is the best tool. The <code>plt.GridSpec()</code> object
does not create a plot by itself; it is simply a convenient interface
that is recognized by the <code>plt.subplot()</code> command. For example, a
gridspec for a grid of two rows and three columns with some specified width
and height space looks like this:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">8</code><code class="p">]:</code> <code class="n">grid</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">GridSpec</code><code class="p">(</code><code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="n">wspace</code><code class="o">=</code><code class="mf">0.4</code><code class="p">,</code> <code class="n">hspace</code><code class="o">=</code><code class="mf">0.3</code><code class="p">)</code></pre>

<p>From this we can specify subplot locations and extents using the
familiar Python slicing syntax (<a data-type="xref" href="#fig0465">Figure 4-65</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">9</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplot</code><code class="p">(</code><code class="n">grid</code><code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">])</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">subplot</code><code class="p">(</code><code class="n">grid</code><code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">1</code><code class="p">:])</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">subplot</code><code class="p">(</code><code class="n">grid</code><code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="p">:</code><code class="mi">2</code><code class="p">])</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">subplot</code><code class="p">(</code><code class="n">grid</code><code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">]);</code></pre>

<figure><div id="fig0465" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in65.png" alt="png" width="374" height="255">
<h6><span class="label">Figure 4-65. </span>Irregular subplots with plt.GridSpec</h6>
</div></figure>

<p>This type of flexible grid alignment has a wide range of uses. I most
often use it when creating multi-axes histogram plots like the
one shown here (<a data-type="xref" href="#fig0466">Figure 4-66</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">10</code><code class="p">]:</code> <code class="c1"># Create some normally distributed data</code>
        <code class="n">mean</code> <code class="o">=</code> <code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">]</code>
        <code class="n">cov</code> <code class="o">=</code> <code class="p">[[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">],</code> <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">]]</code>
        <code class="n">x</code><code class="p">,</code> <code class="n">y</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">multivariate_normal</code><code class="p">(</code><code class="n">mean</code><code class="p">,</code> <code class="n">cov</code><code class="p">,</code> <code class="mi">3000</code><code class="p">)</code><code class="o">.</code><code class="n">T</code>

        <code class="c1"># Set up the axes with gridspec</code>
        <code class="n">fig</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">6</code><code class="p">,</code> <code class="mi">6</code><code class="p">))</code>
        <code class="n">grid</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">GridSpec</code><code class="p">(</code><code class="mi">4</code><code class="p">,</code> <code class="mi">4</code><code class="p">,</code> <code class="n">hspace</code><code class="o">=</code><code class="mf">0.2</code><code class="p">,</code> <code class="n">wspace</code><code class="o">=</code><code class="mf">0.2</code><code class="p">)</code>
        <code class="n">main_ax</code> <code class="o">=</code> <code class="n">fig</code><code class="o">.</code><code class="n">add_subplot</code><code class="p">(</code><code class="n">grid</code><code class="p">[:</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">:])</code>
        <code class="n">y_hist</code> <code class="o">=</code> <code class="n">fig</code><code class="o">.</code><code class="n">add_subplot</code><code class="p">(</code><code class="n">grid</code><code class="p">[:</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code> <code class="mi">0</code><code class="p">],</code> <code class="n">xticklabels</code><code class="o">=</code><code class="p">[],</code> <code class="n">sharey</code><code class="o">=</code><code class="n">main_ax</code><code class="p">)</code>
        <code class="n">x_hist</code> <code class="o">=</code> <code class="n">fig</code><code class="o">.</code><code class="n">add_subplot</code><code class="p">(</code><code class="n">grid</code><code class="p">[</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">:],</code> <code class="n">yticklabels</code><code class="o">=</code><code class="p">[],</code> <code class="n">sharex</code><code class="o">=</code><code class="n">main_ax</code><code class="p">)</code>

        <code class="c1"># scatter points on the main axes</code>
        <code class="n">main_ax</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">,</code> <code class="s1">'ok'</code><code class="p">,</code> <code class="n">markersize</code><code class="o">=</code><code class="mi">3</code><code class="p">,</code> <code class="n">alpha</code><code class="o">=</code><code class="mf">0.2</code><code class="p">)</code>

        <code class="c1"># histogram on the attached axes</code>
        <code class="n">x_hist</code><code class="o">.</code><code class="n">hist</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="mi">40</code><code class="p">,</code> <code class="n">histtype</code><code class="o">=</code><code class="s1">'stepfilled'</code><code class="p">,</code>
                    <code class="n">orientation</code><code class="o">=</code><code class="s1">'vertical'</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s1">'gray'</code><code class="p">)</code>
        <code class="n">x_hist</code><code class="o">.</code><code class="n">invert_yaxis</code><code class="p">()</code>

        <code class="n">y_hist</code><code class="o">.</code><code class="n">hist</code><code class="p">(</code><code class="n">y</code><code class="p">,</code> <code class="mi">40</code><code class="p">,</code> <code class="n">histtype</code><code class="o">=</code><code class="s1">'stepfilled'</code><code class="p">,</code>
                    <code class="n">orientation</code><code class="o">=</code><code class="s1">'horizontal'</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s1">'gray'</code><code class="p">)</code>
        <code class="n">y_hist</code><code class="o">.</code><code class="n">invert_xaxis</code><code class="p">()</code></pre>

<figure><div id="fig0466" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in66.png" alt="png" width="367" height="366">
<h6><span class="label">Figure 4-66. </span>Visualizing multidimensional distributions with plt.GridSpec</h6>
</div></figure>

<p>This type of distribution plotted alongside its margins is common enough
that it has its own plotting API in the Seaborn package; see
<a data-type="xref" href="#visualization-with-seaborn">“Visualization with Seaborn”</a> for more details<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc68" id="idm45026299898200"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc67" id="idm45026299897528"></a>.<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc63" id="idm45026299896760"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc62" id="idm45026299896088"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc61" id="idm45026299895448"></a></p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Text and Annotation"><div class="sect1" id="text-and-annotation">
<h1>Text and Annotation</h1>

<p><a data-type="indexterm" data-primary="annotation of plots" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc69"></a><a data-type="indexterm" data-primary="Matplotlib" data-secondary="text and annotation" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc70"></a><a data-type="indexterm" data-primary="plotting" data-secondary="text and annotation for" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc71"></a>Creating a good visualization involves guiding the reader so that the
figure tells a story. In some cases, this story can be told in an entirely visual manner,
without the need for added text, but in others, small textual cues and
labels are necessary. Perhaps the most basic types of annotations you
will use are axes labels and titles, but the options go beyond this.
Let’s take a look at some data and how we might visualize and annotate
it to help convey interesting information. We’ll start by setting up the notebook for plotting and  importing the functions we will use:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">1</code><code class="p">]:</code> <code class="o">%</code><code class="n">matplotlib</code> <code class="n">inline</code>
       <code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="kn">as</code> <code class="nn">plt</code>
       <code class="kn">import</code> <code class="nn">matplotlib</code> <code class="kn">as</code> <code class="nn">mpl</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">use</code><code class="p">(</code><code class="s1">'seaborn-whitegrid'</code><code class="p">)</code>
       <code class="kn">import</code> <code class="nn">numpy</code> <code class="kn">as</code> <code class="nn">np</code>
       <code class="kn">import</code> <code class="nn">pandas</code> <code class="kn">as</code> <code class="nn">pd</code></pre>








<section data-type="sect2" data-pdf-bookmark="Example: Effect of Holidays on US Births"><div class="sect2" id="example-effect-of-holidays-on-us-births">
<h2>Example: Effect of Holidays on US Births</h2>

<p><a data-type="indexterm" data-primary="annotation of plots" data-secondary="holidays/US births example" id="idm45026299853528"></a>Let’s return to some data we worked with earlier in
<a data-type="xref" href="ch03.html#example-birthrate-data">“Example: Birthrate Data”</a>, where we generated a plot of
average births over the course of the calendar year; as already mentioned, this
data can be downloaded at
<a href="https://raw.githubusercontent.com/jakevdp/data-CDCbirths/master/births.csv"><em class="hyperlink">https://raw.githubusercontent.com/jakevdp/data-CDCbirths/master/births.csv</em></a>.</p>

<p>We’ll start with the same cleaning procedure we used there, and plot the
results (<a data-type="xref" href="#fig0467">Figure 4-67</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">2</code><code class="p">]:</code>
<code class="n">births</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="s1">'births.csv'</code><code class="p">)</code>

<code class="n">quartiles</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">percentile</code><code class="p">(</code><code class="n">births</code><code class="p">[</code><code class="s1">'births'</code><code class="p">],</code> <code class="p">[</code><code class="mi">25</code><code class="p">,</code> <code class="mi">50</code><code class="p">,</code> <code class="mi">75</code><code class="p">])</code>
<code class="n">mu</code><code class="p">,</code> <code class="n">sig</code> <code class="o">=</code> <code class="n">quartiles</code><code class="p">[</code><code class="mi">1</code><code class="p">],</code> <code class="mf">0.74</code> <code class="o">*</code> <code class="p">(</code><code class="n">quartiles</code><code class="p">[</code><code class="mi">2</code><code class="p">]</code> <code class="o">-</code> <code class="n">quartiles</code><code class="p">[</code><code class="mi">0</code><code class="p">])</code>
<code class="n">births</code> <code class="o">=</code> <code class="n">births</code><code class="o">.</code><code class="n">query</code><code class="p">(</code><code class="s1">'(births &gt; @mu - 5 * @sig) &amp; (births &lt; @mu + 5 * @sig)'</code><code class="p">)</code>

<code class="n">births</code><code class="p">[</code><code class="s1">'day'</code><code class="p">]</code> <code class="o">=</code> <code class="n">births</code><code class="p">[</code><code class="s1">'day'</code><code class="p">]</code><code class="o">.</code><code class="n">astype</code><code class="p">(</code><code class="nb">int</code><code class="p">)</code>

<code class="n">births</code><code class="o">.</code><code class="n">index</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">to_datetime</code><code class="p">(</code><code class="mi">10000</code> <code class="o">*</code> <code class="n">births</code><code class="o">.</code><code class="n">year</code> <code class="o">+</code>
                              <code class="mi">100</code> <code class="o">*</code> <code class="n">births</code><code class="o">.</code><code class="n">month</code> <code class="o">+</code>
                              <code class="n">births</code><code class="o">.</code><code class="n">day</code><code class="p">,</code> <code class="n">format</code><code class="o">=</code><code class="s1">'</code><code class="si">%Y%m%d</code><code class="s1">'</code><code class="p">)</code>
<code class="n">births_by_date</code> <code class="o">=</code> <code class="n">births</code><code class="o">.</code><code class="n">pivot_table</code><code class="p">(</code><code class="s1">'births'</code><code class="p">,</code>
                                    <code class="p">[</code><code class="n">births</code><code class="o">.</code><code class="n">index</code><code class="o">.</code><code class="n">month</code><code class="p">,</code> <code class="n">births</code><code class="o">.</code><code class="n">index</code><code class="o">.</code><code class="n">day</code><code class="p">])</code>
<code class="n">births_by_date</code><code class="o">.</code><code class="n">index</code> <code class="o">=</code> <code class="p">[</code><code class="n">pd</code><code class="o">.</code><code class="n">datetime</code><code class="p">(</code><code class="mi">2012</code><code class="p">,</code> <code class="n">month</code><code class="p">,</code> <code class="n">day</code><code class="p">)</code>
                        <code class="k">for</code> <code class="p">(</code><code class="n">month</code><code class="p">,</code> <code class="n">day</code><code class="p">)</code> <code class="ow">in</code> <code class="n">births_by_date</code><code class="o">.</code><code class="n">index</code><code class="p">]</code></pre>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">3</code><code class="p">]:</code> <code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">12</code><code class="p">,</code> <code class="mi">4</code><code class="p">))</code>
       <code class="n">births_by_date</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">ax</code><code class="o">=</code><code class="n">ax</code><code class="p">);</code></pre>

<figure><div id="fig0467" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in67.png" alt="png" width="710" height="265">
<h6><span class="label">Figure 4-67. </span>Average daily births by date</h6>
</div></figure>

<p>When we’re communicating data like this, it is often useful to annotate
certain features of the plot to draw the reader’s attention. This can be
done manually with the <code>plt.text</code>/<code>ax.text</code> command, which will place
text at a particular <em>x</em>/<em>y</em> value (<a data-type="xref" href="#fig0468">Figure 4-68</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">4</code><code class="p">]:</code> <code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">12</code><code class="p">,</code> <code class="mi">4</code><code class="p">))</code>
       <code class="n">births_by_date</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">ax</code><code class="o">=</code><code class="n">ax</code><code class="p">)</code>

       <code class="c1"># Add labels to the plot</code>
       <code class="n">style</code> <code class="o">=</code> <code class="nb">dict</code><code class="p">(</code><code class="n">size</code><code class="o">=</code><code class="mi">10</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s1">'gray'</code><code class="p">)</code>

       <code class="n">ax</code><code class="o">.</code><code class="n">text</code><code class="p">(</code><code class="s1">'2012-1-1'</code><code class="p">,</code> <code class="mi">3950</code><code class="p">,</code> <code class="s2">"New Year's Day"</code><code class="p">,</code> <code class="o">**</code><code class="n">style</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">text</code><code class="p">(</code><code class="s1">'2012-7-4'</code><code class="p">,</code> <code class="mi">4250</code><code class="p">,</code> <code class="s2">"Independence Day"</code><code class="p">,</code> <code class="n">ha</code><code class="o">=</code><code class="s1">'center'</code><code class="p">,</code> <code class="o">**</code><code class="n">style</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">text</code><code class="p">(</code><code class="s1">'2012-9-4'</code><code class="p">,</code> <code class="mi">4850</code><code class="p">,</code> <code class="s2">"Labor Day"</code><code class="p">,</code> <code class="n">ha</code><code class="o">=</code><code class="s1">'center'</code><code class="p">,</code> <code class="o">**</code><code class="n">style</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">text</code><code class="p">(</code><code class="s1">'2012-10-31'</code><code class="p">,</code> <code class="mi">4600</code><code class="p">,</code> <code class="s2">"Halloween"</code><code class="p">,</code> <code class="n">ha</code><code class="o">=</code><code class="s1">'right'</code><code class="p">,</code> <code class="o">**</code><code class="n">style</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">text</code><code class="p">(</code><code class="s1">'2012-11-25'</code><code class="p">,</code> <code class="mi">4450</code><code class="p">,</code> <code class="s2">"Thanksgiving"</code><code class="p">,</code> <code class="n">ha</code><code class="o">=</code><code class="s1">'center'</code><code class="p">,</code> <code class="o">**</code><code class="n">style</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">text</code><code class="p">(</code><code class="s1">'2012-12-25'</code><code class="p">,</code> <code class="mi">3850</code><code class="p">,</code> <code class="s2">"Christmas "</code><code class="p">,</code> <code class="n">ha</code><code class="o">=</code><code class="s1">'right'</code><code class="p">,</code> <code class="o">**</code><code class="n">style</code><code class="p">)</code>

       <code class="c1"># Label the axes</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">set</code><code class="p">(</code><code class="n">title</code><code class="o">=</code><code class="s1">'USA births by day of year (1969-1988)'</code><code class="p">,</code>
              <code class="n">ylabel</code><code class="o">=</code><code class="s1">'average daily births'</code><code class="p">)</code>

       <code class="c1"># Format the x axis with centered month labels</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">xaxis</code><code class="o">.</code><code class="n">set_major_locator</code><code class="p">(</code><code class="n">mpl</code><code class="o">.</code><code class="n">dates</code><code class="o">.</code><code class="n">MonthLocator</code><code class="p">())</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">xaxis</code><code class="o">.</code><code class="n">set_minor_locator</code><code class="p">(</code><code class="n">mpl</code><code class="o">.</code><code class="n">dates</code><code class="o">.</code><code class="n">MonthLocator</code><code class="p">(</code><code class="n">bymonthday</code><code class="o">=</code><code class="mi">15</code><code class="p">))</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">xaxis</code><code class="o">.</code><code class="n">set_major_formatter</code><code class="p">(</code><code class="n">plt</code><code class="o">.</code><code class="n">NullFormatter</code><code class="p">())</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">xaxis</code><code class="o">.</code><code class="n">set_minor_formatter</code><code class="p">(</code><code class="n">mpl</code><code class="o">.</code><code class="n">dates</code><code class="o">.</code><code class="n">DateFormatter</code><code class="p">(</code><code class="s1">'%h'</code><code class="p">));</code></pre>

<figure><div id="fig0468" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in68.png" alt="png" width="724" height="263">
<h6><span class="label">Figure 4-68. </span>Annotated average daily births by date</h6>
</div></figure>

<p>The <code>ax.text</code> method takes an <em>x</em> position, a <em>y</em> position, a string, and
then optional keywords specifying the color, size, style, alignment, and
other properties of the text. Here we used <code>ha='right'</code> and
<code>ha='center'</code>, where <code>ha</code> is short for <em>horizonal alignment</em>. See the
docstring of <code>plt.text()</code> and of <code>mpl.text.Text()</code> for more information
on available options.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Transforms and Text Position"><div class="sect2" id="transforms-and-text-position">
<h2>Transforms and Text Position</h2>

<p><a data-type="indexterm" data-primary="annotation of plots" data-secondary="transforms and text position" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc72"></a><a data-type="indexterm" data-primary="text" data-secondary="transforms and position of" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc73"></a><a data-type="indexterm" data-primary="transforms" data-secondary="modifying" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc74"></a><a data-type="indexterm" data-primary="transforms" data-secondary="text position and" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc75"></a>In the previous example, we anchored our text annotations to data
locations. Sometimes it’s preferable to anchor the text to a position on
the axes or figure, independent of the data. In Matplotlib, we do this by modifying the <em>transform</em>.</p>

<p>Any graphics display framework needs some scheme for translating between
coordinate systems. For example, a data point at
<math xmlns="http://www.w3.org/1998/Math/MathML" alttext="left-parenthesis x comma y right-parenthesis equals left-parenthesis 1 comma 1 right-parenthesis">
  <mrow>
    <mo>(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo>)</mo>
    <mo>=</mo>
    <mo>(</mo>
    <mn>1</mn>
    <mo>,</mo>
    <mn>1</mn>
    <mo>)</mo>
  </mrow>
</math> needs to somehow be represented at a
certain location on the figure, which in turn needs to be represented in
pixels on the screen. Mathematically, such coordinate transformations are relatively straightforward, and Matplotlib has a well-developed set of
tools that it uses internally to perform them (the tools can be explored in the <code>matplotlib.transforms</code> submodule).</p>

<p>The average user rarely needs to worry about the details of these
transforms, but it is helpful knowledge to have when considering the
placement of text on a figure. There are three predefined transforms
that can be useful in this situation:</p>
<dl>
<dt><code>ax.transData</code></dt>
<dd>
<p>Transform associated with data coordinates</p>
</dd>
<dt><code>ax.transAxes</code></dt>
<dd>
<p>Transform associated with the axes (in units of axes
dimensions)</p>
</dd>
<dt><code>fig.transFigure</code></dt>
<dd>
<p>Transform associated with the figure (in units of
figure dimensions)</p>
</dd>
</dl>

<p>Here let’s look at an example of drawing text at various locations using
these transforms (<a data-type="xref" href="#fig0469">Figure 4-69</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">5</code><code class="p">]:</code> <code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">(</code><code class="n">facecolor</code><code class="o">=</code><code class="s1">'lightgray'</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">axis</code><code class="p">([</code><code class="mi">0</code><code class="p">,</code> <code class="mi">10</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">10</code><code class="p">])</code>

       <code class="c1"># transform=ax.transData is the default, but we'll specify it anyway</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">text</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="s2">". Data: (1, 5)"</code><code class="p">,</code> <code class="n">transform</code><code class="o">=</code><code class="n">ax</code><code class="o">.</code><code class="n">transData</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">text</code><code class="p">(</code><code class="mf">0.5</code><code class="p">,</code> <code class="mf">0.1</code><code class="p">,</code> <code class="s2">". Axes: (0.5, 0.1)"</code><code class="p">,</code> <code class="n">transform</code><code class="o">=</code><code class="n">ax</code><code class="o">.</code><code class="n">transAxes</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">text</code><code class="p">(</code><code class="mf">0.2</code><code class="p">,</code> <code class="mf">0.2</code><code class="p">,</code> <code class="s2">". Figure: (0.2, 0.2)"</code><code class="p">,</code> <code class="n">transform</code><code class="o">=</code><code class="n">fig</code><code class="o">.</code><code class="n">transFigure</code><code class="p">);</code></pre>

<figure><div id="fig0469" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in69.png" alt="png" width="370" height="255">
<h6><span class="label">Figure 4-69. </span>Comparing Matplotlib’s coordinate systems</h6>
</div></figure>

<p>Note that by default, the text is aligned above and to the left of the
specified coordinates; here the “.” at the beginning of each string will
approximately mark the given coordinate location.</p>

<p>The <code>transData</code> coordinates give the usual data coordinates associated
with the x- and y-axis labels. The <code>transAxes</code> coordinates give the
location from the bottom-left corner of the axes (here the white box)
as a fraction of the axes size. The <code>transFigure</code> coordinates are
similar, but specify the position from the bottom left of the figure
(here the gray box) as a fraction of the figure size.</p>

<p>Notice now that if we change the axes limits, it is only the <code>transData</code>
coordinates that will be affected, while the others remain stationary (<a data-type="xref" href="#fig0470">Figure 4-70</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">6</code><code class="p">]:</code> <code class="n">ax</code><code class="o">.</code><code class="n">set_xlim</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">2</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">set_ylim</code><code class="p">(</code><code class="o">-</code><code class="mi">6</code><code class="p">,</code> <code class="mi">6</code><code class="p">)</code>
       <code class="n">fig</code></pre>

<figure><div id="fig0470" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in70.png" alt="png" width="371" height="255">
<h6><span class="label">Figure 4-70. </span>Comparing Matplotlib’s coordinate systems</h6>
</div></figure>

<p>You can see this behavior more clearly by changing the axes limits
interactively; if you are executing this code in a notebook, you can
make that happen by changing <code>%matplotlib inline</code> to
<code>%matplotlib notebook</code> and using each plot’s menu to interact with the
plot.<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc75" id="idm45026299249992"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc74" id="idm45026299249320"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc73" id="idm45026299247880"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc72" id="idm45026299247240"></a></p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Arrows and Annotation"><div class="sect2" id="arrows-and-annotation">
<h2>Arrows and Annotation</h2>

<p><a data-type="indexterm" data-primary="annotation of plots" data-secondary="arrows" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc76"></a><a data-type="indexterm" data-primary="arrows" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc77"></a>Along with tick marks and text, another useful annotation mark is the
simple arrow.</p>

<p>Drawing arrows in Matplotlib is often much harder than you might hope.
While there is a <code>plt.arrow()</code> function available, I wouldn’t suggest using
it; the arrows it creates are SVG objects that will be subject to the
varying aspect ratio of your plots, and the result is rarely what the
user intended. Instead, I’d suggest using the <code>plt.annotate()</code> function.
This function creates some text and an arrow, and the arrows can be very
flexibly specified.</p>

<p>Here we’ll use <code>annotate</code> with several of its options (<a data-type="xref" href="#fig0471">Figure 4-71</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">7</code><code class="p">]:</code> <code class="o">%</code><code class="n">matplotlib</code> <code class="n">inline</code>

       <code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">()</code>

       <code class="n">x</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">20</code><code class="p">,</code> <code class="mi">1000</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">cos</code><code class="p">(</code><code class="n">x</code><code class="p">))</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">axis</code><code class="p">(</code><code class="s1">'equal'</code><code class="p">)</code>

       <code class="n">ax</code><code class="o">.</code><code class="n">annotate</code><code class="p">(</code><code class="s1">'local maximum'</code><code class="p">,</code> <code class="n">xy</code><code class="o">=</code><code class="p">(</code><code class="mf">6.28</code><code class="p">,</code> <code class="mi">1</code><code class="p">),</code> <code class="n">xytext</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code> <code class="mi">4</code><code class="p">),</code>
                   <code class="n">arrowprops</code><code class="o">=</code><code class="nb">dict</code><code class="p">(</code><code class="n">facecolor</code><code class="o">=</code><code class="s1">'black'</code><code class="p">,</code> <code class="n">shrink</code><code class="o">=</code><code class="mf">0.05</code><code class="p">))</code>

       <code class="n">ax</code><code class="o">.</code><code class="n">annotate</code><code class="p">(</code><code class="s1">'local minimum'</code><code class="p">,</code> <code class="n">xy</code><code class="o">=</code><code class="p">(</code><code class="mi">5</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">pi</code><code class="p">,</code> <code class="o">-</code><code class="mi">1</code><code class="p">),</code> <code class="n">xytext</code><code class="o">=</code><code class="p">(</code><code class="mi">2</code><code class="p">,</code> <code class="o">-</code><code class="mi">6</code><code class="p">),</code>
                   <code class="n">arrowprops</code><code class="o">=</code><code class="nb">dict</code><code class="p">(</code><code class="n">arrowstyle</code><code class="o">=</code><code class="s2">"-&gt;"</code><code class="p">,</code>
                                   <code class="n">connectionstyle</code><code class="o">=</code><code class="s2">"angle3,angleA=0,angleB=-90"</code><code class="p">));</code></pre>

<figure><div id="fig0471" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in71.png" alt="png" width="370" height="250">
<h6><span class="label">Figure 4-71. </span>Annotation examples</h6>
</div></figure>

<p>The arrow style is controlled through the <code>arrowprops</code> dictionary, which
has numerous options available. These options are fairly well documented
in Matplotlib’s online documentation, so rather than repeating them here
I’ll quickly show some of the possibilities.
Let’s demonstrate several of the possible options using the birthrate
plot from before (<a data-type="xref" href="#fig0472">Figure 4-72</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">8</code><code class="p">]:</code>
<code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">12</code><code class="p">,</code> <code class="mi">4</code><code class="p">))</code>
<code class="n">births_by_date</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">ax</code><code class="o">=</code><code class="n">ax</code><code class="p">)</code>

<code class="c1"># Add labels to the plot</code>
<code class="n">ax</code><code class="o">.</code><code class="n">annotate</code><code class="p">(</code><code class="s2">"New Year's Day"</code><code class="p">,</code> <code class="n">xy</code><code class="o">=</code><code class="p">(</code><code class="s1">'2012-1-1'</code><code class="p">,</code> <code class="mi">4100</code><code class="p">),</code>  <code class="n">xycoords</code><code class="o">=</code><code class="s1">'data'</code><code class="p">,</code>
            <code class="n">xytext</code><code class="o">=</code><code class="p">(</code><code class="mi">50</code><code class="p">,</code> <code class="o">-</code><code class="mi">30</code><code class="p">),</code> <code class="n">textcoords</code><code class="o">=</code><code class="s1">'offset points'</code><code class="p">,</code>
            <code class="n">arrowprops</code><code class="o">=</code><code class="nb">dict</code><code class="p">(</code><code class="n">arrowstyle</code><code class="o">=</code><code class="s2">"-&gt;"</code><code class="p">,</code>
                            <code class="n">connectionstyle</code><code class="o">=</code><code class="s2">"arc3,rad=-0.2"</code><code class="p">))</code>


<code class="n">ax</code><code class="o">.</code><code class="n">annotate</code><code class="p">(</code><code class="s2">"Independence Day"</code><code class="p">,</code> <code class="n">xy</code><code class="o">=</code><code class="p">(</code><code class="s1">'2012-7-4'</code><code class="p">,</code> <code class="mi">4250</code><code class="p">),</code>  <code class="n">xycoords</code><code class="o">=</code><code class="s1">'data'</code><code class="p">,</code>
            <code class="n">bbox</code><code class="o">=</code><code class="nb">dict</code><code class="p">(</code><code class="n">boxstyle</code><code class="o">=</code><code class="s2">"round"</code><code class="p">,</code> <code class="n">fc</code><code class="o">=</code><code class="s2">"none"</code><code class="p">,</code> <code class="n">ec</code><code class="o">=</code><code class="s2">"gray"</code><code class="p">),</code>
            <code class="n">xytext</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code> <code class="o">-</code><code class="mi">40</code><code class="p">),</code> <code class="n">textcoords</code><code class="o">=</code><code class="s1">'offset points'</code><code class="p">,</code> <code class="n">ha</code><code class="o">=</code><code class="s1">'center'</code><code class="p">,</code>
            <code class="n">arrowprops</code><code class="o">=</code><code class="nb">dict</code><code class="p">(</code><code class="n">arrowstyle</code><code class="o">=</code><code class="s2">"-&gt;"</code><code class="p">))</code>

<code class="n">ax</code><code class="o">.</code><code class="n">annotate</code><code class="p">(</code><code class="s1">'Labor Day'</code><code class="p">,</code> <code class="n">xy</code><code class="o">=</code><code class="p">(</code><code class="s1">'2012-9-4'</code><code class="p">,</code> <code class="mi">4850</code><code class="p">),</code> <code class="n">xycoords</code><code class="o">=</code><code class="s1">'data'</code><code class="p">,</code> <code class="n">ha</code><code class="o">=</code><code class="s1">'center'</code><code class="p">,</code>
            <code class="n">xytext</code><code class="o">=</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="o">-</code><code class="mi">20</code><code class="p">),</code> <code class="n">textcoords</code><code class="o">=</code><code class="s1">'offset points'</code><code class="p">)</code>
<code class="n">ax</code><code class="o">.</code><code class="n">annotate</code><code class="p">(</code><code class="s1">''</code><code class="p">,</code> <code class="n">xy</code><code class="o">=</code><code class="p">(</code><code class="s1">'2012-9-1'</code><code class="p">,</code> <code class="mi">4850</code><code class="p">),</code> <code class="n">xytext</code><code class="o">=</code><code class="p">(</code><code class="s1">'2012-9-7'</code><code class="p">,</code> <code class="mi">4850</code><code class="p">),</code>
            <code class="n">xycoords</code><code class="o">=</code><code class="s1">'data'</code><code class="p">,</code> <code class="n">textcoords</code><code class="o">=</code><code class="s1">'data'</code><code class="p">,</code>
            <code class="n">arrowprops</code><code class="o">=</code><code class="p">{</code><code class="s1">'arrowstyle'</code><code class="p">:</code> <code class="s1">'|-|,widthA=0.2,widthB=0.2'</code><code class="p">,</code> <code class="p">})</code>

<code class="n">ax</code><code class="o">.</code><code class="n">annotate</code><code class="p">(</code><code class="s1">'Halloween'</code><code class="p">,</code> <code class="n">xy</code><code class="o">=</code><code class="p">(</code><code class="s1">'2012-10-31'</code><code class="p">,</code> <code class="mi">4600</code><code class="p">),</code>  <code class="n">xycoords</code><code class="o">=</code><code class="s1">'data'</code><code class="p">,</code>
            <code class="n">xytext</code><code class="o">=</code><code class="p">(</code><code class="o">-</code><code class="mi">80</code><code class="p">,</code> <code class="o">-</code><code class="mi">40</code><code class="p">),</code> <code class="n">textcoords</code><code class="o">=</code><code class="s1">'offset points'</code><code class="p">,</code>
            <code class="n">arrowprops</code><code class="o">=</code><code class="nb">dict</code><code class="p">(</code><code class="n">arrowstyle</code><code class="o">=</code><code class="s2">"fancy"</code><code class="p">,</code>
                            <code class="n">fc</code><code class="o">=</code><code class="s2">"0.6"</code><code class="p">,</code> <code class="n">ec</code><code class="o">=</code><code class="s2">"none"</code><code class="p">,</code>
                            <code class="n">connectionstyle</code><code class="o">=</code><code class="s2">"angle3,angleA=0,angleB=-90"</code><code class="p">))</code>

<code class="n">ax</code><code class="o">.</code><code class="n">annotate</code><code class="p">(</code><code class="s1">'Thanksgiving'</code><code class="p">,</code> <code class="n">xy</code><code class="o">=</code><code class="p">(</code><code class="s1">'2012-11-25'</code><code class="p">,</code> <code class="mi">4500</code><code class="p">),</code>  <code class="n">xycoords</code><code class="o">=</code><code class="s1">'data'</code><code class="p">,</code>
            <code class="n">xytext</code><code class="o">=</code><code class="p">(</code><code class="o">-</code><code class="mi">120</code><code class="p">,</code> <code class="o">-</code><code class="mi">60</code><code class="p">),</code> <code class="n">textcoords</code><code class="o">=</code><code class="s1">'offset points'</code><code class="p">,</code>
            <code class="n">bbox</code><code class="o">=</code><code class="nb">dict</code><code class="p">(</code><code class="n">boxstyle</code><code class="o">=</code><code class="s2">"round4,pad=.5"</code><code class="p">,</code> <code class="n">fc</code><code class="o">=</code><code class="s2">"0.9"</code><code class="p">),</code>
            <code class="n">arrowprops</code><code class="o">=</code><code class="nb">dict</code><code class="p">(</code><code class="n">arrowstyle</code><code class="o">=</code><code class="s2">"-&gt;"</code><code class="p">,</code>
                            <code class="n">connectionstyle</code><code class="o">=</code><code class="s2">"angle,angleA=0,angleB=80,rad=20"</code><code class="p">))</code>


<code class="n">ax</code><code class="o">.</code><code class="n">annotate</code><code class="p">(</code><code class="s1">'Christmas'</code><code class="p">,</code> <code class="n">xy</code><code class="o">=</code><code class="p">(</code><code class="s1">'2012-12-25'</code><code class="p">,</code> <code class="mi">3850</code><code class="p">),</code>  <code class="n">xycoords</code><code class="o">=</code><code class="s1">'data'</code><code class="p">,</code>
             <code class="n">xytext</code><code class="o">=</code><code class="p">(</code><code class="o">-</code><code class="mi">30</code><code class="p">,</code> <code class="mi">0</code><code class="p">),</code> <code class="n">textcoords</code><code class="o">=</code><code class="s1">'offset points'</code><code class="p">,</code>
             <code class="n">size</code><code class="o">=</code><code class="mi">13</code><code class="p">,</code> <code class="n">ha</code><code class="o">=</code><code class="s1">'right'</code><code class="p">,</code> <code class="n">va</code><code class="o">=</code><code class="s2">"center"</code><code class="p">,</code>
             <code class="n">bbox</code><code class="o">=</code><code class="nb">dict</code><code class="p">(</code><code class="n">boxstyle</code><code class="o">=</code><code class="s2">"round"</code><code class="p">,</code> <code class="n">alpha</code><code class="o">=</code><code class="mf">0.1</code><code class="p">),</code>
             <code class="n">arrowprops</code><code class="o">=</code><code class="nb">dict</code><code class="p">(</code><code class="n">arrowstyle</code><code class="o">=</code><code class="s2">"wedge,tail_width=0.5"</code><code class="p">,</code> <code class="n">alpha</code><code class="o">=</code><code class="mf">0.1</code><code class="p">));</code>

<code class="c1"># Label the axes</code>
<code class="n">ax</code><code class="o">.</code><code class="n">set</code><code class="p">(</code><code class="n">title</code><code class="o">=</code><code class="s1">'USA births by day of year (1969-1988)'</code><code class="p">,</code>
       <code class="n">ylabel</code><code class="o">=</code><code class="s1">'average daily births'</code><code class="p">)</code>

<code class="c1"># Format the x axis with centered month labels</code>
<code class="n">ax</code><code class="o">.</code><code class="n">xaxis</code><code class="o">.</code><code class="n">set_major_locator</code><code class="p">(</code><code class="n">mpl</code><code class="o">.</code><code class="n">dates</code><code class="o">.</code><code class="n">MonthLocator</code><code class="p">())</code>
<code class="n">ax</code><code class="o">.</code><code class="n">xaxis</code><code class="o">.</code><code class="n">set_minor_locator</code><code class="p">(</code><code class="n">mpl</code><code class="o">.</code><code class="n">dates</code><code class="o">.</code><code class="n">MonthLocator</code><code class="p">(</code><code class="n">bymonthday</code><code class="o">=</code><code class="mi">15</code><code class="p">))</code>
<code class="n">ax</code><code class="o">.</code><code class="n">xaxis</code><code class="o">.</code><code class="n">set_major_formatter</code><code class="p">(</code><code class="n">plt</code><code class="o">.</code><code class="n">NullFormatter</code><code class="p">())</code>
<code class="n">ax</code><code class="o">.</code><code class="n">xaxis</code><code class="o">.</code><code class="n">set_minor_formatter</code><code class="p">(</code><code class="n">mpl</code><code class="o">.</code><code class="n">dates</code><code class="o">.</code><code class="n">DateFormatter</code><code class="p">(</code><code class="s1">'%h'</code><code class="p">));</code>

<code class="n">ax</code><code class="o">.</code><code class="n">set_ylim</code><code class="p">(</code><code class="mi">3600</code><code class="p">,</code> <code class="mi">5400</code><code class="p">);</code></pre>

<figure><div id="fig0472" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in72.png" alt="png" width="724" height="263">
<h6><span class="label">Figure 4-72. </span>Annotated average birth rates by day</h6>
</div></figure>

<p>You’ll notice that the specifications of the arrows and text boxes are
very detailed: this gives you the power to create nearly any arrow style
you wish. Unfortunately, it also means that these sorts of features
often must be manually tweaked, a process that can be very
time-consuming when one is producing publication-quality graphics! Finally,
I’ll note that the preceding mix of styles is by no means best practice for
presenting data, but rather included as a demonstration of some of the
available options.</p>

<p>More discussion and examples of available arrow and annotation styles
can be found in the Matplotlib gallery<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc77" id="idm45026298947976"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc76" id="idm45026298947304"></a>, in particular
<a href="http://matplotlib.org/examples/pylab_examples/annotation_demo2.html"><em class="hyperlink">http://matplotlib.org/examples/pylab_examples/annotation_demo2.html</em></a>.<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc71" id="idm45026298360584"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc70" id="idm45026298359944"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc69" id="idm45026298359224"></a></p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Customizing Ticks"><div class="sect1" id="customizing-ticks">
<h1>Customizing Ticks</h1>

<p><a data-type="indexterm" data-primary="Matplotlib" data-secondary="tick customization" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc78"></a><a data-type="indexterm" data-primary="plotting" data-secondary="ticks" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc79"></a><a data-type="indexterm" data-primary="ticks (tick marks)" data-secondary="customizing" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc80"></a>Matplotlib’s default tick locators and formatters are designed to be
generally sufficient in many common situations, but are in no way
optimal for every plot. This section will give several examples of
adjusting the tick locations and formatting for the particular plot type
you’re interested in.</p>

<p>Before we go into examples, it will be best for us to understand further
the object hierarchy of <a data-type="indexterm" data-primary="Matplotlib" data-secondary="object hierarchy of plots" id="idm45026298351976"></a>Matplotlib plots. Matplotlib aims to have a
Python object representing everything that appears on the plot: for
example, recall that the <code>figure</code> is the bounding box within which plot
elements appear. Each Matplotlib object can also act as a container of
sub-objects; for example, each <code>figure</code> can contain one or more <code>axes</code>
objects, each of which in turn contain other objects representing plot
contents.</p>

<p>The tick marks are no exception. Each <code>axes</code> has attributes <code>xaxis</code> and
<code>yaxis</code>, which in turn have attributes that contain all the properties
of the lines, ticks, and labels that make up the axes.</p>








<section data-type="sect2" data-pdf-bookmark="Major and Minor Ticks"><div class="sect2" id="major-and-minor-ticks">
<h2>Major and Minor Ticks</h2>

<p><a data-type="indexterm" data-primary="ticks (tick marks)" data-secondary="major and minor" id="idm45026298345416"></a>Within each axis, there is the concept of a <em>major</em> tick mark and a
<em>minor</em> tick mark. As the names would imply, major ticks are usually
bigger or more pronounced, while minor ticks are usually smaller. By
default, Matplotlib rarely makes use of minor ticks, but one place you
can see them is within logarithmic plots (<a data-type="xref" href="#fig0473">Figure 4-73</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">1</code><code class="p">]:</code> <code class="o">%</code><code class="n">matplotlib</code> <code class="n">inline</code>
       <code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="kn">as</code> <code class="nn">plt</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">use</code><code class="p">(</code><code class="s1">'seaborn-whitegrid'</code><code class="p">)</code>
       <code class="kn">import</code> <code class="nn">numpy</code> <code class="kn">as</code> <code class="nn">np</code></pre>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">2</code><code class="p">]:</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">axes</code><code class="p">(</code><code class="n">xscale</code><code class="o">=</code><code class="s1">'log'</code><code class="p">,</code> <code class="n">yscale</code><code class="o">=</code><code class="s1">'log'</code><code class="p">)</code></pre>

<figure><div id="fig0473" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in73.png" alt="png" width="385" height="263">
<h6><span class="label">Figure 4-73. </span>Example of logarithmic scales and labels</h6>
</div></figure>

<p>We see here that each major tick shows a large tick mark and a label,
while each minor tick shows a smaller tick mark with no label.</p>

<p>We can customize these tick properties—that is, locations and labels—by
setting the <code>formatter</code> and <code>locator</code> objects of each axis. Let’s
examine these for the x axis of the plot just shown:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">3</code><code class="p">]:</code> <code class="k">print</code><code class="p">(</code><code class="n">ax</code><code class="o">.</code><code class="n">xaxis</code><code class="o">.</code><code class="n">get_major_locator</code><code class="p">())</code>
       <code class="k">print</code><code class="p">(</code><code class="n">ax</code><code class="o">.</code><code class="n">xaxis</code><code class="o">.</code><code class="n">get_minor_locator</code><code class="p">())</code></pre>

<pre data-type="programlisting">&lt;matplotlib.ticker.LogLocator object at 0x107530cc0&gt;
&lt;matplotlib.ticker.LogLocator object at 0x107530198&gt;</pre>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">4</code><code class="p">]:</code> <code class="k">print</code><code class="p">(</code><code class="n">ax</code><code class="o">.</code><code class="n">xaxis</code><code class="o">.</code><code class="n">get_major_formatter</code><code class="p">())</code>
       <code class="k">print</code><code class="p">(</code><code class="n">ax</code><code class="o">.</code><code class="n">xaxis</code><code class="o">.</code><code class="n">get_minor_formatter</code><code class="p">())</code></pre>

<pre data-type="programlisting">&lt;matplotlib.ticker.LogFormatterMathtext object at 0x107512780&gt;
&lt;matplotlib.ticker.NullFormatter object at 0x10752dc18&gt;</pre>

<p>We see that both major and minor tick labels have their locations
specified by a <span class="keep-together"><code>LogLocator</code></span> (which makes sense for a logarithmic plot).
Minor ticks, though, have their labels formatted by a <code>NullFormatter</code>;
this says that no labels will be shown.</p>

<p>We’ll now show a few examples of setting these locators and formatters
for various plots.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Hiding Ticks or Labels"><div class="sect2" id="hiding-ticks-or-labels">
<h2>Hiding Ticks or Labels</h2>

<p>Perhaps the most common tick/label formatting operation is the act of
hiding ticks or labels. We can do this using <code>plt.NullLocator()</code> and
<code>plt.NullFormatter()</code>, as shown here (<a data-type="xref" href="#fig0474">Figure 4-74</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">5</code><code class="p">]:</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">axes</code><code class="p">()</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">rand</code><code class="p">(</code><code class="mi">50</code><code class="p">))</code>

       <code class="n">ax</code><code class="o">.</code><code class="n">yaxis</code><code class="o">.</code><code class="n">set_major_locator</code><code class="p">(</code><code class="n">plt</code><code class="o">.</code><code class="n">NullLocator</code><code class="p">())</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">xaxis</code><code class="o">.</code><code class="n">set_major_formatter</code><code class="p">(</code><code class="n">plt</code><code class="o">.</code><code class="n">NullFormatter</code><code class="p">())</code></pre>

<figure><div id="fig0474" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in74.png" alt="png" width="349" height="237">
<h6><span class="label">Figure 4-74. </span>Plot with hidden tick labels (x-axis) and hidden ticks (y-axis)</h6>
</div></figure>

<p>Notice that we’ve removed the labels (but kept the ticks/gridlines) from
the x axis, and removed the ticks (and thus the labels as well) from the
y axis. Having no ticks at all can be useful in many situations—for
example, when you want to show a grid of images. For instance, consider <a data-type="xref" href="#fig0475">Figure 4-75</a>, which includes images of different faces, an example often used in supervised machine learning problems (for more information, see <a data-type="xref" href="ch05.html#in-depth-support-vector-machines">“In-Depth: Support Vector Machines”</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">6</code><code class="p">]:</code> <code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">(</code><code class="mi">5</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">5</code><code class="p">,</code> <code class="mi">5</code><code class="p">))</code>
       <code class="n">fig</code><code class="o">.</code><code class="n">subplots_adjust</code><code class="p">(</code><code class="n">hspace</code><code class="o">=</code><code class="mi">0</code><code class="p">,</code> <code class="n">wspace</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code>

       <code class="c1"># Get some face data from scikit-learn</code>
       <code class="kn">from</code> <code class="nn">sklearn.datasets</code> <code class="kn">import</code> <code class="n">fetch_olivetti_faces</code>
       <code class="n">faces</code> <code class="o">=</code> <code class="n">fetch_olivetti_faces</code><code class="p">()</code><code class="o">.</code><code class="n">images</code>

       <code class="k">for</code> <code class="n">i</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="mi">5</code><code class="p">):</code>
           <code class="k">for</code> <code class="n">j</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="mi">5</code><code class="p">):</code>
               <code class="n">ax</code><code class="p">[</code><code class="n">i</code><code class="p">,</code> <code class="n">j</code><code class="p">]</code><code class="o">.</code><code class="n">xaxis</code><code class="o">.</code><code class="n">set_major_locator</code><code class="p">(</code><code class="n">plt</code><code class="o">.</code><code class="n">NullLocator</code><code class="p">())</code>
               <code class="n">ax</code><code class="p">[</code><code class="n">i</code><code class="p">,</code> <code class="n">j</code><code class="p">]</code><code class="o">.</code><code class="n">yaxis</code><code class="o">.</code><code class="n">set_major_locator</code><code class="p">(</code><code class="n">plt</code><code class="o">.</code><code class="n">NullLocator</code><code class="p">())</code>
               <code class="n">ax</code><code class="p">[</code><code class="n">i</code><code class="p">,</code> <code class="n">j</code><code class="p">]</code><code class="o">.</code><code class="n">imshow</code><code class="p">(</code><code class="n">faces</code><code class="p">[</code><code class="mi">10</code> <code class="o">*</code> <code class="n">i</code> <code class="o">+</code> <code class="n">j</code><code class="p">],</code> <code class="n">cmap</code><code class="o">=</code><code class="s2">"bone"</code><code class="p">)</code></pre>

<figure><div id="fig0475" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in75.png" alt="png" width="293" height="293">
<h6><span class="label">Figure 4-75. </span>Hiding ticks within image plots</h6>
</div></figure>

<p>Notice that each image has its own axes, and we’ve set the locators to
null because the tick values (pixel number in this case) do not convey
relevant information for this particular visualization.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Reducing or Increasing the Number of Ticks"><div class="sect2" id="reducing-or-increasing-the-number-of-ticks">
<h2>Reducing or Increasing the Number of Ticks</h2>

<p><a data-type="indexterm" data-primary="ticks (tick marks)" data-secondary="reducing/increasing number of" id="idm45026297946392"></a>One common problem with the default settings is that smaller subplots can
end up with crowded labels. We can see this in the plot grid shown in <a data-type="xref" href="#fig0476">Figure 4-76</a>:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">7</code><code class="p">]:</code> <code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">(</code><code class="mi">4</code><code class="p">,</code> <code class="mi">4</code><code class="p">,</code> <code class="n">sharex</code><code class="o">=</code><code class="bp">True</code><code class="p">,</code> <code class="n">sharey</code><code class="o">=</code><code class="bp">True</code><code class="p">)</code></pre>

<figure><div id="fig0476" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in76.png" alt="png" width="374" height="255">
<h6><span class="label">Figure 4-76. </span>A default plot with crowded ticks</h6>
</div></figure>

<p>Particularly for the x ticks, the numbers nearly overlap, making them
quite difficult to decipher. We can fix this with the
<code>plt.MaxNLocator()</code>, which allows us to specify the maximum number of
ticks that will be displayed. Given this maximum number, Matplotlib
will use internal logic to choose the particular tick locations (<a data-type="xref" href="#fig0477">Figure 4-77</a>):</p>

<pre data-type="programlisting" data-code-language="python" class="pagebreak-before"><code class="n">In</code><code class="p">[</code><code class="mi">8</code><code class="p">]:</code> <code class="c1"># For every axis, set the x and y major locator</code>
       <code class="k">for</code> <code class="n">axi</code> <code class="ow">in</code> <code class="n">ax</code><code class="o">.</code><code class="n">flat</code><code class="p">:</code>
           <code class="n">axi</code><code class="o">.</code><code class="n">xaxis</code><code class="o">.</code><code class="n">set_major_locator</code><code class="p">(</code><code class="n">plt</code><code class="o">.</code><code class="n">MaxNLocator</code><code class="p">(</code><code class="mi">3</code><code class="p">))</code>
           <code class="n">axi</code><code class="o">.</code><code class="n">yaxis</code><code class="o">.</code><code class="n">set_major_locator</code><code class="p">(</code><code class="n">plt</code><code class="o">.</code><code class="n">MaxNLocator</code><code class="p">(</code><code class="mi">3</code><code class="p">))</code>
       <code class="n">fig</code></pre>

<figure><div id="fig0477" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in77.png" alt="png" width="367" height="250">
<h6><span class="label">Figure 4-77. </span>Customizing the number of ticks</h6>
</div></figure>

<p>This makes things much cleaner. If you want even more control over the
locations of regularly spaced ticks, you might also use
<code>plt.MultipleLocator</code>, which we’ll discuss in the following section.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Fancy Tick Formats"><div class="sect2" id="fancy-tick-formats">
<h2>Fancy Tick Formats</h2>

<p><a data-type="indexterm" data-primary="ticks (tick marks)" data-secondary="fancy formats" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc81"></a>Matplotlib’s default tick formatting can leave a lot to be desired; it
works well as a broad default, but sometimes you’d like to do something
more. Consider the plot shown in <a data-type="xref" href="#fig0478">Figure 4-78</a>, a sine and a cosine:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">9</code><code class="p">]:</code> <code class="c1"># Plot a sine and cosine curve</code>
       <code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">()</code>
       <code class="n">x</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">3</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">pi</code><code class="p">,</code> <code class="mi">1000</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">),</code> <code class="n">lw</code><code class="o">=</code><code class="mi">3</code><code class="p">,</code> <code class="n">label</code><code class="o">=</code><code class="s1">'Sine'</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">cos</code><code class="p">(</code><code class="n">x</code><code class="p">),</code> <code class="n">lw</code><code class="o">=</code><code class="mi">3</code><code class="p">,</code> <code class="n">label</code><code class="o">=</code><code class="s1">'Cosine'</code><code class="p">)</code>

       <code class="c1"># Set up grid, legend, and limits</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">grid</code><code class="p">(</code><code class="bp">True</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="n">frameon</code><code class="o">=</code><code class="bp">False</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">axis</code><code class="p">(</code><code class="s1">'equal'</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">set_xlim</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">3</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">pi</code><code class="p">);</code></pre>

<figure><div id="fig0478" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in78.png" alt="png" width="364" height="250">
<h6><span class="label">Figure 4-78. </span>A default plot with integer ticks</h6>
</div></figure>

<p>There are a couple changes we might like to make. First, it’s more
natural for this data to space the ticks and grid lines in multiples of
<math xmlns="http://www.w3.org/1998/Math/MathML" alttext="pi">
  <mi>π</mi>
</math>. We can do this by setting a <code>MultipleLocator</code>, which
locates ticks at a multiple of the number you provide. For good measure,
we’ll add both major and minor ticks in multiples of
<math xmlns="http://www.w3.org/1998/Math/MathML" alttext="pi slash 4">
  <mrow>
    <mi>π</mi>
    <mo>/</mo>
    <mn>4</mn>
  </mrow>
</math> (<a data-type="xref" href="#fig0479">Figure 4-79</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">10</code><code class="p">]:</code> <code class="n">ax</code><code class="o">.</code><code class="n">xaxis</code><code class="o">.</code><code class="n">set_major_locator</code><code class="p">(</code><code class="n">plt</code><code class="o">.</code><code class="n">MultipleLocator</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">pi</code> <code class="o">/</code> <code class="mi">2</code><code class="p">))</code>
        <code class="n">ax</code><code class="o">.</code><code class="n">xaxis</code><code class="o">.</code><code class="n">set_minor_locator</code><code class="p">(</code><code class="n">plt</code><code class="o">.</code><code class="n">MultipleLocator</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">pi</code> <code class="o">/</code> <code class="mi">4</code><code class="p">))</code>
        <code class="n">fig</code></pre>

<figure><div id="fig0479" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in79.png" alt="png" width="374" height="250">
<h6><span class="label">Figure 4-79. </span>Ticks at multiples of pi/2</h6>
</div></figure>

<p>But now these tick labels look a little bit silly: we can see that they
are multiples of <math xmlns="http://www.w3.org/1998/Math/MathML" alttext="pi">
  <mi>π</mi>
</math>, but the decimal representation does
not immediately convey this. To fix this, we can change the tick
formatter. There’s no built-in formatter for what we want to do, so
we’ll instead use <code>plt.FuncFormatter</code>, which accepts a user-defined
function giving fine-grained control over the tick outputs (<a data-type="xref" href="#fig0480">Figure 4-80</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">11</code><code class="p">]:</code> <code class="k">def</code> <code class="nf">format_func</code><code class="p">(</code><code class="n">value</code><code class="p">,</code> <code class="n">tick_number</code><code class="p">):</code>
            <code class="c1"># find number of multiples of pi/2</code>
            <code class="n">N</code> <code class="o">=</code> <code class="nb">int</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">round</code><code class="p">(</code><code class="mi">2</code> <code class="o">*</code> <code class="n">value</code> <code class="o">/</code> <code class="n">np</code><code class="o">.</code><code class="n">pi</code><code class="p">))</code>
            <code class="k">if</code> <code class="n">N</code> <code class="o">==</code> <code class="mi">0</code><code class="p">:</code>
                <code class="k">return</code> <code class="s2">"0"</code>
            <code class="k">elif</code> <code class="n">N</code> <code class="o">==</code> <code class="mi">1</code><code class="p">:</code>
                <code class="k">return</code> <code class="s-Affix">r</code><code class="s2">"$\pi/2$"</code>
            <code class="k">elif</code> <code class="n">N</code> <code class="o">==</code> <code class="mi">2</code><code class="p">:</code>
                <code class="k">return</code> <code class="s-Affix">r</code><code class="s2">"$\pi$"</code>
            <code class="k">elif</code> <code class="n">N</code> <code class="o">%</code> <code class="mi">2</code> <code class="o">&gt;</code> <code class="mi">0</code><code class="p">:</code>
                <code class="k">return</code> <code class="s-Affix">r</code><code class="s2">"${0}\pi/2$"</code><code class="o">.</code><code class="n">format</code><code class="p">(</code><code class="n">N</code><code class="p">)</code>
            <code class="k">else</code><code class="p">:</code>
                <code class="k">return</code> <code class="s-Affix">r</code><code class="s2">"${0}\pi$"</code><code class="o">.</code><code class="n">format</code><code class="p">(</code><code class="n">N</code> <code class="o">//</code> <code class="mi">2</code><code class="p">)</code>

        <code class="n">ax</code><code class="o">.</code><code class="n">xaxis</code><code class="o">.</code><code class="n">set_major_formatter</code><code class="p">(</code><code class="n">plt</code><code class="o">.</code><code class="n">FuncFormatter</code><code class="p">(</code><code class="n">format_func</code><code class="p">))</code>
        <code class="n">fig</code></pre>

<figure><div id="fig0480" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in80.png" alt="png" width="371" height="257">
<h6><span class="label">Figure 4-80. </span>Ticks with custom labels</h6>
</div></figure>

<p>This is much better! Notice that we’ve made use of Matplotlib’s
LaTeX support, specified by enclosing the string within dollar signs.
This is very convenient for display of mathematical symbols and
formulae; in this case, <code>"$\pi$"</code> is rendered as the Greek character
<math xmlns="http://www.w3.org/1998/Math/MathML" alttext="pi">
  <mi>π</mi>
</math>.</p>

<p>The <code>plt.FuncFormatter()</code> offers extremely fine-grained control over the
appearance of your plot ticks, and comes in very handy when you’re preparing
plots for presentation or publication.<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc81" id="idm45026297432872"></a></p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Summary of Formatters and Locators"><div class="sect2" id="summary-of-formatters-and-locators">
<h2>Summary of Formatters and Locators</h2>

<p><a data-type="indexterm" data-primary="ticks (tick marks)" data-secondary="formatter/locator options" id="idm45026297430536"></a>We’ve mentioned a couple of the available formatters and locators. We’ll
conclude this section by briefly listing all the built-in locator and formatter
options. For more information on any of these, refer to the docstrings
or to the Matplotlib online documentation. Each of the following is
available in the <code>plt</code> namespace:</p>
<table>

<thead>
<tr>
<th>Locator class</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><p><code>NullLocator</code></p></td>
<td><p>No ticks</p></td>
</tr>
<tr>
<td><p><code>FixedLocator</code></p></td>
<td><p>Tick locations are fixed</p></td>
</tr>
<tr>
<td><p><code>IndexLocator</code></p></td>
<td><p>Locator for index plots (e.g., where <code>x = range(len(y)))</code></p></td>
</tr>
<tr>
<td><p><code>LinearLocator</code></p></td>
<td><p>Evenly spaced ticks from <code>min</code> to <code>max</code></p></td>
</tr>
<tr>
<td><p><code>LogLocator</code></p></td>
<td><p>Logarithmically ticks from <code>min</code> to <code>max</code></p></td>
</tr>
<tr>
<td><p><code>MultipleLocator</code></p></td>
<td><p>Ticks and range are a multiple of base</p></td>
</tr>
<tr>
<td><p><code>MaxNLocator</code></p></td>
<td><p>Finds up to a max number of ticks at nice locations</p></td>
</tr>
<tr>
<td><p><code>AutoLocator</code></p></td>
<td><p>(Default) <code>MaxNLocator</code> with simple defaults</p></td>
</tr>
<tr>
<td><p><code>AutoMinorLocator</code></p></td>
<td><p>Locator for minor ticks</p></td>
</tr>
</tbody>
</table>
<table>

<thead>
<tr>
<th>Formatter class</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><p><code>NullFormatter</code></p></td>
<td><p>No labels on the ticks</p></td>
</tr>
<tr>
<td><p><code>IndexFormatter</code></p></td>
<td><p>Set the strings from a list of labels</p></td>
</tr>
<tr>
<td><p><code>FixedFormatter</code></p></td>
<td><p>Set the strings manually for the labels</p></td>
</tr>
<tr>
<td><p><code>FuncFormatter</code></p></td>
<td><p>User-defined function sets the labels</p></td>
</tr>
<tr>
<td><p><code>FormatStrFormatter</code></p></td>
<td><p>Use a format string for each value</p></td>
</tr>
<tr>
<td><p><code>ScalarFormatter</code></p></td>
<td><p>(Default) Formatter for scalar values</p></td>
</tr>
<tr>
<td><p><code>LogFormatter</code></p></td>
<td><p>Default formatter for log axes</p></td>
</tr>
</tbody>
</table>

<p>We’ll see additional examples of these throughout the remainder of the book.<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc80" id="idm45026297392824"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc79" id="idm45026297392152"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc78" id="idm45026297391512"></a></p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Customizing Matplotlib: Configurations and Stylesheets"><div class="sect1" id="customizing-matplotlib-configurations-and-style-sheets">
<h1>Customizing Matplotlib: Configurations and Stylesheets</h1>

<p><a data-type="indexterm" data-primary="Matplotlib" data-secondary="configurations and stylesheets" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc82"></a>Matplotlib’s default plot settings are often the subject of complaint
among its users. While much is slated to change in the 2.0 Matplotlib
release, the ability to customize default settings helps
bring the package in line with your own aesthetic preferences.</p>

<p>Here we’ll walk through some of Matplotlib’s runtime configuration (<code>rc</code>)
options, and take a look at the newer <em>stylesheets</em> feature, which
contains some nice sets of default configurations.</p>








<section data-type="sect2" data-pdf-bookmark="Plot Customization by Hand"><div class="sect2" id="plot-customization-by-hand">
<h2>Plot Customization by Hand</h2>

<p><a data-type="indexterm" data-primary="histograms" data-secondary="manual customization" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc83"></a><a data-type="indexterm" data-primary="Matplotlib" data-secondary="plot customization" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc84"></a><a data-type="indexterm" data-primary="plotting" data-secondary="manual customization" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc85"></a>Throughout this chapter, we’ve seen how it is possible to
tweak individual plot settings to end up with something that looks a little
bit nicer than the default. It’s possible to do these customizations for
each individual plot. For example, here is a fairly drab default
histogram (<a data-type="xref" href="#fig0481">Figure 4-81</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">1</code><code class="p">]:</code> <code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="kn">as</code> <code class="nn">plt</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">use</code><code class="p">(</code><code class="s1">'classic'</code><code class="p">)</code>
       <code class="kn">import</code> <code class="nn">numpy</code> <code class="kn">as</code> <code class="nn">np</code>

       <code class="o">%</code><code class="n">matplotlib</code> <code class="n">inline</code></pre>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">2</code><code class="p">]:</code> <code class="n">x</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">randn</code><code class="p">(</code><code class="mi">1000</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">hist</code><code class="p">(</code><code class="n">x</code><code class="p">);</code></pre>

<figure><div id="fig0481" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in81.png" alt="png" width="375" height="256">
<h6><span class="label">Figure 4-81. </span>A histogram in Matplotlib’s default style</h6>
</div></figure>

<p>We can adjust this by hand to make it a much more visually pleasing
plot, shown in <a data-type="xref" href="#fig0482">Figure 4-82</a>:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">3</code><code class="p">]:</code> <code class="c1"># use a gray background</code>
       <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">axes</code><code class="p">(</code><code class="n">axisbg</code><code class="o">=</code><code class="s1">'#E6E6E6'</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">set_axisbelow</code><code class="p">(</code><code class="bp">True</code><code class="p">)</code>

       <code class="c1"># draw solid white grid lines</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">grid</code><code class="p">(</code><code class="n">color</code><code class="o">=</code><code class="s1">'w'</code><code class="p">,</code> <code class="n">linestyle</code><code class="o">=</code><code class="s1">'solid'</code><code class="p">)</code>

       <code class="c1"># hide axis spines</code>
       <code class="k">for</code> <code class="n">spine</code> <code class="ow">in</code> <code class="n">ax</code><code class="o">.</code><code class="n">spines</code><code class="o">.</code><code class="n">values</code><code class="p">():</code>
           <code class="n">spine</code><code class="o">.</code><code class="n">set_visible</code><code class="p">(</code><code class="bp">False</code><code class="p">)</code>

       <code class="c1"># hide top and right ticks</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">xaxis</code><code class="o">.</code><code class="n">tick_bottom</code><code class="p">()</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">yaxis</code><code class="o">.</code><code class="n">tick_left</code><code class="p">()</code>

       <code class="c1"># lighten ticks and labels</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">tick_params</code><code class="p">(</code><code class="n">colors</code><code class="o">=</code><code class="s1">'gray'</code><code class="p">,</code> <code class="n">direction</code><code class="o">=</code><code class="s1">'out'</code><code class="p">)</code>
       <code class="k">for</code> <code class="n">tick</code> <code class="ow">in</code> <code class="n">ax</code><code class="o">.</code><code class="n">get_xticklabels</code><code class="p">():</code>
           <code class="n">tick</code><code class="o">.</code><code class="n">set_color</code><code class="p">(</code><code class="s1">'gray'</code><code class="p">)</code>
       <code class="k">for</code> <code class="n">tick</code> <code class="ow">in</code> <code class="n">ax</code><code class="o">.</code><code class="n">get_yticklabels</code><code class="p">():</code>
           <code class="n">tick</code><code class="o">.</code><code class="n">set_color</code><code class="p">(</code><code class="s1">'gray'</code><code class="p">)</code>

       <code class="c1"># control face and edge color of histogram</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">hist</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">edgecolor</code><code class="o">=</code><code class="s1">'#E6E6E6'</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s1">'#EE6666'</code><code class="p">);</code></pre>

<figure><div id="fig0482" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in82.png" alt="png" width="379" height="260">
<h6><span class="label">Figure 4-82. </span>A histogram with manual customizations</h6>
</div></figure>

<p>This looks better, and you may recognize the look as inspired by the
look of the R language’s <code>ggplot</code> visualization package. But this took a
whole lot of effort! We definitely do not want to have to do all that
tweaking each time we create a plot. Fortunately, there is a way to
adjust these defaults once in a way that will work for all plots.<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc85" id="idm45026297150328"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc84" id="idm45026297149656"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc83" id="idm45026297149016"></a></p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Changing the Defaults: rcParams"><div class="sect2" id="changing-the-defaults-rcparams">
<h2>Changing the Defaults: rcParams</h2>

<p><a data-type="indexterm" data-primary="Matplotlib" data-secondary="changing defaults via rcParams" id="idm45026297146504"></a><a data-type="indexterm" data-primary="plotting" data-secondary="changing defaults via rcParams" id="idm45026297145352"></a><a data-type="indexterm" data-primary="rcParams dictionary, changing defaults via" id="idm45026297144392"></a><a data-type="indexterm" data-primary="runtime configuration (rc)" id="idm45026297143688"></a>Each time Matplotlib loads, it defines a runtime configuration (<code>rc</code>) containing the default styles for every plot element you create.
You can adjust this configuration at any time using the <code>plt.rc</code>
convenience routine. Let’s see what it looks like to modify the <code>rc</code>
parameters so that our default plot will look similar to what we did
before.</p>

<p>We’ll start by saving a copy of the current <code>rcParams</code> dictionary, so we
can easily reset these changes in the current session:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">4</code><code class="p">]:</code> <code class="n">IPython_default</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">rcParams</code><code class="o">.</code><code class="n">copy</code><code class="p">()</code></pre>

<p>Now we can use the <code>plt.rc</code> function to change some of these settings:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">5</code><code class="p">]:</code> <code class="kn">from</code> <code class="nn">matplotlib</code> <code class="kn">import</code> <code class="n">cycler</code>
       <code class="n">colors</code> <code class="o">=</code> <code class="n">cycler</code><code class="p">(</code><code class="s1">'color'</code><code class="p">,</code>
                       <code class="p">[</code><code class="s1">'#EE6666'</code><code class="p">,</code> <code class="s1">'#3388BB'</code><code class="p">,</code> <code class="s1">'#9988DD'</code><code class="p">,</code>
                        <code class="s1">'#EECC55'</code><code class="p">,</code> <code class="s1">'#88BB44'</code><code class="p">,</code> <code class="s1">'#FFBBBB'</code><code class="p">])</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">rc</code><code class="p">(</code><code class="s1">'axes'</code><code class="p">,</code> <code class="n">facecolor</code><code class="o">=</code><code class="s1">'#E6E6E6'</code><code class="p">,</code> <code class="n">edgecolor</code><code class="o">=</code><code class="s1">'none'</code><code class="p">,</code>
              <code class="n">axisbelow</code><code class="o">=</code><code class="bp">True</code><code class="p">,</code> <code class="n">grid</code><code class="o">=</code><code class="bp">True</code><code class="p">,</code> <code class="n">prop_cycle</code><code class="o">=</code><code class="n">colors</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">rc</code><code class="p">(</code><code class="s1">'grid'</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s1">'w'</code><code class="p">,</code> <code class="n">linestyle</code><code class="o">=</code><code class="s1">'solid'</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">rc</code><code class="p">(</code><code class="s1">'xtick'</code><code class="p">,</code> <code class="n">direction</code><code class="o">=</code><code class="s1">'out'</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s1">'gray'</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">rc</code><code class="p">(</code><code class="s1">'ytick'</code><code class="p">,</code> <code class="n">direction</code><code class="o">=</code><code class="s1">'out'</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s1">'gray'</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">rc</code><code class="p">(</code><code class="s1">'patch'</code><code class="p">,</code> <code class="n">edgecolor</code><code class="o">=</code><code class="s1">'#E6E6E6'</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">rc</code><code class="p">(</code><code class="s1">'lines'</code><code class="p">,</code> <code class="n">linewidth</code><code class="o">=</code><code class="mi">2</code><code class="p">)</code></pre>

<p>With these settings defined, we can now create a plot and see our
settings in action (<a data-type="xref" href="#fig0483">Figure 4-83</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">6</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">hist</code><code class="p">(</code><code class="n">x</code><code class="p">);</code></pre>

<figure><div id="fig0483" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in83.png" alt="png" width="379" height="260">
<h6><span class="label">Figure 4-83. </span>A customized histogram using rc settings</h6>
</div></figure>

<p>Let’s see what simple line plots look like with these <code>rc</code> parameters (<a data-type="xref" href="#fig0484">Figure 4-84</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">7</code><code class="p">]:</code> <code class="k">for</code> <code class="n">i</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="mi">4</code><code class="p">):</code>
           <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">rand</code><code class="p">(</code><code class="mi">10</code><code class="p">))</code></pre>

<figure><div id="fig0484" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in84.png" alt="png" width="376" height="260">
<h6><span class="label">Figure 4-84. </span>A line plot with customized styles</h6>
</div></figure>

<p>I find this much more aesthetically pleasing than the default styling.
If you disagree with my aesthetic sense, the good news is that you can
adjust the <code>rc</code> parameters to suit your own tastes! These settings can be
saved in a <em>.matplotlibrc</em> file, which you can read about in the
<a href="http://matplotlib.org/users/customizing.html">Matplotlib documentation</a>.
That said, I prefer to customize Matplotlib using its
stylesheets instead.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Stylesheets"><div class="sect2" id="stylesheets">
<h2>Stylesheets</h2>

<p><a data-type="indexterm" data-primary="Matplotlib" data-secondary="stylesheets" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc86"></a><a data-type="indexterm" data-primary="plotting" data-secondary="stylesheets for" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc87"></a><a data-type="indexterm" data-primary="stylesheets" data-secondary="Matplotlib" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc88"></a>The version 1.4 release of Matplotlib in August 2014 added a very
convenient <code>style</code> module, which includes a number of new default
stylesheets, as well as the ability to create and package your own
styles. These stylesheets are formatted similarly to the <em>.matplotlibrc</em>
files mentioned earlier, but must be named with a <em>.mplstyle</em> <span class="keep-together">extension</span>.</p>

<p>Even if you don’t create your own style, the stylesheets included by
default are extremely useful. The available styles are listed in
<code>plt.style.available</code>—here I’ll list only the first five for brevity:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">8</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">available</code><code class="p">[:</code><code class="mi">5</code><code class="p">]</code></pre>

<pre data-type="programlisting">Out[8]: ['fivethirtyeight',
         'seaborn-pastel',
         'seaborn-whitegrid',
         'ggplot',
         'grayscale']</pre>

<p>The basic way to switch to a stylesheet is to call:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">use</code><code class="p">(</code><code class="s1">'stylename'</code><code class="p">)</code></pre>

<p>But keep in mind that this will change the style for the rest of the
session! Alternatively, you can use the style context manager, which
sets a style temporarily:</p>

<pre data-type="programlisting" data-code-language="python"><code class="k">with</code> <code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">context</code><code class="p">(</code><code class="s1">'stylename'</code><code class="p">):</code>
    <code class="n">make_a_plot</code><code class="p">()</code></pre>

<p>Let’s create a function that will make two basic types of plot:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">9</code><code class="p">]:</code> <code class="k">def</code> <code class="nf">hist_and_lines</code><code class="p">():</code>
           <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">seed</code><code class="p">(</code><code class="mi">0</code><code class="p">)</code>
           <code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">11</code><code class="p">,</code> <code class="mi">4</code><code class="p">))</code>
           <code class="n">ax</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="o">.</code><code class="n">hist</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">randn</code><code class="p">(</code><code class="mi">1000</code><code class="p">))</code>
           <code class="k">for</code> <code class="n">i</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="mi">3</code><code class="p">):</code>
               <code class="n">ax</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">rand</code><code class="p">(</code><code class="mi">10</code><code class="p">))</code>
           <code class="n">ax</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="o">.</code><code class="n">legend</code><code class="p">([</code><code class="s1">'a'</code><code class="p">,</code> <code class="s1">'b'</code><code class="p">,</code> <code class="s1">'c'</code><code class="p">],</code> <code class="n">loc</code><code class="o">=</code><code class="s1">'lower left'</code><code class="p">)</code></pre>

<p>We’ll use this to explore how these plots look using the various
built-in styles.</p>










<section data-type="sect3" data-pdf-bookmark="Default style"><div class="sect3" id="default-style">
<h3>Default style</h3>

<p><a data-type="indexterm" data-primary="stylesheets" data-secondary="default style" id="idm45026296562008"></a>The default style is what we’ve been seeing so far throughout the book;
we’ll start with that. First, let’s reset our runtime configuration to
the notebook default:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">10</code><code class="p">]:</code> <code class="c1"># reset rcParams</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">rcParams</code><code class="o">.</code><code class="n">update</code><code class="p">(</code><code class="n">IPython_default</code><code class="p">);</code></pre>

<p>Now let’s see how it looks (<a data-type="xref" href="#fig0485">Figure 4-85</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">11</code><code class="p">]:</code> <code class="n">hist_and_lines</code><code class="p">()</code></pre>

<figure><div id="fig0485" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in85.png" alt="png" width="654" height="256">
<h6><span class="label">Figure 4-85. </span>Matplotlib’s default style</h6>
</div></figure>
</div></section>













<section data-type="sect3" data-pdf-bookmark="FiveThirtyEight style"><div class="sect3" id="five-thiry-eight-style">
<h3>FiveThirtyEight style</h3>

<p><a data-type="indexterm" data-primary="FiveThirtyEight stylesheet" id="idm45026296526856"></a><a data-type="indexterm" data-primary="stylesheets" data-secondary="FiveThirtyEight style" id="idm45026296526184"></a>The FiveThirtyEight style mimics the graphics found on the popular
<a href="http://fivethirtyeight.com">FiveThirtyEight website</a>. As you can see in <a data-type="xref" href="#fig0486">Figure 4-86</a>, it is typified by bold colors, thick
lines, and transparent axes.</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">12</code><code class="p">]:</code> <code class="k">with</code> <code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">context</code><code class="p">(</code><code class="s1">'fivethirtyeight'</code><code class="p">):</code>
            <code class="n">hist_and_lines</code><code class="p">()</code></pre>

<figure><div id="fig0486" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in86.png" alt="png" width="729" height="272">
<h6><span class="label">Figure 4-86. </span>The FiveThirtyEight style</h6>
</div></figure>
</div></section>













<section data-type="sect3" data-pdf-bookmark="ggplot"><div class="sect3" id="ggplot">
<h3>ggplot</h3>

<p><a data-type="indexterm" data-primary="ggplot stylesheet" id="idm45026296452568"></a><a data-type="indexterm" data-primary="stylesheets" data-secondary="ggplot" id="idm45026296451864"></a>The <code>ggplot</code> package in the R language is a very popular visualization
tool. Matplotlib’s <code>ggplot</code> style mimics the default styles from that
package (<a data-type="xref" href="#fig0487">Figure 4-87</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">13</code><code class="p">]:</code> <code class="k">with</code> <code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">context</code><code class="p">(</code><code class="s1">'ggplot'</code><code class="p">):</code>
            <code class="n">hist_and_lines</code><code class="p">()</code></pre>

<figure><div id="fig0487" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in87.png" alt="png" width="658" height="260">
<h6><span class="label">Figure 4-87. </span>The ggplot style</h6>
</div></figure>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Bayesian Methods for Hackers style"><div class="sect3" id="bayesian-methods-for-hackers-style">
<h3>Bayesian Methods for Hackers style</h3>

<p><a data-type="indexterm" data-primary="Bayesian Methods for Hackers stylesheet" id="idm45026296411880"></a><a data-type="indexterm" data-primary="stylesheets" data-secondary="Bayesian Methods for Hackers" id="idm45026296411016"></a>There is a very nice short online book called
<a href="http://bit.ly/2fDJsKC"><em>Probabilistic
Programming and Bayesian Methods for Hackers</em></a>; it features figures
created with Matplotlib, and uses a nice set of <code>rc</code> parameters to create
a consistent and visually appealing style throughout the book. This
style is reproduced in the <code>bmh</code> stylesheet (<a data-type="xref" href="#fig0488">Figure 4-88</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">14</code><code class="p">]:</code> <code class="k">with</code> <code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">context</code><code class="p">(</code><code class="s1">'bmh'</code><code class="p">):</code>
            <code class="n">hist_and_lines</code><code class="p">()</code></pre>

<figure><div id="fig0488" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in88.png" alt="png" width="654" height="256">
<h6><span class="label">Figure 4-88. </span>The bmh style</h6>
</div></figure>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Dark background"><div class="sect3" id="dark-background">
<h3>Dark background</h3>

<p>For figures used within presentations, it is often useful to have a dark
rather than light background. The <code>dark_background</code> style provides
this (<a data-type="xref" href="#fig0489">Figure 4-89</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">15</code><code class="p">]:</code> <code class="k">with</code> <code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">context</code><code class="p">(</code><code class="s1">'dark_background'</code><code class="p">):</code>
            <code class="n">hist_and_lines</code><code class="p">()</code></pre>

<figure><div id="fig0489" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in89.png" alt="png" width="654" height="256">
<h6><span class="label">Figure 4-89. </span>The dark_background style</h6>
</div></figure>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Grayscale"><div class="sect3" id="grayscale">
<h3>Grayscale</h3>

<p>Sometimes you might find yourself preparing figures for a print
publication that does not accept color figures. For this, the
<code>grayscale</code> style, shown in <a data-type="xref" href="#fig0490">Figure 4-90</a>, can be very useful:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">16</code><code class="p">]:</code> <code class="k">with</code> <code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">context</code><code class="p">(</code><code class="s1">'grayscale'</code><code class="p">):</code>
            <code class="n">hist_and_lines</code><code class="p">()</code></pre>

<figure><div id="fig0490" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in90.png" alt="png" width="654" height="256">
<h6><span class="label">Figure 4-90. </span>The grayscale style</h6>
</div></figure>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Seaborn style"><div class="sect3" id="seaborn-style">
<h3>Seaborn style</h3>

<p><a data-type="indexterm" data-primary="Seaborn" data-secondary="stylesheet" id="idm45026296282360"></a><a data-type="indexterm" data-primary="stylesheets" data-secondary="Seaborn" id="idm45026296281384"></a>Matplotlib also has stylesheets inspired by the Seaborn library
(discussed more fully in
<a data-type="xref" href="#visualization-with-seaborn">“Visualization with Seaborn”</a>). As we will see, these styles are loaded automatically when
Seaborn is imported into a notebook. I’ve found these settings to be
very nice, and tend to use them as defaults in my own data exploration (see <a data-type="xref" href="#fig0491">Figure 4-91</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">17</code><code class="p">]:</code> <code class="kn">import</code> <code class="nn">seaborn</code>
        <code class="n">hist_and_lines</code><code class="p">()</code></pre>

<figure><div id="fig0491" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in91.png" alt="png" width="657" height="259">
<h6><span class="label">Figure 4-91. </span>Seaborn’s plotting style</h6>
</div></figure>

<p>With all of these built-in options for various plot styles, Matplotlib
becomes much more useful for both interactive visualization and creation
of figures for publication.<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc88" id="idm45026296240584"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc87" id="idm45026296239912"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc86" id="idm45026296239272"></a> Throughout this book, I will generally use one
or more of these style conventions when creating plots.<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc82" id="idm45026296238392"></a></p>
</div></section>



</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Three-Dimensional Plotting in Matplotlib"><div class="sect1" id="three-dimensional-plotting-in-matplotlib">
<h1>Three-Dimensional Plotting in Matplotlib</h1>

<p><a data-type="indexterm" data-primary="Matplotlib" data-secondary="three-dimensional plotting" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc89"></a><a data-type="indexterm" data-primary="plotting" data-secondary="three-dimensional" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc90"></a><a data-type="indexterm" data-primary="three-dimensional plotting" data-secondary="with Matplotlib" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc91"></a>Matplotlib was initially designed with only two-dimensional plotting in
mind. Around the time of the 1.0 release, some three-dimensional plotting utilities
were built on top of Matplotlib’s two-dimensional display, and the result is a
convenient (if somewhat limited) set of tools for three-dimensional data
visualization. We enable three-dimensional plots by importing the <code>mplot3d</code> toolkit,
included with the main Matplotlib installation (<a data-type="xref" href="#fig0492">Figure 4-92</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">1</code><code class="p">]:</code> <code class="kn">from</code> <code class="nn">mpl_toolkits</code> <code class="kn">import</code> <code class="n">mplot3d</code></pre>

<p>Once this submodule is imported, we can create a three-dimensional axes by passing the keyword <code>projection='3d'</code> to any of the normal axes
creation routines:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">2</code><code class="p">]:</code> <code class="o">%</code><code class="n">matplotlib</code> <code class="n">inline</code>
       <code class="kn">import</code> <code class="nn">numpy</code> <code class="kn">as</code> <code class="nn">np</code>
       <code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="kn">as</code> <code class="nn">plt</code></pre>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">3</code><code class="p">]:</code> <code class="n">fig</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">()</code>
       <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">axes</code><code class="p">(</code><code class="n">projection</code><code class="o">=</code><code class="s1">'3d'</code><code class="p">)</code></pre>

<figure><div id="fig0492" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in92.png" alt="png" width="349" height="237">
<h6><span class="label">Figure 4-92. </span>An empty three-dimensional axes</h6>
</div></figure>

<p>With this 3D axes enabled, we can now plot a variety of
three-dimensional plot types. Three-dimensional plotting is one of the
functionalities that benefits immensely from viewing figures
interactively rather than statically in the notebook; recall that to use
interactive figures, you can use <code>%matplotlib notebook</code> rather than
<code>%matplotlib inline</code> when running this code.</p>








<section data-type="sect2" data-pdf-bookmark="Three-Dimensional Points and Lines"><div class="sect2" id="d-points-and-lines">
<h2>Three-Dimensional Points and Lines</h2>

<p><a data-type="indexterm" data-primary="three-dimensional plotting" data-secondary="points and lines" id="idm45026296123272"></a>The most basic three-dimensional plot is a line or scatter plot created
from sets of (x, y, z) triples. In analogy with the more common
two-dimensional plots discussed earlier, we can create these using the
<code>ax.plot3D</code> and <code>ax.scatter3D</code> functions. The call signature for these
is nearly identical to that of their two-dimensional counterparts, so
you can refer to <a data-type="xref" href="#simple-line-plots">“Simple Line Plots”</a>
and <a data-type="xref" href="#simple-scatter-plots">“Simple Scatter Plots”</a> for more
information on controlling the output. Here we’ll plot a trigonometric
spiral, along with some points drawn randomly near the line (<a data-type="xref" href="#fig0493">Figure 4-93</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">4</code><code class="p">]:</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">axes</code><code class="p">(</code><code class="n">projection</code><code class="o">=</code><code class="s1">'3d'</code><code class="p">)</code>

       <code class="c1"># Data for a three-dimensional line</code>
       <code class="n">zline</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">15</code><code class="p">,</code> <code class="mi">1000</code><code class="p">)</code>
       <code class="n">xline</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">zline</code><code class="p">)</code>
       <code class="n">yline</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">cos</code><code class="p">(</code><code class="n">zline</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">plot3D</code><code class="p">(</code><code class="n">xline</code><code class="p">,</code> <code class="n">yline</code><code class="p">,</code> <code class="n">zline</code><code class="p">,</code> <code class="s1">'gray'</code><code class="p">)</code>

       <code class="c1"># Data for three-dimensional scattered points</code>
       <code class="n">zdata</code> <code class="o">=</code> <code class="mi">15</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">random</code><code class="p">(</code><code class="mi">100</code><code class="p">)</code>
       <code class="n">xdata</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">zdata</code><code class="p">)</code> <code class="o">+</code> <code class="mf">0.1</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">randn</code><code class="p">(</code><code class="mi">100</code><code class="p">)</code>
       <code class="n">ydata</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">cos</code><code class="p">(</code><code class="n">zdata</code><code class="p">)</code> <code class="o">+</code> <code class="mf">0.1</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">randn</code><code class="p">(</code><code class="mi">100</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">scatter3D</code><code class="p">(</code><code class="n">xdata</code><code class="p">,</code> <code class="n">ydata</code><code class="p">,</code> <code class="n">zdata</code><code class="p">,</code> <code class="n">c</code><code class="o">=</code><code class="n">zdata</code><code class="p">,</code> <code class="n">cmap</code><code class="o">=</code><code class="s1">'Greens'</code><code class="p">);</code></pre>

<figure><div id="fig0493" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in93.png" alt="png" width="349" height="237">
<h6><span class="label">Figure 4-93. </span>Points and lines in three dimensions</h6>
</div></figure>

<p>Notice that by default, the scatter points have their transparency
adjusted to give a sense of depth on the page. While the three-dimensional effect is
sometimes difficult to see within a static image, an interactive view
can lead to some nice intuition about the layout of the points.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Three-Dimensional Contour Plots"><div class="sect2" id="d-contour-plots">
<h2>Three-Dimensional Contour Plots</h2>

<p><a data-type="indexterm" data-primary="contour plots" data-secondary="three-dimensional plot" id="idm45026295974712"></a><a data-type="indexterm" data-primary="three-dimensional plotting" data-secondary="contour plots" id="idm45026295973512"></a>Analogous to the contour plots we explored in
<a data-type="xref" href="#density-and-contour-plots">“Density and Contour Plots”</a>,
<code>mplot3d</code> contains tools to create three-dimensional relief plots using
the same inputs. Like two-dimensional <code>ax.contour</code> plots, <code>ax.contour3D</code>
requires all the input data to be in the form of two-dimensional regular
grids, with the Z data evaluated at each point. Here we’ll show a three-dimensional
contour diagram of a three-dimensional sinusoidal function (<a data-type="xref" href="#fig0494">Figure 4-94</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">5</code><code class="p">]:</code> <code class="k">def</code> <code class="nf">f</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">):</code>
           <code class="k">return</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">sqrt</code><code class="p">(</code><code class="n">x</code> <code class="o">**</code> <code class="mi">2</code> <code class="o">+</code> <code class="n">y</code> <code class="o">**</code> <code class="mi">2</code><code class="p">))</code>

       <code class="n">x</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="o">-</code><code class="mi">6</code><code class="p">,</code> <code class="mi">6</code><code class="p">,</code> <code class="mi">30</code><code class="p">)</code>
       <code class="n">y</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="o">-</code><code class="mi">6</code><code class="p">,</code> <code class="mi">6</code><code class="p">,</code> <code class="mi">30</code><code class="p">)</code>

       <code class="n">X</code><code class="p">,</code> <code class="n">Y</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">meshgrid</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">)</code>
       <code class="n">Z</code> <code class="o">=</code> <code class="n">f</code><code class="p">(</code><code class="n">X</code><code class="p">,</code> <code class="n">Y</code><code class="p">)</code></pre>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">6</code><code class="p">]:</code> <code class="n">fig</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">()</code>
       <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">axes</code><code class="p">(</code><code class="n">projection</code><code class="o">=</code><code class="s1">'3d'</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">contour3D</code><code class="p">(</code><code class="n">X</code><code class="p">,</code> <code class="n">Y</code><code class="p">,</code> <code class="n">Z</code><code class="p">,</code> <code class="mi">50</code><code class="p">,</code> <code class="n">cmap</code><code class="o">=</code><code class="s1">'binary'</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">set_xlabel</code><code class="p">(</code><code class="s1">'x'</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">set_ylabel</code><code class="p">(</code><code class="s1">'y'</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">set_zlabel</code><code class="p">(</code><code class="s1">'z'</code><code class="p">);</code></pre>

<figure><div id="fig0494" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in94.png" alt="png" width="349" height="237">
<h6><span class="label">Figure 4-94. </span>A three-dimensional contour plot</h6>
</div></figure>

<p>Sometimes the default viewing angle is not optimal, in which case we can
use the <code>view_init</code> method to set the elevation and azimuthal angles.
In this example (the result of which is shown in <a data-type="xref" href="#fig0495">Figure 4-95</a>), we’ll use an elevation of 60 degrees (that is, 60 degrees above the
<em>x</em>-<em>y</em> plane) and an azimuth of 35 degrees (that is, rotated 35 degrees
counter-clockwise about the <em>z</em>-axis):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">7</code><code class="p">]:</code> <code class="n">ax</code><code class="o">.</code><code class="n">view_init</code><code class="p">(</code><code class="mi">60</code><code class="p">,</code> <code class="mi">35</code><code class="p">)</code>
       <code class="n">fig</code></pre>

<figure><div id="fig0495" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in95.png" alt="png" width="349" height="237">
<h6><span class="label">Figure 4-95. </span>Adjusting the view angle for a three-dimensional plot</h6>
</div></figure>

<p>Again, note that we can accomplish this type of rotation interactively
by clicking and dragging when using one of Matplotlib’s interactive
backends.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Wireframes and Surface Plots"><div class="sect2" id="wireframes-and-surface-plots">
<h2>Wireframes and Surface Plots</h2>

<p><a data-type="indexterm" data-primary="three-dimensional plotting" data-secondary="wireframes" id="idm45026295700136"></a><a data-type="indexterm" data-primary="wireframe plot" id="idm45026295699192"></a>Two other types of three-dimensional plots that work on gridded data are wireframes
and <a data-type="indexterm" data-primary="surface plots, three-dimensional" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc92"></a><a data-type="indexterm" data-primary="three-dimensional plotting" data-secondary="surface plots" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc93"></a>surface plots. These take a grid of values and project it onto the
specified three-dimensional surface, and can make the resulting
three-dimensional forms quite easy to visualize. Here’s an example using a wireframe (<a data-type="xref" href="#fig0496">Figure 4-96</a>):</p>

<pre data-type="programlisting" data-code-language="python" class="pagebreak-before"><code class="n">In</code><code class="p">[</code><code class="mi">8</code><code class="p">]:</code> <code class="n">fig</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">()</code>
       <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">axes</code><code class="p">(</code><code class="n">projection</code><code class="o">=</code><code class="s1">'3d'</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">plot_wireframe</code><code class="p">(</code><code class="n">X</code><code class="p">,</code> <code class="n">Y</code><code class="p">,</code> <code class="n">Z</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s1">'black'</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">set_title</code><code class="p">(</code><code class="s1">'wireframe'</code><code class="p">);</code></pre>

<figure><div id="fig0496" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in96.png" alt="png" width="349" height="237">
<h6><span class="label">Figure 4-96. </span>A wireframe plot</h6>
</div></figure>

<p>A surface plot is like a wireframe plot, but each face of the wireframe
is a filled polygon. Adding a colormap to the filled polygons can aid
perception of the topology of the surface being visualized (<a data-type="xref" href="#fig0497">Figure 4-97</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">9</code><code class="p">]:</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">axes</code><code class="p">(</code><code class="n">projection</code><code class="o">=</code><code class="s1">'3d'</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">plot_surface</code><code class="p">(</code><code class="n">X</code><code class="p">,</code> <code class="n">Y</code><code class="p">,</code> <code class="n">Z</code><code class="p">,</code> <code class="n">rstride</code><code class="o">=</code><code class="mi">1</code><code class="p">,</code> <code class="n">cstride</code><code class="o">=</code><code class="mi">1</code><code class="p">,</code>
                       <code class="n">cmap</code><code class="o">=</code><code class="s1">'viridis'</code><code class="p">,</code> <code class="n">edgecolor</code><code class="o">=</code><code class="s1">'none'</code><code class="p">)</code>
       <code class="n">ax</code><code class="o">.</code><code class="n">set_title</code><code class="p">(</code><code class="s1">'surface'</code><code class="p">);</code></pre>

<figure><div id="fig0497" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in97.png" alt="png" width="349" height="237">
<h6><span class="label">Figure 4-97. </span>A three-dimensional surface plot</h6>
</div></figure>

<p>Note that though the grid of values for a surface plot needs to be
two-dimensional, it need not be rectilinear. Here is an example of
creating a partial polar grid, which when used with the <code>surface3D</code> plot
can give us a slice into the function we’re visualizing (<a data-type="xref" href="#fig0498">Figure 4-98</a>):</p>

<pre data-type="programlisting" data-code-language="python" class="pagebreak-before"><code class="n">In</code><code class="p">[</code><code class="mi">10</code><code class="p">]:</code> <code class="n">r</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">6</code><code class="p">,</code> <code class="mi">20</code><code class="p">)</code>
        <code class="n">theta</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="o">-</code><code class="mf">0.9</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">pi</code><code class="p">,</code> <code class="mf">0.8</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">pi</code><code class="p">,</code> <code class="mi">40</code><code class="p">)</code>
        <code class="n">r</code><code class="p">,</code> <code class="n">theta</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">meshgrid</code><code class="p">(</code><code class="n">r</code><code class="p">,</code> <code class="n">theta</code><code class="p">)</code>

        <code class="n">X</code> <code class="o">=</code> <code class="n">r</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">theta</code><code class="p">)</code>
        <code class="n">Y</code> <code class="o">=</code> <code class="n">r</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">cos</code><code class="p">(</code><code class="n">theta</code><code class="p">)</code>
        <code class="n">Z</code> <code class="o">=</code> <code class="n">f</code><code class="p">(</code><code class="n">X</code><code class="p">,</code> <code class="n">Y</code><code class="p">)</code>

        <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">axes</code><code class="p">(</code><code class="n">projection</code><code class="o">=</code><code class="s1">'3d'</code><code class="p">)</code>
        <code class="n">ax</code><code class="o">.</code><code class="n">plot_surface</code><code class="p">(</code><code class="n">X</code><code class="p">,</code> <code class="n">Y</code><code class="p">,</code> <code class="n">Z</code><code class="p">,</code> <code class="n">rstride</code><code class="o">=</code><code class="mi">1</code><code class="p">,</code> <code class="n">cstride</code><code class="o">=</code><code class="mi">1</code><code class="p">,</code>
                        <code class="n">cmap</code><code class="o">=</code><code class="s1">'viridis'</code><code class="p">,</code> <code class="n">edgecolor</code><code class="o">=</code><code class="s1">'none'</code><code class="p">);</code></pre>

<figure><div id="fig0498" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in98.png" alt="png" width="349" height="237">
<h6><span class="label">Figure 4-98. </span>A polar surface plot</h6>
</div></figure>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Surface Triangulations"><div class="sect2" id="surface-triangulations">
<h2>Surface Triangulations</h2>

<p><a data-type="indexterm" data-primary="three-dimensional plotting" data-secondary="surface triangulations" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc94"></a><a data-type="indexterm" data-primary="triangulated surface plots" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc95"></a>For some applications, the evenly sampled grids required by the preceding
routines are overly restrictive and inconvenient. In these situations,
the triangulation-based plots can be very useful. What if rather than an
even draw from a Cartesian or a polar grid, we instead have a set of
random draws?</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">11</code><code class="p">]:</code> <code class="n">theta</code> <code class="o">=</code> <code class="mi">2</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">pi</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">random</code><code class="p">(</code><code class="mi">1000</code><code class="p">)</code>
        <code class="n">r</code> <code class="o">=</code> <code class="mi">6</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">random</code><code class="p">(</code><code class="mi">1000</code><code class="p">)</code>
        <code class="n">x</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">ravel</code><code class="p">(</code><code class="n">r</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">theta</code><code class="p">))</code>
        <code class="n">y</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">ravel</code><code class="p">(</code><code class="n">r</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">cos</code><code class="p">(</code><code class="n">theta</code><code class="p">))</code>
        <code class="n">z</code> <code class="o">=</code> <code class="n">f</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">)</code></pre>

<p>We could create a scatter plot of the points to get an idea of the
surface we’re sampling from (<a data-type="xref" href="#fig0499">Figure 4-99</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">12</code><code class="p">]:</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">axes</code><code class="p">(</code><code class="n">projection</code><code class="o">=</code><code class="s1">'3d'</code><code class="p">)</code>
        <code class="n">ax</code><code class="o">.</code><code class="n">scatter</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">,</code> <code class="n">z</code><code class="p">,</code> <code class="n">c</code><code class="o">=</code><code class="n">z</code><code class="p">,</code> <code class="n">cmap</code><code class="o">=</code><code class="s1">'viridis'</code><code class="p">,</code> <code class="n">linewidth</code><code class="o">=</code><code class="mf">0.5</code><code class="p">);</code></pre>

<figure><div id="fig0499" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in99.png" alt="png" width="349" height="237">
<h6><span class="label">Figure 4-99. </span>A three-dimensional sampled surface</h6>
</div></figure>

<p>This leaves a lot to be desired. The function that will help us in this
case is <code>ax.plot_trisurf</code>, which creates a surface by first finding a
set of triangles formed between adjacent points (the result is shown in <a data-type="xref" href="#fig04100">Figure 4-100</a>; remember that <code>x</code>, <code>y</code>, and <code>z</code> here are one-dimensional arrays):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">13</code><code class="p">]:</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">axes</code><code class="p">(</code><code class="n">projection</code><code class="o">=</code><code class="s1">'3d'</code><code class="p">)</code>
        <code class="n">ax</code><code class="o">.</code><code class="n">plot_trisurf</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">,</code> <code class="n">z</code><code class="p">,</code>
                        <code class="n">cmap</code><code class="o">=</code><code class="s1">'viridis'</code><code class="p">,</code> <code class="n">edgecolor</code><code class="o">=</code><code class="s1">'none'</code><code class="p">);</code></pre>

<figure><div id="fig04100" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in100.png" alt="png" width="349" height="237">
<h6><span class="label">Figure 4-100. </span>A triangulated surface plot</h6>
</div></figure>

<p>The result is certainly not as clean as when it is plotted with a grid,
but the flexibility of such a triangulation allows for some really
interesting three-dimensional plots. For example, it is actually possible to plot a three-dimensional
Möbius strip using this, as we’ll see next.</p>










<section data-type="sect3" data-pdf-bookmark="Example: Visualizing a Möbius strip"><div class="sect3" id="example-visualizing-a-mobius-strip">
<h3>Example: Visualizing a Möbius strip</h3>

<p><a data-type="indexterm" data-primary="Möbius strip" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc96"></a><a data-type="indexterm" data-primary="three-dimensional plotting" data-secondary="Möbius strip visualization" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc97"></a>A Möbius strip is similar to a strip of paper glued into a loop with a half-twist.
Topologically, it’s quite interesting because despite appearances it has
only a single side! Here we will visualize such an object using
Matplotlib’s three-dimensional tools. The key to creating the Möbius strip is to think
about its parameterization: it’s a two-dimensional strip, so we need two
intrinsic dimensions. Let’s call them <math xmlns="http://www.w3.org/1998/Math/MathML" alttext="theta">
  <mi>θ</mi>
</math>, which ranges
from 0 to <math xmlns="http://www.w3.org/1998/Math/MathML" alttext="2 pi">
  <mrow>
    <mn>2</mn>
    <mi>π</mi>
  </mrow>
</math> around the loop, and
<math xmlns="http://www.w3.org/1998/Math/MathML">
  <mi>w</mi>
</math> which ranges from –1 to 1 across the width of the strip:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">14</code><code class="p">]:</code> <code class="n">theta</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">2</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">pi</code><code class="p">,</code> <code class="mi">30</code><code class="p">)</code>
        <code class="n">w</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="o">-</code><code class="mf">0.25</code><code class="p">,</code> <code class="mf">0.25</code><code class="p">,</code> <code class="mi">8</code><code class="p">)</code>
        <code class="n">w</code><code class="p">,</code> <code class="n">theta</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">meshgrid</code><code class="p">(</code><code class="n">w</code><code class="p">,</code> <code class="n">theta</code><code class="p">)</code></pre>

<p>Now from this parameterization, we must determine the <em>(x, y, z)</em>
positions of the embedded strip.</p>

<p>Thinking about it, we might realize that there are two rotations
happening: one is the position of the loop about its center (what we’ve
called <math xmlns="http://www.w3.org/1998/Math/MathML">
  <mi>θ</mi>
</math>), while the other is the twisting of the
strip about its axis (we’ll call this <math xmlns="http://www.w3.org/1998/Math/MathML" alttext="phi">
  <mi>ϕ</mi>
</math>). For a Möbius
strip, we must have the strip make half a twist during a full loop, or
<math xmlns="http://www.w3.org/1998/Math/MathML" alttext="normal upper Delta phi equals normal upper Delta theta slash 2">
  <mrow>
    <mi>Δ</mi>
    <mi>ϕ</mi>
    <mo>=</mo>
    <mi>Δ</mi>
    <mi>θ</mi>
    <mo>/</mo>
    <mn>2</mn>
  </mrow>
</math>.</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">15</code><code class="p">]:</code> <code class="n">phi</code> <code class="o">=</code> <code class="mf">0.5</code> <code class="o">*</code> <code class="n">theta</code></pre>

<p>Now we use our recollection of trigonometry to derive the
three-dimensional embedding. We’ll define <math xmlns="http://www.w3.org/1998/Math/MathML" alttext="r">
  <mi>r</mi>
</math>, the distance
of each point from the center, and use this to find the embedded
<math xmlns="http://www.w3.org/1998/Math/MathML" alttext="left-parenthesis x comma y comma z right-parenthesis">
  <mrow>
    <mo>(</mo>
    <mi>x</mi>
    <mo>,</mo>
    <mi>y</mi>
    <mo>,</mo>
    <mi>z</mi>
    <mo>)</mo>
  </mrow>
</math> coordinates:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">16</code><code class="p">]:</code> <code class="c1"># radius in x-y plane</code>
        <code class="n">r</code> <code class="o">=</code> <code class="mi">1</code> <code class="o">+</code> <code class="n">w</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">cos</code><code class="p">(</code><code class="n">phi</code><code class="p">)</code>

        <code class="n">x</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">ravel</code><code class="p">(</code><code class="n">r</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">cos</code><code class="p">(</code><code class="n">theta</code><code class="p">))</code>
        <code class="n">y</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">ravel</code><code class="p">(</code><code class="n">r</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">theta</code><code class="p">))</code>
        <code class="n">z</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">ravel</code><code class="p">(</code><code class="n">w</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">phi</code><code class="p">))</code></pre>

<p>Finally, to plot the object, we must make sure the triangulation is
correct. The best way to do this is to define the triangulation
<em>within the underlying parameterization</em>, and then let Matplotlib project
this triangulation into the three-dimensional space of the Möbius strip.
This can be accomplished as follows (<a data-type="xref" href="#fig04101">Figure 4-101</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">17</code><code class="p">]:</code> <code class="c1"># triangulate in the underlying parameterization</code>
        <code class="kn">from</code> <code class="nn">matplotlib.tri</code> <code class="kn">import</code> <code class="n">Triangulation</code>
        <code class="n">tri</code> <code class="o">=</code> <code class="n">Triangulation</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">ravel</code><code class="p">(</code><code class="n">w</code><code class="p">),</code> <code class="n">np</code><code class="o">.</code><code class="n">ravel</code><code class="p">(</code><code class="n">theta</code><code class="p">))</code>

        <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">axes</code><code class="p">(</code><code class="n">projection</code><code class="o">=</code><code class="s1">'3d'</code><code class="p">)</code>
        <code class="n">ax</code><code class="o">.</code><code class="n">plot_trisurf</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">,</code> <code class="n">z</code><code class="p">,</code> <code class="n">triangles</code><code class="o">=</code><code class="n">tri</code><code class="o">.</code><code class="n">triangles</code><code class="p">,</code>
                        <code class="n">cmap</code><code class="o">=</code><code class="s1">'viridis'</code><code class="p">,</code> <code class="n">linewidths</code><code class="o">=</code><code class="mf">0.2</code><code class="p">);</code>

        <code class="n">ax</code><code class="o">.</code><code class="n">set_xlim</code><code class="p">(</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">);</code> <code class="n">ax</code><code class="o">.</code><code class="n">set_ylim</code><code class="p">(</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">);</code> <code class="n">ax</code><code class="o">.</code><code class="n">set_zlim</code><code class="p">(</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">);</code></pre>

<figure><div id="fig04101" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in101.png" alt="png" width="349" height="237">
<h6><span class="label">Figure 4-101. </span>Visualizing a Möbius strip</h6>
</div></figure>

<p>Combining all of these techniques, it is possible to create and
display a wide variety of three-dimensional objects<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc97" id="idm45026294782040"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc96" id="idm45026294781368"></a> and patterns<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc95" id="idm45026294780600"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc94" id="idm45026294779928"></a> in Matplotlib<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc93" id="idm45026294779160"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc92" id="idm45026294778488"></a>.<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc91" id="idm45026294777720"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc90" id="idm45026294776968"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc89" id="idm45026294776248"></a></p>
</div></section>



</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Geographic Data with Basemap"><div class="sect1" id="geographic-data-with-basemap">
<h1>Geographic Data with Basemap</h1>

<p><a data-type="indexterm" data-primary="Basemap toolkit" data-secondary="geographic data with" data-seealso="geographic data" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc98"></a><a data-type="indexterm" data-primary="geographic data" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc99"></a><a data-type="indexterm" data-primary="geographic data" data-secondary="Basemap toolkit for" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc100"></a><a data-type="indexterm" data-primary="Matplotlib" data-secondary="geographic data with Basemap toolkit" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc101"></a>One common type of visualization in data science is that of geographic
data. Matplotlib’s main tool for this type of visualization is the
Basemap toolkit, which is one of several Matplotlib toolkits that
live under the <code>mpl_toolkits</code> namespace. Admittedly, Basemap feels a
bit clunky to use, and often even simple visualizations take much longer
to render than you might hope. More modern solutions, such as leaflet or
the Google Maps API, may be a better choice for more intensive map
visualizations. Still, Basemap is a useful tool for Python users to
have in their virtual toolbelts. In this section, we’ll show several
examples of the type of map visualization that is possible with this
toolkit.</p>

<p><a data-type="indexterm" data-primary="Basemap toolkit" data-secondary="installation" id="idm45026294767624"></a>Installation of Basemap is straightforward; if you’re using conda you
can type this and the package will be downloaded:</p>

<pre data-type="programlisting">$ conda install basemap</pre>

<p>We add just a single new import to our standard boilerplate:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">1</code><code class="p">]:</code> <code class="o">%</code><code class="n">matplotlib</code> <code class="n">inline</code>
       <code class="kn">import</code> <code class="nn">numpy</code> <code class="kn">as</code> <code class="nn">np</code>
       <code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="kn">as</code> <code class="nn">plt</code>
       <code class="kn">from</code> <code class="nn">mpl_toolkits.basemap</code> <code class="kn">import</code> <code class="n">Basemap</code></pre>

<p>Once you have the Basemap toolkit installed and imported, geographic
plots are just a few lines away (the graphics in <a data-type="xref" href="#fig04102">Figure 4-102</a> also
require the <code>PIL</code> package in Python 2, or the <code>pillow</code> package in
Python 3):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">2</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">8</code><code class="p">,</code> <code class="mi">8</code><code class="p">))</code>
       <code class="n">m</code> <code class="o">=</code> <code class="n">Basemap</code><code class="p">(</code><code class="n">projection</code><code class="o">=</code><code class="s1">'ortho'</code><code class="p">,</code> <code class="n">resolution</code><code class="o">=</code><code class="bp">None</code><code class="p">,</code> <code class="n">lat_0</code><code class="o">=</code><code class="mi">50</code><code class="p">,</code> <code class="n">lon_0</code><code class="o">=-</code><code class="mi">100</code><code class="p">)</code>
       <code class="n">m</code><code class="o">.</code><code class="n">bluemarble</code><code class="p">(</code><code class="n">scale</code><code class="o">=</code><code class="mf">0.5</code><code class="p">);</code></pre>

<figure><div id="fig04102" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in102.png" alt="png" width="460" height="460">
<h6><span class="label">Figure 4-102. </span>A “bluemarble” projection of the Earth</h6>
</div></figure>

<p>The meaning of the arguments to Basemap will be discussed momentarily.</p>

<p>The useful thing is that the globe shown here is not a mere image; it is
a fully functioning Matplotlib axes that understands spherical
coordinates and allows us to easily over-plot data on the map! For
example, we can use a different map projection, zoom in to North America,
and plot the location of Seattle. We’ll use an etopo image (which shows
topographical features both on land and under the ocean) as the map
background (<a data-type="xref" href="#fig04103">Figure 4-103</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">3</code><code class="p">]:</code> <code class="n">fig</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">8</code><code class="p">,</code> <code class="mi">8</code><code class="p">))</code>
       <code class="n">m</code> <code class="o">=</code> <code class="n">Basemap</code><code class="p">(</code><code class="n">projection</code><code class="o">=</code><code class="s1">'lcc'</code><code class="p">,</code> <code class="n">resolution</code><code class="o">=</code><code class="bp">None</code><code class="p">,</code>
                   <code class="n">width</code><code class="o">=</code><code class="mf">8E6</code><code class="p">,</code> <code class="n">height</code><code class="o">=</code><code class="mf">8E6</code><code class="p">,</code>
                   <code class="n">lat_0</code><code class="o">=</code><code class="mi">45</code><code class="p">,</code> <code class="n">lon_0</code><code class="o">=-</code><code class="mi">100</code><code class="p">,)</code>
       <code class="n">m</code><code class="o">.</code><code class="n">etopo</code><code class="p">(</code><code class="n">scale</code><code class="o">=</code><code class="mf">0.5</code><code class="p">,</code> <code class="n">alpha</code><code class="o">=</code><code class="mf">0.5</code><code class="p">)</code>

       <code class="c1"># Map (long, lat) to (x, y) for plotting</code>
       <code class="n">x</code><code class="p">,</code> <code class="n">y</code> <code class="o">=</code> <code class="n">m</code><code class="p">(</code><code class="o">-</code><code class="mf">122.3</code><code class="p">,</code> <code class="mf">47.6</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">,</code> <code class="s1">'ok'</code><code class="p">,</code> <code class="n">markersize</code><code class="o">=</code><code class="mi">5</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">text</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">,</code> <code class="s1">' Seattle'</code><code class="p">,</code> <code class="n">fontsize</code><code class="o">=</code><code class="mi">12</code><code class="p">);</code></pre>

<figure><div id="fig04103" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in103.png" alt="png" width="460" height="460">
<h6><span class="label">Figure 4-103. </span>Plotting data and labels on the map</h6>
</div></figure>

<p>This gives you a brief glimpse into the sort of geographic visualizations
that are possible with just a few lines of Python. We’ll now discuss
the features of Basemap in more depth, and provide several examples of
visualizing map data. Using these brief examples as building blocks, you
should be able to create nearly any map visualization that you desire.</p>








<section data-type="sect2" data-pdf-bookmark="Map Projections"><div class="sect2" id="map-projections">
<h2>Map Projections</h2>

<p><a data-type="indexterm" data-primary="geographic data" data-secondary="map projections" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc102"></a><a data-type="indexterm" data-primary="map projections" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc103"></a>The first thing to decide when you are using maps is which projection to use. You’re probably familiar with the fact that it is impossible to
project a spherical map, such as that of the Earth, onto a flat surface
without somehow distorting it or breaking its continuity. These
projections have been developed over the course of human history, and
there are a lot of choices! Depending on the intended use of the map
projection, there are certain map features (e.g., direction, area, distance, shape, or other considerations) that are useful to maintain.</p>

<p>The Basemap package implements several dozen such projections, all
referenced by a short format code. Here we’ll briefly demonstrate some
of the more common ones.</p>

<p>We’ll start by defining a convenience routine to draw our world map
along with the longitude and latitude lines:</p>

<pre data-type="programlisting" data-code-language="python" class="pagebreak-before"><code class="n">In</code><code class="p">[</code><code class="mi">4</code><code class="p">]:</code> <code class="kn">from</code> <code class="nn">itertools</code> <code class="kn">import</code> <code class="n">chain</code>

       <code class="k">def</code> <code class="nf">draw_map</code><code class="p">(</code><code class="n">m</code><code class="p">,</code> <code class="n">scale</code><code class="o">=</code><code class="mf">0.2</code><code class="p">):</code>
           <code class="c1"># draw a shaded-relief image</code>
           <code class="n">m</code><code class="o">.</code><code class="n">shadedrelief</code><code class="p">(</code><code class="n">scale</code><code class="o">=</code><code class="n">scale</code><code class="p">)</code>

           <code class="c1"># lats and longs are returned as a dictionary</code>
           <code class="n">lats</code> <code class="o">=</code> <code class="n">m</code><code class="o">.</code><code class="n">drawparallels</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="o">-</code><code class="mi">90</code><code class="p">,</code> <code class="mi">90</code><code class="p">,</code> <code class="mi">13</code><code class="p">))</code>
           <code class="n">lons</code> <code class="o">=</code> <code class="n">m</code><code class="o">.</code><code class="n">drawmeridians</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="o">-</code><code class="mi">180</code><code class="p">,</code> <code class="mi">180</code><code class="p">,</code> <code class="mi">13</code><code class="p">))</code>

           <code class="c1"># keys contain the plt.Line2D instances</code>
           <code class="n">lat_lines</code> <code class="o">=</code> <code class="n">chain</code><code class="p">(</code><code class="o">*</code><code class="p">(</code><code class="n">tup</code><code class="p">[</code><code class="mi">1</code><code class="p">][</code><code class="mi">0</code><code class="p">]</code> <code class="k">for</code> <code class="n">tup</code> <code class="ow">in</code> <code class="n">lats</code><code class="o">.</code><code class="n">items</code><code class="p">()))</code>
           <code class="n">lon_lines</code> <code class="o">=</code> <code class="n">chain</code><code class="p">(</code><code class="o">*</code><code class="p">(</code><code class="n">tup</code><code class="p">[</code><code class="mi">1</code><code class="p">][</code><code class="mi">0</code><code class="p">]</code> <code class="k">for</code> <code class="n">tup</code> <code class="ow">in</code> <code class="n">lons</code><code class="o">.</code><code class="n">items</code><code class="p">()))</code>
           <code class="n">all_lines</code> <code class="o">=</code> <code class="n">chain</code><code class="p">(</code><code class="n">lat_lines</code><code class="p">,</code> <code class="n">lon_lines</code><code class="p">)</code>

           <code class="c1"># cycle through these lines and set the desired style</code>
           <code class="k">for</code> <code class="n">line</code> <code class="ow">in</code> <code class="n">all_lines</code><code class="p">:</code>
               <code class="n">line</code><code class="o">.</code><code class="n">set</code><code class="p">(</code><code class="n">linestyle</code><code class="o">=</code><code class="s1">'-'</code><code class="p">,</code> <code class="n">alpha</code><code class="o">=</code><code class="mf">0.3</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s1">'w'</code><code class="p">)</code></pre>










<section data-type="sect3" data-pdf-bookmark="Cylindrical projections"><div class="sect3" id="cylindrical-projections">
<h3>Cylindrical projections</h3>

<p><a data-type="indexterm" data-primary="cylindrical projections" id="idm45026294497528"></a><a data-type="indexterm" data-primary="map projections" data-secondary="cylindrical" id="idm45026294496600"></a>The simplest of map projections are cylindrical projections, in which
lines of constant latitude and longitude are mapped to horizontal and
vertical lines, respectively. This type of mapping represents equatorial
regions quite well, but results in extreme distortions near the poles.
The spacing of latitude lines varies between different cylindrical
projections, leading to different conservation properties, and different
distortion near the poles. <a data-type="indexterm" data-primary="equidistant cylindrical projection" id="idm45026294315096"></a>In <a data-type="xref" href="#fig04104">Figure 4-104</a>, we show an example of the <em>equidistant
cylindrical projection</em>, which chooses a latitude scaling that
preserves distances along meridians. Other cylindrical projections are
the Mercator (<code>projection='merc'</code>) and the cylindrical equal-area
(<code>projection='cea'</code>) projections.</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">5</code><code class="p">]:</code> <code class="n">fig</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">8</code><code class="p">,</code> <code class="mi">6</code><code class="p">),</code> <code class="n">edgecolor</code><code class="o">=</code><code class="s1">'w'</code><code class="p">)</code>
       <code class="n">m</code> <code class="o">=</code> <code class="n">Basemap</code><code class="p">(</code><code class="n">projection</code><code class="o">=</code><code class="s1">'cyl'</code><code class="p">,</code> <code class="n">resolution</code><code class="o">=</code><code class="bp">None</code><code class="p">,</code>
                   <code class="n">llcrnrlat</code><code class="o">=-</code><code class="mi">90</code><code class="p">,</code> <code class="n">urcrnrlat</code><code class="o">=</code><code class="mi">90</code><code class="p">,</code>
                   <code class="n">llcrnrlon</code><code class="o">=-</code><code class="mi">180</code><code class="p">,</code> <code class="n">urcrnrlon</code><code class="o">=</code><code class="mi">180</code><code class="p">,</code> <code class="p">)</code>
       <code class="n">draw_map</code><code class="p">(</code><code class="n">m</code><code class="p">)</code></pre>

<figure><div id="fig04104" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in104.png" alt="png" width="460" height="237">
<h6><span class="label">Figure 4-104. </span>Cylindrical equal-area projection</h6>
</div></figure>

<p>The additional arguments to Basemap for this view specify the latitude
(<code>lat</code>) and longitude (<code>lon</code>) of the lower-left corner (<code>llcrnr</code>) and
upper-right corner (<code>urcrnr</code>) for the desired map, in units of degrees.</p>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Pseudo-cylindrical projections"><div class="sect3" id="pseudo-cylindrical-projections">
<h3>Pseudo-cylindrical projections</h3>

<p><a data-type="indexterm" data-primary="map projections" data-secondary="pseudo-cylindrical" id="idm45026294251048"></a><a data-type="indexterm" data-primary="pseudo-cylindrical projections" id="idm45026294249848"></a>Pseudo-cylindrical projections relax the requirement that meridians
(lines of constant longitude) remain vertical; this can give better
properties near the poles of the projection. <a data-type="indexterm" data-primary="Mollweide projection" id="idm45026294248888"></a>The Mollweide projection
(<code>projection='moll'</code>) is one common example of this, in which all
meridians are elliptical arcs (<a data-type="xref" href="#fig04105">Figure 4-105</a>). It is constructed so as to preserve area
across the map: though there are distortions near the poles, the area of
small patches reflects the true area. Other pseudo-cylindrical
projections are the sinusoidal (<code>projection='sinu'</code>) and Robinson
(<code>projection='robin'</code>) projections.</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">6</code><code class="p">]:</code> <code class="n">fig</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">8</code><code class="p">,</code> <code class="mi">6</code><code class="p">),</code> <code class="n">edgecolor</code><code class="o">=</code><code class="s1">'w'</code><code class="p">)</code>
       <code class="n">m</code> <code class="o">=</code> <code class="n">Basemap</code><code class="p">(</code><code class="n">projection</code><code class="o">=</code><code class="s1">'moll'</code><code class="p">,</code> <code class="n">resolution</code><code class="o">=</code><code class="bp">None</code><code class="p">,</code>
                   <code class="n">lat_0</code><code class="o">=</code><code class="mi">0</code><code class="p">,</code> <code class="n">lon_0</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code>
       <code class="n">draw_map</code><code class="p">(</code><code class="n">m</code><code class="p">)</code></pre>

<figure><div id="fig04105" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in105.png" alt="png" width="460" height="237">
<h6><span class="label">Figure 4-105. </span>The Molleweide projection</h6>
</div></figure>

<p>The extra arguments to <code>Basemap</code> here refer to the central latitude
(<code>lat_0</code>) and longitude (<code>lon_0</code>) for the desired map.</p>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Perspective projections"><div class="sect3" id="perspective-projections">
<h3>Perspective projections</h3>

<p><a data-type="indexterm" data-primary="map projections" data-secondary="perspective" id="idm45026294126392"></a><a data-type="indexterm" data-primary="perspective projections" id="idm45026294125192"></a>Perspective projections are constructed using a particular choice of
perspective point, similar to if you photographed the Earth from a
particular point in space (a point which, for some projections,
technically lies within the Earth!). One common example is the
<a data-type="indexterm" data-primary="orthographic projection" id="idm45026294124120"></a>orthographic projection (<code>projection='ortho'</code>), which shows one side of
the globe as seen from a viewer at a very long distance. Thus, it can
show only half the globe at a time. Other perspective-based projections
include the gnomonic projection (<code>projection='gnom'</code>) and stereographic
projection (<code>projection='stere'</code>). These are often the most useful for
showing small portions of the map.</p>

<p>Here is an example of the orthographic projection (<a data-type="xref" href="#fig04106">Figure 4-106</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">7</code><code class="p">]:</code> <code class="n">fig</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">8</code><code class="p">,</code> <code class="mi">8</code><code class="p">))</code>
       <code class="n">m</code> <code class="o">=</code> <code class="n">Basemap</code><code class="p">(</code><code class="n">projection</code><code class="o">=</code><code class="s1">'ortho'</code><code class="p">,</code> <code class="n">resolution</code><code class="o">=</code><code class="bp">None</code><code class="p">,</code>
                   <code class="n">lat_0</code><code class="o">=</code><code class="mi">50</code><code class="p">,</code> <code class="n">lon_0</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code>
       <code class="n">draw_map</code><code class="p">(</code><code class="n">m</code><code class="p">);</code></pre>

<figure><div id="fig04106" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in106.png" alt="png" width="460" height="460">
<h6><span class="label">Figure 4-106. </span>The orthographic projection</h6>
</div></figure>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Conic projections"><div class="sect3" id="conic-projections">
<h3>Conic projections</h3>

<p><a data-type="indexterm" data-primary="conic projections" id="idm45026294091032"></a><a data-type="indexterm" data-primary="map projections" data-secondary="conic" id="idm45026294089928"></a>A conic projection projects the map onto a single cone, which is then
unrolled. This can lead to very good local properties, but regions far
from the focus point of the cone may become very distorted. One example
of this is the <a data-type="indexterm" data-primary="Lambert conformal conic projection" id="idm45026294056472"></a>Lambert conformal conic projection (<code>projection='lcc'</code>),
which we saw earlier in the map of North America. It projects the map onto
a cone arranged in such a way that two standard parallels (specified in
<code>Basemap</code> by <code>lat_1</code> and <code>lat_2</code>) have well-represented distances, with
scale decreasing between them and increasing outside of them. Other
useful conic projections are the equidistant conic (<code>projection='eqdc'</code>)
and the <a data-type="indexterm" data-primary="Albers equal-area projection" id="idm45026294053256"></a>Albers equal-area (<code>projection='aea'</code>) projection (<a data-type="xref" href="#fig04107">Figure 4-107</a>). Conic
projections, like perspective projections, tend to be good choices for
representing small to medium patches of the globe.</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">8</code><code class="p">]:</code> <code class="n">fig</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">8</code><code class="p">,</code> <code class="mi">8</code><code class="p">))</code>
       <code class="n">m</code> <code class="o">=</code> <code class="n">Basemap</code><code class="p">(</code><code class="n">projection</code><code class="o">=</code><code class="s1">'lcc'</code><code class="p">,</code> <code class="n">resolution</code><code class="o">=</code><code class="bp">None</code><code class="p">,</code>
                   <code class="n">lon_0</code><code class="o">=</code><code class="mi">0</code><code class="p">,</code> <code class="n">lat_0</code><code class="o">=</code><code class="mi">50</code><code class="p">,</code> <code class="n">lat_1</code><code class="o">=</code><code class="mi">45</code><code class="p">,</code> <code class="n">lat_2</code><code class="o">=</code><code class="mi">55</code><code class="p">,</code>
                   <code class="n">width</code><code class="o">=</code><code class="mf">1.6E7</code><code class="p">,</code> <code class="n">height</code><code class="o">=</code><code class="mf">1.2E7</code><code class="p">)</code>
       <code class="n">draw_map</code><code class="p">(</code><code class="n">m</code><code class="p">)</code></pre>

<figure><div id="fig04107" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in107.png" alt="png" width="460" height="349">
<h6><span class="label">Figure 4-107. </span>The Albers equal-area projection</h6>
</div></figure>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Other projections"><div class="sect3" id="other-projections">
<h3>Other projections</h3>

<p>If you’re going to do much with map-based visualizations, I encourage
you to read up on other available projections, along with their
properties, advantages, and disadvantages. Most likely, they are
available in the
<a href="http://matplotlib.org/basemap/users/mapsetup.html">Basemap package</a>. If
you dig deep enough into this topic, you’ll find an incredible subculture
of geo-viz geeks who will be ready to argue fervently in support of
their favorite projection for any given application!<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc103" id="idm45026293948056"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc102" id="idm45026293947384"></a></p>
</div></section>



</div></section>













<section data-type="sect2" data-pdf-bookmark="Drawing a Map Background"><div class="sect2" id="drawing-a-map-background">
<h2>Drawing a Map Background</h2>

<p><a data-type="indexterm" data-primary="geographic data" data-secondary="drawing a map background" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc104"></a>Earlier we saw the <code>bluemarble()</code> and <code>shadedrelief()</code> methods
for projecting global images on the map, as well as the
<code>drawparallels()</code> and <code>drawmeridians()</code> methods for drawing lines of
constant latitude and longitude. The Basemap package contains a range of
useful functions for drawing borders of physical features like
continents, oceans, lakes, and rivers, as well as political boundaries
such as countries and US states and counties. The following are some of
the available drawing functions that you may wish to explore using
IPython’s help features:</p>

<ul>
<li>
<p>Physical boundaries and bodies of water</p>
<dl>
<dt><code>drawcoastlines()</code></dt>
<dd>
<p>Draw continental coast lines</p>
</dd>
<dt><code>drawlsmask()</code></dt>
<dd>
<p>Draw a mask between the land and sea, for use with projecting images on one or the other</p>
</dd>
<dt><code>drawmapboundary()</code></dt>
<dd>
<p>Draw the map boundary, including the fill color for oceans</p>
</dd>
<dt><code>drawrivers()</code></dt>
<dd>
<p>Draw rivers on the map</p>
</dd>
<dt><code>fillcontinents()</code></dt>
<dd>
<p>Fill the continents with a given color; optionally fill lakes with another color</p>
</dd>
</dl>
</li>
<li>
<p>Political boundaries</p>
<dl>
<dt><code>drawcountries()</code></dt>
<dd>
<p>Draw country boundaries</p>
</dd>
<dt><code>drawstates()</code></dt>
<dd>
<p>Draw US state boundaries</p>
</dd>
<dt><code>drawcounties()</code></dt>
<dd>
<p>Draw US county boundaries</p>
</dd>
</dl>
</li>
<li>
<p>Map features</p>
<dl>
<dt><code>drawgreatcircle()</code></dt>
<dd>
<p>Draw a great circle between two points</p>
</dd>
<dt><code>drawparallels()</code></dt>
<dd>
<p>Draw lines of constant latitude</p>
</dd>
<dt><code>drawmeridians()</code></dt>
<dd>
<p>Draw lines of constant longitude</p>
</dd>
<dt><code>drawmapscale()</code></dt>
<dd>
<p>Draw a linear scale on the map</p>
</dd>
</dl>
</li>
<li>
<p>Whole-globe images</p>
<dl>
<dt><code>bluemarble()</code></dt>
<dd>
<p>Project NASA’s blue marble image onto the map</p>
</dd>
<dt><code>shadedrelief()</code></dt>
<dd>
<p>Project a shaded relief image onto the map</p>
</dd>
<dt><code>etopo()</code></dt>
<dd>
<p>Draw an etopo relief image onto the map</p>
</dd>
<dt><code>warpimage()</code></dt>
<dd>
<p>Project a user-provided image onto the map</p>
</dd>
</dl>
</li>
</ul>

<p>For the boundary-based features, you must set the desired resolution
when creating a Basemap image. The <code>resolution</code> argument of the
<code>Basemap</code> class sets the level of detail in boundaries, either <code>'c'</code>
(crude), <code>'l'</code> (low), <code>'i'</code> (intermediate), <code>'h'</code> (high), <code>'f'</code> (full),
or <code>None</code> if no boundaries will be used. This choice is important:
setting high-resolution boundaries on a global map, for example, can be
<em>very</em> slow.</p>

<p>Here’s an example of drawing land/sea boundaries, and the effect of the
resolution parameter. We’ll create both a low- and high-resolution map of
Scotland’s beautiful Isle of Skye. It’s located at 57.3°N, 6.2°W, and a
map of 90,000×120,000 kilometers shows it well (<a data-type="xref" href="#fig04108">Figure 4-108</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">9</code><code class="p">]:</code> <code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">12</code><code class="p">,</code> <code class="mi">8</code><code class="p">))</code>

       <code class="k">for</code> <code class="n">i</code><code class="p">,</code> <code class="n">res</code> <code class="ow">in</code> <code class="nb">enumerate</code><code class="p">([</code><code class="s1">'l'</code><code class="p">,</code> <code class="s1">'h'</code><code class="p">]):</code>
           <code class="n">m</code> <code class="o">=</code> <code class="n">Basemap</code><code class="p">(</code><code class="n">projection</code><code class="o">=</code><code class="s1">'gnom'</code><code class="p">,</code> <code class="n">lat_0</code><code class="o">=</code><code class="mf">57.3</code><code class="p">,</code> <code class="n">lon_0</code><code class="o">=-</code><code class="mf">6.2</code><code class="p">,</code>
                       <code class="n">width</code><code class="o">=</code><code class="mi">90000</code><code class="p">,</code> <code class="n">height</code><code class="o">=</code><code class="mi">120000</code><code class="p">,</code> <code class="n">resolution</code><code class="o">=</code><code class="n">res</code><code class="p">,</code> <code class="n">ax</code><code class="o">=</code><code class="n">ax</code><code class="p">[</code><code class="n">i</code><code class="p">])</code>
           <code class="n">m</code><code class="o">.</code><code class="n">fillcontinents</code><code class="p">(</code><code class="n">color</code><code class="o">=</code><code class="s2">"#FFDDCC"</code><code class="p">,</code> <code class="n">lake_color</code><code class="o">=</code><code class="s1">'#DDEEFF'</code><code class="p">)</code>
           <code class="n">m</code><code class="o">.</code><code class="n">drawmapboundary</code><code class="p">(</code><code class="n">fill_color</code><code class="o">=</code><code class="s2">"#DDEEFF"</code><code class="p">)</code>
           <code class="n">m</code><code class="o">.</code><code class="n">drawcoastlines</code><code class="p">()</code>
           <code class="n">ax</code><code class="p">[</code><code class="n">i</code><code class="p">]</code><code class="o">.</code><code class="n">set_title</code><code class="p">(</code><code class="s2">"resolution='{0}'"</code><code class="o">.</code><code class="n">format</code><code class="p">(</code><code class="n">res</code><code class="p">));</code></pre>

<figure><div id="fig04108" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in108.png" alt="png" width="683" height="435">
<h6><span class="label">Figure 4-108. </span>Map boundaries at low and high resolution</h6>
</div></figure>

<p>Notice that the low-resolution coastlines are not suitable for this
level of zoom, while high-resolution works just fine. The low level
would work just fine for a global view, however, and would be <em>much</em>
faster than loading the high-resolution border data for the entire
globe! It might require some experimentation to find the correct
resolution parameter for a given view; the best route is to start with a
fast, low-resolution plot and increase the resolution as needed.<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc104" id="idm45026293768440"></a></p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Plotting Data on Maps"><div class="sect2" id="plotting-data-on-maps">
<h2>Plotting Data on Maps</h2>

<p><a data-type="indexterm" data-primary="geographic data" data-secondary="plotting data on maps" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc105"></a><a data-type="indexterm" data-primary="plotting" data-secondary="data on maps" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc106"></a>Perhaps the most useful piece of the Basemap toolkit is the ability to
over-plot a variety of data onto a map background. For simple plotting
and text, any <code>plt</code> function works on the map; you can use the <code>Basemap</code>
instance to project latitude and longitude coordinates to <code>(x, y)</code>
coordinates for plotting with <code>plt</code>, as we saw earlier in the Seattle example.</p>

<p>In addition to this, there are many map-specific functions available
as methods of the <code>Basemap</code> instance. These work very similarly to their
standard Matplotlib counterparts, but have an additional Boolean
argument <code>latlon</code>, which if set to <code>True</code> allows you to pass raw
latitudes and longitudes to the method, rather than projected <code>(x, y)</code>
coordinates.</p>

<p>Some of these map-specific methods are:</p>
<dl>
<dt><code>contour()</code>/<code>contourf()</code></dt>
<dd>
<p>Draw contour lines or filled contours</p>
</dd>
<dt><code>imshow()</code></dt>
<dd>
<p>Draw an image</p>
</dd>
<dt><code>pcolor()</code>/<code>pcolormesh()</code></dt>
<dd>
<p>Draw a pseudocolor plot for irregular/regular meshes</p>
</dd>
<dt><code>plot()</code></dt>
<dd>
<p>Draw lines and/or markers</p>
</dd>
<dt><code>scatter()</code></dt>
<dd>
<p>Draw points with markers</p>
</dd>
<dt><code>quiver()</code></dt>
<dd>
<p>Draw vectors</p>
</dd>
<dt><code>barbs()</code></dt>
<dd>
<p>Draw wind barbs</p>
</dd>
<dt><code>drawgreatcircle()</code></dt>
<dd>
<p>Draw a great circle</p>
</dd>
</dl>

<p>We’ll see examples of a few of these as we continue. For more information on these functions, including several example plots, see the <a href="http://matplotlib.org/basemap/">online Basemap documentation</a>.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Example: California Cities"><div class="sect2" id="example-california-cities">
<h2>Example: California Cities</h2>

<p><a data-type="indexterm" data-primary="geographic data" data-secondary="California city population example" id="idm45026293742744"></a>Recall that in <a data-type="xref" href="#customizing-plot-legends">“Customizing Plot Legends”</a>, we demonstrated the use of size and color in a scatter plot to
convey information about the location, size, and population of
California cities. Here, we’ll create this plot again, but using Basemap
to put the data in context.</p>

<p>We start with loading the data, as we did before:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">10</code><code class="p">]:</code> <code class="kn">import</code> <code class="nn">pandas</code> <code class="kn">as</code> <code class="nn">pd</code>
        <code class="n">cities</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="s1">'data/california_cities.csv'</code><code class="p">)</code>

        <code class="c1"># Extract the data we're interested in</code>
        <code class="n">lat</code> <code class="o">=</code> <code class="n">cities</code><code class="p">[</code><code class="s1">'latd'</code><code class="p">]</code><code class="o">.</code><code class="n">values</code>
        <code class="n">lon</code> <code class="o">=</code> <code class="n">cities</code><code class="p">[</code><code class="s1">'longd'</code><code class="p">]</code><code class="o">.</code><code class="n">values</code>
        <code class="n">population</code> <code class="o">=</code> <code class="n">cities</code><code class="p">[</code><code class="s1">'population_total'</code><code class="p">]</code><code class="o">.</code><code class="n">values</code>
        <code class="n">area</code> <code class="o">=</code> <code class="n">cities</code><code class="p">[</code><code class="s1">'area_total_km2'</code><code class="p">]</code><code class="o">.</code><code class="n">values</code></pre>

<p>Next, we set up the map projection, scatter the data, and then create a
colorbar and legend (<a data-type="xref" href="#fig04109">Figure 4-109</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">11</code><code class="p">]:</code> <code class="c1"># 1. Draw the map background</code>
        <code class="n">fig</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">8</code><code class="p">,</code> <code class="mi">8</code><code class="p">))</code>
        <code class="n">m</code> <code class="o">=</code> <code class="n">Basemap</code><code class="p">(</code><code class="n">projection</code><code class="o">=</code><code class="s1">'lcc'</code><code class="p">,</code> <code class="n">resolution</code><code class="o">=</code><code class="s1">'h'</code><code class="p">,</code>
                    <code class="n">lat_0</code><code class="o">=</code><code class="mf">37.5</code><code class="p">,</code> <code class="n">lon_0</code><code class="o">=-</code><code class="mi">119</code><code class="p">,</code>
                    <code class="n">width</code><code class="o">=</code><code class="mf">1E6</code><code class="p">,</code> <code class="n">height</code><code class="o">=</code><code class="mf">1.2E6</code><code class="p">)</code>
        <code class="n">m</code><code class="o">.</code><code class="n">shadedrelief</code><code class="p">()</code>
        <code class="n">m</code><code class="o">.</code><code class="n">drawcoastlines</code><code class="p">(</code><code class="n">color</code><code class="o">=</code><code class="s1">'gray'</code><code class="p">)</code>
        <code class="n">m</code><code class="o">.</code><code class="n">drawcountries</code><code class="p">(</code><code class="n">color</code><code class="o">=</code><code class="s1">'gray'</code><code class="p">)</code>
        <code class="n">m</code><code class="o">.</code><code class="n">drawstates</code><code class="p">(</code><code class="n">color</code><code class="o">=</code><code class="s1">'gray'</code><code class="p">)</code>

        <code class="c1"># 2. scatter city data, with color reflecting population</code>
        <code class="c1"># and size reflecting area</code>
        <code class="n">m</code><code class="o">.</code><code class="n">scatter</code><code class="p">(</code><code class="n">lon</code><code class="p">,</code> <code class="n">lat</code><code class="p">,</code> <code class="n">latlon</code><code class="o">=</code><code class="bp">True</code><code class="p">,</code>
                  <code class="n">c</code><code class="o">=</code><code class="n">np</code><code class="o">.</code><code class="n">log10</code><code class="p">(</code><code class="n">population</code><code class="p">),</code> <code class="n">s</code><code class="o">=</code><code class="n">area</code><code class="p">,</code>
                  <code class="n">cmap</code><code class="o">=</code><code class="s1">'Reds'</code><code class="p">,</code> <code class="n">alpha</code><code class="o">=</code><code class="mf">0.5</code><code class="p">)</code>

        <code class="c1"># 3. create colorbar and legend</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">colorbar</code><code class="p">(</code><code class="n">label</code><code class="o">=</code><code class="s-Affix">r</code><code class="s1">'$\log_{10}({\rm population})$'</code><code class="p">)</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">clim</code><code class="p">(</code><code class="mi">3</code><code class="p">,</code> <code class="mi">7</code><code class="p">)</code>

        <code class="c1"># make legend with dummy points</code>
        <code class="k">for</code> <code class="n">a</code> <code class="ow">in</code> <code class="p">[</code><code class="mi">100</code><code class="p">,</code> <code class="mi">300</code><code class="p">,</code> <code class="mi">500</code><code class="p">]:</code>
            <code class="n">plt</code><code class="o">.</code><code class="n">scatter</code><code class="p">([],</code> <code class="p">[],</code> <code class="n">c</code><code class="o">=</code><code class="s1">'k'</code><code class="p">,</code> <code class="n">alpha</code><code class="o">=</code><code class="mf">0.5</code><code class="p">,</code> <code class="n">s</code><code class="o">=</code><code class="n">a</code><code class="p">,</code>
                        <code class="n">label</code><code class="o">=</code><code class="nb">str</code><code class="p">(</code><code class="n">a</code><code class="p">)</code> <code class="o">+</code> <code class="s1">' km$^2$'</code><code class="p">)</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="n">scatterpoints</code><code class="o">=</code><code class="mi">1</code><code class="p">,</code> <code class="n">frameon</code><code class="o">=</code><code class="bp">False</code><code class="p">,</code>
                   <code class="n">labelspacing</code><code class="o">=</code><code class="mi">1</code><code class="p">,</code> <code class="n">loc</code><code class="o">=</code><code class="s1">'lower left'</code><code class="p">);</code></pre>

<figure><div id="fig04109" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in109.png" alt="png" width="456" height="470">
<h6><span class="label">Figure 4-109. </span>Scatter plot over a map background</h6>
</div></figure>

<p>This shows us roughly where larger populations of people have settled in
California: they are clustered near the coast in the Los Angeles and San
Francisco areas, stretched along the highways in the flat central
valley, and avoiding almost completely the mountainous regions along the
borders of the state.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Example: Surface Temperature Data"><div class="sect2" id="example-surface-temperature-data">
<h2>Example: Surface Temperature Data</h2>

<p><a data-type="indexterm" data-primary="geographic data" data-secondary="surface temperature data example" id="idm45026293381192"></a>As an example of visualizing some more continuous geographic data, let’s consider the “polar vortex” that hit the eastern half of the
United States in January 2014. A great source for any sort of
climatic data is <a href="http://data.giss.nasa.gov/">NASA’s Goddard Institute for Space Studies</a>. Here we’ll use the GIS 250 temperature data,
which we can download using shell commands (these commands may have to
be modified on Windows machines). The data used here was downloaded on
6/12/2016, and the file size is approximately 9 MB:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">12</code><code class="p">]:</code> <code class="c1"># !curl -O http://data.giss.nasa.gov/pub/gistemp/gistemp250.nc.gz</code>
        <code class="c1"># !gunzip gistemp250.nc.gz</code></pre>

<p>The data comes in NetCDF format, which can be read in Python by the
<code>netCDF4</code> library. You can install this library as shown here:</p>

<pre data-type="programlisting">$ conda install netcdf4</pre>

<p class="pagebreak-before">We read the data as follows:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">13</code><code class="p">]:</code> <code class="kn">from</code> <code class="nn">netCDF4</code> <code class="kn">import</code> <code class="n">Dataset</code>
        <code class="n">data</code> <code class="o">=</code> <code class="n">Dataset</code><code class="p">(</code><code class="s1">'gistemp250.nc'</code><code class="p">)</code></pre>

<p>The file contains many global temperature readings on a variety of
dates; we need to select the index of the date we’re interested in—in
this case, January 15, 2014:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">14</code><code class="p">]:</code> <code class="kn">from</code> <code class="nn">netCDF4</code> <code class="kn">import</code> <code class="n">date2index</code>
        <code class="kn">from</code> <code class="nn">datetime</code> <code class="kn">import</code> <code class="n">datetime</code>
        <code class="n">timeindex</code> <code class="o">=</code> <code class="n">date2index</code><code class="p">(</code><code class="n">datetime</code><code class="p">(</code><code class="mi">2014</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">15</code><code class="p">),</code>
                               <code class="n">data</code><code class="o">.</code><code class="n">variables</code><code class="p">[</code><code class="s1">'time'</code><code class="p">])</code></pre>

<p>Now we can load the latitude and longitude data, as well as the
temperature anomaly for this index:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">15</code><code class="p">]:</code> <code class="n">lat</code> <code class="o">=</code> <code class="n">data</code><code class="o">.</code><code class="n">variables</code><code class="p">[</code><code class="s1">'lat'</code><code class="p">][:]</code>
        <code class="n">lon</code> <code class="o">=</code> <code class="n">data</code><code class="o">.</code><code class="n">variables</code><code class="p">[</code><code class="s1">'lon'</code><code class="p">][:]</code>
        <code class="n">lon</code><code class="p">,</code> <code class="n">lat</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">meshgrid</code><code class="p">(</code><code class="n">lon</code><code class="p">,</code> <code class="n">lat</code><code class="p">)</code>
        <code class="n">temp_anomaly</code> <code class="o">=</code> <code class="n">data</code><code class="o">.</code><code class="n">variables</code><code class="p">[</code><code class="s1">'tempanomaly'</code><code class="p">][</code><code class="n">timeindex</code><code class="p">]</code></pre>

<p>Finally, we’ll use the <code>pcolormesh()</code> method to draw a color mesh of the
data. We’ll look at North America, and use a shaded relief map in the
background. Note that for this data we specifically chose a divergent
colormap, which has a neutral color at zero and two contrasting colors
at negative and positive values (<a data-type="xref" href="#fig04110">Figure 4-110</a>). We’ll also lightly draw the coastlines
over the colors for reference:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">16</code><code class="p">]:</code> <code class="n">fig</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code> <code class="mi">8</code><code class="p">))</code>
        <code class="n">m</code> <code class="o">=</code> <code class="n">Basemap</code><code class="p">(</code><code class="n">projection</code><code class="o">=</code><code class="s1">'lcc'</code><code class="p">,</code> <code class="n">resolution</code><code class="o">=</code><code class="s1">'c'</code><code class="p">,</code>
                    <code class="n">width</code><code class="o">=</code><code class="mf">8E6</code><code class="p">,</code> <code class="n">height</code><code class="o">=</code><code class="mf">8E6</code><code class="p">,</code>
                    <code class="n">lat_0</code><code class="o">=</code><code class="mi">45</code><code class="p">,</code> <code class="n">lon_0</code><code class="o">=-</code><code class="mi">100</code><code class="p">,)</code>
        <code class="n">m</code><code class="o">.</code><code class="n">shadedrelief</code><code class="p">(</code><code class="n">scale</code><code class="o">=</code><code class="mf">0.5</code><code class="p">)</code>
        <code class="n">m</code><code class="o">.</code><code class="n">pcolormesh</code><code class="p">(</code><code class="n">lon</code><code class="p">,</code> <code class="n">lat</code><code class="p">,</code> <code class="n">temp_anomaly</code><code class="p">,</code>
                     <code class="n">latlon</code><code class="o">=</code><code class="bp">True</code><code class="p">,</code> <code class="n">cmap</code><code class="o">=</code><code class="s1">'RdBu_r'</code><code class="p">)</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">clim</code><code class="p">(</code><code class="o">-</code><code class="mi">8</code><code class="p">,</code> <code class="mi">8</code><code class="p">)</code>
        <code class="n">m</code><code class="o">.</code><code class="n">drawcoastlines</code><code class="p">(</code><code class="n">color</code><code class="o">=</code><code class="s1">'lightgray'</code><code class="p">)</code>

        <code class="n">plt</code><code class="o">.</code><code class="n">title</code><code class="p">(</code><code class="s1">'January 2014 Temperature Anomaly'</code><code class="p">)</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">colorbar</code><code class="p">(</code><code class="n">label</code><code class="o">=</code><code class="s1">'temperature anomaly (°C)'</code><code class="p">);</code></pre>

<p>The data paints a picture of the localized, extreme temperature
anomalies that happened during that month. The eastern half of the United States
was much colder than normal, while the western half and Alaska were much
warmer. Regions with no recorded temperature show the map background.</p>

<figure><div id="fig04110" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in110.png" alt="png" width="544" height="480">
<h6><span class="label">Figure 4-110. </span>The temperature anomaly in January 2014</h6>
</div></figure>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Visualization with Seaborn"><div class="sect1" id="visualization-with-seaborn">
<h1>Visualization with Seaborn</h1>

<p><a data-type="indexterm" data-primary="plotting" data-secondary="Seaborn" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc107"></a><a data-type="indexterm" data-primary="Seaborn" data-secondary="visualization with" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc108"></a>Matplotlib has proven to be an incredibly useful and popular
visualization tool, but even avid users will admit it often leaves much
to be desired. <a data-type="indexterm" data-primary="Matplotlib" data-secondary="Seaborn vs." id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc109"></a><a data-type="indexterm" data-primary="Seaborn" data-secondary="Matplotlib vs." id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc110"></a>There are several valid complaints about Matplotlib that
often come up:</p>

<ul>
<li>
<p>Prior to version 2.0, Matplotlib’s defaults are not exactly the best
choices. It was based off of MATLAB circa 1999, and this often shows.</p>
</li>
<li>
<p>Matplotlib’s API is relatively low level. Doing sophisticated
statistical visualization is possible, but often requires a <em>lot</em> of
boilerplate code.</p>
</li>
<li>
<p>Matplotlib predated Pandas by more than a decade, and thus is not
designed for use with Pandas <code>DataFrame</code>s. In order to visualize data from
a Pandas <code>DataFrame</code>, you must extract each <code>Series</code> and often concatenate
them together into the right format. It would be nicer to have
a plotting library that can intelligently use the <code>DataFrame</code> labels in a
plot.</p>
</li>
</ul>

<p>An answer to these problems is
<a href="http://seaborn.pydata.org">Seaborn</a>. Seaborn
provides an API on top of Matplotlib that offers sane choices for plot
style and color defaults, defines simple high-level functions for common
statistical plot types, and integrates with the functionality
provided by Pandas <code>DataFrame</code>s.</p>

<p>To be fair, the Matplotlib team is addressing this: it has recently
added the <code>plt.style</code> tools (discussed in
<a data-type="xref" href="#customizing-matplotlib-configurations-and-style-sheets">“Customizing Matplotlib: Configurations and Stylesheets”</a>), and is starting to handle Pandas data
more seamlessly. The 2.0 release of the library will include a new
default stylesheet that will improve on the current status quo. But for
all the reasons just discussed, Seaborn remains an extremely useful
<span class="keep-together">add-on</span>.</p>








<section data-type="sect2" data-pdf-bookmark="Seaborn Versus Matplotlib"><div class="sect2" id="seaborn-vs.-matplotlib">
<h2>Seaborn Versus Matplotlib</h2>

<p>Here is an example of a simple random-walk plot in Matplotlib, using its
classic plot formatting and colors. We start with the typical imports:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">1</code><code class="p">]:</code> <code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="kn">as</code> <code class="nn">plt</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">use</code><code class="p">(</code><code class="s1">'classic'</code><code class="p">)</code>
       <code class="o">%</code><code class="n">matplotlib</code> <code class="n">inline</code>
       <code class="kn">import</code> <code class="nn">numpy</code> <code class="kn">as</code> <code class="nn">np</code>
       <code class="kn">import</code> <code class="nn">pandas</code> <code class="kn">as</code> <code class="nn">pd</code></pre>

<p>Now we create some random walk data:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">2</code><code class="p">]:</code> <code class="c1"># Create some data</code>
       <code class="n">rng</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">RandomState</code><code class="p">(</code><code class="mi">0</code><code class="p">)</code>
       <code class="n">x</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">10</code><code class="p">,</code> <code class="mi">500</code><code class="p">)</code>
       <code class="n">y</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">cumsum</code><code class="p">(</code><code class="n">rng</code><code class="o">.</code><code class="n">randn</code><code class="p">(</code><code class="mi">500</code><code class="p">,</code> <code class="mi">6</code><code class="p">),</code> <code class="mi">0</code><code class="p">)</code></pre>

<p>And do a simple plot (<a data-type="xref" href="#fig04111">Figure 4-111</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">3</code><code class="p">]:</code> <code class="c1"># Plot the data with Matplotlib defaults</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="s1">'ABCDEF'</code><code class="p">,</code> <code class="n">ncol</code><code class="o">=</code><code class="mi">2</code><code class="p">,</code> <code class="n">loc</code><code class="o">=</code><code class="s1">'upper left'</code><code class="p">);</code></pre>

<figure><div id="fig04111" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in111.png" alt="png" width="380" height="256">
<h6><span class="label">Figure 4-111. </span>Data in Matplotlib’s default style</h6>
</div></figure>

<p>Although the result contains all the information we’d like it to convey,
it does so in a way that is not all that aesthetically pleasing, and
even looks a bit old-fashioned in the context of 21st-century data
visualization.</p>

<p>Now let’s take a look at how it works with Seaborn. As we will see, Seaborn has many of its
own high-level plotting routines, but it can also overwrite Matplotlib’s default parameters and in turn get even simple Matplotlib scripts to produce vastly superior output.
We can set the style by calling Seaborn’s <code>set()</code> method. By convention,
Seaborn is imported as <code>sns</code>:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">4</code><code class="p">]:</code> <code class="kn">import</code> <code class="nn">seaborn</code> <code class="kn">as</code> <code class="nn">sns</code>
       <code class="n">sns</code><code class="o">.</code><code class="n">set</code><code class="p">()</code></pre>

<p>Now let’s rerun the same two lines as before (<a data-type="xref" href="#fig04112">Figure 4-112</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">5</code><code class="p">]:</code> <code class="c1"># same plotting code as above!</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">)</code>
       <code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="s1">'ABCDEF'</code><code class="p">,</code> <code class="n">ncol</code><code class="o">=</code><code class="mi">2</code><code class="p">,</code> <code class="n">loc</code><code class="o">=</code><code class="s1">'upper left'</code><code class="p">);</code></pre>

<figure><div id="fig04112" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in112.png" alt="png" width="495" height="343">
<h6><span class="label">Figure 4-112. </span>Data in Seaborn’s default style</h6>
</div></figure>

<p>Ah, much better<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc110" id="idm45026292748696"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc109" id="idm45026292747992"></a>!<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc108" id="idm45026292747224"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc107" id="idm45026292746552"></a></p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Exploring Seaborn Plots"><div class="sect2" id="exploring-seaborn-plots">
<h2>Exploring Seaborn Plots</h2>

<p><a data-type="indexterm" data-primary="Seaborn" data-secondary="datasets and plot types" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc111"></a>The main idea of Seaborn is that it provides high-level commands to
create a variety of plot types useful for statistical data exploration,
and even some statistical model <span class="keep-together">fitting</span>.</p>

<p>Let’s take a look at a few of the datasets and plot types available in
Seaborn. Note that all of the following <em>could</em> be done using raw
Matplotlib commands (this is, in fact, what Seaborn does under the hood),
but the Seaborn API is much more convenient.</p>










<section data-type="sect3" data-pdf-bookmark="Histograms, KDE, and densities"><div class="sect3" id="histograms-kde-and-densities">
<h3>Histograms, KDE, and densities</h3>

<p><a data-type="indexterm" data-primary="histograms" data-secondary="Seaborn" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc112"></a><a data-type="indexterm" data-primary="Seaborn" data-secondary="histograms, KDE, and densities" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc113"></a>Often in statistical data visualization, all you want is to plot
histograms and joint distributions of variables. We have seen that this
is relatively straightforward in Matplotlib (<a data-type="xref" href="#fig04113">Figure 4-113</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">6</code><code class="p">]:</code> <code class="n">data</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">multivariate_normal</code><code class="p">([</code><code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">],</code> <code class="p">[[</code><code class="mi">5</code><code class="p">,</code> <code class="mi">2</code><code class="p">],</code> <code class="p">[</code><code class="mi">2</code><code class="p">,</code> <code class="mi">2</code><code class="p">]],</code> <code class="n">size</code><code class="o">=</code><code class="mi">2000</code><code class="p">)</code>
       <code class="n">data</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="n">data</code><code class="p">,</code> <code class="n">columns</code><code class="o">=</code><code class="p">[</code><code class="s1">'x'</code><code class="p">,</code> <code class="s1">'y'</code><code class="p">])</code>

       <code class="k">for</code> <code class="n">col</code> <code class="ow">in</code> <code class="s1">'xy'</code><code class="p">:</code>
           <code class="n">plt</code><code class="o">.</code><code class="n">hist</code><code class="p">(</code><code class="n">data</code><code class="p">[</code><code class="n">col</code><code class="p">],</code> <code class="n">normed</code><code class="o">=</code><code class="bp">True</code><code class="p">,</code> <code class="n">alpha</code><code class="o">=</code><code class="mf">0.5</code><code class="p">)</code></pre>

<figure><div id="fig04113" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in113.png" alt="png" width="496" height="343">
<h6><span class="label">Figure 4-113. </span>Histograms for visualizing distributions</h6>
</div></figure>

<p><a data-type="indexterm" data-primary="kernel density estimation (KDE)" data-secondary="Seaborn" id="idm45026292637048"></a>Rather than a histogram, we can get a smooth estimate of the
distribution using a kernel density estimation, which Seaborn does with
<code>sns.kdeplot</code> (<a data-type="xref" href="#fig04114">Figure 4-114</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">7</code><code class="p">]:</code> <code class="k">for</code> <code class="n">col</code> <code class="ow">in</code> <code class="s1">'xy'</code><code class="p">:</code>
           <code class="n">sns</code><code class="o">.</code><code class="n">kdeplot</code><code class="p">(</code><code class="n">data</code><code class="p">[</code><code class="n">col</code><code class="p">],</code> <code class="n">shade</code><code class="o">=</code><code class="bp">True</code><code class="p">)</code></pre>

<figure><div id="fig04114" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in114.png" alt="png" width="496" height="343">
<h6><span class="label">Figure 4-114. </span>Kernel density estimates for visualizing distributions</h6>
</div></figure>

<p>Histograms and KDE can be combined using <code>distplot</code> (<a data-type="xref" href="#fig04115">Figure 4-115</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">8</code><code class="p">]:</code> <code class="n">sns</code><code class="o">.</code><code class="n">distplot</code><code class="p">(</code><code class="n">data</code><code class="p">[</code><code class="s1">'x'</code><code class="p">])</code>
       <code class="n">sns</code><code class="o">.</code><code class="n">distplot</code><code class="p">(</code><code class="n">data</code><code class="p">[</code><code class="s1">'y'</code><code class="p">]);</code></pre>

<figure><div id="fig04115" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in115.png" alt="png" width="496" height="358">
<h6><span class="label">Figure 4-115. </span>Kernel density and histograms plotted together</h6>
</div></figure>

<p>If we pass the full two-dimensional dataset to <code>kdeplot</code>, we will get a
two-dimensional visualization of the data (<a data-type="xref" href="#fig04116">Figure 4-116</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">9</code><code class="p">]:</code> <code class="n">sns</code><code class="o">.</code><code class="n">kdeplot</code><code class="p">(</code><code class="n">data</code><code class="p">);</code></pre>

<figure><div id="fig04116" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in116.png" alt="png" width="482" height="338">
<h6><span class="label">Figure 4-116. </span>A two-dimensional kernel density plot</h6>
</div></figure>

<p><a data-type="indexterm" data-primary="joint distributions" id="idm45026292522872"></a>We can see the joint distribution and the marginal distributions
together using <code>sns.jointplot</code>. For this plot, we’ll set the style to a
white background (<a data-type="xref" href="#fig04117">Figure 4-117</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">10</code><code class="p">]:</code> <code class="k">with</code> <code class="n">sns</code><code class="o">.</code><code class="n">axes_style</code><code class="p">(</code><code class="s1">'white'</code><code class="p">):</code>
            <code class="n">sns</code><code class="o">.</code><code class="n">jointplot</code><code class="p">(</code><code class="s2">"x"</code><code class="p">,</code> <code class="s2">"y"</code><code class="p">,</code> <code class="n">data</code><code class="p">,</code> <code class="n">kind</code><code class="o">=</code><code class="s1">'kde'</code><code class="p">);</code></pre>

<figure><div id="fig04117" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in117.png" alt="png" width="420" height="422">
<h6><span class="label">Figure 4-117. </span>A joint distribution plot with a two-dimensional kernel density estimate</h6>
</div></figure>

<p class="pagebreak-before">There are other parameters that can be passed to <code>jointplot</code>—for
example, we can use a hexagonally based histogram instead (<a data-type="xref" href="#fig04118">Figure 4-118</a>):<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc113" id="idm45026292432776"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc112" id="idm45026292432104"></a></p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">11</code><code class="p">]:</code> <code class="k">with</code> <code class="n">sns</code><code class="o">.</code><code class="n">axes_style</code><code class="p">(</code><code class="s1">'white'</code><code class="p">):</code>
            <code class="n">sns</code><code class="o">.</code><code class="n">jointplot</code><code class="p">(</code><code class="s2">"x"</code><code class="p">,</code> <code class="s2">"y"</code><code class="p">,</code> <code class="n">data</code><code class="p">,</code> <code class="n">kind</code><code class="o">=</code><code class="s1">'hex'</code><code class="p">)</code></pre>

<figure><div id="fig04118" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in118.png" alt="png" width="420" height="422">
<h6><span class="label">Figure 4-118. </span>A joint distribution plot with a hexagonal bin representation</h6>
</div></figure>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Pair plots"><div class="sect3" id="pairplots">
<h3>Pair plots</h3>

<p><a data-type="indexterm" data-primary="pair plots" id="idm45026292385512"></a><a data-type="indexterm" data-primary="plotting" data-secondary="pair plots" id="idm45026292384808"></a><a data-type="indexterm" data-primary="Seaborn" data-secondary="pair plots" id="idm45026292383864"></a>When you generalize joint plots to datasets of larger dimensions, you
end up with <em>pair plots</em>. This is very useful for exploring correlations
between multidimensional data, when you’d like to plot all pairs of
values against each other.</p>

<p><a data-type="indexterm" data-primary="Iris dataset" data-secondary="pair plots" id="idm45026292381960"></a>We’ll demo this with the well-known Iris dataset, which lists
measurements of petals and sepals of three iris species:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">12</code><code class="p">]:</code> <code class="n">iris</code> <code class="o">=</code> <code class="n">sns</code><code class="o">.</code><code class="n">load_dataset</code><code class="p">(</code><code class="s2">"iris"</code><code class="p">)</code>
        <code class="n">iris</code><code class="o">.</code><code class="n">head</code><code class="p">()</code></pre>

<pre data-type="programlisting">Out[12]:    sepal_length  sepal_width  petal_length  petal_width species
         0           5.1          3.5           1.4          0.2  setosa
         1           4.9          3.0           1.4          0.2  setosa
         2           4.7          3.2           1.3          0.2  setosa
         3           4.6          3.1           1.5          0.2  setosa
         4           5.0          3.6           1.4          0.2  setosa</pre>

<p class="pagebreak-before">Visualizing the multidimensional relationships among the samples is as
easy as calling <code>sns.pairplot</code> (<a data-type="xref" href="#fig04119">Figure 4-119</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">13</code><code class="p">]:</code> <code class="n">sns</code><code class="o">.</code><code class="n">pairplot</code><code class="p">(</code><code class="n">iris</code><code class="p">,</code> <code class="n">hue</code><code class="o">=</code><code class="s1">'species'</code><code class="p">,</code> <code class="n">size</code><code class="o">=</code><code class="mf">2.5</code><code class="p">);</code></pre>

<figure><div id="fig04119" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in119.png" alt="png" width="804" height="710">
<h6><span class="label">Figure 4-119. </span>A pair plot showing the relationships between four variables</h6>
</div></figure>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Faceted histograms"><div class="sect3" id="faceted-histograms">
<h3>Faceted histograms</h3>

<p><a data-type="indexterm" data-primary="faceted histograms" id="idm45026292328408"></a><a data-type="indexterm" data-primary="histograms" data-secondary="faceted" id="idm45026292327704"></a><a data-type="indexterm" data-primary="Seaborn" data-secondary="faceted histograms" id="idm45026292326760"></a><a data-type="indexterm" data-primary="subsets, faceted histograms" id="idm45026292325816"></a>Sometimes the best way to view data is via histograms of subsets.
Seaborn’s <code>FacetGrid</code> makes this extremely simple. We’ll take a look at
some data that shows the amount that restaurant staff receive in tips
based on various indicator data (<a data-type="xref" href="#fig04120">Figure 4-120</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">14</code><code class="p">]:</code> <code class="n">tips</code> <code class="o">=</code> <code class="n">sns</code><code class="o">.</code><code class="n">load_dataset</code><code class="p">(</code><code class="s1">'tips'</code><code class="p">)</code>
        <code class="n">tips</code><code class="o">.</code><code class="n">head</code><code class="p">()</code></pre>

<pre data-type="programlisting">Out[14]:    total_bill   tip     sex smoker  day    time  size
         0       16.99  1.01  Female     No  Sun  Dinner     2
         1       10.34  1.66    Male     No  Sun  Dinner     3
         2       21.01  3.50    Male     No  Sun  Dinner     3
         3       23.68  3.31    Male     No  Sun  Dinner     2
         4       24.59  3.61  Female     No  Sun  Dinner     4</pre>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">15</code><code class="p">]:</code> <code class="n">tips</code><code class="p">[</code><code class="s1">'tip_pct'</code><code class="p">]</code> <code class="o">=</code> <code class="mi">100</code> <code class="o">*</code> <code class="n">tips</code><code class="p">[</code><code class="s1">'tip'</code><code class="p">]</code> <code class="o">/</code> <code class="n">tips</code><code class="p">[</code><code class="s1">'total_bill'</code><code class="p">]</code>

        <code class="n">grid</code> <code class="o">=</code> <code class="n">sns</code><code class="o">.</code><code class="n">FacetGrid</code><code class="p">(</code><code class="n">tips</code><code class="p">,</code> <code class="n">row</code><code class="o">=</code><code class="s2">"sex"</code><code class="p">,</code> <code class="n">col</code><code class="o">=</code><code class="s2">"time"</code><code class="p">,</code> <code class="n">margin_titles</code><code class="o">=</code><code class="bp">True</code><code class="p">)</code>
        <code class="n">grid</code><code class="o">.</code><code class="n">map</code><code class="p">(</code><code class="n">plt</code><code class="o">.</code><code class="n">hist</code><code class="p">,</code> <code class="s2">"tip_pct"</code><code class="p">,</code> <code class="n">bins</code><code class="o">=</code><code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">40</code><code class="p">,</code> <code class="mi">15</code><code class="p">));</code></pre>

<figure><div id="fig04120" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in120.png" alt="png" width="427" height="423">
<h6><span class="label">Figure 4-120. </span>An example of a faceted histogram</h6>
</div></figure>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Factor plots"><div class="sect3" id="factor-plots">
<h3>Factor plots</h3>

<p><a data-type="indexterm" data-primary="factor plots" id="idm45026292165544"></a><a data-type="indexterm" data-primary="plotting" data-secondary="factor plots" id="idm45026292164840"></a><a data-type="indexterm" data-primary="Seaborn" data-secondary="factor plots" id="idm45026292163896"></a>Factor plots can be useful for this kind of visualization as well. This
allows you to view the distribution of a parameter within bins defined
by any other parameter (<a data-type="xref" href="#fig04121">Figure 4-121</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">16</code><code class="p">]:</code> <code class="k">with</code> <code class="n">sns</code><code class="o">.</code><code class="n">axes_style</code><code class="p">(</code><code class="n">style</code><code class="o">=</code><code class="s1">'ticks'</code><code class="p">):</code>
            <code class="n">g</code> <code class="o">=</code> <code class="n">sns</code><code class="o">.</code><code class="n">factorplot</code><code class="p">(</code><code class="s2">"day"</code><code class="p">,</code> <code class="s2">"total_bill"</code><code class="p">,</code> <code class="s2">"sex"</code><code class="p">,</code> <code class="n">data</code><code class="o">=</code><code class="n">tips</code><code class="p">,</code> <code class="n">kind</code><code class="o">=</code><code class="s2">"box"</code><code class="p">)</code>
            <code class="n">g</code><code class="o">.</code><code class="n">set_axis_labels</code><code class="p">(</code><code class="s2">"Day"</code><code class="p">,</code> <code class="s2">"Total Bill"</code><code class="p">);</code></pre>

<figure><div id="fig04121" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in121.png" alt="png" width="344" height="278">
<h6><span class="label">Figure 4-121. </span>An example of a factor plot, comparing distributions given various discrete factors</h6>
</div></figure>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Joint distributions"><div class="sect3" id="joint-distributions">
<h3>Joint distributions</h3>

<p><a data-type="indexterm" data-primary="joint distributions" id="idm45026292070264"></a><a data-type="indexterm" data-primary="plotting" data-secondary="joint distributions" id="idm45026292069560"></a><a data-type="indexterm" data-primary="Seaborn" data-secondary="joint distributions" id="idm45026292068616"></a>Similar to the pair plot we saw earlier, we can use <code>sns.jointplot</code> to show
the joint distribution between different datasets, along with the
associated marginal distributions (<a data-type="xref" href="#fig04122">Figure 4-122</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">17</code><code class="p">]:</code> <code class="k">with</code> <code class="n">sns</code><code class="o">.</code><code class="n">axes_style</code><code class="p">(</code><code class="s1">'white'</code><code class="p">):</code>
            <code class="n">sns</code><code class="o">.</code><code class="n">jointplot</code><code class="p">(</code><code class="s2">"total_bill"</code><code class="p">,</code> <code class="s2">"tip"</code><code class="p">,</code> <code class="n">data</code><code class="o">=</code><code class="n">tips</code><code class="p">,</code> <code class="n">kind</code><code class="o">=</code><code class="s1">'hex'</code><code class="p">)</code></pre>

<figure><div id="fig04122" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in122.png" alt="png" width="418" height="422">
<h6><span class="label">Figure 4-122. </span>A joint distribution plot</h6>
</div></figure>

<p>The joint plot can even do some automatic kernel density estimation and
regression (<a data-type="xref" href="#fig04123">Figure 4-123</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">18</code><code class="p">]:</code> <code class="n">sns</code><code class="o">.</code><code class="n">jointplot</code><code class="p">(</code><code class="s2">"total_bill"</code><code class="p">,</code> <code class="s2">"tip"</code><code class="p">,</code> <code class="n">data</code><code class="o">=</code><code class="n">tips</code><code class="p">,</code> <code class="n">kind</code><code class="o">=</code><code class="s1">'reg'</code><code class="p">);</code></pre>

<figure><div id="fig04123" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in123.png" alt="png" width="420" height="422">
<h6><span class="label">Figure 4-123. </span>A joint distribution plot with a regression fit</h6>
</div></figure>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Bar plots"><div class="sect3" id="bar-plots">
<h3>Bar plots</h3>

<p><a data-type="indexterm" data-primary="bar plots" id="idm45026291953160"></a><a data-type="indexterm" data-primary="Planets dataset" data-secondary="bar plots" id="idm45026291952232"></a><a data-type="indexterm" data-primary="plotting" data-secondary="bar plots" id="idm45026291951288"></a><a data-type="indexterm" data-primary="Seaborn" data-secondary="bar plots" id="idm45026291950344"></a><a data-type="indexterm" data-primary="time series" data-secondary="bar plots" id="idm45026291949400"></a>Time series can be plotted with <code>sns.factorplot</code>. In the following example (visualized in <a data-type="xref" href="#fig04124">Figure 4-124</a>), we’ll use the Planets data that we first saw in
<a data-type="xref" href="ch03.html#aggregation-and-grouping-pandas">“Aggregation and Grouping”</a>:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">19</code><code class="p">]:</code> <code class="n">planets</code> <code class="o">=</code> <code class="n">sns</code><code class="o">.</code><code class="n">load_dataset</code><code class="p">(</code><code class="s1">'planets'</code><code class="p">)</code>
        <code class="n">planets</code><code class="o">.</code><code class="n">head</code><code class="p">()</code></pre>

<pre data-type="programlisting">Out[19]:             method  number  orbital_period   mass  distance  year
         0  Radial Velocity       1         269.300   7.10     77.40  2006
         1  Radial Velocity       1         874.774   2.21     56.95  2008
         2  Radial Velocity       1         763.000   2.60     19.84  2011
         3  Radial Velocity       1         326.030  19.40    110.62  2007
         4  Radial Velocity       1         516.220  10.50    119.47  2009</pre>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">20</code><code class="p">]:</code> <code class="k">with</code> <code class="n">sns</code><code class="o">.</code><code class="n">axes_style</code><code class="p">(</code><code class="s1">'white'</code><code class="p">):</code>
            <code class="n">g</code> <code class="o">=</code> <code class="n">sns</code><code class="o">.</code><code class="n">factorplot</code><code class="p">(</code><code class="s2">"year"</code><code class="p">,</code> <code class="n">data</code><code class="o">=</code><code class="n">planets</code><code class="p">,</code> <code class="n">aspect</code><code class="o">=</code><code class="mi">2</code><code class="p">,</code>
                               <code class="n">kind</code><code class="o">=</code><code class="s2">"count"</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s1">'steelblue'</code><code class="p">)</code>
            <code class="n">g</code><code class="o">.</code><code class="n">set_xticklabels</code><code class="p">(</code><code class="n">step</code><code class="o">=</code><code class="mi">5</code><code class="p">)</code></pre>

<figure><div id="fig04124" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in124.png" alt="png" width="577" height="278">
<h6><span class="label">Figure 4-124. </span>A histogram as a special case of a factor plot</h6>
</div></figure>

<p>We can learn more by looking at the <em>method</em> of discovery of each of
these planets, as illustrated in <a data-type="xref" href="#fig04125">Figure 4-125</a>:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">21</code><code class="p">]:</code> <code class="k">with</code> <code class="n">sns</code><code class="o">.</code><code class="n">axes_style</code><code class="p">(</code><code class="s1">'white'</code><code class="p">):</code>
            <code class="n">g</code> <code class="o">=</code> <code class="n">sns</code><code class="o">.</code><code class="n">factorplot</code><code class="p">(</code><code class="s2">"year"</code><code class="p">,</code> <code class="n">data</code><code class="o">=</code><code class="n">planets</code><code class="p">,</code> <code class="n">aspect</code><code class="o">=</code><code class="mf">4.0</code><code class="p">,</code> <code class="n">kind</code><code class="o">=</code><code class="s1">'count'</code><code class="p">,</code>
                               <code class="n">hue</code><code class="o">=</code><code class="s1">'method'</code><code class="p">,</code> <code class="n">order</code><code class="o">=</code><code class="nb">range</code><code class="p">(</code><code class="mi">2001</code><code class="p">,</code> <code class="mi">2015</code><code class="p">))</code>
            <code class="n">g</code><code class="o">.</code><code class="n">set_ylabels</code><code class="p">(</code><code class="s1">'Number of Planets Discovered'</code><code class="p">)</code></pre>

<figure><div id="fig04125" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in125.png" alt="png" width="1342" height="278">
<h6><span class="label">Figure 4-125. </span>Number of planets discovered by year and type (see the <a href="https://github.com/jakevdp/PythonDataScienceHandbook">online appendix</a> for a full-scale figure)</h6>
</div></figure>

<p>For more information on plotting with Seaborn, see the
<a href="http://seaborn.pydata.org">Seaborn documentation</a>, <a href="http://stanford.edu/~mwaskom/software/seaborn/tutorial.htm">a tutorial</a>, and the <a href="http://stanford.edu/~mwaskom/software/seaborn/examples/index.html">Seaborn gallery</a>.</p>
</div></section>



</div></section>













<section data-type="sect2" data-pdf-bookmark="Example: Exploring Marathon Finishing Times"><div class="sect2" id="example-exploring-marathon-finishing-times">
<h2>Example: Exploring Marathon Finishing Times</h2>

<p><a data-type="indexterm" data-primary="Seaborn" data-secondary="marathon finishing times example" id="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc114"></a>Here we’ll look at using Seaborn to help visualize and understand
finishing results from a marathon. I’ve scraped the data from sources on the Web, aggregated it and removed any identifying information, and put it
on GitHub where it can be downloaded (if you are interested in using
Python for web scraping, I would recommend <a class="orm:hideurl" href="http://shop.oreilly.com/product/0636920034391.do"><em>Web Scraping with Python</em></a> by Ryan Mitchell). We will start by downloading the data from the Web, and loading it into Pandas:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">22</code><code class="p">]:</code>
<code class="c1"># !curl -O https://raw.githubusercontent.com/jakevdp/marathon-data/</code>
<code class="c1"># master/marathon-data.csv</code></pre>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">23</code><code class="p">]:</code> <code class="n">data</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="s1">'marathon-data.csv'</code><code class="p">)</code>
        <code class="n">data</code><code class="o">.</code><code class="n">head</code><code class="p">()</code></pre>

<pre data-type="programlisting">Out[23]:    age gender     split     final
         0   33      M  01:05:38  02:08:51
         1   32      M  01:06:26  02:09:28
         2   31      M  01:06:49  02:10:42
         3   38      M  01:06:16  02:13:45
         4   31      M  01:06:32  02:13:59</pre>

<p>By default, Pandas loaded the time columns as Python strings (type
<code>object</code>); we can see this by looking at the <code>dtypes</code> attribute of the
<code>DataFrame</code>:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">24</code><code class="p">]:</code> <code class="n">data</code><code class="o">.</code><code class="n">dtypes</code></pre>

<pre data-type="programlisting">Out[24]: age        int64
         gender    object
         split     object
         final     object
         dtype: object</pre>

<p>Let’s fix this by providing a converter for the times:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">25</code><code class="p">]:</code> <code class="k">def</code> <code class="nf">convert_time</code><code class="p">(</code><code class="n">s</code><code class="p">):</code>
            <code class="n">h</code><code class="p">,</code> <code class="n">m</code><code class="p">,</code> <code class="n">s</code> <code class="o">=</code> <code class="nb">map</code><code class="p">(</code><code class="nb">int</code><code class="p">,</code> <code class="n">s</code><code class="o">.</code><code class="n">split</code><code class="p">(</code><code class="s1">':'</code><code class="p">))</code>
            <code class="k">return</code> <code class="n">pd</code><code class="o">.</code><code class="n">datetools</code><code class="o">.</code><code class="n">timedelta</code><code class="p">(</code><code class="n">hours</code><code class="o">=</code><code class="n">h</code><code class="p">,</code> <code class="n">minutes</code><code class="o">=</code><code class="n">m</code><code class="p">,</code> <code class="n">seconds</code><code class="o">=</code><code class="n">s</code><code class="p">)</code>

        <code class="n">data</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="s1">'marathon-data.csv'</code><code class="p">,</code>
                           <code class="n">converters</code><code class="o">=</code><code class="p">{</code><code class="s1">'split'</code><code class="p">:</code><code class="n">convert_time</code><code class="p">,</code> <code class="s1">'final'</code><code class="p">:</code><code class="n">convert_time</code><code class="p">})</code>
        <code class="n">data</code><code class="o">.</code><code class="n">head</code><code class="p">()</code></pre>

<pre data-type="programlisting">Out[25]:    age gender    split    final
         0   33      M 01:05:38 02:08:51
         1   32      M 01:06:26 02:09:28
         2   31      M 01:06:49 02:10:42
         3   38      M 01:06:16 02:13:45
         4   31      M 01:06:32 02:13:59</pre>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">26</code><code class="p">]:</code> <code class="n">data</code><code class="o">.</code><code class="n">dtypes</code></pre>

<pre data-type="programlisting">Out[26]: age                 int64
         gender             object
         split     timedelta64[ns]
         final     timedelta64[ns]
         dtype: object</pre>

<p>That looks much better. For the purpose of our Seaborn plotting
utilities, let’s next add columns that give the times in seconds:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">27</code><code class="p">]:</code> <code class="n">data</code><code class="p">[</code><code class="s1">'split_sec'</code><code class="p">]</code> <code class="o">=</code> <code class="n">data</code><code class="p">[</code><code class="s1">'split'</code><code class="p">]</code><code class="o">.</code><code class="n">astype</code><code class="p">(</code><code class="nb">int</code><code class="p">)</code> <code class="o">/</code> <code class="mf">1E9</code>
        <code class="n">data</code><code class="p">[</code><code class="s1">'final_sec'</code><code class="p">]</code> <code class="o">=</code> <code class="n">data</code><code class="p">[</code><code class="s1">'final'</code><code class="p">]</code><code class="o">.</code><code class="n">astype</code><code class="p">(</code><code class="nb">int</code><code class="p">)</code> <code class="o">/</code> <code class="mf">1E9</code>
        <code class="n">data</code><code class="o">.</code><code class="n">head</code><code class="p">()</code></pre>

<pre data-type="programlisting">Out[27]:    age gender    split    final  split_sec  final_sec
         0   33      M 01:05:38 02:08:51     3938.0     7731.0
         1   32      M 01:06:26 02:09:28     3986.0     7768.0
         2   31      M 01:06:49 02:10:42     4009.0     7842.0
         3   38      M 01:06:16 02:13:45     3976.0     8025.0
         4   31      M 01:06:32 02:13:59     3992.0     8039.0</pre>

<p>To get an idea of what the data looks like, we can plot a <code>jointplot</code>
over the data (<a data-type="xref" href="#fig04126">Figure 4-126</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">28</code><code class="p">]:</code> <code class="k">with</code> <code class="n">sns</code><code class="o">.</code><code class="n">axes_style</code><code class="p">(</code><code class="s1">'white'</code><code class="p">):</code>
            <code class="n">g</code> <code class="o">=</code> <code class="n">sns</code><code class="o">.</code><code class="n">jointplot</code><code class="p">(</code><code class="s2">"split_sec"</code><code class="p">,</code> <code class="s2">"final_sec"</code><code class="p">,</code> <code class="n">data</code><code class="p">,</code> <code class="n">kind</code><code class="o">=</code><code class="s1">'hex'</code><code class="p">)</code>
            <code class="n">g</code><code class="o">.</code><code class="n">ax_joint</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">4000</code><code class="p">,</code> <code class="mi">16000</code><code class="p">),</code>
                            <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">8000</code><code class="p">,</code> <code class="mi">32000</code><code class="p">),</code> <code class="s1">':k'</code><code class="p">)</code></pre>

<figure><div id="fig04126" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in126.png" alt="png" width="437" height="422">
<h6><span class="label">Figure 4-126. </span>The relationship between the split for the first half-marathon and the finishing time for the full marathon</h6>
</div></figure>

<p>The dotted line shows where someone’s time would lie if they ran the
marathon at a perfectly steady pace. The fact that the distribution lies
above this indicates (as you might expect) that most people slow down
over the course of the marathon. If you have run competitively, you’ll
know that those who do the opposite—run faster during the second half
of the race—are said to have “negative-split” the race.</p>

<p>Let’s create another column in the data, the split fraction, which
measures the degree to which each runner negative-splits or
positive-splits the race:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">29</code><code class="p">]:</code> <code class="n">data</code><code class="p">[</code><code class="s1">'split_frac'</code><code class="p">]</code> <code class="o">=</code> <code class="mi">1</code> <code class="o">-</code> <code class="mi">2</code> <code class="o">*</code> <code class="n">data</code><code class="p">[</code><code class="s1">'split_sec'</code><code class="p">]</code> <code class="o">/</code> <code class="n">data</code><code class="p">[</code><code class="s1">'final_sec'</code><code class="p">]</code>
        <code class="n">data</code><code class="o">.</code><code class="n">head</code><code class="p">()</code></pre>

<pre data-type="programlisting">Out[29]:    age gender    split    final  split_sec  final_sec  split_frac
         0   33      M 01:05:38 02:08:51     3938.0     7731.0   -0.018756
         1   32      M 01:06:26 02:09:28     3986.0     7768.0   -0.026262
         2   31      M 01:06:49 02:10:42     4009.0     7842.0   -0.022443
         3   38      M 01:06:16 02:13:45     3976.0     8025.0    0.009097
         4   31      M 01:06:32 02:13:59     3992.0     8039.0    0.006842</pre>

<p>Where this split difference is less than zero, the person negative-split
the race by that fraction. Let’s do a distribution plot of this split
fraction (<a data-type="xref" href="#fig04127">Figure 4-127</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">30</code><code class="p">]:</code> <code class="n">sns</code><code class="o">.</code><code class="n">distplot</code><code class="p">(</code><code class="n">data</code><code class="p">[</code><code class="s1">'split_frac'</code><code class="p">],</code> <code class="n">kde</code><code class="o">=</code><code class="bp">False</code><code class="p">);</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">axvline</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s2">"k"</code><code class="p">,</code> <code class="n">linestyle</code><code class="o">=</code><code class="s2">"--"</code><code class="p">);</code></pre>

<figure><div id="fig04127" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in127.png" alt="png" width="501" height="358">
<h6><span class="label">Figure 4-127. </span>The distribution of split fractions; 0.0 indicates a runner who completed the first and second halves in identical times</h6>
</div></figure>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">31</code><code class="p">]:</code> <code class="nb">sum</code><code class="p">(</code><code class="n">data</code><code class="o">.</code><code class="n">split_frac</code> <code class="o">&lt;</code> <code class="mi">0</code><code class="p">)</code></pre>

<pre data-type="programlisting">Out[31]: 251</pre>

<p>Out of nearly 40,000 participants, there were only 250 people who
negative-split their marathon.</p>

<p>Let’s see whether there is any correlation between this split fraction
and other variables. We’ll do this using a <code>pairgrid</code>, which draws plots
of all these correlations (<a data-type="xref" href="#fig04128">Figure 4-128</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">32</code><code class="p">]:</code>
<code class="n">g</code> <code class="o">=</code> <code class="n">sns</code><code class="o">.</code><code class="n">PairGrid</code><code class="p">(</code><code class="n">data</code><code class="p">,</code> <code class="nb">vars</code><code class="o">=</code><code class="p">[</code><code class="s1">'age'</code><code class="p">,</code> <code class="s1">'split_sec'</code><code class="p">,</code> <code class="s1">'final_sec'</code><code class="p">,</code> <code class="s1">'split_frac'</code><code class="p">],</code>
                 <code class="n">hue</code><code class="o">=</code><code class="s1">'gender'</code><code class="p">,</code> <code class="n">palette</code><code class="o">=</code><code class="s1">'RdBu_r'</code><code class="p">)</code>
<code class="n">g</code><code class="o">.</code><code class="n">map</code><code class="p">(</code><code class="n">plt</code><code class="o">.</code><code class="n">scatter</code><code class="p">,</code> <code class="n">alpha</code><code class="o">=</code><code class="mf">0.8</code><code class="p">)</code>
<code class="n">g</code><code class="o">.</code><code class="n">add_legend</code><code class="p">();</code></pre>

<figure><div id="fig04128" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in128.png" alt="png" width="775" height="710">
<h6><span class="label">Figure 4-128. </span>The relationship between quantities within the marathon dataset</h6>
</div></figure>

<p>It looks like the split fraction does not correlate particularly with
age, but does correlate with the final time: faster runners tend to have
closer to even splits on their marathon time. (We see here that Seaborn
is no panacea for Matplotlib’s ills when it comes to plot styles: in
particular, the <em>x</em>-axis labels overlap. Because the output is a simple
Matplotlib plot, however, the methods in
<a data-type="xref" href="#customizing-ticks">“Customizing Ticks”</a> can be used to
adjust such things if desired.)</p>

<p>The difference between men and women here is interesting. Let’s look at
the histogram of split fractions for these two groups (<a data-type="xref" href="#fig04129">Figure 4-129</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">33</code><code class="p">]:</code> <code class="n">sns</code><code class="o">.</code><code class="n">kdeplot</code><code class="p">(</code><code class="n">data</code><code class="o">.</code><code class="n">split_frac</code><code class="p">[</code><code class="n">data</code><code class="o">.</code><code class="n">gender</code><code class="o">==</code><code class="s1">'M'</code><code class="p">],</code> <code class="n">label</code><code class="o">=</code><code class="s1">'men'</code><code class="p">,</code> <code class="n">shade</code><code class="o">=</code><code class="bp">True</code><code class="p">)</code>
        <code class="n">sns</code><code class="o">.</code><code class="n">kdeplot</code><code class="p">(</code><code class="n">data</code><code class="o">.</code><code class="n">split_frac</code><code class="p">[</code><code class="n">data</code><code class="o">.</code><code class="n">gender</code><code class="o">==</code><code class="s1">'W'</code><code class="p">],</code> <code class="n">label</code><code class="o">=</code><code class="s1">'women'</code><code class="p">,</code> <code class="n">shade</code><code class="o">=</code><code class="bp">True</code><code class="p">)</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">xlabel</code><code class="p">(</code><code class="s1">'split_frac'</code><code class="p">);</code></pre>

<figure><div id="fig04129" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in129.png" alt="png" width="482" height="358">
<h6><span class="label">Figure 4-129. </span>The distribution of split fractions by gender</h6>
</div></figure>

<p>The interesting thing here is that there are many more men than women
who are running close to an even split! This almost looks like some kind
of bimodal distribution among the men and women. Let’s see if we can
suss out what’s going on by looking at the distributions as a function
of age.</p>

<p><a data-type="indexterm" data-primary="violin plot" id="idm45026291072168"></a>A nice way to compare distributions is to use a <em>violin plot</em> (<a data-type="xref" href="#fig04130">Figure 4-130</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">34</code><code class="p">]:</code>
<code class="n">sns</code><code class="o">.</code><code class="n">violinplot</code><code class="p">(</code><code class="s2">"gender"</code><code class="p">,</code> <code class="s2">"split_frac"</code><code class="p">,</code> <code class="n">data</code><code class="o">=</code><code class="n">data</code><code class="p">,</code>
               <code class="n">palette</code><code class="o">=</code><code class="p">[</code><code class="s2">"lightblue"</code><code class="p">,</code> <code class="s2">"lightpink"</code><code class="p">]);</code></pre>

<figure><div id="fig04130" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in130.png" alt="png" width="507" height="358">
<h6><span class="label">Figure 4-130. </span>A violin plot showing the split fraction by gender</h6>
</div></figure>

<p>This is yet another way to compare the distributions between men and
women.</p>

<p>Let’s look a little deeper, and compare these violin plots as a function
of age. We’ll start by creating a new column in the array that
specifies the decade of age that each person is in (<a data-type="xref" href="#fig04131">Figure 4-131</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">35</code><code class="p">]:</code> <code class="n">data</code><code class="p">[</code><code class="s1">'age_dec'</code><code class="p">]</code> <code class="o">=</code> <code class="n">data</code><code class="o">.</code><code class="n">age</code><code class="o">.</code><code class="n">map</code><code class="p">(</code><code class="k">lambda</code> <code class="n">age</code><code class="p">:</code> <code class="mi">10</code> <code class="o">*</code> <code class="p">(</code><code class="n">age</code> <code class="o">//</code> <code class="mi">10</code><code class="p">))</code>
<code class="n">data</code><code class="o">.</code><code class="n">head</code><code class="p">()</code></pre>

<pre data-type="programlisting">Out[35]:
   age gender    split    final  split_sec  final_sec  split_frac  age_dec
0   33      M 01:05:38 02:08:51     3938.0     7731.0   -0.018756       30
1   32      M 01:06:26 02:09:28     3986.0     7768.0   -0.026262       30
2   31      M 01:06:49 02:10:42     4009.0     7842.0   -0.022443       30
3   38      M 01:06:16 02:13:45     3976.0     8025.0    0.009097       30
4   31      M 01:06:32 02:13:59     3992.0     8039.0    0.006842       30</pre>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">36</code><code class="p">]:</code>
<code class="n">men</code> <code class="o">=</code> <code class="p">(</code><code class="n">data</code><code class="o">.</code><code class="n">gender</code> <code class="o">==</code> <code class="s1">'M'</code><code class="p">)</code>
<code class="n">women</code> <code class="o">=</code> <code class="p">(</code><code class="n">data</code><code class="o">.</code><code class="n">gender</code> <code class="o">==</code> <code class="s1">'W'</code><code class="p">)</code>

<code class="k">with</code> <code class="n">sns</code><code class="o">.</code><code class="n">axes_style</code><code class="p">(</code><code class="n">style</code><code class="o">=</code><code class="bp">None</code><code class="p">):</code>
    <code class="n">sns</code><code class="o">.</code><code class="n">violinplot</code><code class="p">(</code><code class="s2">"age_dec"</code><code class="p">,</code> <code class="s2">"split_frac"</code><code class="p">,</code> <code class="n">hue</code><code class="o">=</code><code class="s2">"gender"</code><code class="p">,</code> <code class="n">data</code><code class="o">=</code><code class="n">data</code><code class="p">,</code>
                  <code class="n">split</code><code class="o">=</code><code class="bp">True</code><code class="p">,</code> <code class="n">inner</code><code class="o">=</code><code class="s2">"quartile"</code><code class="p">,</code>
                  <code class="n">palette</code><code class="o">=</code><code class="p">[</code><code class="s2">"lightblue"</code><code class="p">,</code> <code class="s2">"lightpink"</code><code class="p">]);</code></pre>

<figure><div id="fig04131" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in131.png" alt="png" width="507" height="353">
<h6><span class="label">Figure 4-131. </span>A violin plot showing the split fraction by gender and age</h6>
</div></figure>

<p>Looking at this, we can see where the distributions of men and women
differ: the split distributions of men in their 20s to 50s show a
pronounced over-density toward lower splits when compared to women of
the same age (or of any age, for that <span class="keep-together">matter</span>).</p>

<p>Also surprisingly, the 80-year-old women seem to outperform <em>everyone</em>
in terms of their split time. This is probably due to the fact that
we’re estimating the distribution from small numbers, as there are only
a handful of runners in that range:</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">38</code><code class="p">]:</code> <code class="p">(</code><code class="n">data</code><code class="o">.</code><code class="n">age</code> <code class="o">&gt;</code> <code class="mi">80</code><code class="p">)</code><code class="o">.</code><code class="n">sum</code><code class="p">()</code></pre>

<pre data-type="programlisting">Out[38]: 7</pre>

<p>Back to the men with negative splits: who are these runners? Does this
split fraction correlate with finishing quickly? We can plot this very
easily. We’ll use <code>regplot</code>, which will automatically fit a linear
regression to the data (<a data-type="xref" href="#fig04132">Figure 4-132</a>):</p>

<pre data-type="programlisting" data-code-language="python"><code class="n">In</code><code class="p">[</code><code class="mi">37</code><code class="p">]:</code> <code class="n">g</code> <code class="o">=</code> <code class="n">sns</code><code class="o">.</code><code class="n">lmplot</code><code class="p">(</code><code class="s1">'final_sec'</code><code class="p">,</code> <code class="s1">'split_frac'</code><code class="p">,</code> <code class="n">col</code><code class="o">=</code><code class="s1">'gender'</code><code class="p">,</code> <code class="n">data</code><code class="o">=</code><code class="n">data</code><code class="p">,</code>
                       <code class="n">markers</code><code class="o">=</code><code class="s2">"."</code><code class="p">,</code> <code class="n">scatter_kws</code><code class="o">=</code><code class="nb">dict</code><code class="p">(</code><code class="n">color</code><code class="o">=</code><code class="s1">'c'</code><code class="p">))</code>
        <code class="n">g</code><code class="o">.</code><code class="n">map</code><code class="p">(</code><code class="n">plt</code><code class="o">.</code><code class="n">axhline</code><code class="p">,</code> <code class="n">y</code><code class="o">=</code><code class="mf">0.1</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s2">"k"</code><code class="p">,</code> <code class="n">ls</code><code class="o">=</code><code class="s2">":"</code><code class="p">);</code></pre>

<figure><div id="fig04132" class="figure">
<img src="/library/view/python-data-science/9781491912126/assets/pyds_04in132.png" alt="png" width="708" height="350">
<h6><span class="label">Figure 4-132. </span>Split fraction versus finishing time by gender</h6>
</div></figure>

<p>Apparently the people with fast splits are the elite runners who are
finishing within ~15,000 seconds, or about 4 hours. People slower than that
are much less likely to have a fast second split<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc114" id="idm45026290729640"></a>.<a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc111" id="idm45026290728840"></a><a data-type="indexterm" data-startref="ix_04-00-Introduction-To-Matplotlib_processed-asciidoc106" id="idm45026290728168"></a></p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Further Resources"><div class="sect1" id="further-resources-matplotlib">
<h1>Further Resources</h1>








<section data-type="sect2" data-pdf-bookmark="Matplotlib Resources"><div class="sect2" id="matplotlib-resources">
<h2>Matplotlib Resources</h2>

<p><a data-type="indexterm" data-primary="Matplotlib" id="idm45026290725768"></a><a data-type="indexterm" data-primary="Matplotlib" data-secondary="resources and documentation for" id="idm45026290725064"></a>A single chapter in a book can never hope to cover all the available
features and plot types available in Matplotlib. As with other packages
we’ve seen, liberal use of IPython’s tab-completion and help functions
(see <a data-type="xref" href="ch01.html#help-and-documentation-in-ipython">“Help and Documentation in IPython”</a>) can be very helpful when you’re exploring Matplotlib’s API. In
addition, Matplotlib’s <a href="http://matplotlib.org/">online documentation</a>
can be a helpful reference. See in particular the
<a href="http://matplotlib.org/gallery.html">Matplotlib gallery</a> linked on that
page: it shows thumbnails of hundreds of different plot types, each one
linked to a page with the Python code snippet used to generate it. In
this way, you can visually inspect and learn about a wide range of
different plotting styles and visualization techniques.</p>

<p>For a book-length treatment of Matplotlib, I would recommend
<a href="http://bit.ly/2fSqswQ"><em>Interactive
Applications Using Matplotlib</em></a>, written by Matplotlib core developer
Ben Root.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Other Python Graphics Libraries"><div class="sect2" id="other-python-graphics-libraries">
<h2>Other Python Graphics Libraries</h2>

<p><a data-type="indexterm" data-primary="graphics libraries" id="idm45026290718008"></a><a data-type="indexterm" data-primary="plotting" data-secondary="various Python graphics libraries" id="idm45026290717304"></a>Although Matplotlib is the most prominent Python visualization library,
there are other more modern tools that are worth exploring as well. I’ll
mention a few of them briefly here:</p>

<ul>
<li>
<p><a href="http://bokeh.pydata.org">Bokeh</a> <a data-type="indexterm" data-primary="Bokeh" id="idm45026290714392"></a>is a JavaScript visualization library
with a Python frontend that creates highly interactive visualizations
capable of handling very large and/or streaming datasets. The Python
frontend outputs a JSON data structure that can be interpreted by the
Bokeh JS engine.</p>
</li>
<li>
<p><a href="http://plot.ly">Plotly</a> <a data-type="indexterm" data-primary="Plotly" id="idm45026290711864"></a>is the eponymous open source product of the
Plotly company, and is similar in spirit to Bokeh. Because Plotly is the
main product of a startup, it is receiving a high level of development
effort. Use of the library is entirely free.</p>
</li>
<li>
<p><a href="http://vispy.org/">Vispy</a> <a data-type="indexterm" data-primary="Vispy" id="idm45026290709352"></a>is an actively developed project focused on
dynamic visualizations of very large datasets. Because it is built to
target OpenGL and make use of efficient graphics processors in your
computer, it is able to render some quite large and stunning
visualizations.</p>
</li>
<li>
<p><a href="https://vega.github.io/">Vega</a> <a data-type="indexterm" data-primary="Vega/Vega-Lite" id="idm45026290706824"></a>and
<a href="https://vega.github.io/vega-lite">Vega-Lite</a> are declarative graphics
representations, and are the product of years of research into the
fundamental language of data visualization. The reference rendering
implementation is JavaScript, but the API is language agnostic. There is
a Python API under development in the
<a href="http://altair-viz.github.io/">Altair package</a>. Though it’s not
mature yet, I’m quite excited for the possibilities of this project to
provide a common reference point for visualization in Python and other
languages.</p>
</li>
</ul>

<p>The visualization space in the Python community is very dynamic, and I
fully expect this list to be out of date as soon as it is published.
Keep an eye out for what’s coming in the future!</p>
</div></section>





</div></section>







</div></section></div>
    </div>
    
    <section class="t-bottom-cta bottom-cta bottom-cta-book free-chapter">
  <p>Get <em>Python Data Science Handbook</em> now with O’Reilly <span class="nowrap">online learning.</span></p>
  <p>O’Reilly members experience live online training, plus books, videos, and digital content from <span class="nowrap">200+ publishers.</span></p>

  <div class="controls">
      <a href="https://learning.oreilly.com/p/register/" class="button-primary" data-ga-label="Bottom CTA">Start your free trial</a>
  </div>
</section>

</div>


</section>



  </div>
</main>


  <footer id="footer" class="footer">
  <div class="content">
    <div class="footer-main" aria-label="company info">
      <div class="footer-mainLeft">
        <div class="footer-mainLeftOne">
          <div class="footer-approach">
            <h2 class="footer-header"><a href="https://www.oreilly.com/about/">About O’Reilly</a></h2>
            <ul class="footer-links">
              <li><a href="https://www.oreilly.com/work-with-us.html">Teach/write/train</a></li>
              <li><a href="https://www.oreilly.com/careers/">Careers</a></li>
              <li><a href="https://www.oreilly.com/partner/signup.csp">Community partners</a></li>
              <li><a href="https://www.oreilly.com/affiliates/">Affiliate program</a></li>
              <li><a href="https://www.oreilly.com/diversity/">Diversity</a></li>
            </ul>
          </div>
        </div>
        <div class="footer-mainLeftTwo">
          <div class="footer-contact">
            <h2 class="footer-header"><a href="https://www.oreilly.com/online-learning/support/">Support</a></h2>

            <ul class="footer-links">
              <li><a href="https://www.oreilly.com/about/contact.html">Contact us</a></li>
              <li><a href="https://www.oreilly.com/emails/newsletters/">Newsletters</a></li>
              <li><a href="https://www.oreilly.com/privacy.html">Privacy policy</a></li>
            </ul>
          
            <a href="https://twitter.com/oreillymedia" target="_blank"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 400 400" style="enable-background:new 0 0 400 400;" xml:space="preserve"><style type="text/css">.st0{fill:#ee0000;}.st1{fill:#FFFFFF;}</style><g id="Red"><circle class="st0" cx="200" cy="200" r="200"/></g><g id="Logo__x2014__FIXED"><path class="st1" d="M163.4,305.5c88.7,0,137.2-73.5,137.2-137.2c0-2.1,0-4.2-0.1-6.2c9.4-6.8,17.6-15.3,24.1-25 c-8.6,3.8-17.9,6.4-27.7,7.6c10-6,17.6-15.4,21.2-26.7c-9.3,5.5-19.6,9.5-30.6,11.7c-8.8-9.4-21.3-15.2-35.2-15.2 c-26.6,0-48.2,21.6-48.2,48.2c0,3.8,0.4,7.5,1.3,11c-40.1-2-75.6-21.2-99.4-50.4c-4.1,7.1-6.5,15.4-6.5,24.2 c0,16.7,8.5,31.5,21.5,40.1c-7.9-0.2-15.3-2.4-21.8-6c0,0.2,0,0.4,0,0.6c0,23.4,16.6,42.8,38.7,47.3c-4,1.1-8.3,1.7-12.7,1.7 c-3.1,0-6.1-0.3-9.1-0.9c6.1,19.2,23.9,33.1,45,33.5c-16.5,12.9-37.3,20.6-59.9,20.6c-3.9,0-7.7-0.2-11.5-0.7 C110.8,297.5,136.2,305.5,163.4,305.5"/></g></svg></a>
            <a href="https://www.facebook.com/OReilly/" target="_blank"><svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32.25 32.25"><defs><style>.cls-1{fill:#E00;fill-rule:evenodd;}</style></defs><title>facebook-logo</title><path class="cls-1" d="M16.13,0A16.13,16.13,0,1,0,32.25,16.12,16.13,16.13,0,0,0,16.13,0Zm5.12,9.54H19.57a1.52,1.52,0,0,0-1.51,1.51v1.14h3.19v3.42H18.06V26.12H13.57V15.61H10.69V12.19h2.88v-2a4,4,0,0,1,4-4h3.65Z"/></svg></a>
            <a href="https://www.linkedin.com/company/oreilly-media" target="_blank"><svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32.25 32.25"><defs><style>.cls-1{fill:#E00;fill-rule:evenodd;}</style></defs><title>linkedin-logo</title><path class="cls-1" d="M17.43,13.53v0l0,0ZM16.12,0A16.13,16.13,0,1,0,32.25,16.12,16.12,16.12,0,0,0,16.12,0ZM11.77,22.92H8.12v-11h3.65ZM9.94,10.44h0a1.89,1.89,0,0,1-2-1.89A1.91,1.91,0,0,1,10,6.65a1.9,1.9,0,1,1,0,3.79Zm15,12.48H21.28V17.05c0-1.48-.53-2.49-1.85-2.49a2,2,0,0,0-1.88,1.34,2.63,2.63,0,0,0-.12.89v6.13H13.79s.05-10,0-11h3.64V13.5a3.63,3.63,0,0,1,3.29-1.82c2.4,0,4.21,1.57,4.21,4.95Z"/></svg></a>
            <a href="https://www.youtube.com/user/OreillyMedia" target="_blank"><svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32.25 32.25"><defs><style>.cls-1{fill:#E00;fill-rule:evenodd;}</style></defs><title>youtube-logo</title><path class="cls-1" d="M18.35,18.68a.89.89,0,0,0-.86.63V16.94h-1v7.59h1v-.59a.92.92,0,0,0,.89.74c.52,0,.86-.36,1-1.07a8.56,8.56,0,0,0,.14-1.9,10.47,10.47,0,0,0-.12-1.93C19.21,19.05,18.87,18.68,18.35,18.68Zm.09,4.14c-.05.52-.2.77-.45.77s-.43-.21-.49-.63a7.22,7.22,0,0,1,0-1c0-.72,0-1.14,0-1.26.07-.58.23-.88.51-.88s.4.27.46.79c0,.09,0,.47,0,1.13S18.46,22.71,18.44,22.82ZM8.61,18.19H9.86v6.34H11V18.19H12.2V16.94H8.61Zm7.71-6.12c.27,0,.43-.22.49-.66,0-.09,0-.45,0-1.07V9.78c0-.58,0-.93,0-1-.07-.43-.23-.65-.48-.65s-.41.19-.48.57a8.79,8.79,0,0,0,0,1v.53c0,.71,0,1.09,0,1.16C15.88,11.82,16.05,12.07,16.32,12.07Zm-1.74,10.4a2.92,2.92,0,0,1-.06.71c-.07.25-.2.37-.4.37s-.32-.11-.38-.34a2.63,2.63,0,0,1-.05-.66V18.83h-1v4.48c0,.91.33,1.37,1,1.37A1,1,0,0,0,14.6,24v.57h1v-5.7h-1Zm7.1-3.79a1.35,1.35,0,0,0-1.22.59,2.48,2.48,0,0,0-.3,1.07c0,.23,0,.61,0,1.16s0,1.13,0,1.37a2.93,2.93,0,0,0,.35,1.27,1.25,1.25,0,0,0,1.14.54,1.36,1.36,0,0,0,1.13-.45,2.29,2.29,0,0,0,.37-1.43s0-.07,0-.11v-.12h-1c0,.75-.17,1.12-.51,1.12s-.38-.18-.45-.56a4.68,4.68,0,0,1-.06-.9c0-.18,0-.31,0-.37h2v-.43a4.86,4.86,0,0,0-.3-2.11A1.28,1.28,0,0,0,21.68,18.68ZM22.15,21h-1c0-.05,0-.11,0-.16v-.08a1.64,1.64,0,0,1,.11-.8.39.39,0,0,1,.38-.23.42.42,0,0,1,.43.33,2.32,2.32,0,0,1,.07.7Zm-6-21A16.13,16.13,0,1,0,32.25,16.12,16.12,16.12,0,0,0,16.12,0Zm2.51,7.2h1V11a2.52,2.52,0,0,0,.06.66c.06.23.18.34.38.34s.34-.12.41-.37a3.76,3.76,0,0,0,.05-.71V7.2h1v5.74h-1v-.57a1,1,0,0,1-.93.72c-.66,0-1-.46-1-1.38ZM15,8a1.29,1.29,0,0,1,1.33-.92A1.3,1.3,0,0,1,17.65,8a6.77,6.77,0,0,1,.23,2.1,6.77,6.77,0,0,1-.23,2.1,1.3,1.3,0,0,1-1.32.92A1.29,1.29,0,0,1,15,12.17a6.77,6.77,0,0,1-.23-2.1A6.86,6.86,0,0,1,15,8ZM11.45,5.3l.89,2.87.88-2.87H14.4L12.88,9.7v3.24h-1.1V9.7L10.24,5.3ZM24.93,23.91a3,3,0,0,1-3,3h-12a3,3,0,0,1-3-3V18.05a3,3,0,0,1,3-3h12a3,3,0,0,1,3,3Z"/></svg></a>
          </div>
        </div>
      </div>

      <div class="footer-download" id="download-info">
        <h2 class="footer-header">Download the O’Reilly App</h2>

        <div class="footer-downloadLinks">
          <a href="https://itunes.apple.com/us/app/safari-to-go/id881697395"><img src="https://cdn.oreillystatic.com/oreilly/images/app-store-logo.png" alt="Apple app store" /></a>
          <a href="https://play.google.com/store/apps/details?id=com.safariflow.queue"><img src="https://cdn.oreillystatic.com/oreilly/images/google-play-logo.png"  alt="Google play store" /></a>
        </div>

        <p>Take O’Reilly online learning with you and learn anywhere, anytime on your phone <span class="nowrap">and tablet.</span></p>

        <ul>
          <li>Get unlimited access to books, videos, and <span class="nowrap">live training.</span></li>
          <li>Sync all your devices and never lose your place.</li>
          <li>Learn even when there’s no signal with <span class="nowrap">offline access.</span></li>
        </ul>
      </div>

      <div class="footer-donotsell" id="donotsell-info">
        <h2 class="footer-header">Do not sell my personal information</h2>

        <p style="line-height: 1.5em;">Exercise your consumer rights by contacting us at <a href="mailto:donotsell@oreilly.com?subject=Do Not Sell My Personal Information Request" style="text-decoration:underline;">donotsell@oreilly.com</a>.</p>
      </div>
    </div>

    <div class="footer-subfooter">

      <a href="https://www.oreilly.com" title="home page" aria-current="page">
        <img 
        class="footer-subfooterLogo" 
        id="footer-subfooterLogo"
        src="https://cdn.oreillystatic.com/images/sitewide-headers/oreilly_logo_mark_red.svg" 
        onerror="this.src='https://cdn.oreillystatic.com/images/sitewide-headers/oreilly_logo_mark_red_@2x.png'; this.onerror=null;" 
        alt="O'Reilly home">
      </a>

      <p>&copy; 2020, O’Reilly Media, Inc. All trademarks and registered trademarks appearing on oreilly.com are the property of their respective owners.</p>
      
      

      <p><a href="https://www.oreilly.com/terms/">Terms of service</a> • <a href="https://www.oreilly.com/privacy.html">Privacy policy</a> • <a href="https://www.oreilly.com/about/editorial_independence.html">Editorial independence</a></p>
    </div>

  </div>
</footer>




<script>
  var g = {
    
    position_cache: {},
    title: "Python Data Science Handbook",
    author_list: "Jake VanderPlas",
    format: "book",
    source: "application/epub+zip",
    is_system_book: true,
    is_public: true,
    loaded_from_server: true,
    allow_scripts: false,
    has_mathml: true
    
  };
</script>
<script>
  window.dataLayer = window.dataLayer || [];
  window.dataLayer.push({
    'product.title': "Python Data Science Handbook",
    'product.type': "book",
    'product.identifier': "9781491912126",
    'content.identifier': "9781491912126/ch04.html",
    'content.publisher': "O'Reilly Media, Inc.",
    'content.free': "no",
    
    'content.subdirectory': "none",
    'content.subTopic': "none",
    'content.parentTopic': "none",
    'content.formatType': "book-chapter",
    'content.author': "Jake VanderPlas",
    'content.releaseDate': "2016-11-30",
    'content.title': "4. Visualization with Matplotlib",
  });
</script>






<script src="/library/view/static/CACHE/js/output.3fa4edd6d217.js"></script>


<noscript> 
  <iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P4V6Z"
          height="0" width="0"
          style="display:none;visibility:hidden">
  </iframe>
</noscript>


<script async defer src="/library/view/pageview.js"></script>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>

<script>
  jQuery(document).ready(function($) {
    //Toggle isActive and mobileHidden classes for mobileNavButton
    $('nav #mobileNavButton').on('click', function() {
      var expanded = $(this).attr('aria-expanded') === 'true' || false;
      $(this).attr('aria-expanded', !expanded);
      $(this).toggleClass("isActive");
      $(this).next().toggleClass("mobileHidden");
    });

    //Toggle isFocused class for keyboard navigation of submenus
    $('nav #menuList .menuList-subItem a').each(function(navItem) {
      $(this).on('focus', function() {
        $(this).parent().parent().toggleClass('isFocused');
      });
      $(this).on('blur', function() {
        $(this).parent().parent().toggleClass('isFocused');
      });
    });

    //Toggle mobileHidden class accordian elements
    $('.mobileAccordian').each(function() {
      var $btn = $(this).find('button');
      var $target =  $(this).next();
      $btn.on('click', function() {
        var expanded = $btn.attr('aria-expanded') === 'true' || false;

        $btn.attr('aria-expanded', !expanded);
        $target.toggleClass("mobileHidden");
      });
    });


    //Hide title page's long description behind disclosure button
    var titleDescriptionExtra = $('.title-description p:first-of-type').nextAll(':nth-child(3)').nextAll();
    titleDescriptionExtra.wrapAll('<div id="titleDescriptionExtra" />');
    if (titleDescriptionExtra.length > 0) {
      $('#titleDescriptionExtra').toggle();
      $('#showMoreDescription').removeClass('hidden');
      $('#showMoreDescription button').on('click', function() {
        $(this).toggleClass('more');
        $('#titleDescriptionExtra').slideToggle();
      });
    }

    //Hide title page's long TOC behind disclosure button
    var titleTOCShort = $('.sbo-reader-title .detail-toc').find('li').slice(0,4);
    var titleTOCExtra = $('.sbo-reader-title .detail-toc').find('li').not(titleTOCShort);
    if (titleTOCExtra.length > 0) {
      titleTOCExtra.toggle();
      $('#showMoreTOC').removeClass('hidden');
      $('#showMoreTOC button').on('click', function() {
        $(this).toggleClass('more');
        titleTOCExtra.toggle();
      });
    }

    //Hide product information on page load
    $('#product-information').toggle();
    $('#title-tabs button').on('click', function() {
      var $thisTab = $(this);
      if (!$thisTab.hasClass('title-tab-active')) {
        var lastTabTarget = $('#title-tabs .title-tab-active').removeClass('title-tab-active').attr('data-target');
        $('#' + lastTabTarget).toggle();

        $thisTab.addClass('title-tab-active');
        var $tabTarget = $(this).attr('data-target');
        $('#' + $tabTarget).toggle();
      }
    });


    //Trigger GA events for related products
    $('#recommendations .recommendations-item').each(function(i) {
      $(this).on('click', function(e) {
        var cardTitle = $(this).find('.recommendations-title').text().toLowerCase();
        var productType = $(this).find('.recommendations-format').text().toLowerCase();
        var contentID = $(this).attr('data-id');
        var eventLbl = String(i);

        dataLayer.push({
          'product.title': undefined,
          'content.formatType': undefined,
          'product.identifier': undefined,
          'content.title': undefined,
          'content.author': undefined,
          'content.publisher': undefined,
          'content.releaseDate': undefined,
          'content.free': undefined,
          'content.subdirectory': undefined,
          'content.parentTopic': undefined,
          'content.subTopic': undefined,
          'event': 'eventTracker',
          'eventCat': 'recommended titles',
          'eventAct': 'card click',
          'eventLbl': eventLbl,
          'eventVal': 0, 
          'nonInteraction': 0,
          'cardTitle': cardTitle,
          'product.type': productType,
          'content.identifier': contentID,
          'eventCallback': function() {
            dataLayer.push({'cardTitle': undefined});
          },
          'eventTimeout' : 2000
        });
      });
    });

  });

</script>



<!-- MARC Intercept Support -->

<script src="https://service.seamlessaccess.org/thiss.js"></script>

<script src="/library/view/static/CACHE/js/output.5426f7a3b865.js"></script>


</body>
</html>
